var ej=function(t){"use strict";function e(t,e){var i=e;return i.unshift(void 0),new(Function.prototype.bind.apply(t,i))}function i(t){var e,i=new Uint16Array(5);(window.msCrypto||window.crypto).getRandomValues(i);var n="ej2"+C(i),o=function(i){i.source===window&&"string"==typeof i.data&&i.data.length<=32&&i.data===n&&(t(),e())};return window.addEventListener("message",o,!1),window.postMessage(n,"*"),e=function(){window.removeEventListener("message",o),t=o=n=void 0}}function n(t,e){for(var i=e,n=t.split("."),o=0;o<n.length&&!d(i);o++)i=i[n[o]];return i}function o(t,e,i){var n,o,r=t.split("."),s=i||{},a=s,l=r.length;for(n=0;n<l;n++)o=r[n],n+1===l?a[o]=void 0===e?{}:e:c(a[o])&&(a[o]={}),a=a[o];return s}function r(t,e){delete t[e]}function s(t){var e={};return!c(t)&&t.constructor===e.constructor}function a(t,e){return t[e]}function l(t,e){if(!c(e))for(var i=t,n=e,o=0,r=Object.keys(e);o<r.length;o++){var a=r[o];c(i.deepMerge)||-1===i.deepMerge.indexOf(a)||!s(n[a])&&!Array.isArray(n[a])?i[a]=n[a]:h(i[a],i[a],n[a],!0)}}function h(t,e,i,n){var o=t||{},r=arguments.length;n&&(r-=1);for(var a=arguments,l=1;l<r;l++)!function(t){if(!a[t])return"continue";var e=a[t];Object.keys(e).forEach(function(t){var i,r=o[t],a=e[t];n&&(s(a)||Array.isArray(a))?s(a)?(i=r||{},o[t]=h({},i,a,n)):(i=r||[],o[t]=h([],i,a,n)):o[t]=a})}(l);return o}function c(t){return void 0===t||null===t}function d(t){return void 0===t}function p(t){return t+"_"+Ta++}function u(t,e){var i;return function(){var n=this,o=arguments,r=function(){return i=null,t.apply(n,o)};clearTimeout(i),i=setTimeout(r,e)}}function g(t){for(var e=[],i=0,n=Object.keys(t);i<n.length;i++){var o=n[i];e.push(encodeURIComponent(o)+"="+encodeURIComponent(""+t[o]))}return e.join("&")}function m(t){var e=Object.prototype.toString;return"[object Array]"===e.call(t)&&"[object Object]"===e.call(t[0])}function f(t,e){var i=t;return i===e||!(i===document||!i)&&f(i.parentNode,e)}function v(t){try{throw new Error(t)}catch(t){throw t.message+"\n"+t.stack}}function y(t,e){var i=document.createElement("div"),n=[].slice.call(document.getElementsByTagName("head")[0].querySelectorAll("link, style")),o="";c(e)&&(e=window.open("","print","height=452,width=1024,tabbar=no")),i.appendChild(t.cloneNode(!0));for(var r=0,s=n.length;r<s;r++)o+=n[r].outerHTML;e.document.write("<!DOCTYPE html> <html><head>"+o+"</head><body>"+i.innerHTML+"<script> (function() { window.ready = true; })(); <\/script></body></html>"),e.document.close(),e.focus();var a=setInterval(function(){e.ready&&(e.print(),e.close(),clearInterval(a))},500);return e}function b(t){var e=t+"";return"auto"===e||-1!==e.indexOf("%")||-1!==e.indexOf("px")?e:e+"px"}function w(t,e){var i="string"==typeof t?document.querySelector(t):t;if(i[ka])for(var n=0,o=i[ka];n<o.length;n++){var r=o[n];if(r instanceof e)return r}return null}function x(t,e){var i="string"==typeof t?document.querySelector(t):t;i[ka]?i[ka].push(e):i[ka]=[e]}function S(){if("undefined"!=typeof window){var t=new Uint16Array(5);return(window.msCrypto||window.crypto).getRandomValues(t)}}function C(t){for(var e="",i=0;i<5;i++)e+=(i?",":"")+t[i];return e}function L(t,e){var i=Ra.test(t)?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t);return void 0===e?i:(i.innerHTML=e.innerHTML?e.innerHTML:"",void 0!==e.className&&(i.className=e.className),void 0!==e.id&&(i.id=e.id),void 0!==e.styles&&i.setAttribute("style",e.styles),void 0!==e.attrs&&R(i,e.attrs),i)}function E(t,e){for(var i=k(e),n=0,o=t;n<o.length;n++)for(var r=o[n],s=0,a=i;s<a.length;s++){var l=a[s];r.classList.contains(l)||r.classList.add(l)}return t}function P(t,e){for(var i=k(e),n=0,o=t;n<o.length;n++){var r=o[n];if(""!==r.className)for(var s=0,a=i;s<a.length;s++){var l=a[s];r.classList.remove(l)}}return t}function k(t){var e=[];return"string"==typeof t?e.push(t):e=t,e}function T(t){var e=t;return""===e.style.visibility&&e.offsetWidth>0}function O(t,e){for(var i=document.createDocumentFragment(),n=0,o=t;n<o.length;n++){var r=o[n];i.appendChild(r)}return e.insertBefore(i,e.firstElementChild),t}function I(t,e){for(var i=document.createDocumentFragment(),n=0,o=t;n<o.length;n++){var r=o[n];i.appendChild(r)}return e.appendChild(i),t}function A(t){return t.parentNode.removeChild(t)}function M(t){var e=t.parentNode;Ma.clearEvents(t),e.removeChild(t)}function R(t,e){for(var i=t,n=0,o=Object.keys(e);n<o.length;n++){var r=o[n];i.setAttribute(r,e[r])}return i}function D(t,e){return void 0===e&&(e=document),e.querySelector(t)}function B(t,e){return void 0===e&&(e=document),e.querySelectorAll(t)}function N(t,e){var i=t;if("function"==typeof i.closest)return i.closest(e);for(;i&&1===i.nodeType;){if(F(i,e))return i;i=i.parentNode}return null}function H(t){for(var e=[],i=0,n=Array.prototype.slice.call(t.parentNode.childNodes);i<n.length;i++){var o=n[i];o.nodeType===Node.ELEMENT_NODE&&t!==o&&e.push(o)}return e}function z(t,e,i){var n=t.getAttribute(e);return c(n)&&(t.setAttribute(e,i.toString()),n=i),n}function j(t,e){void 0!==e&&Object.keys(e).forEach(function(i){t.style[i]=e[i]})}function V(t,e,i){E([t],e),P([t],i)}function F(t,e){var i=t.matches||t.msMatchesSelector||t.webkitMatchesSelector;return i?i.call(t,e):-1!==[].indexOf.call(document.querySelectorAll(e),t)}function _(t,e){var i,n;for(n=0;n<t.ej2_instances.length;n++)if(e===(i=t.ej2_instances[n]).getModuleName())return i}function W(t,i,n,o){return t.properties.hasOwnProperty(i)&&t.properties[i]instanceof o||(t.properties[i]=e(o,[t,i,n])),t.properties[i]}function U(t,i,n,o,r,s){for(var a=[],l=n.length,h=0;h<l;h++){var c=o;if(s&&(c=o(n[h],t)),r){var d=e(c,[t,i,{},!0]);d.setProperties(n[h],!0),a.push(d)}else a.push(e(c,[t,i,n[h],!0]))}return a}function q(t,e){return function(){return this.properties.hasOwnProperty(e)||(this.properties[e]=t),this.properties[e]}}function X(t,e){return function(i){if(this.properties[e]!==i){var n=this.properties.hasOwnProperty(e)?this.properties[e]:t;this.saveChanges(e,i,n),this.properties[e]=i}}}function Y(t,e,i){return function(){return W(this,e,t,i)}}function G(t,e,i){return function(n){W(this,e,t,i).setProperties(n)}}function Z(t,e,i){return function(){var n=i({});return this.properties.hasOwnProperty(e)?this.properties[e]:W(this,e,t,n)}}function K(t,e,i){return function(n){var o=i(n,this);W(this,e,t,o).setProperties(n)}}function Q(t,e,i){return function(){if(!this.properties.hasOwnProperty(e)){var n=U(this,e,t,i,!1);this.properties[e]=n}return this.properties[e]}}function J(t,e,i){return function(n){var o=U(this,e,t,i,!1),r=U(this,e,n,i,!0);this.saveChanges(e,r,o),this.properties[e]=r}}function $(t,e,i){return function(n){var o=this.properties.hasOwnProperty(e)?this.properties[e]:t,r=U(this,e,n,i,!0,!0);this.saveChanges(e,r,o),this.properties[e]=r}}function tt(t,e,i){return function(){var n=i({});if(!this.properties.hasOwnProperty(e)){var o=U(this,e,t,n,!1);this.properties[e]=o}return this.properties[e]}}function et(t){return function(e,i){var n={set:X(t,i),get:q(t,i),enumerable:!0,configurable:!0};Object.defineProperty(e,i,n),lt(e,i,"prop",t)}}function it(t,e){return function(i,n){var o={set:G(t,n,e),get:Y(t,n,e),enumerable:!0,configurable:!0};Object.defineProperty(i,n,o),lt(i,n,"complexProp",t,e)}}function nt(t){return function(e,i){var n={set:K({},i,t),get:Z({},i,t),enumerable:!0,configurable:!0};Object.defineProperty(e,i,n),lt(e,i,"complexProp",{},t)}}function ot(t,e){return function(i,n){var o={set:J(t,n,e),get:Q(t,n,e),enumerable:!0,configurable:!0};Object.defineProperty(i,n,o),lt(i,n,"colProp",t,e)}}function rt(t){return function(e,i){var n={set:$([],i,t),get:tt([],i,t),enumerable:!0,configurable:!0};Object.defineProperty(e,i,n),lt(e,i,"colProp",{},t)}}function st(){return function(t,e){var i={set:function(t){var i=this.properties[e];if(i!==t){var n=dt(this,e);!1===d(i)&&n.context.removeEventListener(n.prefix,i),n.context.addEventListener(n.prefix,t),this.properties[e]=t}},get:q(void 0,e),enumerable:!0,configurable:!0};Object.defineProperty(t,e,i),lt(t,e,"event")}}function at(t){}function lt(t,e,i,n,o){d(t.propList)&&(t.propList={props:[],complexProps:[],colProps:[],events:[],propNames:[],complexPropNames:[],colPropNames:[],eventNames:[]}),t.propList[i+"s"].push({propertyName:e,defaultValue:n,type:o}),t.propList[i+"Names"].push(e)}function ht(t){if(d(t.prototype.builderObject)){t.prototype.builderObject={properties:{},propCollections:[],add:function(){this.isPropertyArray=!0,this.propCollections.push(h({},this.properties,{}))}};for(var e=/complex/,i=0,n=Object.keys(t.prototype.propList);i<n.length;i++)for(var o=n[i],r=0,s=t.prototype.propList[o];r<s.length;r++)!function(i){e.test(o)?t.prototype.builderObject[i.propertyName]=function(t){var e={};l(e,ht(i.type)),t(e);var n;return n=e.isPropertyArray?e.propCollections:h({},e.properties,{}),this.properties[i.propertyName]=n,e.properties={},e.propCollections=[],e.isPropertyArray=!1,this}:t.prototype.builderObject[i.propertyName]=function(t){return this.properties[i.propertyName]=t,this}}(s[r])}return t.prototype.builderObject}function ct(t){var e=function(t){return this.element=t,this};return function(i){return e.prototype.hasOwnProperty("create")||((e.prototype=ht(t)).create=function(){var e=h({},{},this.properties);return this.properties={},new t(e,this.element)}),new e(i)}}function dt(t,e){if(!1===t.hasOwnProperty("parentObj"))return{context:t,prefix:e};var i=n("propName",t);return i&&(e=i+"-"+e),dt(n("parentObj",t),e)}function pt(t,e,i){var n=ut(e);return!1===n.rippleFlag||void 0===n.rippleFlag&&!_a?Function:(t.setAttribute("data-ripple","true"),Ma.add(t,"mousedown",gt,{parent:t,rippleOptions:n}),Ma.add(t,"mouseup",mt,{parent:t,rippleOptions:n,done:i}),Ma.add(t,"mouseleave",ft,{parent:t,rippleOptions:n}),za.isPointer&&Ma.add(t,"transitionend",ft,{parent:t,rippleOptions:n}),function(){t.removeAttribute("data-ripple"),Ma.remove(t,"mousedown",gt),Ma.remove(t,"mouseup",mt),Ma.remove(t,"mouseleave",ft),Ma.remove(t,"transitionend",ft)})}function ut(t){return{selector:t&&t.selector?t.selector:null,ignore:t&&t.ignore?t.ignore:null,rippleFlag:t&&t.rippleFlag,isCenterRipple:t&&t.isCenterRipple,duration:t&&t.duration?t.duration:350}}function gt(t){var e=t.target,i=this.rippleOptions.selector,n=i?N(e,i):e;if(!(!n||this.rippleOptions&&N(e,this.rippleOptions.ignore))){var o=n.getBoundingClientRect(),r=t.pageX-document.body.scrollLeft,s=t.pageY-(!document.body.scrollTop&&document.documentElement?document.documentElement.scrollTop:document.body.scrollTop),a=Math.max(Math.abs(r-o.left),Math.abs(r-o.right)),l=Math.max(Math.abs(s-o.top),Math.abs(s-o.bottom)),h=Math.sqrt(a*a+l*l),c=2*h+"px",d=r-o.left-h,p=s-o.top-h;this.rippleOptions&&this.rippleOptions.isCenterRipple&&(d=0,p=0,c="100%"),n.classList.add("e-ripple");var u=L("div",{className:"e-ripple-element",styles:"width: "+c+";height: "+c+";left: "+d+"px;top: "+p+"px;transition-duration: "+this.rippleOptions.duration.toString()+"ms;"});n.appendChild(u),window.getComputedStyle(u).getPropertyValue("opacity"),u.style.transform="scale(1)",n!==this.parent&&Ma.add(n,"mouseleave",ft,{parent:this.parent,rippleOptions:this.rippleOptions})}}function mt(t){vt(t,this)}function ft(t){vt(t,this)}function vt(t,e){var i=e.rippleOptions.duration,n=t.target,o=e.rippleOptions.selector,r=o?N(n,o):n;if(r&&(!r||-1!==r.className.indexOf("e-ripple"))){var s=B(".e-ripple-element",r),a=s[s.length-1];a&&(a.style.opacity="0.5"),e.parent!==r&&Ma.remove(r,"mouseleave",ft),setTimeout(function(){a&&a.parentNode&&a.parentNode.removeChild(a),r.getElementsByClassName("e-ripple-element").length||r.classList.remove("e-ripple"),e.done&&e.done(t)},i)}}function yt(t){return _a=t}function bt(t){pl=t,hl.notify("notifyExternalChange",{locale:pl})}function wt(t){ul=t,hl.notify("notifyExternalChange",{currencyCode:ul})}function xt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0,n=t;i<n.length;i++){var o=n[i];h(dl,o,{},!0)}}function St(t){void 0===t&&(t=!0),cl=t,hl.notify("notifyExternalChange",{enableRtl:cl})}function Ct(t,e){var i=Ha.getDependables(dl,t,!0)[gl[0]],o=Ha.getDependables(dl,t)[gl[1]],r=n("defaultNumberingSystem",i),s=n("symbols-numberSystem-"+r,i),a=Ha.getSymbolPattern(e||"decimal",r,i,!1);return h(s,Ha.getFormatData(a,!0,"",!0),{dateSeparator:Ha.getDateSeparator(o)})}function Lt(){return Ha.getDependables(dl,"",!1)[gl[1]]}function Et(t,e){var i='var str="'+Pt(t,"data",e)+'"; return str;';return new Function("data",i).bind(e)}function Pt(t,e,i){var n=0,o=[];return t.replace(Fl,"").replace(Ql,"'$1'").replace(Jl,function(t,r,s,a){var l=r.match(Gl);if(l){var h=l[1];if(Ul.test(r))r='";} '+r.replace(l[1],h.replace(Kl,function(t){return t=t.trim(),kt(t,!_l.test(t)&&-1===o.indexOf(t),e,o)}))+'{ \n str = str + "';else if(Wl.test(r))r='"; '+r.replace(l[1],h.replace(Kl,function(t){return t=t.trim(),kt(t,!_l.test(t)&&-1===o.indexOf(t),e,o)}))+'{ \n str = str + "';else if(Xl.test(r)){var c=l[1].split(" of ");r='"; '+r.replace(l[1],function(t){return o.push(c[0]),o.push(c[0]+"Index"),"var i"+(n+=1)+"=0; i"+n+" < "+kt(c[1],!0,e,o)+".length; i"+n+"++"})+"{ \n "+c[0]+"= "+kt(c[1],!0,e,o)+"[i"+n+"]; \n var "+c[0]+"Index=i"+n+'; \n str = str + "'}else{var d=r.split("("),p=i&&i.hasOwnProperty(d[0])?"this.":"global";r='" + '+("global"===(p=/\./.test(d[0])?"":p)?"":p)+r.replace(h,kt(l[1].replace(",",e+"."),"global"!==p,e,o))+'+"'}}else r=ql.test(r)?'"; '+r.replace(ql,'} else { \n str = str + "'):r.match(Yl)?r.replace(Yl,'"; \n } \n str = str + "'):'"+'+kt(r,-1===o.indexOf(r),e,o)+'+"';return r})}function kt(t,e,i,n){return e&&!Zl.test(t)&&-1===n.indexOf(t.split(".")[0])?i+"."+t:t}function Tt(t,e){var i=eh.compile(t,e);return function(t,e,n){var o=i(t,e,n);if("string"==typeof o){if(th.test(o))return(r=L("svg",{innerHTML:o})).childNodes;var r=L($l.test(o)?"table":"div",{innerHTML:o});return r.childNodes}return o}}function Ot(t){eh.compile=t.compile}function It(){return eh.compile}function At(t){var e=[],i=Mt(t);if(i.length>0)for(var n=0;n<i.length;n++){var o=i[n],r="";switch((r=o[0]).toLowerCase()){case"m":e.push({command:r,x:o[1],y:o[2]});break;case"l":case"t":e.push({command:r,x:o[1],y:o[2]});break;case"h":e.push({command:r,x:o[1]});break;case"v":e.push({command:r,y:o[1]});break;case"z":e.push({command:r});break;case"c":e.push({command:r,x1:o[1],y1:o[2],x2:o[3],y2:o[4],x:o[5],y:o[6]});break;case"s":e.push({command:r,x2:o[1],y2:o[2],x:o[3],y:o[4]});break;case"q":e.push({command:r,x1:o[1],y1:o[2],x:o[3],y:o[4]});break;case"a":var s=o[4],a=o[5];e.push({command:r,r1:o[1],r2:o[2],angle:o[3],largeArc:s,sweep:a,x:o[6],y:o[7]})}}return e}function Mt(t){var e=/([a-z]+)|([+-]?(?:\d+\.?\d*|\.\d+))/gi,i=[],n=[],o={};e.lastIndex=0;var r=!1;for(o=e.exec(t);o;)"e"===o[1]?r=!0:o[1]?("zm"===o[1].toLowerCase()?(i.length&&n.push(i),n.push(["Z"]),i=[o[1].substring(1,2)]):(i.length&&n.push(i),i=[o[1]]),r=!1):(i.length||(i=[]),r||i.push(Number(o[2])),r=!1),o=e.exec(t);return i.length&&n.push(i),n}function Rt(t,e,i){var n,o,r="",s=[{x:0+t,y:0},{x:0+i-t,y:0},{x:0+i,y:0+t},{x:0+i,y:0+e-t},{x:0+i-t,y:0+e},{x:0+t,y:0+e},{x:0,y:0+e-t},{x:0,y:0+t}],a=[{x:0+i,y:0},{x:0+i,y:0+e},{x:0,y:0+e},{x:0,y:0}],l=0;r="M"+s[0].x+" "+s[0].y;var h;for(h=0;h<s.length;h+=2)r+="L"+(n=s[h+1]).x+" "+n.y,o=s[h+2]||s[0],r+="Q"+a[l].x+" "+a[l].y+" "+o.x+" "+o.y,l++;return r}function Dt(t){var e,i="";i="M"+t[0].x+" "+t[0].y;var n;for(n=1;n<t.length;n++)i+="L"+(e=t[n]).x+" "+e.y;return i+="Z"}function Bt(t){var e,i,n,o,r,s,a,l,h,c,d=[];for(a=0,l=0,c=0,h=t.length;c<h;++c){var p=t[c],u="";u=p.command,"y1"in p&&(o=p.y1),"y2"in p&&(s=p.y2),"x1"in p&&(n=p.x1),"x2"in p&&(r=p.x2),"x"in p&&(a=p.x),"y"in p&&(l=p.y);var g=d[d.length-1];switch(u){case"M":d.push({command:"M",x:a,y:l});break;case"L":d.push({command:"L",x0:e,y0:i,x:a,y:l});break;case"H":d.push({command:"L",x0:e,y0:i,x:a,y:i});break;case"V":d.push({command:"L",x0:e,y0:i,x:e,y:l});break;case"C":d.push({command:"C",x0:e,y0:i,x1:n,y1:o,x2:r,y2:s,x:a,y:l});break;case"S":if(g){var m=void 0,f={x:2*e-(m="C"===g.command||"S"===g.command?{x:g.x2,y:g.y2}:{x:e,y:i}).x,y:2*i-m.y};d.push({command:"C",x0:e,y0:i,x1:f.x,y1:f.y,x2:r,y2:s,x:a,y:l})}break;case"Q":d.push({command:"Q",x0:e,y0:i,x1:n,y1:o,x:a,y:l});break;case"T":if(g){var m=void 0,f={x:2*e-(m="Q"===g.command?{x:g.x1,y:g.y1}:{x:e,y:i}).x,y:2*i-m.y};d.push({command:"Q",x0:e,y0:i,x1:f.x,y1:f.y,x:a,y:l})}break;case"A":var v=p;v.command="A",d.push(v);break;case"Z":case"z":d.push({command:"Z"}),a=e,l=i}e=a,i=l}return d}function Nt(t,e,i,n,o,r,s,a){var l,h,c,d,p,u,g,m,f;for(p=0,u=0,m=0,g=t.length;m<g;++m){var v=t[m],y=v.command;"x"in v&&(p=v.x),"y"in v&&(u=v.y),"y1"in v&&(h=v.y1),"y2"in v&&(d=v.y2),"x1"in v&&(l=v.x1),"x2"in v&&(c=v.x2),n?(void 0!==p&&(p=zt(p,e,o,s)),void 0!==u&&(u=zt(u,i,r,a)),void 0!==l&&(l=zt(l,e,o,s)),void 0!==h&&(h=zt(h,i,r,a)),void 0!==c&&(c=zt(c,e,o,s)),void 0!==d&&(d=zt(d,i,r,a))):(void 0!==p&&(p=Number((p+e).toFixed(2))),void 0!==u&&(u=Number((u+i).toFixed(2))),void 0!==l&&(l=Number((l+e).toFixed(2))),void 0!==h&&(h=Number((h+i).toFixed(2))),void 0!==c&&(c=Number((c+e).toFixed(2))),void 0!==d&&(d=Number((d+i).toFixed(2)))),(f=Ht(v,y,{x:p,y:u,x1:l,y1:h,x2:c,y2:d,r1:v.r1,r2:v.r2},n,e,i))&&(t[m]=f)}return Vt(t)}function Ht(t,e,i,n,o,r){switch(e){case"M":case"L":t.x=i.x,t.y=i.y;break;case"H":t.x=i.x;break;case"V":t.y=i.y;break;case"C":t.x=i.x,t.y=i.y,t.x1=i.x1,t.y1=i.y1,t.x2=i.x2,t.y2=i.y2;break;case"S":t.x=i.x,t.y=i.y,t.x2=i.x2,t.y2=i.y2;break;case"Q":t.x=i.x,t.y=i.y,t.x1=i.x1,t.y1=i.y1;break;case"T":t.x=i.x,t.y=i.y;break;case"A":var s=i.r1,a=i.r2;n&&(i.r1=s*=o,i.r2=a*=r),t.x=i.x,t.y=i.y,t.r1=i.r1,t.r2=i.r2;break;case"z":case"Z":t={command:"Z"}}return t}function zt(t,e,i,n){return t!==i?t=n!==i?t*e-(Number(i)*e-Number(i))+(n-Number(i)):Number(t)*e-(Number(i)*e-Number(i)):n!==i&&(t=n),Number(t.toFixed(2))}function jt(t){var e,i,n,o,r,s,a,l,h,c;for(a=0,l=0,c=0,h=t.length;c<h;++c){var d=t[c],p=d.command;if(/[MLHVCSQTA]/.test(p))"x"in d&&(d.x=a=d.x),"y"in d&&(d.y=l=d.y);else{"x1"in d&&(d.x1=n=a+d.x1),"x2"in d&&(d.x2=r=a+d.x2),"y1"in d&&(d.y1=o=l+d.y1),"y2"in d&&(d.y2=s=l+d.y2),"x"in d&&(d.x=a+=d.x),"y"in d&&(d.y=l+=d.y);var u=void 0;switch(p){case"m":case"M":u={command:"M",x:a,y:l};break;case"l":case"L":u={command:"L",x:a,y:l};break;case"h":case"H":u={command:"H",x:a};break;case"v":case"V":u={command:"V",y:l};break;case"c":case"C":u={command:"C",x:a,y:l,x1:n,y1:o,x2:r,y2:s};break;case"s":case"S":u={command:"S",x:a,y:l,x2:r,y2:s};break;case"q":case"Q":u={command:"Q",x:a,y:l,x1:n,y1:o};break;case"t":case"T":u={command:"T",x:a,y:l};break;case"a":case"A":(u={command:"A",x:a,y:l}).r1=d.r1,u.r2=d.r2,u.angle=d.angle,u.largeArc=d.largeArc,u.sweep=d.sweep;break;case"z":case"Z":u={command:"Z"},a=e,l=i,u=t[c]}u&&(t[c]=u)}"M"!==p&&"m"!==p||(e=a,i=l)}return t}function Vt(t){var e,i="";for(e=0;e<t.length;e++)i+=0===e?Ft(t[e]):" "+Ft(t[e]);return i}function Ft(t){var e="";switch(t.command){case"Z":case"z":e=t.command;break;case"M":case"m":case"L":case"l":e=t.command+" "+t.x+" "+t.y;break;case"C":case"c":e=t.command+" "+t.x1+" "+t.y1+" "+t.x2+" "+t.y2+" "+t.x+" "+t.y;break;case"Q":case"q":e=t.command+" "+t.x1+" "+t.y1+" "+t.x+" "+t.y;break;case"A":case"a":var i=t.command,n=t.angle,o=t.largeArc?"1":"0",r=t.sweep?"1":"0";e=i+" "+t.r1+" "+t.r2+" "+n+" "+o+" "+r+" "+t.x+" "+t.y;break;case"H":case"h":e=t.command+" "+t.x;break;case"V":case"v":e=t.command+" "+t.y;break;case"S":case"s":e=t.command+" "+t.x2+" "+t.y2+" "+t.x+" "+t.y;break;case"T":case"t":e=t.command+" "+t.x+" "+t.y}return e}function _t(){return new hh(1,0,0,1,0,0,xl.Identity)}function Wt(t,e){var i=Kt(t,e.x,e.y);return{x:Math.round(100*i.x)/100,y:Math.round(100*i.y)/100}}function Ut(t,e){for(var i=[],n=0,o=e;n<o.length;n++){var r=o[n];i.push(Wt(t,r))}return i}function qt(t,e,i,n){Qt(t,Zt(.017453292519943295*(e%=360),i||0,n||0))}function Xt(t,e,i,n,o){void 0===n&&(n=0),void 0===o&&(o=0),Qt(t,Gt(e,i,n,o))}function Yt(t,e,i){return t.type&xl.Identity?(t.type=xl.Translation,void Jt(t,1,0,0,1,e,i)):t.type&xl.Unknown?(t.offsetX+=e,void(t.offsetY+=i)):(t.offsetX+=e,t.offsetY+=i,void(t.type|=xl.Translation))}function Gt(t,e,i,n){var o=_t();return o.type=i||n?xl.Scaling|xl.Translation:xl.Scaling,Jt(o,t,0,0,e,i-t*i,n-e*n),o}function Zt(t,e,i){var n=_t(),o=Math.sin(t),r=Math.cos(t),s=e*(1-r)+i*o,a=i*(1-r)-e*o;return n.type=xl.Unknown,Jt(n,r,o,-o,r,s,a),n}function Kt(t,e,i){switch(t.type){case xl.Identity:break;case xl.Translation:e+=t.offsetX,i+=t.offsetY;break;case xl.Scaling:e*=t.m11,i*=t.m22;break;case xl.Translation|xl.Scaling:e*=t.m11,e+=t.offsetX,i*=t.m22,i+=t.offsetY;break;default:var n=i*t.m21+t.offsetX,o=e*t.m12+t.offsetY;e*=t.m11,e+=n,i*=t.m22,i+=o}return{x:e,y:i}}function Qt(t,e){var i=t.type,n=e.type;if(n!==xl.Identity){if(i===xl.Identity)return $t(t,e),void(t.type=e.type);if(n===xl.Translation)return t.offsetX+=e.offsetX,t.offsetY+=e.offsetY,void(i!==xl.Unknown&&(t.type|=xl.Translation));if(i!==xl.Translation){var o=i<<4|n;switch(o){case 34:return t.m11*=e.m11,void(t.m22*=e.m22);case 35:return t.m11*=e.m11,t.m22*=e.m22,t.offsetX=e.offsetX,t.offsetY=e.offsetY,void(t.type=xl.Translation|xl.Scaling);case 36:break;default:switch(o){case 50:return t.m11*=e.m11,t.m22*=e.m22,t.offsetX*=e.m11,void(t.offsetY*=e.m22);case 51:return t.m11*=e.m11,t.m22*=e.m22,t.offsetX=e.m11*t.offsetX+e.offsetX,void(t.offsetY=e.m22*t.offsetY+e.offsetY);case 52:break;default:switch(o){case 66:case 67:case 68:break;default:return}}}var r=_t();return Jt(r,t.m11*e.m11+t.m12*e.m21,t.m11*e.m12+t.m12*e.m22,t.m21*e.m11+t.m22*e.m21,t.m21*e.m12+t.m22*e.m22,t.offsetX*e.m11+t.offsetY*e.m21+e.offsetX,t.offsetX*e.m12+t.offsetY*e.m22+e.offsetY),r.m21||r.m12?r.type=xl.Unknown:((r.m11&&1!==r.m11||r.m22&&1!==r.m22)&&(r.type=xl.Scaling),(r.offsetX||r.offsetY)&&(r.type|=xl.Translation),(r.type&(xl.Translation|xl.Scaling))===xl.Identity&&(r.type=xl.Identity),r.type=xl.Scaling|xl.Translation),$t(t,r),void(t.type=r.type)}var s=t.offsetX,a=t.offsetY;if(t.offsetX=s*e.m11+a*e.m21+e.offsetX,t.offsetY=s*e.m12+a*e.m22+e.offsetY,n===xl.Unknown)return void(t.type=xl.Unknown);t.type=xl.Translation|xl.Scaling}}function Jt(t,e,i,n,o,r,s){t.m11=e,t.m12=i,t.m21=n,t.m22=o,t.offsetX=r,t.offsetY=s}function $t(t,e){t.m11=e.m11,t.m12=e.m12,t.m21=e.m21,t.m22=e.m22,t.offsetX=e.offsetX,t.offsetY=e.offsetY,t.type=e.type}function te(){for(var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",i="",n=0;n<5;n++){if("crypto"in window&&"getRandomValues"in crypto){var o=new Uint16Array(1);t=(window.msCrypto||window.crypto).getRandomValues(o)[0]%(e.length-1)}i+=e.substring(t,t+1)}return i}function ee(t){new ah;var e=new ah,i=t.offsetY-t.actualSize.height*t.pivot.y,n=t.offsetY+t.actualSize.height*(1-t.pivot.y),o=t.offsetX-t.actualSize.width*t.pivot.x,r=t.offsetX+t.actualSize.width*(1-t.pivot.x),s={x:o,y:i},a={x:r,y:i},l={x:o,y:n},h={x:r,y:n};if(e=ah.toBounds([s,a,l,h]),t.corners=e,0!==t.rotateAngle||0!==t.parentTransform){var c=_t();qt(c,t.rotateAngle+t.parentTransform,t.offsetX,t.offsetY),s=Wt(c,s),a=Wt(c,a),l=Wt(c,l),h=Wt(c,h)}return ah.toBounds([s,a,l,h])}function ie(t,e,i){var n={},o="properties";if(t){i=t.propName;var r=t[o]||t,s=[];s=s.concat(Object.keys(r));var a=[];if(i){var l=fe(e);a=l?l(i):[],s=s.concat(a)}for(var h=ne(i),c=0,d=s=s.concat(h);c<d.length;c++){var p=d[c];if("wrapper"!==p){!!(t[p]&&t[p].constructor&&t[p].constructor.name&&"EventEmitter"===t[p].constructor.name)||(t[p]instanceof Array?n[p]=oe(-1===h.indexOf(p)&&t[o]?t[o][p]:t[p],e,p):t[p]instanceof Array==!1&&t[p]instanceof HTMLElement?n[p]=t[p].cloneNode(!0).innerHtml:t[p]instanceof Array==!1&&t[p]instanceof Object?n[p]=ie(-1===h.indexOf(p)&&t[o]?t[o][p]:t[p]):n[p]=t[p])}else t[p]&&(n[p]={actualSize:{width:t[p].actualSize.width,height:t[p].actualSize.height},offsetX:t[p].offsetX,offsetY:t[p].offsetY})}}return n}function ne(t){switch(t){case"nodes":return["inEdges","outEdges","parentId","processId"];case"connectors":return["parentId"]}return[]}function oe(t,e,i){var n;if(t){n=[];for(var o=0;o<t.length;o++)t[o]instanceof Array?n.push(t[o]):t[o]instanceof Object?n.push(ie(t[o],e,i)):n.push(t[o])}return n}function re(t,e){if(t){e||(e={properties:{}});for(var i=0,n=Object.keys(t);i<n.length;i++){var o=n[i];if(t[o]instanceof Array){var r=se(t[o],e.properties[o]);e.properties[o]&&e.properties[o].length||(e[o]=r)}else if(t[o]instanceof Array==!1&&t[o]instanceof HTMLElement)e[o]=t[o].cloneNode(!0).innerHtml;else if(t[o]instanceof Array==!1&&t[o]instanceof Object){var s=re(t[o],e.properties[o]);s.properties&&!Object.keys(s.properties).length&&delete s.properties,e[o]=s}else e[o]=void 0!==e.properties[o]?e[o]:t[o]}}return e}function se(t,e){var i=[],n=!1;e||(e=[]),e.length||(n=!0);for(var o=0;o<t.length;o++)if(t[o]instanceof Array){se(t[o],e[o]);n&&i.push(se)}else if(t[o]instanceof Object){var r=re(t[o],e[o]);n&&i.push(r)}else i.push(t[o]);return i}function ae(t){var e="";switch(t){case"Center":e="center";break;case"Left":e="left";break;case"Right":e="right"}return e}function le(t){var e="";switch(t){case"Wrap":e="breakall";break;case"NoWrap":e="keepall";break;case"WrapWithOverflow":e="normal";break;case"LineThrough":e="line-through"}return e}function he(t,e){window.measureElement.style.visibility="visible";var i=window.measureElement.children[2].children[1];i.textContent=t,i.setAttribute("style","font-size:"+e.fontSize+"px; font-family:"+e.fontFamily+";font-weight:"+(e.bold?"bold":"normal"));var n=i.getBBox().width;return window.measureElement.style.visibility="hidden",n}function ce(t,e){return(t+e)/2}function de(t,e){var i=0,n=0,o=0,r=0,s="";n=t.length;var a=0;do{r>0&&(i=o),o=Math.floor(ce(i,n)),r=he(s+=t.substr(i,o),e)}while(r<=e.width);for(s=s.substr(0,i),a=i;a<n;a++)if(s+=t[a],(r=he(s,e))>=e.width){t=t.substr(0,s.length-1);break}return"Ellipsis"===e.textOverflow?(t=t.substr(0,t.length-3),t+="..."):t=t.substr(0,t.length),t}function pe(t,e){if("NoWrap"===e&&"PreserveAll"===t)return"pre";var i="";switch(t){case"CollapseAll":i="nowrap";break;case"CollapseSpace":i="pre-line";break;case"PreserveAll":i="pre-wrap"}return i}function ue(t,e){var i=_t();qt(i,e,0,0);var n=Wt(i,{x:0,y:0}),o=Wt(i,{x:t.width,y:0}),r=Wt(i,{x:0,y:t.height}),s=Wt(i,{x:t.width,y:t.height}),a=Math.min(n.x,o.x,r.x,s.x),l=Math.min(n.y,o.y,r.y,s.y),h=Math.max(n.x,o.x,r.x,s.x),c=Math.max(n.y,o.y,r.y,s.y);return new nh(h-a,c-l)}function ge(t,e,i,n){if(0!==t){var o=_t();return qt(o,t,e,i),Wt(o,n)}return n}function me(t,e){return{x:t.x+e.desiredSize.width*e.pivot.x,y:t.y+e.desiredSize.height*e.pivot.y}}function fe(t){return void 0!==t&&"string"==typeof t&&(t=n(t,window)),t}function ve(t){var e,i,n=[];window.measureElement.style.visibility="visible";var o=window.measureElement.children[2].children[0];o.setAttributeNS(null,"d",t.data);var r=Oe(t,t.absoluteBounds,t);o.setAttributeNS(null,"d",r);var s=o.getTotalLength();for(i=0;i<=s;i+=10)e=o.getPointAtLength(i),n.push({x:e.x,y:e.y});return window.measureElement.style.visibility="hidden",n}function ye(t,e){for(var i=[],n=0,o=e;n<o.length;n++){var r=o[n],s={x:t.offsetX-t.actualSize.width*t.pivot.x+r.x,y:t.offsetY-t.actualSize.height*t.pivot.y+r.y},a=void 0,l=t.rotateAngle+t.parentTransform;l&&qt(a=_t(),l,t.offsetX,t.offsetY),a&&(s=Wt(a,s)),i.push(s)}return i}function be(t){if(t){window.measureElement.style.visibility="visible";var e=window.measureElement.children[2].children[0];e.setAttribute("d",t);var i=e.getBBox(),n=new ah(i.x,i.y,i.width,i.height);return window.measureElement.style.visibility="hidden",n}return new ah(0,0,0,0)}function we(t,e){var i={fill:t.style.fill,stroke:t.style.strokeColor,angle:t.rotateAngle+t.parentTransform,pivotX:t.pivot.x,pivotY:t.pivot.y,strokeWidth:t.style.strokeWidth,dashArray:t.style.strokeDashArray,opacity:t.style.opacity,shadow:t.shadow,gradient:t.style.gradient,visible:t.visible,id:t.id,description:t.description,width:e||t.actualSize.width,height:t.actualSize.height,x:t.offsetX-t.actualSize.width*t.pivot.x+.5,y:t.offsetY-t.actualSize.height*t.pivot.y+.5};return i.fontSize=t.style.fontSize,i.fontFamily=t.style.fontFamily,i.textOverflow=t.style.textOverflow,i.textDecoration=t.style.textDecoration,i.doWrap=t.doWrap,i.whiteSpace=pe(t.style.whiteSpace,t.style.textWrapping),i.content=t.content,i.breakWord=le(t.style.textWrapping),i.textAlign=ae(t.style.textAlign),i.color=t.style.color,i.italic=t.style.italic,i.bold=t.style.bold,i.dashArray="",i.strokeWidth=0,i.fill="",i}function xe(t,e){var i,n,o=[],r=0,s=e||t.content;if("nowrap"!==t.whiteSpace&&"pre"!==t.whiteSpace)if("breakall"===t.breakWord)for(i="",i+=s[0],r=0;r<s.length;r++)if((n=he(i,t))>=t.width&&i.length>0)o[o.length]={text:i,x:0,dy:0,width:n},i="";else{(i+=s[r+1]||"").indexOf("\n")>-1&&(i=i.replace("\n",""));var a=he(i,t);Math.ceil(a)+2>=t.width&&i.length>0&&(o[o.length]={text:i,x:0,dy:0,width:a},i=""),r===s.length-1&&i.length>0&&(o[o.length]={text:i,x:0,dy:0,width:a},i="")}else o=Se(t,e);else o[o.length]={text:s,x:0,dy:0,width:he(s,t)};return o}function Se(t,e){var i,n,o,r,s=[],a="",l=0,h=0,c="nowrap"!==t.whiteSpace,d=(e||t.content).split("\n");for(l=0;l<d.length;l++)for(i=d[l].split(" "),h=0;h<i.length;h++){var p=he(n=(a+=((0!==h||1===i.length)&&c&&a.length>0?" ":"")+i[h])+(i[h+1]||""),t);Math.floor(p)>t.width-2&&a.length>0?(s[s.length]={text:a,x:0,dy:0,width:n===a?p:a===r?o:he(a,t)},a=""):h===i.length-1&&(s[s.length]={text:a,x:0,dy:0,width:p},a=""),r=n,o=p}return s}function Ce(t,e){var i,n,o={x:0,width:0},r=0;for(r=0;r<e.length;r++)n=i=e[r].width,i="left"===t.textAlign?0:"center"===t.textAlign?i>t.width&&("Ellipsis"===t.textOverflow||"Clip"===t.textOverflow)?0:-i/2:"right"===t.textAlign?-i:e.length>1?0:-i/2,e[r].dy=t.fontSize,e[r].x=i,o?(o.x=Math.min(o.x,i),o.width=Math.max(o.width,n)):o={x:i,width:n};return o}function Le(t,e,i,n,o){var r=new nh,s=document.createElement("Span");return s.setAttribute("style","display:inline-block ; line-height: normal"),t.bold&&(s.style.fontWeight="bold"),t.italic&&(s.style.fontStyle="italic"),void 0!==i&&(s.style.width=i.toString()+"px"),void 0!==n&&(s.style.height=n.toString()+"px"),void 0!==o&&(s.style.maxWidth=o.toString()+"px"),s.style.fontFamily=t.fontFamily,s.style.fontSize=t.fontSize+"px",s.style.color=t.color,s.textContent=e,s.style.whiteSpace=pe(t.whiteSpace,t.textWrapping),s.style.wordBreak=void 0!==o?"break-word":le(t.textWrapping),document.body.appendChild(s),r.width=s.offsetWidth,r.height=s.offsetHeight,document.body.removeChild(s),r}function Ee(t,e,i,n,o){var r,s,a=new nh(0,0),l=we(t,n);return t.childNodes=r=xe(l,o),t.wrapBounds=s=Ce(l,r),a.width=s.width,a.height=r.length*t.style.fontSize,a}function Pe(t,e){window.measureElement.style.visibility="visible";var i=window.measureElement.children[1];i.setAttribute("src",t);var n=i.getBoundingClientRect(),o=n.width,r=n.height;return e=new nh(o,r),window.measureElement.style.visibility="hidden",e}function ke(t){window.measureElement.style.visibility="visible";var e=window.measureElement.children[2];e.appendChild(t);var i=t.getBoundingClientRect(),n=e.getBoundingClientRect(),o=i;return o.x=i.left-n.left,o.y=i.top-n.top,e.removeChild(t),window.measureElement.style.visibility="hidden",o}function Te(t){window.measureElement.style.visibility="visible";var e=window.measureElement.children[2];e.appendChild(t);var i=e.getBoundingClientRect();return e.removeChild(t),window.measureElement.style.visibility="hidden",i}function Oe(t,e,i){var n,o=0,r=0,s=!1,a="",l=[];return 0===(n=e).x&&0===n.y||(o=0-Number(n.x),r=0-Number(n.y)),t.actualSize.width===n.width&&t.actualSize.height===n.height||(o=t.actualSize.width/Number(n.width?n.width:1),r=t.actualSize.height/Number(n.height?n.height:1),s=!0),l=At(t.data),l=jt(l),a=Nt(l,o,r,s,n.x,n.y,0,0),s=!1,a}function Ie(t){var e;return e=Ae(t).getElementsByClassName("e-diagram-layer"),e[0]}function Ae(t){return document.getElementById(t)}function Me(t){var e;return e=Ae(t).getElementsByClassName("e-adorner-layer"),e[0]}function Re(t){return Me(t).getElementById(t+"_SelectorElement")}function De(t){return Me(t).getElementById(t+"_diagramAdorner")}function Be(t){return Ie(t).getElementById(t+"_diagramLayer")}function Ne(t){var e;return e=Ae(t).getElementsByClassName("e-ports-expand-layer"),e[0]}function He(t){var e;return e=Ae(t).getElementsByClassName("e-native-layer"),e[0]}function ze(t){var e;return e=Ae(t).getElementsByClassName("e-grid-layer"),e[0]}function je(t){return Ae(t).getElementsByClassName("e-background-layer")[0].parentNode}function Ve(t){var e;return e=Ae(t).getElementsByClassName("e-background-image-layer"),e[0]}function Fe(t){var e;return e=Ae(t).getElementsByClassName("e-background-layer"),e[0]}function _e(t){return ze(t).getElementById(t+"_gridline")}function We(t){return Ne(t).getElementById(t+"_diagramExpander")}function Ue(t){return Ne(t).getElementById(t+"_diagramPorts")}function qe(t){return He(t).getElementById(t+"_nativeLayer")}function Xe(t){var e;return e=Ae(t).getElementsByClassName("e-html-layer"),e[0]}function Ye(t,e){var i=document.createElement(t);return ii(i,e),i}function Ge(t,e){var i=document.createElementNS("http://www.w3.org/2000/svg",t);return ei(i,e),i}function Ze(t,e,i){for(var n=t;n&&(i?n.id!==e:!Ke(n,e));)n=n.parentNode;return n}function Ke(t,e){return(" "+("object"==typeof t.className?t.className.animVal:t.className)+" ").indexOf(" "+e+" ")>-1}function Qe(){var t=document.createElement("div");t.style.visibility="hidden",t.style.width="100px",document.body.appendChild(t);var e=t.getBoundingClientRect().width;t.style.overflow="scroll";var i=document.createElement("div");i.style.width="100%",t.appendChild(i);var n=i.getBoundingClientRect().width;return t.parentNode.removeChild(t),e-n}function Je(t,e,i){t=[];for(var n=0,o=i.length;n<o;n++)t.push({pageX:i[n].clientX,pageY:i[n].clientY,pointerId:null});return t}function $e(t,e){var i=document.getElementById(e),n=e&&i?document.getElementById(e).querySelector("#"+t):document.getElementById(t);n&&n.parentNode.removeChild(n)}function ti(t,e){var i;i=e?Ye("div",{style:"height: 100%; width: 100%"}):document.createElementNS("http://www.w3.org/2000/svg","g");var n;if("string"==typeof t.content)for(var o=void 0,r=0,s=(o=Tt(t.content))({});r<s.length;r++)n=s[r],i.appendChild(n);else i.appendChild(t.content);return i.cloneNode(!0)}function ei(t,e){for(var i=Object.keys(e),n=0;n<i.length;n++)t.setAttribute(i[n],e[i[n]])}function ii(t,e){for(var i=Object.keys(e),n=0;n<i.length;n++)t.setAttribute(i[n],e[i[n]])}function ni(){if(window.measureElement)window.measureElement.usageCount+=1;else{var t=L("div",{id:"measureElement",styles:"visibility:hidden"}),e=document.createElement("Span");e.setAttribute("style","display:inline-block ; line-height: normal"),t.appendChild(e);var i=void 0;i=document.createElement("img"),t.appendChild(i);var n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("xlink","http://www.w3.org/1999/xlink"),t.appendChild(n);var o=document.createElementNS("http://www.w3.org/2000/svg","path");n.appendChild(o);document.createTextNode("");var r=document.createElementNS("http://www.w3.org/2000/svg","text");r.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),n.appendChild(r),window.measureElement=t,window.measureElement.usageCount=1,document.body.appendChild(t)}}function oi(t){return ac[t.toString()]}function ri(t){return yc[t.toString()]}function si(t,e){return"Custom"===t?e.pathData:bc[t]}function ai(t){var e;switch(t.shape){case"Minus":e="M0,50 L100,50";break;case"Plus":e="M0,-50 L0,50 M-50,0 L50,0";break;case"ArrowUp":e="M0,100 L50,0 L100,100 Z";break;case"ArrowDown":e="M0,0 L50,100 L100,0 Z";break;case"Path":e=t.pathData}return e}function li(t){return wc[t.toString()]}function hi(t,e,i,r,s){if(i.tagName===t){for(var a=n("ej2_instances",i),l=L("input",{attrs:{type:e}}),h=["change","cssClass","label","labelPosition"],c=L(t,{className:r,attrs:{role:s,"aria-checked":"false"}}),d=0,p=i.attributes.length;d<p;d++)-1===h.indexOf(i.attributes[d].nodeName)&&l.setAttribute(i.attributes[d].nodeName,i.attributes[d].nodeValue);i.parentNode.insertBefore(l,i),A(i),(i=l).parentNode.insertBefore(c,i),c.appendChild(i),o("ej2_instances",a,i)}return i}function ci(t){for(var e,i=t.childNodes,n=0;n<i.length;n++)if(3===(e=i[n]).nodeType)return e;return null}function di(t,e,i){"INPUT"===i?(e.parentNode.insertBefore(t.element,e),A(e),t.element.checked=!1,["name","value","disabled"].forEach(function(e){t.element.removeAttribute(e)})):(t.element.id&&e.setAttribute("id",t.element.id),["role","aria-checked","class"].forEach(function(t){e.removeAttribute(t)}),e.innerHTML="")}function pi(t,e,i,n,o){n=hi(e,"checkbox",n,i,o),t.element=n,"checkbox"!==t.element.getAttribute("type")&&t.element.setAttribute("type","checkbox"),t.element.id||(t.element.id=p("e-"+o))}function ui(t,e){void 0===t&&(t=!1),void 0===e&&(e={});var i=L("div",{className:"e-checkbox-wrapper e-css"});if(e.cssClass&&E([i],e.cssClass.split(" ")),e.enableRtl&&i.classList.add("e-rtl"),t){var n=L("span",{className:"e-ripple-container"});pt(n,{isCenterRipple:!0,duration:400}),i.appendChild(n)}var o=L("span",{className:"e-frame e-icons"});if(e.checked&&o.classList.add("e-check"),i.appendChild(o),e.label){var r=L("span",{className:"e-label",innerHTML:e.label});i.appendChild(r)}return i}function gi(t,e){if(e){var i=document.createEvent("MouseEvents");i.initEvent(t.type,!1,!0),e.dispatchEvent(i)}}function mi(t,e){var i=!1,n={left:0,top:0},o=t;if(!t||!e)return n;for(c(e.offsetParent)&&"fixed"===e.style.position&&(i=!0);(e.offsetParent||i)&&t&&e.offsetParent!==t;)n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent;for(t=o;(e.offsetParent||i)&&t&&e.offsetParent!==t;)n.left-=t.scrollLeft,n.top-=t.scrollTop,t=t.parentElement;return n}function fi(t,e,i,n,o){if(Oh=o,Fc=!!n,!t)return{left:0,top:0};e||(e="left"),i||(i="top"),Ah=t.ownerDocument,Ih=t;var r={left:0,top:0};return bi(e.toLowerCase(),i.toLowerCase(),r)}function vi(t,e){e.left=t}function yi(t,e){e.top=t}function bi(t,e,i){switch(Th=Ih.getBoundingClientRect(),e+t){case"topcenter":vi(ki(),i),yi(Li(),i);break;case"topright":vi(Pi(),i),yi(Li(),i);break;case"centercenter":vi(ki(),i),yi(Ci(),i);break;case"centerright":vi(Pi(),i),yi(Ci(),i);break;case"centerleft":vi(Ei(),i),yi(Ci(),i);break;case"bottomcenter":vi(ki(),i),yi(Si(),i);break;case"bottomright":vi(Pi(),i),yi(Si(),i);break;case"bottomleft":vi(Ei(),i),yi(Si(),i);break;default:case"topleft":vi(Ei(),i),yi(Li(),i)}return i}function wi(){return Ah.documentElement.scrollTop||Ah.body.scrollTop}function xi(){return Ah.documentElement.scrollLeft||Ah.body.scrollLeft}function Si(){return Fc?Th.bottom:Th.bottom+wi()}function Ci(){return Li()+Th.height/2}function Li(){return Fc?Th.top:Th.top+wi()}function Ei(){return Th.left+xi()}function Pi(){return Th.right+xi()-(Oh?Oh.width:0)}function ki(){return Ei()+Th.width/2}function Ti(t,e,i,n){if(void 0===e&&(e=null),void 0===i&&(i={X:!1,Y:!1}),!i.Y&&!i.X)return{left:0,top:0};var o=t.getBoundingClientRect();if(Rh=e,Mh=t.ownerDocument,n||(n=fi(t,"left","top")),i.X){var r=Rh?zi():Zi(),s=Wi(),a=Ui(),l=s-n.left,h=n.left+o.width-a;o.width>r?n.left=l>0&&h<=0?a-o.width:h>0&&l<=0?s:l>h?a-o.width:s:l>0?n.left+=l:h>0&&(n.left-=h)}if(i.Y){var c=Rh?ji():Gi(),d=_i(),p=qi(),u=d-n.top,g=n.top+o.height-p;o.height>c?n.top=u>0&&g<=0?p-o.height:g>0&&u<=0?d:u>g?p-o.height:d:u>0?n.top+=u:g>0&&(n.top-=g)}return n}function Oi(t,e,i,n){void 0===e&&(e=null);var o=fi(t,"left","top");i&&(o.left=i),n&&(o.top=n);var r=[];Rh=e,Mh=t.ownerDocument;var s=t.getBoundingClientRect(),a=o.top,l=o.left,h=o.left+s.width,c=Hi(a,o.top+s.height),d=Di(l,h);return c.topSide&&r.push("top"),d.rightSide&&r.push("right"),d.leftSide&&r.push("left"),c.bottomSide&&r.push("bottom"),r}function Ii(t,e,i,n,o,r,s,a,l){if(void 0===s&&(s=null),void 0===a&&(a={X:!0,Y:!0}),e&&t&&o&&r&&(a.X||a.Y)){var h={TL:null,TR:null,BL:null,BR:null},c={TL:null,TR:null,BL:null,BR:null},d=t.getBoundingClientRect(),p={posX:o,posY:r,offsetX:i,offsetY:n,position:{left:0,top:0}};Rh=s,Mh=e.ownerDocument,Mi(e,h,p,l,d),Ri(c,p,d),a.X&&Bi(e,c,h,p,d,!0),a.Y&&h.TL.top>-1&&Ni(e,c,h,p,d,!0),Ai(t,p,d)}}function Ai(t,e,i){var n=0,o=0;if(null!=t.offsetParent&&("absolute"===getComputedStyle(t.offsetParent).position||"relative"===getComputedStyle(t.offsetParent).position)){var r=fi(t.offsetParent,"left","top",!1,i);n=r.left,o=r.top}t.style.top=e.position.top+e.offsetY-o+"px",t.style.left=e.position.left+e.offsetX-n+"px"}function Mi(t,e,i,n,o){i.position=fi(t,i.posX,i.posY,n,o),e.TL=fi(t,"left","top",n,o),e.TR=fi(t,"right","top",n,o),e.BR=fi(t,"left","bottom",n,o),e.BL=fi(t,"right","bottom",n,o)}function Ri(t,e,i){t.TL={top:e.position.top+e.offsetY,left:e.position.left+e.offsetX},t.TR={top:t.TL.top,left:t.TL.left+i.width},t.BL={top:t.TL.top+i.height,left:t.TL.left},t.BR={top:t.TL.top+i.height,left:t.TL.left+i.width}}function Di(t,e){var i=!1,n=!1;return t-Yi()<Wi()&&(i=!0),e>Ui()&&(n=!0),{leftSide:i,rightSide:n}}function Bi(t,e,i,n,o,r){var s=Di(e.TL.left,e.TR.left);i.TL.left-Yi()<=Wi()&&(s.leftSide=!1),i.TR.left>=Ui()&&(s.rightSide=!1),(s.leftSide&&!s.rightSide||!s.leftSide&&s.rightSide)&&("right"===n.posX?n.posX="left":n.posX="right",n.offsetX=n.offsetX+o.width,n.offsetX=-1*n.offsetX,n.position=fi(t,n.posX,n.posY,!1),Ri(e,n,o),r&&Bi(t,e,i,n,o,!1))}function Ni(t,e,i,n,o,r){var s=Hi(e.TL.top,e.BL.top);i.TL.top-Xi()<=_i()&&(s.topSide=!1),i.BL.top>=qi()&&(s.bottomSide=!1),(s.topSide&&!s.bottomSide||!s.topSide&&s.bottomSide)&&("top"===n.posY?n.posY="bottom":n.posY="top",n.offsetY=n.offsetY+o.height,n.offsetY=-1*n.offsetY,n.position=fi(t,n.posX,n.posY,!1,o),Ri(e,n,o),r&&Ni(t,e,i,n,o,!1))}function Hi(t,e){var i=!1,n=!1;return t-Xi()<_i()&&(i=!0),e>qi()&&(n=!0),{topSide:i,bottomSide:n}}function zi(){return Rh.getBoundingClientRect().width}function ji(){return Rh.getBoundingClientRect().height}function Vi(){return Rh.getBoundingClientRect().left}function Fi(){return Rh.getBoundingClientRect().top}function _i(){return Rh?Fi():0}function Wi(){return Rh?Vi():0}function Ui(){return Rh?Yi()+Vi()+zi():Yi()+Zi()}function qi(){return Rh?Xi()+Fi()+ji():Xi()+Gi()}function Xi(){return Mh.documentElement.scrollTop||Mh.body.scrollTop}function Yi(){return Mh.documentElement.scrollLeft||Mh.body.scrollLeft}function Gi(){return window.innerHeight}function Zi(){return window.innerWidth}function Ki(t,e){for(var i=getComputedStyle(t),n=[],o=/(auto|scroll)/,r=t.parentElement;r&&"HTML"!==r.tagName;){var s=getComputedStyle(r);"absolute"===i.position&&"static"===s.position||!o.test(s.overflow+s.overflowY+s.overflowX)||n.push(r),r=r.parentElement}return e||n.push(document),n}function Qi(t){for(var e=t.parentElement,i=[];e&&"BODY"!==e.tagName;){var n=document.defaultView.getComputedStyle(e,null).getPropertyValue("z-index"),o=document.defaultView.getComputedStyle(e,null).getPropertyValue("position");"auto"!==n&&"static"!==o&&i.push(n),e=e.parentElement}for(var r=[],s=0;s<document.body.children.length;s++)if(!t.isEqualNode(document.body.children[s])){var n=document.defaultView.getComputedStyle(document.body.children[s],null).getPropertyValue("z-index"),o=document.defaultView.getComputedStyle(document.body.children[s],null).getPropertyValue("position");"auto"!==n&&"static"!==o&&r.push(n)}r.push("999");var a=i.concat(r);return Math.max.apply(Math,a)+1}function Ji(t){var e,i=yn(t.target);if(c(t.cssClass)||i.wrap.classList.add(t.cssClass),c(t.template)&&c(od)){var n=c(t.type)?rn(i.wrap):t.type;e=un(c(t.width)?void 0:t.width,n),sn(n,i.wrap,e),c(t.label)||$i(i.inner_wrap,t.label)}else{var o=c(t.template)?od:t.template;i.wrap.classList.add(wd),pn(i.wrap,o,rd)}i.wrap.classList.add(cd),i=null}function $i(t,e){var i=document.createElement("div");return i.classList.add(bd),i.textContent=e,t.appendChild(i),i}function tn(t,e){var i=mn();nd[i]={timeOut:0,type:"Material",radius:e},vn(t,i),xn(e,t)}function en(t,e,i){var n={};nd[e].timeOut=0,n[e]=gn(e,i,0,0),bn({uniqueID:e,container:t,globalInfo:n,timeOutVar:0})}function nn(t,e){var i=mn();nd[i]={timeOut:0,type:"Fabric",radius:e},fn(t,i,pd),kn(e,t,pd)}function on(t,e){var i=mn();nd[i]={timeOut:0,type:"HighContrast",radius:e},fn(t,i,gd),kn(e,t,gd)}function rn(t){return window.getComputedStyle(t,":after").getPropertyValue("content").replace(/['"]+/g,"")}function sn(t,e,i){var n=e.querySelector("."+fd),o=n.querySelector("svg");switch(c(o)||n.removeChild(o),t){case"Material":tn(n,i);break;case"Fabric":nn(n,i);break;case"Bootstrap":an(n,i);break;case"HighContrast":on(n,i)}}function an(t,e){var i=mn();nd[i]={timeOut:0,type:"Bootstrap",radius:e},ln(t,i),hn(t,e)}function ln(t,e){var i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttribute("id",e),i.setAttribute("class",ud),i.setAttribute("viewBox","0 0 64 64"),t.insertBefore(i,t.firstChild);for(var n=0;n<=7;n++){var o=document.createElementNS("http://www.w3.org/2000/svg","circle");o.setAttribute("class",vd+"_"+n),o.setAttribute("r","2"),o.setAttribute("transform","translate(32,32)"),i.appendChild(o)}}function hn(t,e){var i=t.querySelector("svg.e-spin-bootstrap");i.style.width=i.style.height=e+"px";for(var n=90,o=0;o<=7;o++){var r=Tn(0,0,24,n),s=i.querySelector("."+vd+"_"+o);s.setAttribute("cx",r.x+""),s.setAttribute("cy",r.y+""),n=n>=360?0:n,n+=45}}function cn(t,e){function i(t){n.push(t),t===r&&1!==a||(t<=o&&t>1&&!s?t=parseFloat((t-.2).toFixed(2)):1===t?(t=7,t=parseFloat((t+.2).toFixed(2)),s=!0):t<8&&s?8===(t=parseFloat((t+.2).toFixed(2)))&&(s=!1):t<=8&&!s&&(t=parseFloat((t-.2).toFixed(2))),++a,i(t))}var n=[],o=t,r=e,s=!1,a=1;return i(o),n}function dn(t){for(var e=t.querySelector("svg.e-spin-bootstrap").getAttribute("id"),i=1;i<=8;i++)!function(t,e,i,n,o){function r(e){nd[o].isAnimate&&(++s,t.setAttribute("r",e+""),s>=n.length&&(s=0),nd[o].timeOut=setTimeout(r.bind(null,n[s]),18))}var s=0;r(e)}(t.getElementsByClassName("e-path-circle_"+(8===i?0:i))[0],i,0,cn(i,i),e)}function pn(t,e,i){c(i)||t.classList.add(i),t.querySelector(".e-spinner-inner").innerHTML=e}function un(t,e){var i="Material"===e?sd:"Fabric"===e?ad:ld;return t=t?parseFloat(t+""):i,"Bootstrap"===e?t:t/2}function gn(t,e,i,n){return{radius:e,count:i,previousId:n}}function mn(){for(var t="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;i<5;i++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}function fn(t,e,i){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("id",e),n.setAttribute("class",i);var o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("class",vd);var r=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("class",yd),t.insertBefore(n,t.firstChild),n.appendChild(o),n.appendChild(r)}function vn(t,e){var i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttribute("class",dd),i.setAttribute("id",e);var n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("class",vd),t.insertBefore(i,t.firstChild),i.appendChild(n)}function yn(t){var e=document.createElement("div");e.classList.add(md);var i=document.createElement("div");return i.classList.add(fd),t.appendChild(e),e.appendChild(i),{wrap:e,inner_wrap:i}}function bn(t){wn(1,149,Pn,1333,t.globalInfo[t.uniqueID].count,75,t),t.globalInfo[t.uniqueID].count=++t.globalInfo[t.uniqueID].count%4}function wn(t,e,i,n,o,r,s){function a(e){var o=Math.max(0,Math.min((new Date).getTime()-d,n));l(i(o,t,p,n),e.container),h===e.globalInfo[e.uniqueID].previousId&&o<n?nd[e.uniqueID].timeOut=setTimeout(a.bind(null,e),1):bn(e)}function l(t,e){if(!c(e.querySelector("svg.e-spin-material"))&&!c(e.querySelector("svg.e-spin-material").querySelector("path.e-path-circle"))){var i=e.querySelector("svg.e-spin-material").querySelector("path.e-path-circle");i.setAttribute("stroke-dashoffset",En(u,g,t,r)+""),i.setAttribute("transform","rotate("+m+" "+u/2+" "+u/2+")")}}var h=++s.globalInfo[s.uniqueID].previousId,d=(new Date).getTime(),p=e-t,u=Sn(2*s.globalInfo[s.uniqueID].radius+""),g=Ln(u),m=-90*(s.globalInfo[s.uniqueID].count||0);a(s)}function xn(t,e){var i=2*t,n=e.querySelector("svg.e-spin-material"),o=n.querySelector("path.e-path-circle"),r=Ln(i),s=i/2+"px";n.setAttribute("viewBox","0 0 "+i+" "+i),n.style.width=n.style.height=i+"px",n.style.transformOrigin=s+" "+s+" "+s,o.setAttribute("stroke-width",r+""),o.setAttribute("d",Cn(i,r)),o.setAttribute("stroke-dasharray",(i-r)*Math.PI*.75+""),o.setAttribute("stroke-dashoffset",En(i,r,1,75)+"")}function Sn(t){return parseFloat(t)}function Cn(t,e){var i=t/2,n=e/2;return"M"+i+","+n+"A"+(i-n)+","+(i-n)+" 0 1 1 "+n+","+i}function Ln(t){return.1*t}function En(t,e,i,n){return(t-e)*Math.PI*(3*n/100-i/100)}function Pn(t,e,i,n){var o=(t/=n)*t,r=o*t;return e+i*(6*r*o+-15*o*o+10*r)}function kn(t,e,i){var n=t,o=t,r=2*t,s=e.querySelector("."+i),a=s.querySelector(".e-path-circle"),l=s.querySelector(".e-path-arc"),h=r/2+"px";a.setAttribute("d",In(n,o,t)),l.setAttribute("d",On(n,o,t,315,45)),s.setAttribute("viewBox","0 0 "+r+" "+r),s.style.transformOrigin=h+" "+h+" "+h,s.style.width=s.style.height=r+"px"}function Tn(t,e,i,n){var o=(n-90)*Math.PI/180;return{x:t+i*Math.cos(o),y:e+i*Math.sin(o)}}function On(t,e,i,n,o){var r=Tn(t,e,i,o),s=Tn(t,e,i,n);return["M",r.x,r.y,"A",i,i,0,0,0,s.x,s.y].join(" ")}function In(t,e,i){return["M",t,e,"m",-i,0,"a",i,i,0,1,0,2*i,0,"a",i,i,0,1,0,2*-i,0].join(" ")}function An(t){Mn(t,!1),t=null}function Mn(t,e){var i=t.classList.contains(md)?t:t.querySelector("."+md),n=i.querySelector("."+fd);if(e?!i.classList.contains(wd)&&!i.classList.contains(cd):!i.classList.contains(wd)&&!i.classList.contains(hd)){var o=i.querySelector("svg");if(c(o))return;var r=o.getAttribute("id");switch(nd[r].isAnimate=!e,nd[r].type){case"Material":e?clearTimeout(nd[r].timeOut):en(n,r,nd[r].radius);break;case"Bootstrap":e?clearTimeout(nd[r].timeOut):dn(n)}}e?V(i,[cd],[hd]):V(i,[hd],[cd]),t=null}function Rn(t){Mn(t,!0),t=null}function Dn(t){void 0!==t.template&&(od=t.template,void 0!==t.template&&(rd=t.cssClass));for(var e=document.querySelectorAll("."+md),i=0;i<e.length;i++)Bn(t.template,e[i],t.type,t.cssClass)}function Bn(t,e,i,n){c(t)&&!e.classList.contains(wd)?(Nn(e,i,n),e.classList.contains(hd)?(e.classList.remove(hd),An(e)):(e.classList.remove(cd),Rn(e))):(od=t,c(n)||(rd=n))}function Nn(t,e,i){c(i)||t.classList.add(i);var n=t.querySelector("svg"),o="Bootstrap"===e?parseFloat(n.style.height):parseFloat(n.style.height)/2;if(n.getAttribute("class").split(/\s/).indexOf("e-spin-material")>=0){var r=n.getAttribute("id");clearTimeout(nd[r].timeOut)}sn(e,t,o)}function Hn(t){var e=new id;e=Fn(t.tooltip,e);var i=new id(e);return i.beforeCollision=jn,i.beforeOpen=zn,i.cssClass="e-diagram-tooltip",i.opensOn="custom",i.appendTo("#"+t.element.id),i.close(),i}function zn(t){""!==this.content&&void 0!==this.content||(t.element.style.display="none")}function jn(t){t.collidedPosition&&t.collidedPosition!==this.position&&(t.element.style.display="none")}function Vn(t,e){var i,n=t.tooltipObject;return i=e?e.tooltip:t.tooltip,Fn(i,n),n}function Fn(t,e){return t.content?(e.content=t.content,e.position=t.position,e.showTipPointer=t.showTipPointer,e.width=t.width,e.height=t.height,t.animation?e.animation=t.animation:e.animation={close:{effect:"None"}}):e.close(),e}function _n(t,e){var i,n;return n="Straight"!==t.type&&t.sourceWrapper?t.sourceWrapper.corners.center:Wn(t),i=qn(t,n,t.targetPoint,e),So(t,i[0],!1),So(t,i[i.length-1],!0),i}function Wn(t){var e;if(t.sourcePortWrapper){var i=t.sourcePortWrapper,n=t.sourceWrapper,o={x:i.offsetX,y:i.offsetY};Zo(o,n.corners,n.bounds,!1);e=o}else if(t.sourceID&&t.sourceWrapper)if(t.targetWrapper){var r=t.sourceWrapper.corners.center,s=t.targetWrapper.corners.center;e=xo(t,t.sourceWrapper,r,s,!1)}else e=t.sourcePoint;else e=t.sourcePoint;return e}function Un(t,e,i){"LeftToRight"===i?(t.direction=t.direction?t.direction:"Right",e.direction=e.direction?e.direction:"Left"):"RightToLeft"===i?(t.direction=t.direction?t.direction:"Left",e.direction=e.direction?e.direction:"Right"):"TopToBottom"===i?(t.direction=t.direction?t.direction:"Bottom",e.direction=e.direction?e.direction:"Top"):"BottomToTop"===i&&(t.direction=t.direction?t.direction:"Top",e.direction=e.direction?e.direction:"Bottom")}function qn(t,e,i,n){var o=t.sourceWrapper,r=t.targetWrapper,s=t.sourcePortWrapper,a=t.targetPortWrapper,l=[],h={corners:void 0,point:e,direction:void 0,margin:{left:5,right:5,bottom:5,top:5}},c={corners:void 0,point:i,direction:void 0,margin:{left:5,right:5,bottom:5,top:5}};if(void 0!==o&&void 0!==r&&(h.corners=o.corners,c.corners=r.corners),void 0!==s){var d={x:s.offsetX,y:s.offsetY};h.direction=Zo(d,h.corners,o.bounds,!1)}if(void 0!==a){var p={x:a.offsetX,y:a.offsetY};c.direction=Zo(p,c.corners,r.bounds,!1)}return void 0!==o&&void 0!==r?(void 0!==h.direction&&void 0!==c.direction||(n?Un(h,c,n):h.corners.topCenter.y>c.corners.bottomCenter.y&&Math.abs(h.corners.topCenter.y-c.corners.bottomCenter.y)>h.margin.top+h.margin.bottom?(h.direction=h.direction?h.direction:"Top",c.direction=c.direction?c.direction:"Bottom"):h.corners.bottomCenter.y<c.corners.topCenter.y&&Math.abs(h.corners.bottomCenter.y-c.corners.topCenter.y)>h.margin.bottom+h.margin.top?(h.direction=h.direction?h.direction:"Bottom",c.direction=c.direction?c.direction:"Top"):h.corners.middleRight.x<c.corners.middleLeft.x&&Math.abs(h.corners.middleRight.x-c.corners.middleLeft.x)>h.margin.right+h.margin.left?(h.direction=h.direction?h.direction:"Right",c.direction=c.direction?c.direction:"Left"):h.corners.middleLeft.x>c.corners.middleRight.x&&Math.abs(h.corners.middleLeft.x-c.corners.middleRight.x)>h.margin.left+h.margin.right?(h.direction=h.direction?h.direction:"Left",c.direction=c.direction?c.direction:"Right"):o.id!==r.id&&!h.corners.equals(h.corners,c.corners)&&c.corners.containsPoint(h.corners.topCenter,h.margin.top)?(h.direction=h.direction?h.direction:"Bottom",c.direction=c.direction?c.direction:"Top"):(h.direction=h.direction?h.direction:"Top",c.direction=c.direction?c.direction:"Bottom")),ro(t,h.direction,c.direction,h.point,c.point)):(lo(t),(t.sourceWrapper||t.targetWrapper)&&eo(t,h,c),"Straight"===t.type||"Bezier"===t.type?l=so(t,h,c):"Orthogonal"===t.type&&t.segments&&t.segments.length>0&&null!==t.segments[0].length&&null!==t.segments[0].direction?l=Jn(t,h,c,o,r,s,a):(h.direction||(h.direction=c.direction?void 0!==t.targetPortWrapper?c.direction:Qo(c.direction):sh.direction(h.point,c.point)),t.segments[0].points=l=jo(t,h,c)),l)}function Xn(t,e){var i,n,o;return t.direction=e.direction,e.points=[],e.points.push(t.point),o="Left"===e.direction||"Top"===e.direction?-e.length:e.length,n="Left"===e.direction||"Right"===e.direction?0:90,i=wo(t.point,o,n),e.points.push(i),i}function Yn(t,e,i){var n,o,r;if(e.corners=t.sourceWrapper?t.sourceWrapper.corners:void 0,t.sourcePortWrapper&&(r=Zo({x:t.sourcePortWrapper.offsetX,y:t.sourcePortWrapper.offsetY},e.corners,t.sourceWrapper.bounds,!1),!e.corners||"Bottom"!==e.direction&&"Top"!==e.direction?!e.corners||"Left"!==e.direction&&"Right"!==e.direction||i.point.y>e.corners.topCenter.y&&i.point.y<e.corners.bottomCenter.y&&(o=e.point.x>i.point.x?"Left":"Right"):i.point.x>e.corners.middleLeft.x&&i.point.x<e.corners.middleRight.x&&(o=e.point.y>i.point.y?"Top":"Bottom")),t.sourcePortWrapper&&r===Qo(o)){var s;("Left"===r||"Right"===r)&&e.point.y>=e.corners.topCenter.y&&e.point.y<=e.corners.center.y&&i.point.y>=e.corners.topCenter.y&&i.point.y<=e.corners.center.y?(e.direction="Top",s=e.point.y-e.corners.topCenter.y+20):("Left"===r||"Right"===r)&&e.point.y>e.corners.center.y&&e.point.y<=e.corners.bottomCenter.y&&i.point.y>e.corners.center.y&&i.point.y<=e.corners.bottomCenter.y?(e.direction="Bottom",s=e.corners.bottomCenter.y-e.point.y+20):("Top"===r||"Bottom"===r)&&e.point.x>=e.corners.middleLeft.x&&e.point.x<=e.corners.center.x&&i.point.x>=e.corners.middleLeft.x&&i.point.x<=e.corners.center.x?(e.direction="Left",s=e.point.x-e.corners.middleLeft.x+20):("Top"===r||"Bottom"===r)&&e.point.x<=e.corners.middleRight.x&&e.point.x>e.corners.center.x&&i.point.x<=e.corners.middleRight.x&&i.point.x<e.corners.center.x&&(e.direction="Right",s=e.corners.middleRight.x-e.point.x+20),e.direction&&s&&(n=jo(t,e,i,s,!0))}else e.direction=o||ao(e.direction,e.point,i.point),n=zo(e,i);return n}function Gn(t,e,i){var n;i.corners=t.targetWrapper.corners,mo(t.targetWrapper,e,i,t);var o=ao(i.direction,e.point,i.point);return e.direction!==i.direction||"Left"!==e.direction&&"Right"!==e.direction?(e.direction=o,n=zo(e,i)):(e.direction=o,n=jo(t,e,i,t.targetWrapper.width/2+20),e.point=n[1],mo(t.targetWrapper,e,i,t),n=jo(t,e,i)),n}function Zn(t,e,i){var n;i.corners=t.targetWrapper.corners;var o,r;"Left"!==e.direction&&"Right"!==e.direction?i.corners.center.y!==e.point.y||i.corners.middleLeft.x<=e.point.x&&e.point.x<=i.corners.middleRight.x?i.corners.center.y===e.point.y&&"Bottom"===t.segments[t.segments.length-2].direction||i.corners.center.y>e.point.y&&e.point.y>=i.corners.topCenter.y?(o="Top",r=e.point.y-i.corners.topCenter.y+20):i.corners.center.y===e.point.y&&"Top"===t.segments[t.segments.length-2].direction||i.corners.center.y<e.point.y&&e.point.y<=i.corners.bottomCenter.y?(o="Bottom",r=i.corners.bottomCenter.y-e.point.y+20):void 0!==t.sourcePortWrapper&&void 0!==t.targetPortWrapper&&e.corners.topCenter.y<=e.point.y&&e.point.y<=e.corners.bottomCenter.y&&(o=e.direction,r=e.point.y>i.point.y?e.point.y-e.corners.topCenter.y+20:e.corners.bottomCenter.y-e.point.y+20):(o="Top",r=i.corners.height/2+20):i.corners.center.x!==e.point.x||i.corners.topCenter.y<e.point.y&&e.point.y<=i.corners.bottomCenter.y?i.corners.center.x===e.point.x&&"Right"===t.segments[t.segments.length-2].direction||i.corners.center.x>e.point.x&&e.point.x>=i.corners.middleLeft.x?(o="Left",r=e.point.x-i.corners.middleLeft.x+20):i.corners.center.x===e.point.x&&"Left"===t.segments[t.segments.length-2].direction||i.corners.center.x<=e.point.x&&e.point.x<=i.corners.middleRight.x?(o="Right",r=i.corners.middleRight.x-e.point.x+20):void 0!==t.sourcePortWrapper&&void 0!==t.targetPortWrapper&&e.corners.middleLeft.x<=e.point.x&&e.point.x<=e.corners.middleRight.x&&(o=e.direction,r=e.point.x>i.point.x?e.point.x-e.corners.middleLeft.x+20:e.corners.middleRight.x-e.point.x+20):(o="Left",r=i.corners.width/2+20);var s="Left"===o||"Top"===o?-r:r,a="Left"===o||"Right"===o?0:90;n=e.point,e.point=wo(e.point,s,a),e.direction=sh.direction(e.point,i.point),void 0===t.sourcePortWrapper||void 0===t.targetPortWrapper||e.corners.center.x!==i.corners.center.x&&e.corners.center.y!==i.corners.center.y||(e.direction=i.direction);var l=jo(t,e,i);return l.splice(0,0,n),l}function Kn(t,e,i,n){var o=!1;switch(i.direction){case"Left":void 0!==t.sourcePortWrapper&&void 0!==t.targetPortWrapper&&"Right"===n&&e.point.x>i.point.x&&e.point.y>=e.corners.topCenter.y&&e.point.y<=e.corners.bottomCenter.y||("Bottom"===n&&e.point.y>i.point.y||"Top"===n&&e.point.y<i.point.y)&&e.point.x>=e.corners.middleLeft.x&&e.point.x<=e.corners.middleRight.x?(e.direction="Right"===n?e.point.y>i.point.y?"Top":"Bottom":e.point.x<i.point.x?"Right":"Left",o=!0):e.point.x>i.point.x&&(e.point.y>i.point.y||e.point.y<i.point.y)&&!(i.corners.topCenter.y>e.point.y&&i.corners.bottomCenter.y<e.point.y)?e.direction="Left":e.point.x<i.point.x&&e.point.y>i.point.y||e.point.x>i.point.x&&e.point.y<=i.point.y&&i.corners.topCenter.y<e.point.y&&i.corners.center.y>=e.point.y?e.direction="Top":e.point.x<i.point.x&&e.point.y<i.point.y||e.point.x>i.point.x&&e.point.y>i.point.y&&i.corners.bottomCenter.y<e.point.y&&i.corners.center.y>e.point.y?e.direction="Bottom":e.point.y===i.point.y&&e.point.x<i.point.x&&(e.direction="Right");break;case"Right":void 0!==t.sourcePortWrapper&&void 0!==t.targetPortWrapper&&("Bottom"===n&&e.point.y>i.point.y||"Top"===n&&e.point.y<i.point.y)&&e.point.x>i.point.x&&e.point.x>=e.corners.middleLeft.x&&e.point.x<=e.corners.middleRight.x?(e.direction=e.point.x>i.point.x?"Left":"Right",o=!0):void 0!==t.sourcePortWrapper&&void 0!==t.targetPortWrapper&&"Left"===n&&e.point.x<i.point.x&&e.point.y>=e.corners.topCenter.y&&e.point.y<=e.corners.bottomCenter.y?(e.direction=e.point.y>i.point.y?"Top":"Bottom",o=!0):e.point.x<i.point.x&&i.corners.topCenter.y<=e.point.y&&i.corners.bottomCenter.y>=e.point.y&&e.point.y===i.point.y?e.direction="Top":e.point.y>i.point.y&&e.point.x>i.point.x?e.direction="Top":e.point.y<i.point.y&&e.point.x>i.point.x?e.direction="Bottom":e.point.x<i.point.x&&(e.point.y>i.point.y||e.point.y<i.point.y)?e.direction="Right":e.point.y===i.point.y&&e.point.x>i.point.x&&(e.direction="Left");break;case"Top":void 0!==t.sourcePortWrapper&&void 0!==t.targetPortWrapper&&"Bottom"===n&&e.point.y>i.point.y&&e.point.x>=e.corners.middleLeft.x&&e.point.x<=e.corners.middleRight.x||("Right"===n&&e.point.x>i.point.x||"Left"===n&&i.point.y>e.point.y&&i.point.x>e.point.x)&&e.point.y>=e.corners.topCenter.y&&e.point.y<=e.corners.bottomCenter.y?(e.direction="Bottom"===n?e.point.x>i.point.x?"Left":"Right":e.point.y<i.point.y?"Bottom":"Top",o=!0):e.point.x===i.point.x&&e.point.y<i.point.y?e.direction="Bottom":e.point.y>i.point.y&&e.point.x>i.corners.middleLeft.x&&e.point.x<i.corners.middleRight.x?e.direction="Left":e.point.y>=i.point.y?e.direction="Top":e.point.y<i.point.y&&e.point.x>i.point.x?e.direction="Left":e.point.y<i.point.y&&e.point.x<i.point.x&&(e.direction="Right");break;case"Bottom":void 0!==t.sourcePortWrapper&&void 0!==t.targetPortWrapper&&(("Right"===n||"Left"===n&&i.point.x>e.point.x)&&e.point.y>i.point.y&&e.point.y>=e.corners.topCenter.y&&e.point.y<=e.corners.bottomCenter.y||"Top"===n&&e.point.y<i.point.y&&e.point.x>=e.corners.middleLeft.x&&e.point.x<=e.corners.middleRight.x)?(e.direction="Right"===n||"Left"===n?e.point.y>i.point.y?"Top":"Bottom":e.point.x>i.point.x?"Left":"Right",o=!0):e.point.y<i.point.y&&e.point.x>i.corners.middleLeft.x&&i.corners.middleRight.x>e.point.x?e.point.y<i.point.y&&e.point.x>i.corners.middleLeft.x&&i.corners.center.x>=e.point.x?e.direction="Left":e.point.y<i.point.y&&e.point.x<i.corners.middleRight.x&&i.corners.center.x<e.point.x&&(e.direction="Right"):e.point.y>i.point.y&&e.point.x>i.point.x?e.direction="Left":e.point.y>i.point.y&&e.point.x<i.point.x?e.direction="Right":e.point.y<=i.point.y&&(e.point.x>i.point.x||i.point.x>e.point.x)&&(e.direction="Bottom")}return o}function Qn(t,e,i){var n;i.corners=t.targetWrapper.corners;var o;void 0!==t.sourcePortWrapper&&(o=Zo({x:t.sourcePortWrapper.offsetX,y:t.sourcePortWrapper.offsetY},e.corners,t.sourceWrapper.bounds,!1));var r=Kn(t,e,i,o);return void 0!==t.sourcePortWrapper&&void 0!==t.targetPortWrapper&&i.direction===Qo(o)&&(("Left"===i.direction&&e.point.x>i.point.x||"Right"===i.direction&&e.point.x<i.point.x)&&e.point.y>=e.corners.topCenter.y&&e.point.y<=e.corners.bottomCenter.y||"Bottom"===i.direction&&e.point.y<i.point.y&&e.point.x>=e.corners.middleLeft.x&&e.point.x<=e.corners.middleRight.x)?n=Zn(t,e,i):e.direction===i.direction?n=jo(t,e,i):("Left"===i.direction&&e.point.x>i.point.x||"Right"===i.direction&&e.point.x<i.point.x)&&("Top"===e.direction||"Bottom"===e.direction)&&e.point.y<=i.point.y&&i.corners.topCenter.y<=e.point.y&&i.corners.bottomCenter.y>=e.point.y||"Top"===i.direction&&e.point.y>i.point.y||"Bottom"===i.direction&&e.point.y<i.point.y&&i.corners.middleLeft.x<=e.point.x&&i.corners.middleRight.x>=e.point.x?n=Zn(t,e,i):void 0!==t.sourceWrapper&&void 0!==t.targetWrapper&&void 0!==t.targetPortWrapper&&("Left"===e.direction||"Right"===e.direction)&&e.point.y>=e.corners.topCenter.y&&e.point.y<=e.corners.bottomCenter.y&&("Top"===i.direction||"Bottom"===i.direction)&&i.corners.center.x===e.corners.center.x?(e.direction="Top"===i.direction?"Bottom":"Top",n=jo(t,e,i,"Top"===i.direction?e.corners.bottomCenter.y-e.point.y+20:e.point.y-e.corners.topCenter.y+20)):void 0!==t.sourceWrapper&&void 0!==t.targetWrapper&&void 0!==t.targetPortWrapper&&("Top"===e.direction||"Bottom"===e.direction)&&e.point.x>=e.corners.middleLeft.x&&e.point.x<=e.corners.middleRight.x&&("Left"===i.direction||"Right"===i.direction)&&i.corners.center.y===e.corners.center.y?(e.direction="Left"===i.direction?"Right":"Left",n=jo(t,e,i,"Left"===i.direction?e.corners.middleRight.x-e.point.x+20:e.point.x-e.corners.middleLeft.x+20)):n=r?jo(t,e,i,"Left"===e.direction||"Right"===e.direction?"Left"===e.direction?e.point.x-e.corners.middleLeft.x+20:e.corners.middleRight.x-e.point.x+20:"Top"===e.direction?e.point.y-e.corners.topCenter.y+20:e.corners.bottomCenter.y-e.point.y+20):zo(e,i),n}function Jn(t,e,i,n,o,r,s){var a,l,h,c=[];lo(t);var d;if(t.segments.length>0){for(var p=0;p<t.segments.length;p++){var u=t.segments[p];if(0===p&&void 0!==t.sourcePortWrapper&&(h=Zo({x:r.offsetX,y:r.offsetY},n.corners,n.bounds,!1),u.direction===Qo(h)&&(u.direction=h)),p>0&&t.segments[p-1].direction===u.direction)p=ho(t,p,e);else{var g=t.segments[p-1];e.point=u.direction?Xn(e,u):g.points[g.points.length-1]}if(p===t.segments.length-1)if(s||o?t.targetWrapper&&void 0===t.targetPortWrapper?(po(t,e),l=Gn(t,e,i)):l=Qn(t,e,i):l=Yn(t,e,i),to(l,t,e),u.points=[],l.length>=2)for(a=0;a<l.length;a++)u.points.push(l[a]);else d=p;if(r&&0===p){var m=$n(t,r,n);m&&(e.point=m)}}void 0!==d&&(d===t.segments.length-1&&(t.segments[d-1].direction=null,t.segments[d-1].length=null),t.segments.splice(d,1)),c=go(t,c)}return c}function $n(t,e,i){var n,o=Zo({x:e.offsetX,y:e.offsetY},i.corners,i.bounds,!1),r=t.segments[0];return r.direction!==o&&(bo(r,o,i.corners,r.points[0],r.points[r.points.length-1],!1),n=r.points[r.points.length-1],r.direction=sh.direction(r.points[r.points.length-2],r.points[r.points.length-1])),n}function to(t,e,i){var n,o=e.segments[e.segments.length-2],r=o.points[o.points.length-1];("Top"!==o.direction&&"Bottom"!==o.direction||r.x!==t[1].x)&&("Left"!==o.direction&&"Right"!==o.direction||r.y!==t[1].y)||(o.points[o.points.length-1]=t[1],n=sh.direction(o.points[0],o.points[o.points.length-1]),void 0!==e.sourceWrapper&&void 0===e.sourcePortWrapper&&n===Qo(o.direction)&&("Left"===o.direction||"Right"===o.direction?o.points[0].x="Right"===o.direction?o.points[0].x-e.sourceWrapper.corners.width:o.points[0].x+e.sourceWrapper.corners.width:o.points[0].y="Bottom"===o.direction?o.points[0].y-e.sourceWrapper.corners.height:o.points[0].y+e.sourceWrapper.corners.height),o.direction=n,o.length=sh.distancePoints(o.points[0],o.points[o.points.length-1]),t.splice(0,1))}function eo(t,e,i){var n=t.sourcePortWrapper,o=t.targetPortWrapper,r=t.sourceWrapper,s=e.point,a={left:0,right:0,top:0,bottom:0},l={x:0,y:0},h="Top";if(r?(s=i.point,a=e.margin):(r=t.targetWrapper,a=i.margin),"Orthogonal"===t.type)if(t.segments&&t.segments.length>0&&t.sourceWrapper&&t.segments[0].direction)e.direction=t.segments[0].direction,l=xo(t,r,l=yo(r.corners,e.direction),Po(e.direction,l,r),!1);else{var c={corners:null,direction:null,point:null,margin:null};mo(r,{corners:null,direction:null,point:s,margin:a},c,t),l=c.point,h=c.direction}else{var d=void 0;t.segments&&t.segments.length>1&&(d=r===t.sourceWrapper?t.segments[0].point:t.segments[t.segments.length-2].point),l=xo(t,r,r.bounds.center,t.segments&&t.segments.length>1?d:s,r===t.targetWrapper)}r===t.sourceWrapper?(e.direction=e.direction||h,e.point=l,t.sourcePortWrapper&&(e.point={x:n.offsetX,y:n.offsetY})):(i.direction=i.direction||h,i.point=l,t.targetPortWrapper&&(i.point={x:o.offsetX,y:o.offsetY}))}function io(t,e){for(var i=no(t),n=no(e),o=0;o<i.length-1;o++)for(var r=i[o],s=0;s<n.length-1;s++)if(Kr(r,n[s]).enabled)return!0;return!1}function no(t){var e=[],i=Qr(t,t.corners);i.push(i[0]);for(var n=0;n<i.length-1;n++)e.push(oo(i[n],i[n+1]));return e}function oo(t,e){return{X1:t.x,Y1:t.y,X2:e.x,Y2:e.y}}function ro(t,e,i,n,o){var r,s=t.sourceWrapper,a=t.targetWrapper,l=t.sourcePortWrapper,h=t.targetPortWrapper,c=[],d=s.corners,p=a.corners,u=(p.center,{corners:d,point:n,direction:e,margin:{left:5,right:5,bottom:5,top:5}}),g={corners:p,point:o,direction:i,margin:{left:5,right:5,bottom:5,top:5}},m=!1;if(t.sourceWrapper&&t.targetWrapper&&(m=io(t.sourceWrapper,t.targetWrapper)),void 0!==l)switch(u.point={x:l.offsetX,y:l.offsetY},u.direction){case"Bottom":case"Top":u.point.y=u.point.y;break;case"Left":case"Right":u.point.x=u.point.x}else"Orthogonal"===t.type?(t.segments&&t.segments.length>0&&t.segments[0].direction&&(u.direction=t.segments[0].direction),u.point=yo(u.corners,u.direction),r=Po(u.direction,u.point,s),u.point=xo(t,s,u.point,r,!1)):u.point=s.corners.center;if(void 0!==h)switch(g.point={x:h.offsetX,y:h.offsetY},g.direction){case"Bottom":case"Top":g.point.y=g.point.y;break;case"Left":case"Right":g.point.x=g.point.x}else"Orthogonal"===t.type?(g.point=yo(g.corners,g.direction),r=Po(g.direction,g.point,a),g.point=xo(t,a,g.point,r,!0)):g.point=a.corners.center;if("Orthogonal"!==t.type){var f=void 0,v=void 0;if(lo(t),void 0===t.sourcePortWrapper){u.point=u.corners.center,t.segments&&t.segments.length>0&&(v=t.segments[0],f=sh.isEmptyPoint(v.point)?void 0:v);var y=void 0!==f?f.point:g.point;if("Bezier"===t.type&&t.segments.length>0&&t.segments[0].vector1.angle&&t.segments[0].vector1.distance){w=Math.max(u.corners.width,u.corners.height);y=sh.transform(u.point,t.segments[0].vector1.angle,w/2)}u.point=m?t.sourceWrapper.bounds.center:xo(t,s,u.point,y,!1)}if(void 0===t.targetPortWrapper){g.point=g.corners.center,t.segments&&t.segments.length>1&&(v=t.segments[t.segments.length-2],f=sh.isEmptyPoint(v.point)?void 0:v);var b=f?f.point:u.point;if("Bezier"===t.type&&t.segments.length>0&&t.segments[t.segments.length-1].vector2.angle&&t.segments[t.segments.length-1].vector2.distance){var w=Math.max(u.corners.width,u.corners.height);b=sh.transform(g.point,t.segments[0].vector2.angle,w/2)}g.point=m?t.targetWrapper.bounds.center:xo(t,a,b,g.point,!0)}c=so(t,u,g)}else if("Orthogonal"===t.type&&t.segments&&t.segments.length>0&&null!==t.segments[0].direction)c=uo(t,u,g,l,h,s,a);else{if(!t.segments[0]){f=new jd(t,"segments",{type:"Orthogonal"},!0);t.segments.push(f)}t.segments[0].points=c=fo(t,u,g)}return c}function so(t,e,i){var n=[];if(t.segments&&t.segments.length>0){var o=void 0,r=[],s=e.point;for(o=0;o<t.segments.length;o++){var a=t.segments[o];if((r=[]).push(s),o!==t.segments.length-1?(r.push(a.point),s=a.point):r.push(i.point),t.segments[o].points=r,t.segments.length>1&&sh.equals(a.points[0],a.points[1])&&t.segments.splice(o,1),a)for(var l=0;l<a.points.length;l++)(l>0||0===o)&&n.push(a.points[l])}}return n}function ao(t,e,i){return"Top"===t||"Bottom"===t?i.x>e.x?"Right":"Left":i.y>e.y?"Bottom":"Top"}function lo(t){if("Straight"===t.type||"Bezier"===t.type){if(0===t.segments.length||t.segments.length>0&&!sh.isEmptyPoint(t.segments[t.segments.length-1].point)){e=void 0;e="Bezier"===t.type?new zd(t,"segments",{type:"Bezier"},!0):new Hd(t,"segments",{type:"Straight"},!0),t.segments.push(e)}}else if(0===t.segments.length||t.segments[t.segments.length-1].direction){var e=new jd(t,"segments",{type:"Orthogonal"},!0);t.segments.push(e)}}function ho(t,e,i){var n=t.segments[e],o="Left"===n.direction||"Top"===n.direction?-n.length:n.length,r="Left"===n.direction||"Right"===n.direction?0:90,s=wo(i.point,o,r);return t.segments[e-1].length+=n.length,t.segments[e-1].points[1]=i.point=s,t.segments.splice(e,1),--e}function co(t,e,i){var n,o;t.sourcePortWrapper&&(o=Zo({x:t.sourcePortWrapper.offsetX,y:t.sourcePortWrapper.offsetY},e.corners,t.sourceWrapper.bounds,!1)),mo(t.targetWrapper,e,i,t);var r=ao(i.direction,e.point,i.point);if(void 0===t.sourcePortWrapper||e.direction!==i.direction||("Top"!==e.direction&&"Bottom"!==e.direction||e.corners.center.x!==i.corners.center.x)&&("Left"!==e.direction&&"Right"!==e.direction||e.corners.center.y!==i.corners.center.y))if(i.point.x>=e.corners.middleLeft.x&&i.point.x<=e.corners.middleRight.x&&e.point.y>=e.corners.topCenter.y&&e.point.y<=e.corners.bottomCenter.y)e.direction=i.point.y>e.point.y?"Bottom":"Top",n=jo(t,e,i,"Top"===e.direction?e.point.y-e.corners.topCenter.y+20:e.corners.bottomCenter.y-e.point.y+20);else if(t.sourcePortWrapper&&o===Qo(r)){var s;("Left"===o||"Right"===o)&&e.point.y>=e.corners.topCenter.y&&e.point.y<=e.corners.bottomCenter.y?(e.direction=i.point.y>e.point.y?"Bottom":"Top",s=e.corners.height/2+20):("Top"===o||"Bottom"===o)&&e.point.x>=e.corners.middleLeft.x&&e.point.x<=e.corners.middleRight.x&&(e.direction=i.point.x>e.point.x?"Right":"Left",s=e.corners.width/2+20),e.direction&&s?n=jo(t,e,i,s,!0):(e.direction=r,n=zo(e,i))}else!t.sourcePortWrapper||o!==i.direction||"Top"!==o&&"Bottom"!==o||e.corners.center.x!==i.corners.center.x?(e.direction=r,n=zo(e,i)):(e.direction=i.point.y>e.point.y?"Bottom":"Top",n=jo(t,e,i,"Bottom"===e.direction?e.corners.bottomCenter.y-e.point.y+20:e.point.y-e.corners.topCenter.y+20));else e.direction=r,n="Top"===r||"Bottom"===r?jo(t,e,i,t.sourceWrapper.height/2+20):jo(t,e,i,t.sourceWrapper.width/2+20),e.point=n[1],"Left"===r||"Right"===r?(i.direction=r,i.point="Left"===r?i.corners.middleLeft:i.corners.middleRight):mo(t.targetWrapper,e,i,t),n=jo(t,e,i);return n}function po(t,e){if(void 0!==t.targetWrapper&&void 0===t.targetPortWrapper&&t.targetWrapper.corners.containsPoint(e.point)){var i=t.targetWrapper,n=t.segments[t.segments.length-2],o=n.points[n.points.length-1],r=Qo(n.direction);"Bottom"===r?o.y<i.corners.bottomCenter.y&&(n.points[n.points.length-1].y=i.corners.bottomCenter.y+20,n.length=sh.distancePoints(n.points[0],n.points[n.points.length-1])):"Top"===r?o.y>i.corners.topCenter.y&&(n.points[n.points.length-1].y=i.corners.topCenter.y-20,n.length=sh.distancePoints(n.points[0],n.points[n.points.length-1])):"Left"===r?o.x>i.corners.middleLeft.x&&(n.points[n.points.length-1].x=i.corners.middleLeft.x-20,n.length=sh.distancePoints(n.points[0],n.points[n.points.length-1])):"Right"===r&&o.x<i.corners.middleRight.x&&(n.points[n.points.length-1].x=i.corners.middleRight.x+20,n.length=sh.distancePoints(n.points[0],n.points[n.points.length-1])),e.point=n.points[n.points.length-1]}}function uo(t,e,i,n,o,r,s){var a,l,h,c,d=[];lo(t);for(var p=0;p<t.segments.length;p++){if(l=t.segments[p],n&&e.direction===Qo(l.direction)&&(l.direction=e.direction),p>0&&t.segments[p-1].direction===l.direction)p=ho(t,p,e);else if(l.direction)e.point=Xn(e,t.segments[p]);else{var u=t.segments[p-1];e.point=u.points[u.points.length-1]}if(p===t.segments.length-1)if(po(t,e),a=void 0===o?co(t,e,i):Qn(t,e,i),to(a,t,e),l.points=[],a.length>=2)for(h=0;h<a.length;h++)l.points.push(a[h]);else c=p;if(void 0!==c&&(c===t.segments.length-1&&(t.segments[c-1].direction=null,t.segments[c-1].length=null),t.segments.splice(c,1)),n&&0===p){var g=$n(t,n,r);g&&(e.point=g)}}return go(t,d)}function go(t,e){for(var i=0;i<t.segments.length;i++)for(var n=t.segments[i],o=0;o<n.points.length;o++)(o>0||0===i)&&e.push(n.points[o]);return e}function mo(t,e,i,n){var o,r={x:0,y:0},s=t.corners,a=e.margin,l=e.point;if(s.bottomCenter.y+a.bottom<l.y)o="Bottom",r=s.bottomCenter;else if(s.topCenter.y-a.top>l.y)o="Top",r=s.topCenter;else if(s.middleLeft.x-a.left>l.x)o="Left",r=s.middleLeft;else if(s.middleRight.x+a.right<l.x)o="Right",r=s.middleRight;else{var h=Math.abs(l.y-s.topCenter.y),c=Math.abs(l.x-s.middleRight.x),d=Math.abs(l.y-s.bottomCenter.y),p=Math.abs(l.x-s.middleLeft.x),u=Number.MAX_VALUE;u=h,o="Top",r=s.topCenter,u>c&&(u=c,o="Right",r=s.middleRight),u>d&&(u=d,o="Bottom",r=s.bottomCenter),u>p&&(o="Left",r=s.middleLeft)}i.point=r,i.direction=o;var g=Po(i.direction,i.point,t);i.point=xo(n,t,i.point,g,t===n.targetWrapper)}function fo(t,e,i,n){var o,r=!1;return(r=Yo(e.direction,i.direction))&&Go(e,i),"Right"===e.direction&&"Left"===i.direction?o=ko(t,e,i,r):"Right"===e.direction&&"Right"===i.direction?o=To(t,e,i):"Right"===e.direction&&"Top"===i.direction?o=Oo(t,e,i,r):"Right"===e.direction&&"Bottom"===i.direction?o=Io(t,e,i,r):"Bottom"===e.direction&&"Top"===i.direction?o=Ao(e,i):"Bottom"===e.direction&&"Bottom"===i.direction?(e.margin={left:10,right:10,top:10,bottom:10},i.margin={left:10,right:10,top:10,bottom:10},o=Ro(t,e,i)):"Bottom"===e.direction&&"Left"===i.direction?o=Mo(t,e,i,r):"Left"===e.direction&&"Left"===i.direction?o=Bo(t,e,i):"Left"===e.direction&&"Top"===i.direction?o=Do(t,e,i,r):"Top"===e.direction&&"Top"===i.direction&&(o=No(t,e,i)),r&&Go(e,i),Ho(t,o,e,i,n)}function vo(t,e){var i={x:e.x,y:t.y},n=(sh.findLength(t,i),sh.findLength(i,e)),o=sh.findLength(e,t),r=Math.asin(n/o);return r=180*r/Math.PI,t.x<e.x?t.y>e.y&&(r=360-r):r=t.y<e.y?180-r:180+r,r}function yo(t,e){var i;switch(e){case"Left":i=t.middleLeft;break;case"Top":i=t.topCenter;break;case"Right":i=t.middleRight;break;case"Bottom":i=t.bottomCenter}return i}function bo(t,e,i,n,o,r){var s,a,l=[];l.push(n);n.y===o.y&&("Left"===e&&o.x<n.x||"Right"===e&&o.x>n.x)||n.x===o.x&&("Top"===e&&o.y<n.y||"Bottom"===e&&o.y>n.y)||("Top"===e||"Bottom"===e?"Top"===e&&o.y<n.y&&o.y>n.y-13||"Bottom"===e&&o.y>n.y&&o.y<n.y+13?(a="Top"===e?i.top-13:i.bottom+13,l.push({x:n.x,y:a}),l.push({x:n.x+(o.x-n.x)/2,y:a}),l.push({x:n.x+(o.x-n.x)/2,y:o.y})):Math.abs(n.x-o.x)>13&&("Top"===e&&o.y<n.y||"Bottom"===e&&o.y>n.y)?l.push({x:n.x,y:o.y}):(a="Top"===e?i.top-13:i.bottom+13,s=o.x<n.x?i.left-13:i.right+13,l.push({x:n.x,y:a}),l.push({x:o.x,y:a})):"Left"===e&&o.x<n.x&&o.x>n.x-13||"right"===e&&o.x>n.x&&o.x<n.x+13?(s="Left"===e?i.left-13:i.right+13,l.push({x:s,y:n.y}),l.push({x:s,y:n.y+(o.y-n.y)/2}),l.push({x:o.x,y:n.y+(o.y-n.y)/2})):Math.abs(n.y-o.y)>13&&("Left"===e&&o.x<n.x||"Right"===e&&o.x>n.x)?l.push({x:o.x,y:n.y}):(s="Left"===e?i.left-13:i.right+13,l.push({x:s,y:n.y}),l.push({x:s,y:o.y})),r&&(l.push(t.points[0]),l.reverse()),t.points=l)}function wo(t,e,i){return sh.transform(t,i,e)}function xo(t,e,i,n,o){i={x:i.x,y:i.y},n={x:n.x,y:n.y};var r,s,a=sh.findAngle(n,i),l=o?t.targetWrapper:t.sourceWrapper,h=o||"Orthogonal"===t.type?i:n;sh.transform(i,a,Math.max(l.actualSize.height/2,l.actualSize.width/2));if(r=l,"Orthogonal"===t.type){var c=Math.abs(r.bounds.height-r.actualSize.height)/2+5;i.x===n.x&&(i.y<n.y?i.y-=c:i.y+=c),c=Math.abs(r.bounds.width-r.actualSize.width)/2+5,i.y===n.y&&(i.x<n.x?i.x-=c:i.x+=c)}else{o?sh.findAngle(i,n):sh.findAngle(n,i);if(o){var d=sh.findAngle(i,n);n=sh.transform({x:n.x,y:n.y},d,Math.max(l.actualSize.width,l.actualSize.height))}else{var p=sh.findAngle(n,i);i=sh.transform({x:i.x,y:i.y},p,Math.max(l.actualSize.width,l.actualSize.height))}}l instanceof Hh&&l.data?(s=r.getPoints(),r.data.split("m").length-1+(r.data.split("M").length-1)==1&&(s[s.length]=s[0])):(s=Qr(l,l.corners))[s.length]=s[0];s.length;return Co({X1:i.x,Y1:i.y,X2:n.x,Y2:n.y},s,!0,h)||(o?n:i)}function So(t,e,i){return e.x=Math.round(100*e.x)/100,e.y=Math.round(100*e.y)/100,i?t.targetPoint=e:t.sourcePoint=e,e}function Co(t,e,i,n){var o,r=e.length,s={X1:e[0].x,Y1:e[0].y,X2:e[1].x,Y2:e[1].y},a=Lo(t,s);if(a&&(o=sh.distancePoints(a,n)),isNaN(o)||o>0)for(var l=1;l<r-1;l++){var h=Lo(t,s={X1:e[l].x,Y1:e[l].y,X2:e[l+1].x,Y2:e[l+1].y});if(h){var c=sh.distancePoints(h,n);if((isNaN(o)||o>c)&&(o=c,a=h),o>=0&&o<=1)break}}return a}function Lo(t,e){var i,n,o,r,s,a,l,h,c,d,p,u,g,m,f,v=t.X1,y=t.Y1,b=t.X2,w=t.Y2,x=e.X1,S=e.Y1,C=e.X2,L=e.Y2;return i=w-y,o=v-b,s=b*y-v*w,p=i*x+o*S+s,u=i*C+o*L+s,0!==p&&0!==u&&Eo(p,u)?null:(n=L-S,r=x-C,a=C*S-x*L,c=n*v+r*y+a,d=n*b+r*w+a,0!==c&&0!==d&&Eo(c,d)?null:0===(g=i*r-n*o)?null:(m=g<0?-g/2:g/2,m=0,f=o*a-r*s,l=f<0?(f-m)/g:(f+m)/g,f=n*s-i*a,h=f<0?(f-m)/g:(f+m)/g,{x:l,y:h}))}function Eo(t,e){return t*e>=0}function Po(t,e,i){var n;switch(t){case"Bottom":n={x:e.x,y:e.y-Math.max(i.actualSize.width,i.actualSize.height)};break;case"Top":n={x:e.x,y:e.y+Math.max(i.actualSize.width,i.actualSize.height)};break;case"Right":n={y:e.y,x:e.x-Math.max(i.actualSize.width,i.actualSize.height)};break;case"Left":n={y:e.y,x:e.x+Math.max(i.actualSize.width,i.actualSize.height)}}return n}function ko(t,e,i,n){var o=t.sourcePortWrapper,r=(t.targetPortWrapper,Math.round(Math.abs(e.point.y-i.point.y))),s=(Math.round(Math.abs(e.point.x-i.point.x)),{x:Math.max(e.point.x,e.corners.right),y:e.point.y}),a={x:Math.min(i.point.x,i.corners.left),y:i.point.y},l=10;if(n){var h=void 0;h=a,a=s,s=h}return e.corners.bottomCenter.y+l<i.corners.topCenter.y-l||e.corners.topCenter.y-l>i.corners.bottomCenter.y+l||(l=0),e.margin={left:l,right:l,top:l,bottom:l},i.margin={left:l,right:l,top:l,bottom:l},0===r&&(e.corners.middleRight.x<i.corners.middleLeft.x||n&&e.corners.middleRight.x<i.corners.middleLeft.x)?Eh.One:e.corners.middleRight.x+e.margin.right<i.corners.middleLeft.x-i.margin.left?Eh.Three:t.sourceWrapper!==t.targetWrapper&&(e.corners.containsPoint(a)||i.corners.containsPoint(s))?Eh.Three:e.corners.bottomCenter.y<=i.corners.topCenter.y?Eh.Five:e.corners.topCenter.y>=i.corners.topCenter.y?Eh.Five:void 0!==o&&o.offsetY<=i.corners.topCenter.y||void 0===o&&e.corners.middleRight.y<=i.corners.topCenter.y?Eh.Five:(void 0!==o&&o.offsetY>=i.corners.bottomCenter.y||void 0===o&&(e.corners.middleRight.y,i.corners.bottomCenter.y),Eh.Five)}function To(t,e,i){var n=t.sourcePortWrapper,o=t.targetPortWrapper,r=e.point.x-i.point.x,s=e.point.y-i.point.y;return i.margin={left:10,right:10,top:10,bottom:10},e.margin={left:10,right:10,top:10,bottom:10},e.corners.middleRight.x>=i.corners.middleRight.x?void 0!==n&&(n.offsetY<i.corners.topCenter.y||n.offsetY>i.corners.bottomCenter.y)||void 0===n&&e.corners.middleRight.y<i.corners.topCenter.y?Eh.Three:void 0!==n&&n.offsetY>i.corners.bottomCenter.y+i.margin.bottom&&e.corners.topCenter.y>i.corners.bottomCenter.y||void 0===n&&e.corners.middleRight.y>i.corners.bottomCenter.y?Eh.Three:void 0!==n&&n.offsetY<i.corners.topCenter.y&&e.corners.bottomCenter.y>i.corners.topCenter.y||void 0===n&&e.corners.middleRight.y>i.corners.bottomCenter.y?Eh.Three:e.corners.middleRight.x<i.corners.middleLeft.x||i.corners.middleRight.x<e.corners.middleLeft.x?Eh.Five:0===r||0===s?Eh.One:Eh.Three:void 0!==o&&e.corners.bottomCenter.y<o.offsetY||void 0===o&&e.corners.bottomCenter.y<i.corners.middleRight.y?Eh.Three:void 0!==o&&e.corners.topCenter.y>o.offsetY||void 0===o&&e.corners.topCenter.y>i.corners.middleRight.y?Eh.Three:void 0!==o&&(void 0!==n&&n.offsetX<i.corners.middleLeft.x&&n.offsetX!==o.offsetX&&n.offsetY!==o.offsetY&&Math.abs(e.corners.middleRight.x-i.corners.middleLeft.x)<=20||void 0===n&&e.corners.middleRight.x<i.corners.middleLeft.x&&e.corners.center.x!==i.corners.center.x&&e.corners.center.y!==i.corners.center.y)?Eh.Three:e.corners.middleRight.x<i.corners.middleLeft.x?Eh.Five:0===r||0===s?Eh.One:Eh.Three}function Oo(t,e,i,n){var o=t.targetPortWrapper,r=t.sourcePortWrapper,s={x:Math.max(e.point.x,e.corners.right),y:e.point.y},a={x:i.point.x,y:Math.min(i.point.y,i.corners.top)};if(i.margin={left:5,right:5,top:5,bottom:5},e.margin={top:5,bottom:5,left:5,right:5},n){var l=void 0;l=r,r=o,o=l}return void 0!==r&&r.offsetY<i.corners.topCenter.y-i.margin.top||void 0===r&&e.corners.bottomCenter.y<i.corners.topCenter.y-i.margin.top?e.corners.bottomCenter.y<i.corners.topCenter.y?void 0!==o&&e.corners.middleRight.x+e.margin.right<o.offsetX||void 0===o&&e.corners.middleRight.x+e.margin.right<i.corners.topCenter.x?Eh.Two:Eh.Four:void 0!==o&&e.corners.middleLeft.x>o.offsetX||void 0===o&&e.corners.middleLeft.x>i.corners.topCenter.x?Eh.Four:Eh.Two:void 0!==r&&Math.abs(e.corners.middleRight.x-i.corners.middleLeft.x)<=25&&Math.abs(r.offsetY-i.corners.topCenter.y)<=25?Eh.Two:void 0!==o&&Math.abs(o.offsetX-e.corners.topCenter.x)>=25&&e.corners.middleRight.y<o.offsetY?Eh.Two:e.corners.middleRight.x<i.corners.middleLeft.x?Eh.Four:t.sourceWrapper!==t.targetWrapper&&(e.corners.containsPoint(a)||i.corners.containsPoint(s))?Eh.Two:Eh.Four}function Io(t,e,i,n){e.margin={left:10,right:10,top:10,bottom:10},i.margin={left:10,right:10,top:10,bottom:10};var o=t.sourcePortWrapper,r=t.targetPortWrapper;Math.max(e.point.x,e.corners.right),e.point.y,i.point.x,Math.max(i.point.y,i.corners.bottom);if(n){var s=void 0;s=o,o=r,r=s}return void 0!==o&&o.offsetY>i.corners.bottomCenter.y+i.margin.bottom||void 0===o&&e.corners.middleRight.y>i.corners.bottomCenter.y+i.margin.bottom?e.corners.topCenter.y>i.corners.bottomCenter.y?void 0!==r&&e.corners.middleRight.x+e.margin.right<r.offsetX||void 0===r&&e.corners.middleRight.x+e.margin.right<i.corners.bottomCenter.x?Eh.Two:Eh.Four:void 0!==r&&e.corners.middleLeft.x>r.offsetX||void 0===r&&e.corners.middleLeft.x>i.corners.bottomCenter.x?Eh.Four:Eh.Two:void 0!==o&&Math.abs(e.corners.middleRight.x-i.corners.middleLeft.x)<=25&&Math.abs(o.offsetY-i.corners.bottomCenter.y)<=25?Eh.Two:(e.corners.middleRight.x,i.corners.middleLeft.x,Eh.Four)}function Ao(t,e){var i=t.point.x-e.point.x,n=(t.point.y,e.point.y,t.point.x,Math.max(t.point.y,t.corners.bottom),e.point.x,Math.min(e.point.y,e.corners.top),10);return t.corners.middleRight.x+n<e.corners.middleLeft.x-n||t.corners.middleLeft.x-n>e.corners.middleRight.x+n||(n=0),t.margin={left:n,right:n,top:n,bottom:n},e.margin={left:n,right:n,top:n,bottom:n},0===i&&t.corners.bottomCenter.y<e.corners.topCenter.y?Eh.One:t.corners.bottomCenter.y+t.margin.bottom<e.corners.topCenter.y-e.margin.top?Eh.Three:t.corners.middleRight.x+t.margin.right<e.corners.middleLeft.x-e.margin.left?Eh.Five:(t.corners.middleLeft.x,t.margin.left,e.corners.middleRight.x,e.margin.right,Eh.Five)}function Mo(t,e,i,n){var o=t.sourcePortWrapper,r=t.targetPortWrapper;e.point.x,Math.max(e.point.y,e.corners.bottom),Math.min(i.point.x,i.corners.left),i.point.y;if(n){var s=void 0;s=o,o=r,r=s}return void 0!==o&&o.offsetX<i.corners.middleLeft.x-i.margin.left||void 0===o&&e.corners.bottomCenter.x<i.corners.bottomLeft.x-i.margin.left?e.corners.middleRight.x<i.corners.middleLeft.x?void 0!==r&&e.corners.bottomCenter.y+e.margin.bottom<r.offsetY||void 0===r&&e.corners.bottomCenter.y+e.margin.bottom<i.corners.middleLeft.y?Eh.Two:Eh.Four:void 0!==r&&e.corners.topCenter.y>r.offsetY||void 0===r&&e.corners.topCenter.y>i.corners.middleLeft.y?Eh.Four:Eh.Two:void 0!==r&&Math.abs(e.corners.middleRight.x-i.corners.middleLeft.x)<=25&&Math.abs(r.offsetY-e.corners.bottomCenter.y)<=25?Eh.Two:Eh.Four}function Ro(t,e,i){var n=t.sourcePortWrapper,o=t.targetPortWrapper,r=Math.round(Math.abs(e.point.x-i.point.x)),s=Math.round(Math.abs(i.point.y-i.point.y));return e.corners.bottomCenter.y<i.corners.bottomCenter.y?void 0!==n&&n.offsetX<i.corners.middleLeft.x-i.margin.left||void 0===n&&e.corners.bottomCenter.x<i.corners.middleLeft.x-i.margin.left?Eh.Three:void 0!==n&&n.offsetX>i.corners.middleRight.x+i.margin.right||void 0===n&&e.corners.bottomCenter.x>i.corners.middleRight.x+i.margin.right?Eh.Three:e.corners.bottomCenter.y<i.corners.topCenter.y?Eh.Five:0===r||0===s?Eh.One:Eh.Three:void 0!==o&&e.corners.middleLeft.x>o.offsetX||void 0===o&&e.corners.middleLeft.x>i.corners.middleLeft.x?Eh.Three:void 0!==o&&e.corners.middleRight.x<o.offsetX||void 0===o&&e.corners.middleRight.x<i.corners.middleRight.x?Eh.Three:e.corners.topCenter.y>i.corners.bottomCenter.y?Eh.Five:0===r||0===s?Eh.One:Eh.Three}function Do(t,e,i,n){var o=t.sourcePortWrapper,r=t.targetPortWrapper,s={x:Math.min(e.point.x,e.corners.left),y:e.point.y},a={x:i.point.x,y:Math.min(i.point.y,i.corners.top)};if(n){var l=void 0;l=o,o=r,r=l}return void 0!==o&&o.offsetY<i.corners.topCenter.y-i.margin.top||void 0===o&&(e.corners.bottomCenter.y<i.corners.topCenter.y-i.margin.top||e.corners.middleLeft.y<i.corners.topCenter.y-i.margin.top)?e.corners.bottomCenter.y<i.corners.topCenter.y?void 0!==r&&e.corners.middleLeft.x-e.margin.left>r.offsetX||void 0===r&&e.corners.middleLeft.x-e.margin.left>i.corners.topCenter.x?Eh.Two:Eh.Four:void 0!==r&&e.corners.middleRight.x<r.offsetX||void 0===r&&e.corners.middleRight.x<i.corners.topCenter.x?Eh.Four:Eh.Two:void 0!==o&&Math.abs(e.corners.middleLeft.x-i.corners.middleRight.x)<=25&&Math.abs(o.offsetY-i.corners.topCenter.y)<=25?Eh.Two:t.sourceWrapper!==t.targetWrapper&&(e.corners.containsPoint(a)||i.corners.containsPoint(s))?Eh.Two:(e.corners.middleLeft.x,i.corners.middleRight.x,Eh.Four)}function Bo(t,e,i){var n=t.sourcePortWrapper,o=t.targetPortWrapper;e.margin={left:10,right:10,top:10,bottom:10},i.margin={left:10,right:10,top:10,bottom:10};var r=Math.round(Math.abs(e.point.x-i.point.x)),s=Math.round(Math.abs(e.point.y-i.point.y));return e.corners.middleLeft.x<i.corners.middleLeft.x?void 0!==o&&e.corners.bottomCenter.y+e.margin.bottom<o.offsetY||void 0===o&&e.corners.bottomCenter.y+e.margin.bottom<i.corners.middleLeft.y?Eh.Three:void 0!==o&&e.corners.topCenter.y-e.margin.top>o.offsetY||void 0===o&&e.corners.topCenter.y-e.margin.top>i.corners.middleLeft.y?Eh.Three:e.corners.middleRight.x<i.corners.middleLeft.x||i.corners.middleRight.x<e.corners.middleLeft.x?Eh.Five:0===r||0===s?Eh.One:Eh.Three:void 0!==n&&n.offsetY<i.corners.topCenter.y-i.margin.top||void 0===n&&e.corners.middleLeft.y<i.corners.topCenter.y?Eh.Three:void 0!==n&&n.offsetY>i.corners.bottomCenter.y+i.margin.bottom||void 0===n&&e.corners.middleLeft.y>i.corners.bottomCenter.y+i.margin.bottom?Eh.Three:e.corners.middleLeft.x>i.corners.middleRight.x?Eh.Five:0===r||0===s?Eh.One:Eh.Three}function No(t,e,i){var n=t.sourcePortWrapper,o=t.targetPortWrapper,r=Math.round(Math.abs(e.point.x-i.point.x)),s=Math.round(Math.abs(e.point.y-i.point.y));e.margin={left:10,right:10,top:10,bottom:10};return i.margin={left:10,right:10,top:10,bottom:10},e.corners.topCenter.y<i.corners.topCenter.y?void 0!==o&&e.corners.middleLeft.x>o.offsetX||void 0===o&&e.corners.middleLeft.x>i.corners.middleLeft.x?Eh.Three:void 0!==o&&e.corners.middleRight.x<o.offsetX||void 0===o&&e.corners.middleRight.x<i.corners.middleRight.x?Eh.Three:e.corners.bottomCenter.y<i.corners.topCenter.y?Eh.Five:0===r||0===s?Eh.One:Eh.Three:void 0!==n&&n.offsetX>i.corners.middleRight.x||void 0===n&&e.corners.middleLeft.x>i.corners.middleRight.x?Eh.Three:void 0!==n&&n.offsetX<i.corners.middleLeft.x||void 0===n&&e.corners.bottomRight.x<i.corners.middleLeft.x?Eh.Three:e.corners.topCenter.y>i.corners.bottomCenter.y?Eh.Five:0===r||0===s?Eh.One:Eh.Three}function Ho(t,e,i,n,o){var r,s=t.sourceWrapper,a=t.targetWrapper,l=t.targetPortWrapper,h=s.corners,c=a.corners;if(void 0!==a&&void 0===l){var d=Po(n.direction,n.point,a);n.point=xo(t,a,n.point,d,!0)}var p=20;if(!(i.direction===n.direction&&e!==Eh.Five||i.direction!==Qo(n.direction)&&e!==Eh.Three))switch(i.direction){case"Left":h.middleLeft.x>c.middleRight.x&&(p=Math.min(p,(h.middleLeft.x-c.middleRight.x)/2));break;case"Right":h.middleRight.x<c.middleLeft.x&&(p=Math.min(p,(c.middleLeft.x-h.middleRight.x)/2));break;case"Top":h.topCenter.y>c.bottomCenter.y&&(p=Math.min(p,(h.topCenter.y-c.bottomCenter.y)/2));break;case"Bottom":h.bottomCenter.y<c.topCenter.y&&(p=Math.min(p,(c.topCenter.y-h.bottomCenter.y)/2))}switch(i.direction){case"Left":i.point.x>h.middleLeft.x&&(p=i.point.x-h.middleLeft.x>p?i.point.x-h.middleLeft.x+p:p);break;case"Right":i.point.x<h.middleRight.x&&(p=h.middleRight.x-i.point.x>p?h.middleRight.x-i.point.x+p:p);break;case"Top":i.point.y>h.topCenter.y&&(p=i.point.y-h.topCenter.y>p?i.point.y-h.topCenter.y+p:p);break;case"Bottom":i.point.y<h.bottomCenter.y&&(p=h.bottomCenter.y-i.point.y>p?h.bottomCenter.y-i.point.y+p:p)}if(o&&(p=Math.max(p,o)),e===Eh.One&&(r=[i.point,n.point]),e===Eh.Two&&(r=zo(i,n)),e===Eh.Three&&(r=jo(t,i,n,p)),e===Eh.Four){r=Fo(i,n,void 0,r,p)}return e===Eh.Five&&(r=Vo(i,n,p)),r}function zo(t,e){var i;switch(t.direction){case"Left":case"Right":var n={x:e.point.x,y:t.point.y};i=sh.equals(t.point,n)||sh.equals(e.point,n)?[t.point,e.point]:[t.point,n,e.point];break;case"Top":case"Bottom":var o={x:t.point.x,y:e.point.y};i=sh.equals(t.point,o)||sh.equals(e.point,o)?[t.point,e.point]:[t.point,o,e.point]}return i}function jo(t,e,i,n,o){n||(n=20);var r,s,a,l=t.sourcePortWrapper,h=i.point.x-e.point.x,c=i.point.y-e.point.y;if(!o&&(Math.abs(h)<.001||Math.abs(c)<.001)&&void 0===i.direction)return[e.point,i.point];if(void 0===t.targetWrapper&&Math.abs(h)<=31&&Math.abs(c)<=31){if("Left"===e.direction||"Right"===e.direction?Math.abs(c)<12&&(e.direction=e.point.y>i.point.y?"Top":"Bottom"):Math.abs(h)<12&&(e.direction=e.point.x>i.point.x?"Left":"Right"),Math.abs(h)>12||Math.abs(c)>12)return zo(e,i);n+=5}return"Left"===e.direction||"Right"===e.direction?("Right"===e.direction?(void 0!==i.direction&&"Right"===i.direction&&(n=Math.max(e.point.x,i.point.x)-e.point.x+n),e.point.x>i.point.x&&void 0===l&&(n=-n)):(void 0!==i.direction&&"Left"===i.direction&&(n=e.point.x-Math.min(e.point.x,i.point.x)+n),(e.point.x>i.point.x||void 0!==l||"Left"===e.direction)&&(n=-n)),a=i.point.y-e.point.y,r=wo(e.point,n,0),0!==(a=i.point.y-r.y)&&(s=wo(r,i.point.y-r.y,90))):"Top"!==e.direction&&"Bottom"!==e.direction||("Bottom"===e.direction?void 0!==i.direction&&"Bottom"===i.direction&&(n=Math.max(e.point.y,i.point.y)-e.point.y+n):(void 0!==i.direction&&"Top"===i.direction&&(n=e.point.y-Math.min(e.point.y,i.point.y)+n),(e.point.y>i.point.y||void 0!==l||"Top"===e.direction)&&(n=-n)),a=i.point.x-e.point.x,r=(e.direction,wo(e.point,n,90)),0!==(a=i.point.x-r.x)&&(s=wo(r,i.point.x-r.x,0))),0===a?[e.point,i.point]:[e.point,r,s,i.point]}function Vo(t,e,i){void 0===i&&(i=20);var n,o,r=i,s=t.corners.middleLeft.x-t.margin.left,a=t.corners.middleRight.x+t.margin.right,l=t.corners.bottomCenter.y+t.margin.bottom,h=t.corners.topCenter.y-t.margin.top,c=e.corners.middleLeft.x-e.margin.left,d=e.corners.middleRight.x+e.margin.right,p=e.corners.bottomCenter.y+e.margin.bottom,u=e.corners.topCenter.y-e.margin.top;switch(t.direction){case"Left":(h>u&&h<p||l<p&&l>u)&&s>c&&s<=d&&i>=20&&(r=t.point.x-e.corners.middleLeft.x+r),o=wo(t.point,r,180);break;case"Top":(s>c&&s<d||a<d&&a>c)&&h>u&&h<=p&&i>=20&&(r=t.point.y-e.corners.topCenter.y+r),o=wo(t.point,r,270);break;case"Right":(h>u&&h<p||l<p&&l>u)&&a<d&&a>=c&&i>=20&&(r=e.corners.middleRight.x-t.point.x+r),o=wo(t.point,r,0);break;case"Bottom":(s>c&&s<d||a<d&&a>c)&&l<p&&l>=u&&i>=20&&(r=e.corners.bottomCenter.y-t.point.y+r),o=wo(t.point,r,90)}if(n=[t.point,o],"Top"===t.direction||"Bottom"===t.direction){g=t.direction;t.direction=o.x>e.point.x?"Left":"Right",t.point=o,n=Fo(t,e,g,n)}else{var g=t.direction;t.direction=o.y>e.point.y?"Top":"Bottom",t.point=o,n=Fo(t,e,g,n)}return n}function Fo(t,e,i,n,o){void 0===o&&(o=20);var r;switch(void 0===i?(t.margin={left:2,right:2,top:2,bottom:2},e.margin={left:0,right:5,top:0,bottom:5}):"Bottom"===t.direction?e.corners.top>t.corners.bottom&&e.corners.top-t.corners.bottom<20&&(o=(e.corners.top-t.corners.bottom)/2):"Top"===t.direction?e.corners.bottom<t.corners.top&&t.corners.top-e.corners.bottom<20&&(o=(t.corners.top-e.corners.bottom)/2):"Right"===t.direction?e.corners.left>t.corners.right&&e.corners.left-t.corners.right<20&&(o=(e.corners.left-t.corners.right)/2):"Left"===t.direction&&e.corners.right<t.corners.left&&t.corners.left-e.corners.right<20&&(o=(t.corners.left-e.corners.right)/2),t.direction){case"Left":o=Uo(t,e,i,o),r=wo(t.point,o,180);break;case"Right":o=qo(t,e,o,i),r=wo(t.point,o,0);break;case"Top":o=Wo(t,e,i,o),r=wo(t.point,o,270);break;case"Bottom":o=Xo(t,e,o,i),r=wo(t.point,o,90)}return void 0!==n?n.push(r):n=[t.point,r],"Top"===t.direction||"Bottom"===t.direction?_o(r,"horizontal",t,e,n):"Right"!==t.direction&&"Left"!==t.direction||_o(r,"vertical",t,e,n),n}function _o(t,e,i,n,o){var r,s,a;"horizontal"===e?(i.margin={left:0,right:10,top:0,bottom:10},n.margin={left:0,right:10,top:0,bottom:10}):"vertical"===e&&(i.margin={left:10,right:0,top:10,bottom:0},n.margin={left:10,right:0,top:10,bottom:0});var l=20;if("horizontal"===e){switch(n.direction){case"Left":if(i.corners.right+i.margin.right<n.corners.left-n.margin.left&&(n.corners.left-i.corners.right>l||i.corners.top-i.margin.top<=n.point.y&&i.corners.bottom+i.margin.bottom>=n.point.y)){h=Math.min(Math.abs(n.corners.left-i.corners.right)/2,20);l=i.corners.right-t.x+h}else l="Top"===i.direction&&t.y>n.point.y||"Bottom"===i.direction&&t.y<n.point.y?Math.min(n.corners.left,t.x)-t.x-20:t.x>=i.corners.left-i.margin.left&&t.x<=i.corners.right+i.margin.right?Math.min(n.corners.left,i.corners.left)-t.x-20:n.corners.left-t.x-20;break;case"Right":if(i.corners.left-i.margin.left>n.corners.right+n.margin.right&&(i.corners.left-n.corners.right>l||i.corners.top-i.margin.top<=n.point.y&&i.corners.bottom+i.margin.bottom>=n.point.y)){h=Math.min(Math.abs(i.corners.left-n.corners.right)/2,20);l=i.corners.left-t.x-h}else l="Top"===i.direction&&t.y>n.point.y||"Bottom"===i.direction&&t.y<n.point.y?Math.max(n.corners.right,t.x)-t.x+20:t.x>=i.corners.left-i.margin.left&&t.x<=i.corners.right+i.margin.right?Math.max(n.corners.right,i.corners.right)-t.x+20:n.corners.right-t.x+20}s=wo(r=wo(t,l,0),n.point.y-t.y,90),a=n.point}else if("vertical"===e){switch(n.direction){case"Top":if(i.corners.bottom+i.margin.bottom<n.corners.top-n.margin.top&&(n.corners.top-i.corners.bottom>l||i.corners.left-i.margin.left<=n.point.x&&i.corners.right+i.margin.right>=n.point.x)){h=Math.min(Math.abs(n.corners.top-i.corners.bottom)/2,20);l=i.corners.bottom-t.y+h}else l="Left"===i.direction&&t.x>n.point.x||"Right"===i.direction&&t.x<n.point.x?Math.min(n.corners.top,t.y)-t.y-20:t.y>=i.corners.top-i.margin.top&&t.y<=i.corners.bottom+i.margin.bottom?Math.min(n.corners.top,i.corners.top)-t.y-20:n.corners.top-t.y-20;break;case"Bottom":if(i.corners.top-i.margin.top>n.corners.bottom+n.margin.bottom&&(i.corners.top-n.corners.bottom>l||i.corners.left-i.margin.left<=n.point.x&&i.corners.right+i.margin.right>=n.point.x)){var h=Math.min(Math.abs(i.corners.top-n.corners.bottom)/2,20);l=i.corners.top-t.y-h}else l="Left"===i.direction&&t.x>n.point.x||"Right"===i.direction&&t.x<n.point.x?Math.max(n.corners.bottom,t.y)-t.y+20:t.y>=i.corners.top-i.margin.top&&t.y<=i.corners.bottom+i.margin.bottom?Math.max(n.corners.bottom,i.corners.bottom)-t.y+20:n.corners.bottom-t.y+20}s=wo(r=wo(t,l,90),n.point.x-t.x,0),a=n.point}o.push(r),o.push(s),o.push(a)}function Wo(t,e,i,n){return t.corners.top-t.margin.top>e.corners.top+e.margin.top&&t.corners.top-t.margin.top<=e.corners.bottom+e.margin.bottom?("Right"===e.direction&&t.point.x<e.point.x?n+=t.corners.top-e.corners.top:"Left"===e.direction&&t.point.x>e.point.x&&(n+=t.corners.top-e.corners.top),n+=t.point.y-t.corners.top):void 0!==i&&"Left"!==i&&"Right"===e.direction&&t.point.x<e.point.x?n+=Math.abs(t.point.y-e.corners.bottom):void 0!==i&&"Right"!==i&&"Left"===e.direction&&e.point.x<t.point.x?n+=Math.abs(t.point.y-e.corners.bottom):n+=t.point.y-t.corners.top,n}function Uo(t,e,i,n){return t.corners.left-t.margin.left>e.corners.left-e.margin.left&&t.corners.left-t.margin.left<=e.corners.right+e.margin.right?("Bottom"===e.direction&&t.point.y<e.point.y?n+=t.corners.left-e.corners.left:"Top"===e.direction&&t.point.y>e.point.y&&(n+=t.corners.left-e.corners.left),n+=t.point.x-t.corners.left):void 0!==i&&"Top"!==i&&"Bottom"===e.direction&&t.point.y<e.point.y?n+=Math.abs(t.point.x-e.corners.right):void 0!==i&&"Bottom"!==i&&"Top"===e.direction&&e.point.y<t.point.y?n+=Math.abs(t.point.x-e.corners.right):n+=t.point.x-t.corners.left,n}function qo(t,e,i,n){return t.corners.right+t.margin.right<e.corners.right+e.margin.right&&t.corners.right+t.margin.right>=e.corners.left-e.margin.left?("Bottom"===e.direction&&t.point.y<e.point.y?i+=e.corners.right-t.corners.right:"Top"===e.direction&&t.point.y>e.point.y&&(i+=e.corners.right-t.corners.right),i+=t.corners.right-t.point.x):void 0!==n&&"Top"!==n&&"Bottom"===e.direction&&t.point.y<e.point.y?i+=Math.abs(t.point.x-e.corners.right):void 0!==n&&"Bottom"!==n&&"Top"===e.direction&&e.point.y<t.point.y?i+=Math.abs(t.point.x-e.corners.right):i+=t.corners.right-t.point.x,i}function Xo(t,e,i,n){return t.corners.bottom+t.margin.bottom<e.corners.bottom+e.margin.bottom&&t.corners.bottom+t.margin.bottom>=e.corners.top-e.margin.top?("Right"===e.direction&&t.point.x<e.point.x?i+=e.corners.bottom-t.corners.bottom:"Left"===e.direction&&t.point.x>e.point.x&&(i+=e.corners.bottom-t.corners.bottom),i+=t.corners.bottom-t.point.y):void 0!==n&&"Left"!==n&&"Right"===e.direction&&t.point.x<e.point.x?i+=Math.abs(t.point.y-e.corners.bottom):void 0!==n&&"Right"!==n&&"Left"===e.direction&&e.point.x<t.point.x?i+=Math.abs(t.point.y-e.corners.bottom):i+=t.corners.bottom-t.point.y,i}function Yo(t,e){var i=!1;switch(t){case"Left":switch(e){case"Right":case"Bottom":i=!0}break;case"Top":switch(e){case"Left":case"Right":case"Bottom":i=!0}break;case"Bottom":switch(e){case"Right":i=!0}}return i}function Go(t,e){var i=t.direction;t.direction=e.direction,e.direction=i;var n=t.point;t.point=e.point,e.point=n;var o=t.corners;t.corners=e.corners,e.corners=o}function Zo(t,e,i,n){var o=void 0===e?i:e,r=o.topLeft,s=o.topRight,a=o.bottomRight,l=o.bottomLeft,h=o.center,c=vo(h,t),d=vo(h,a),p=vo(h,l),u=vo(h,r),g=vo(h,s);return c>u&&c<g?"Top":c>=d&&c<p?"Bottom":c>=p&&c<=u?"Left":"Right"}function Ko(t){var e;return e=t.wrapper.children[0].bounds,"None"!==t.sourceDecorator.shape&&e.uniteRect(t.wrapper.children[1].bounds),"None"!==t.targetDecorator.shape&&e.uniteRect(t.wrapper.children[2].bounds),e}function Qo(t){switch(t){case"Top":return"Bottom";case"Bottom":return"Top";case"Left":return"Right";case"Right":return"Left"}return"auto"}function Jo(t,e,i){var n=t.center,o=i?45:180/(2+2/(t.height/t.width)),r=o,s=180-o,a=s+2*o,l=360-o,h=vo(e,n);return h>r&&h<s?"top":h>s&&h<a?"right":h>a&&h<l?"bottom":"left"}function $o(t){return!t.distance&&!t.angle}function tr(t,e,i){var n=60,o={x:0,y:0};switch(i||(i=Math.abs(e.x-t.x)>Math.abs(e.y-t.y)?t.x<e.x?"right":"left":t.y<e.y?"bottom":"top"),i){case"bottom":case"top":n=Math.min(.45*Math.abs(t.y-e.y),n),o={x:t.x,y:t.y+("bottom"===i?n:-n)};break;case"right":case"left":n=Math.min(.45*Math.abs(t.x-e.x),n),o={x:t.x+("right"===i?n:-n),y:t.y}}return o}function er(t,e,i,n,o){var r=0,s=0,a=0,l=0,h=Number((o.distance(e,t)+o.distance(i,e)+o.distance(n,i))/3);if(0!==h)for(var c=0;c<=h;c++){var d=c/h,p=(1-d)*(1-d)*(1-d)*t.x+3*d*(1-d)*(1-d)*e.x+3*d*d*(1-d)*i.x+d*d*d*n.x,u=(1-d)*(1-d)*(1-d)*t.y+3*d*(1-d)*(1-d)*e.y+3*d*d*(1-d)*i.y+d*d*d*n.y;0===c?(r=a=p,s=l=u):(r=Math.min(p,r),s=Math.min(u,s),a=Math.max(p,a),l=Math.max(u,l))}return{x:r,y:s,width:a-r,height:l-s,left:r,top:s,right:r+(a-r),bottom:s+(l-s),center:{x:(r+(a-r))/2,y:(s+(l-s))/2}}}function ir(t,e,i,n,o,r,s){var a={x:0,y:0},l=r/s,h=(1-l)*(1-l)*(1-l)*e.x+3*l*(1-l)*(1-l)*i.x+3*l*l*(1-l)*n.x+l*l*l*o.x;a.x=h;var c=(1-l)*(1-l)*(1-l)*e.y+3*l*(1-l)*(1-l)*i.y+3*l*l*(1-l)*n.y+l*l*l*o.y;return a.y=c,a}function nr(t){if(t){return t instanceof Vd?t.constraints&gh.Select:t.constraints&fh.Select}return 1}function or(t){if(t){return t instanceof Vd?t.constraints&gh.Drag:t instanceof Ud?1:t.constraints&fh.Drag}return 1}function rr(t,e){return t instanceof Vd?t.constraints&gh.PointerEvents:t.constraints&fh.PointerEvents}function sr(t){return t instanceof Vd?t.constraints&gh.Delete:t.constraints&fh.Delete}function ar(t,e){return t.constraints&gh.Bridging?t.constraints&gh.Bridging:t.constraints&gh.InheritBridging?e.constraints&yh.Bridging:0}function lr(t){return t.constraints&gh.DragSourceEnd}function hr(t){return t.constraints&gh.DragTargetEnd}function cr(t){return t.constraints&gh.DragSegmentThumb}function dr(t){return t.constraints&fh.Rotate}function pr(t){return t.constraints&fh.Shadow}function ur(t){return t instanceof gp&&t.constraints&fh.InConnect?t.constraints&fh.InConnect:0}function gr(t){return t instanceof gp&&t.constraints&fh.OutConnect?t.constraints&fh.OutConnect:0}function mr(t,e){var i=0;return t&&("SouthEast"===e?i=t.constraints&fh.ResizeSouthEast:"East"===e?i=t.constraints&fh.ResizeEast:"NorthEast"===e?i=t.constraints&fh.ResizeNorthEast:"South"===e?i=t.constraints&fh.ResizeSouth:"North"===e?i=t.constraints&fh.ResizeNorth:"SouthWest"===e?i=t.constraints&fh.ResizeSouthWest:"West"===e?i=t.constraints&fh.ResizeWest:"NorthWest"===e&&(i=t.constraints&fh.ResizeNorthWest)),i}function fr(t){return t instanceof Vd?t.constraints&gh.AllowDrop:t.constraints&fh.AllowDrop}function vr(t,e){var i=0;return t instanceof Vd?t.constraints&gh.Tooltip?i=t.constraints&gh.Tooltip:t.constraints&gh.InheritTooltip&&(i=e.constraints&yh.Tooltip):t.constraints&fh.Tooltip?i=t.constraints&fh.Tooltip:t.constraints&fh.InheritTooltip&&(i=e.constraints&yh.Tooltip),i}function yr(t){return t.tool&bh.SingleSelect}function br(t){return t.tool&bh.MultipleSelect}function wr(t){return t.tool&bh.ZoomPan}function xr(t){return t.tool&bh.ContinuousDraw}function Sr(t){return t.tool&bh.DrawOnce}function Cr(t){return t.tool&bh.SingleSelect||t.tool&bh.MultipleSelect}function Lr(t){return t.constraints&yh.Zoom}function Er(t){return t.constraints&yh.Pan}function Pr(t){return t.constraints&yh.UserInteraction}function kr(t){return t.constraints&yh.ApiUpdate}function Tr(t){return t.constraints&yh.PanX}function Or(t){return t.constraints&yh.PanY}function Ir(t){return kr(t)||t.diagramActions&Lh.ToolAction}function Ar(t,e){var i=0;return i=e instanceof Vd?gh.ReadOnly:fh.ReadOnly,"Text"===e.shape.type?e.constraints&fh.ReadOnly:e.constraints&i?t.constraints&mh.InheritReadOnly?1:0:t.constraints&mh.ReadOnly?1:0}function Mr(t,e){return t.constraints&kh.Draw}function Rr(t,e){return t.constraints&kh.Drag}function Dr(t){var e=zr(t),i=Ye("div",{id:t.element.id+"_overlapRuler",style:"height:"+e.height+"px;width:"+e.width+"px;position:absolute;left:0;top:0",class:"e-ruler-overlap"});t.element.insertBefore(i,t.element.firstChild)}function Br(t,e){var i=document.getElementById(t.element.id+(e?"_hRuler":"_vRuler")),n=zr(t),o=jr(t),r=e?"margin-left:"+n.width+"px;":"margin-top:"+n.height+"px;";if(!i){var s="height:"+(e?n.height:o.height+100)+"px;overflow:hidden;width:"+(e?o.width+100:n.width)+"px;position:absolute;font-size:11px;"+r;i=Ye("div",{id:t.element.id+(e?"_hRuler":"_vRuler"),style:s})}t.element.insertBefore(i,t.element.firstChild);var a=e?t.rulerSettings.horizontalRuler:t.rulerSettings.verticalRuler,l=new vp(a);l.orientation=e?"Horizontal":"Vertical",l.length=(e?o.width:o.height)+a.segmentWidth,l.appendTo("#"+t.element.id+(e?"_hRuler":"_vRuler")),e?t.hRuler=l:t.vRuler=l;var h=document.getElementById(t.element.id+(e?"_hRuler":"_vRuler"));e?t.hRuler.element=h:t.vRuler.element=h}function Nr(t){var e=-t.scroller.horizontalOffset,i=-t.scroller.verticalOffset;t&&t.rulerSettings.showRulers?(t.hRuler.length=0,t.vRuler.length=0,void 0!==e&&t.hRuler.element&&_r(t,t.hRuler,e,!0),void 0!==i&&t.vRuler.element&&_r(t,t.vRuler,i,!1)):Hr(t)}function Hr(t){$e(t.element.id+"_hRuler"),$e(t.element.id+"_vRuler"),$e(t.element.id+"_overlapRuler")}function zr(t){var e=0,i=0;return t.rulerSettings.showRulers&&(e=t.rulerSettings.horizontalRuler.thickness,i=t.rulerSettings.verticalRuler.thickness),new nh(i,e)}function jr(t){var e=zr(t),i=t.scroller.viewPortHeight,n=t.scroller.viewPortWidth;return n<t.element.clientWidth-e.width&&(n=t.element.clientWidth-e.width),i<t.element.clientHeight-e.height&&(i=t.element.clientHeight-e.height),t.hRuler&&t.hRuler.length&&(n=t.hRuler.length),t.vRuler&&t.vRuler.length&&(i=t.vRuler.length),new nh(n,i)}function Vr(){var t,e,i=document.getElementsByClassName("e-d-ruler-marker");if(i&&i.length>0)for(e=i.length-1;e>=0;e--)(t=i[e])&&t.parentNode.removeChild(t)}function Fr(t,e){t.rulerSettings.showRulers&&(t.hRuler.drawRulerMarker(t.hRuler.element,e,t.scroller.horizontalOffset),t.vRuler.drawRulerMarker(t.vRuler.element,e,t.scroller.verticalOffset))}function _r(t,e,i,n){var o=zr(t),r=jr(t),s=n?t.rulerSettings.horizontalRuler:t.rulerSettings.verticalRuler;Ur(t,r,n),Wr(t,r,n),e.offset=i,e.scale=t.scroller.currentZoom,e.length=r.width+100,e.arrangeTick=fe(s.arrangeTick),e.dataBind();var a=n?t.hRuler.element:t.vRuler.element;n?a.style.marginLeft=o.width-e.hRulerOffset+"px":a.style.marginTop=o.height-e.vRulerOffset+"px"}function Wr(t,e,i){var n=document.getElementById(t.element.id+(i?"_hRuler_ruler_space":"_vRuler_ruler_space")),o=i?t.hRuler:t.vRuler;n&&t&&e&&(n.style.width=(i?e.width+2*o.segmentWidth:o.thickness)+"px",n.style.height=(i?o.thickness:e.height+2*o.segmentWidth)+"px")}function Ur(t,e,i){var n=document.getElementById(t.element.id+(i?"_hRuler":"_vRuler")),o=i?t.hRuler:t.vRuler;n&&t&&e&&(n.style.width=(i?e.width+o.segmentWidth:o.thickness)+"px",n.style.height=(i?o.thickness:e.height+o.segmentWidth)+"px",(n=document.getElementById(t.element.id+"_overlapRuler"))&&(i?n.style.height=o.thickness+"px":n.style.width=o.thickness+"px"))}function qr(t,e){for(var i=[],n=0;n<e.length;n++){var o=e[n];t.containsRect(o.wrapper.bounds)&&i.push(o)}return i}function Xr(t){var e;return t&&(t.type?e="Connector":t.shape&&!t.type&&(e="Node")),e}function Yr(t,e,i){var n;n=sh.findLength(e,t)>sh.findLength(i,t)?i:e;var o=sh.findAngle(e,i),r=sh.findAngle(n,t),s=sh.findLength(n,t),a=r+2*(o-r);return{x:n.x+s*Math.cos(a*Math.PI/180),y:n.y+s*Math.sin(a*Math.PI/180)}}function Gr(t){var e=[];if("Bezier"===t.type)for(var i=0,n=0;n<t.segments.length;n++)for(var o=t.segments[n],r=sh.isEmptyPoint(o.point1)?o.bezierPoint1:o.point1,s=sh.isEmptyPoint(o.point2)?o.bezierPoint2:o.point2,a=Number((t.distance(r,o.points[0])+t.distance(s,r)+t.distance(o.points[1],s))/1.5),l=0;l<a-1;l+=10)e[i]=ir(t,o.points[0],sh.isEmptyPoint(o.point1)?o.bezierPoint1:o.point1,sh.isEmptyPoint(o.point2)?o.bezierPoint2:o.point2,o.points[1],l,a),i++;return e}function Zr(t,e){var i;i="Bezier"===t.type?Gr(t):t.intermediatePoints;for(var n=0;n<i.length-1;n++){var o=i[n],r=i[n+1],s=ah.toBounds([o,r]);if(s.Inflate(t.hitPadding),s.containsPoint(e)){var a=Yr(e,o,r),l=Kr({X1:o.x,X2:r.x,Y1:o.y,Y2:r.y},{X1:e.x,X2:a.x,Y1:e.y,Y2:a.y});if(l.enabled){var h=sh.findLength(e,l.intersectPt);if(Math.abs(h)<t.hitPadding)return!0}else{var c=ah.toBounds([e,e]);if(c.Inflate(3),c.containsPoint(o)||c.containsPoint(r))return!0}if(sh.equals(e,a))return!0}}return!1}function Kr(t,e){var i={x:0,y:0},n=t,o=e,r=(o.Y2-o.Y1)*(n.X2-n.X1)-(o.X2-o.X1)*(n.Y2-n.Y1),s=(o.X2-o.X1)*(n.Y1-o.Y1)-(o.Y2-o.Y1)*(n.X1-o.X1),a=(n.X2-n.X1)*(n.Y1-o.Y1)-(n.Y2-n.Y1)*(n.X1-o.X1);if(0===r)return{enabled:!1,intersectPt:i};var l=s/r,h=a/r;return l>=0&&l<=1&&h>=0&&h<=1?(i.x=n.X1+l*(n.X2-n.X1),i.y=n.Y1+l*(n.Y2-n.Y1),{enabled:!0,intersectPt:i}):{enabled:!1,intersectPt:i}}function Qr(t,e){var i=[],n=e.topLeft,o=e.topRight,r=e.bottomRight,s=e.bottomLeft;if(0!==t.rotateAngle||0!==t.parentTransform){var a=_t();qt(a,t.rotateAngle+t.parentTransform,t.offsetX,t.offsetY),n=Wt(a,n),o=Wt(a,o),r=Wt(a,r),s=Wt(a,s)}return i.push(n),i.push(o),i.push(r),i.push(s),i}function Jr(t,e,i){var n,o=i instanceof gp?i.constraints&fh.InheritTooltip:i.constraints&gh.InheritTooltip,r=i instanceof gp?i.constraints&fh.Tooltip:i.constraints&gh.Tooltip;n=$r(i,e,t,"Mouse"===(!o&&r?i.tooltip.relativeMode:t.tooltip.relativeMode));var s=zr(t);return{x:n.x+s.width,y:n.y+s.height}}function $r(t,e,i,n){var o={},r=(i.scroller.transform.scale,document.getElementById(i.element.id)),s=t.wrapper.outerBounds,a=r.getBoundingClientRect();i.scroller.horizontalOffset,i.scroller.verticalOffset;switch(i.tooltipObject.position){case"BottomCenter":o=ts(e,s.bottomCenter,i,n,a.width/2,a.height);break;case"BottomLeft":case"LeftBottom":o=ts(e,s.bottomLeft,i,n,0,a.height);break;case"BottomRight":case"RightBottom":o=ts(e,s.bottomRight,i,n,a.width,a.height);break;case"LeftCenter":o=ts(e,s.middleLeft,i,n,0,a.height/2);break;case"LeftTop":case"TopLeft":o=ts(e,s.topLeft,i,n,0,0);break;case"RightCenter":o=ts(e,s.middleRight,i,n,a.width,a.height/2);break;case"RightTop":case"TopRight":o=ts(e,s.topRight,i,n,a.width,0);break;case"TopCenter":o=ts(e,s.topCenter,i,n,a.width/2,0)}return o}function ts(t,e,i,n,o,r){var s={},a=i.scroller.transform.scale,l=i.scroller.horizontalOffset,h=i.scroller.verticalOffset;return s.x=(n?t.x:e.x)*a+l-o,s.y=(n?t.y:e.y)*a+h-r,s}function es(t){var e,i=0,n=0;for(i=0;i<t.length;i++){var o=ee(t[i].wrapper);for(n=i;n<t.length;n++){var r=ee(t[n].wrapper);o.center.x>r.center.x&&(e=t[i],t[i]=t[n],t[n]=e)}}return t}function is(t,e,i){var n,o,r;o=ns(t,e,i),n=sh.findAngle(t[o.index],t[o.index+1]);var s=os(e);return r=sh.transform(o.point,n+45,s),o.point=r,o.angle=n,o}function ns(t,e,i){for(var n,o,r,s,a,l=0,h=e.offset,c=[],d=0;d<t.length-1;d++)l+=sh.distancePoints(t[d],t[d+1]),c.push(l);r=h*l;for(var p=0;p<c.length;p++){if(c[p]>=r)return o=sh.findAngle(t[p],t[p+1]),n=sh.transform(t[p],o,r-(s||0)),a=p,{point:n,index:a};s=c[p]}return{point:n,index:a}}function os(t){var e=void 0===t.content?10:0,i=0;switch(t.alignment){case"Center":i=0;break;case"Before":i=-(0+e);break;case"After":i=0+e}return i}function rs(t,e,i){e%=360;var n,o;switch(t.alignment){case"Before":e>=45&&e<=135?(o="right",n=.5===t.offset?"center":"top"):e>=225&&e<=315?(o="left",n=.5===t.offset?"center":"bottom"):e>45&&e<225?(n="top",o=.5===t.offset?"center":"right"):(n="bottom",o=.5===t.offset?"center":"left");break;case"After":e>=45&&e<=135?(o="left",n=.5===t.offset?"center":"top"):e>=225&&e<=315?(o="right",n=.5===t.offset?"center":"bottom"):e>45&&e<225?(n="bottom",o=.5===t.offset?"center":"right"):(n="top",o=.5===t.offset?"center":"left");break;case"Center":o="center",n="center"}if(0===t.offset||1===t.offset){switch(ss(i[0],i[1])){case"left":o=0===t.offset?"right":"left";break;case"right":o=0===t.offset?"left":"right";break;case"bottom":n=0===t.offset?"top":"bottom";break;case"top":n=0===t.offset?"bottom":"top"}}return{hAlign:o,vAlign:n}}function ss(t,e){return Math.abs(e.x-t.x)>Math.abs(e.y-t.y)?t.x<e.x?"right":"left":t.y<e.y?"bottom":"top"}function as(t){var e=ie(t,t.getCustomProperty);return JSON.stringify(e)}function ls(t,e){e.clear(),e.protectPropertyChange(!0);for(var i=e.dataSourceSettings.doBinding,n=e.setNodeTemplate,o=e.getDescription,r=e.getCustomProperty,s={},a=0,l=e.commandManager.commands;a<l.length;a++){var h=l[a];s[h.name]={execute:h.execute,canExecute:h.canExecute}}var c=e.rulerSettings.horizontalRuler.arrangeTick,d=e.rulerSettings.verticalRuler.arrangeTick,p=e.layout.getLayoutInfo,u=e.layout.getBranch,g=e.getNodeDefaults,m=e.getConnectorDefaults,f=JSON.parse(t);e.contextMenuSettings=f.contextMenuSettings,e.constraints=f.constraints,e.tool=f.tool,e.bridgeDirection=f.bridgeDirection,e.pageSettings=f.pageSettings,e.drawingObject=f.drawingObject,e.tooltip=f.tooltip,e.addInfo=f.addInfo,e.getDescription=o,e.scrollSettings=f.scrollSettings,e.commandManager=f.commandManager,e.layers=f.layers,e.rulerSettings.horizontalRuler.arrangeTick=c,e.rulerSettings.verticalRuler.arrangeTick=d;for(var v=0,y=e.commandManager.commands;v<y.length;v++){var b=y[v];s[b.name]&&(b.execute=s[b.name].execute,b.canExecute=s[b.name].canExecute)}e.backgroundColor=f.backgroundColor,e.basicElements=f.basicElements,e.connectors=f.connectors,e.dataSourceSettings=f.dataSourceSettings,e.dataSourceSettings.doBinding=i,e.height=f.height,e.setNodeTemplate=n,e.getConnectorDefaults=m,e.getNodeDefaults=g,e.getCustomProperty=r,e.mode=f.mode,e.nodes=f.nodes,e.rulerSettings=f.rulerSettings,e.snapSettings=f.snapSettings,e.width=f.width,e.layout=f.layout,e.layout.getLayoutInfo=fe(p),e.layout.getBranch=fe(u),e.diagramActions=0,e.isLoading=!0,e.protectPropertyChange(!1);for(var w,x=0;x<e.views.length;x++)(w=e.views[e.views[x]]).refresh(),w instanceof wu&&e.element.classList.add("e-diagram");var S=hs(f.selectedItems.nodes,e.nodes),C=hs(f.selectedItems.connectors,e.connectors),L=[];return L=L.concat(S).concat(C),e.select(L),f}function hs(t,e){for(var i=[],n=0;n<t.length;n++)for(var o=0,r=e;o<r.length;o++){var s=r[o];s.id===t[n].id&&i.push(s)}return i}function cs(t,e){for(var i=e.style,n=e,o=0,r=Object.keys(t);o<r.length;o++)switch(r[o]){case"fill":i.fill=t.fill,i instanceof $h&&(i.fill="transparent");break;case"textOverflow":i.textOverflow=t.textOverflow;break;case"opacity":i.opacity=t.opacity;break;case"strokeColor":i.strokeColor=t.strokeColor;break;case"strokeDashArray":i.strokeDashArray=t.strokeDashArray;break;case"strokeWidth":i.strokeWidth=t.strokeWidth;break;case"bold":i.bold=t.bold;break;case"color":i.color=t.color;break;case"textWrapping":i.textWrapping=t.textWrapping;break;case"fontFamily":i.fontFamily=t.fontFamily;break;case"fontSize":i.fontSize=t.fontSize;break;case"italic":i.italic=t.italic;break;case"textAlign":i.textAlign=t.textAlign;break;case"whiteSpace":i.whiteSpace=t.whiteSpace;break;case"textDecoration":i.textDecoration=t.textDecoration;break;case"gradient":i.gradient=t.gradient}e instanceof Fh&&n.refreshTextElement()}function ds(t,e,i){for(var n=e,o=n.hyperlink,r=0,s=Object.keys(t);r<s.length;r++)switch(s[r]){case"color":n.style.color=o.color=t.color;break;case"content":n.content=o.content=t.content||o.link;break;case"link":var a=i.style;n.style.color=t.link?o.color:a.color,n.style.textDecoration=t.link?o.textDecoration:i.style.textDecoration,n.content=t.link?o.content||t.link:i.content,o.link=t.link;break;case"textDecoration":n.style.textDecoration=o.textDecoration=t.textDecoration}}function ps(t,e,i){t.width=e.width,t.height=e.height,t.minHeight=e.minHeight,t.maxHeight=e.maxHeight,t.minWidth=e.minWidth,t.maxWidth=e.maxWidth,t.horizontalAlignment=e.wrapper.children[0].horizontalAlignment,t.verticalAlignment=e.wrapper.children[0].verticalAlignment,t.relativeMode=e.wrapper.children[0].relativeMode,t.visible=e.wrapper.children[0].visible,e.shape instanceof Text&&(t.margin=e.shape.margin),t.id=e.wrapper.children[0].id,t.style=e.style;for(var n=0,o=i.views;n<o.length;n++){var r=o[n];$e(e.id+"_groupElement",r),$e(e.id+"_content_groupElement",r),$e(e.id+"_content_html_element",r)}e.wrapper.children.splice(0,1),e.wrapper.children.splice(0,0,t)}function us(t,e,i,n){var o=new Bh;switch(t.shape.type){case"Path":var r=new Hh;r.data=e.shape.data,ps(o=r,e,n);break;case"Image":var s=new jh;s.source=e.shape.source,s.imageAlign=e.shape.align,s.imageScale=e.shape.scale,ps(o=s,e,n);break;case"Text":ps(o=new Fh,e,n);break;case"Basic":var a=void 0;a="Rectangle"===e.shape.shape?new Bh:new Hh,"Polygon"===e.shape.shape?a.data=Dt(e.shape.points):a.data=oi(e.shape.shape),ps(o,e,n),"Rectangle"===e.shape.shape&&(a.cornerRadius=e.shape.cornerRadius),o=a;break;case"Flow":var l=new Hh;l.data=li(e.shape.shape),ps(o=l,e,n);break;case"Native":var h=new oc;h.content=e.shape.content,h.scale=e.shape.scale,ps(o=h,e,n);break;case"HTML":var c=new Xd;c.content=e.shape.content,ps(o=c,e,n)}void 0===t.shape.type||t.shape.type===i.shape.type?gs(t,e):(o.width=e.wrapper.children[0].width,o.height=e.wrapper.children[0].height,e.shape instanceof Text&&(o.margin=e.shape.margin),o.style=e.style,e.wrapper.children[0]=o)}function gs(t,e){if(Object.keys(t.shape).length>0)if("Path"===e.shape.type&&void 0!==t.shape.data)e.wrapper.children[0].data=t.shape.data;else if("Text"===e.shape.type&&void 0!==t.shape.content)e.wrapper.children[0].content=t.shape.content;else if("Image"===e.shape.type&&void 0!==t.shape.source)e.wrapper.children[0].source=t.shape.source;else if("Native"===e.shape.type){var i=document.getElementById(e.wrapper.children[0].id+"_groupElement");void 0!==t.shape.content&&i&&(i.removeChild(i.children[0]),e.wrapper.children[0].content=t.shape.content,i.appendChild(ti(e.wrapper.children[0],!1))),e.wrapper.children[0].scale=t.shape.scale?t.shape.scale:e.wrapper.children[0].scale}else if("HTML"===e.shape.type){var n=document.getElementById(e.wrapper.children[0].id+"_html_element");n&&(n.removeChild(n.children[0]),e.wrapper.children[0].content=t.shape.content,n.appendChild(ti(e.wrapper.children[0],!0)))}else if("Flow"===e.shape.type&&void 0!==t.shape.shape){e.shape.shape=t.shape.shape;var o=li((r=e.shape.shape).toString());e.wrapper.children[0].data=o}else if(void 0!==t.shape.cornerRadius)e.wrapper.children[0].cornerRadius=t.shape.cornerRadius;else if(void 0!==t.shape.shape){e.shape.shape=t.shape.shape;var r=e.shape.shape,s=oi(r.toString());e.wrapper.children[0].data=s}}function ms(t,e){var i=t.indexOf(e);i>=0&&t.splice(i,1)}function fs(t,e){var i,n,o;if(t.intermediatePoints=e,t.updateSegmentElement(t,e,t.wrapper.children[0]),t.sourcePoint,n=t.sourceDecorator,"Bezier"===t.type){var r=t.segments[0],s=t.segments[t.segments.length-1];i=[sh.isEmptyPoint(s.point2)?s.bezierPoint2:s.point2,sh.isEmptyPoint(r.point1)?r.bezierPoint1:r.point1]}else i=t.intermediatePoints;e=t.clipDecorators(t,e);var a=t.wrapper.children[1];t.updateDecoratorElement(a,e[0],i[1],n),t.targetPoint,o=t.targetDecorator,a=t.wrapper.children[2],t.updateDecoratorElement(a,e[e.length-1],i[i.length-2],o),t.updateShapeElement(t)}function vs(t,e,i){var n,o=t.wrapper,r=o.bounds,s=e.offset,a=e.size/i.scale,l=e.margin,h=o.offsetX-o.actualSize.width*o.pivot.x,c=o.offsetY-o.actualSize.height*o.pivot.y;if(n={x:0,y:0},t.nodes.length>0){switch(e.side){case"Top":n.x+=h+r.width*s,n.y+=c-a;break;case"Bottom":n.x+=h+s*r.width,n.y+=c+o.actualSize.height+a;break;case"Left":n.x+=h-a,n.y+=c+s*r.height;break;case"Right":n.x+=h+o.actualSize.width+a,n.y+=c+s*r.height}n.x+=l.left-l.right+a/2*("Center"===e.horizontalAlignment?0:"Right"===e.horizontalAlignment?-1:1),n.y+=l.top-l.bottom+a/2*("Center"===e.verticalAlignment?0:"Top"===e.verticalAlignment?-1:1)}else if(t.connectors.length>0){var d=t.connectors[0],p={offset:s},u=ns(d.intermediatePoints,p,r),g=u.index;n=u.point;var m=is(d.intermediatePoints,p,r),f=(d.intermediatePoints,m.angle);qt(v=_t(),-f,d.intermediatePoints[g].x,d.intermediatePoints[g].y),(n=Wt(v,n)).x+=l.left-l.right+a/2*("Center"===e.horizontalAlignment?0:"Right"===e.horizontalAlignment?-1:1),n.y+=l.top-l.bottom+a/2*("Center"===e.verticalAlignment?0:"Top"===e.verticalAlignment?-1:1),qt(v=_t(),f,d.intermediatePoints[g].x,d.intermediatePoints[g].y),n=Wt(v,n)}if(0!==o.rotateAngle||0!==o.parentTransform){var v=_t();qt(v,o.rotateAngle+o.parentTransform,o.offsetX,o.offsetY),n=Wt(v,n)}return n}function ys(t,e,i){return!!(uh[e]&t&&vh[e]&i)}function bs(t,e){return!!(uh[e]&t)}function ws(t,e){return t.visibility&e}function xs(t,e){var i;if("Text"===t.shape.type)i=t.shape;else{var n=e.split("_");e=n[n.length-1];for(var o=0;o<t.annotations.length;o++)e===t.annotations[o].id&&(i=t.annotations[o])}return i}function Ss(t,e){for(var i=0;i<t.ports.length;i++)if(t.ports[i].id===e)return i.toString();return null}function Cs(t,e){var i;for(i=0;i<t.length;i++)if(e===t[i].id)return!0;return!1}function Ls(t,e,i,n){if(void 0!==t.width&&void 0!==t.height&&(t.width*=e,t.height*=i),t instanceof ic){var o=_t(),r=n.width||n.actualSize.width,s=n.height||n.actualSize.height;if(void 0!==r&&void 0!==s){var a=n.offsetX-r*n.pivot.x,l=n.offsetY-s*n.pivot.y,h={x:a+r*n.pivot.x,y:l+s*n.pivot.y};h=ge(n.rotateAngle,n.offsetX,n.offsetY,h),qt(o,-n.rotateAngle,h.x,h.y),Xt(o,e,i,h.x,h.y),qt(o,n.rotateAngle,h.x,h.y);for(var c=0,d=t.children;c<d.length;c++){var p=d[c];if(void 0!==p.width&&void 0!==p.height){var u=Wt(o,{x:p.offsetX,y:p.offsetY});p.offsetX=u.x,p.offsetY=u.y,Ls(p,e,i,n)}}}}}function Es(t,e,i){if(0===i.length)i.push(t);else if(1===i.length)i[0][e]>t[e]?i.splice(0,0,t):i.push(t);else if(i.length>1){for(var n=0,o=i.length-1,r=Math.floor((n+o)/2);r!==n;)i[r][e]<t[e]?(n=r,r=Math.floor((n+o)/2)):i[r][e]>t[e]&&(o=r,r=Math.floor((n+o)/2));i[o][e]<t[e]?i.push(t):i[n][e]>t[e]?i.splice(n,0,t):i[n][e]<t[e]&&i[o][e]>t[e]&&i.splice(o,0,t)}}function Ps(t,e,i,n,o,r,s){n.selectedItems.connectors[0];if(r&&r.length>1&&o&&o.length>1)return"PinchZoom";if(n.currentSymbol)return"Drag";if("PortDraw"===n.eventHandler.action&&(n.tool&=~bh.DrawOnce),(Sr(n)||xr(n))&&n.drawingObject)return"Draw";if(As(n)&&(u=n.selectedItems).wrapper&&bs(u.constraints,"UserHandle"))for(var a=0,l=u.userHandles;a<l.length;a++){var h=l[a];if(h.visible&&Is(i,p=vs(u,h,n.scroller.transform),h.size/2))return h.name}if(wr(n)&&!t)return"Pan";if(As(n)){var c=n.selectedItems.wrapper,d=c.bounds,p=new ah(d.x,d.y,d.width,d.height),u=n.selectedItems;if(Ms(n)){var g=n.selectedItems.connectors[0],m=10/n.scrollSettings.currentZoom,f=10/n.scrollSettings.currentZoom;if(bs(u.constraints,"ResizeAll")){if(bs(u.constraints,"ConnectorSourceThumb")&&lr(g)&&Is(i,g.sourcePoint,m))return"ConnectorSourceEnd";if(bs(u.constraints,"ConnectorTargetThumb")&&hr(g)&&Is(i,g.targetPoint,f))return"ConnectorTargetEnd";if(S=ks(g,u,i,n))return S}}else{var v=10/n.scroller.currentZoom,y=_t();qt(y,c.rotateAngle+c.parentTransform,c.offsetX,c.offsetY);var b=c.offsetX-c.pivot.x*c.actualSize.width,w=c.offsetY-c.pivot.y*c.actualSize.height,x={x:b+c.actualSize.width/2,y:w-30/n.scroller.currentZoom};if(x=Wt(y,x),bs(u.constraints,"Rotate")&&Is(i,x,v)&&n.selectedItems.thumbsConstraints&vh.Rotate)return"Rotate";if(p.Inflate(v),p.containsPoint(i)&&(S=Os(n,c,i,y,b,w)))return S}}if(s instanceof dc&&!wr(n)){var S=Ts(n,s);if("None"!==S)return S}if(null!==t){if(!(t instanceof gp||t instanceof Vd))return"Select";if(e&&e.id){var C=e.id.split(t.id)[1];if(C&&C.match("^_icon"))return"LayoutAnimation"}if(or(t)&&e instanceof Fh&&e.hyperlink.link)return"Hyperlink";if(!or(t)||!Rs(n,t,!1))return t&&wr(n)&&!Cr(n)?"Pan":"Select";if(t instanceof Vd&&!Is(i,t.sourcePoint,t.hitPadding)&&!Is(i,t.targetPoint,t.hitPadding)||!(t instanceof Vd))return"Drag"}return"Select"}function ks(t,e,i,n){var o=10/n.scrollSettings.currentZoom,r=10/n.scrollSettings.currentZoom;if("Bezier"===t.type)for(s=0;s<t.segments.length;s++){a=t.segments[s];if(Is(i,sh.isEmptyPoint(a.point1)?a.bezierPoint1:a.point1,r))return"BezierSourceThumb";if(Is(i,sh.isEmptyPoint(a.point2)?a.bezierPoint2:a.point2,o))return"BezierTargetThumb"}if(n.connectorEditingToolModule&&cr(t))if("Straight"===t.type||"Bezier"===t.type)for(s=0;s<t.segments.length;s++){a=void 0;if(a=t.segments[s],Is(i,a.point,10))return"SegmentEnd"}else for(var s=0;s<t.segments.length;s++){var a=void 0,l={x:0,y:0};a=t.segments[s];for(var h=0;h<a.points.length-1;h++)if(sh.distancePoints(a.points[h],a.points[h+1])>=50&&(l.x=(a.points[h].x+a.points[h+1].x)/2,l.y=(a.points[h].y+a.points[h+1].y)/2,Is(i,l,30)))return"OrthoThumb"}return null}function Ts(t,e,i,n){if(Rr(e,t)&&(ws(e,lh.Hover)||ws(e,lh.Visible))){if(e.constraints&kh.Drag)return"PortDrag"}else if(Mr(e,t)&&(ws(e,lh.Hover)||ws(e,lh.Visible))&&e.constraints&kh.Draw){t.drawingObject={};var o={type:"Orthogonal",sourcePortID:e.id};return t.drawingObject=o,t.tool|=bh.DrawOnce,t.currentDrawingObject=o,"PortDraw"}return"None"}function Os(t,e,i,n,o,r){t.selectedItems.nodes[0];var s=40/t.scroller.currentZoom,a=10/t.scroller.currentZoom,l=t.selectedItems;if(e.actualSize.width>=s&&e.actualSize.height>=s){if(ys(l.constraints,"ResizeSouthEast",l.thumbsConstraints)&&Is(i,Wt(n,{x:o+e.actualSize.width,y:r+e.actualSize.height}),a))return"ResizeSouthEast";if(ys(l.constraints,"ResizeSouthWest",l.thumbsConstraints)&&Is(i,Wt(n,{x:o,y:r+e.actualSize.height}),a))return"ResizeSouthWest";if(ys(l.constraints,"ResizeNorthEast",l.thumbsConstraints)&&Is(i,Wt(n,{x:o+e.actualSize.width,y:r}),a))return"ResizeNorthEast";if(ys(l.constraints,"ResizeNorthWest",l.thumbsConstraints)&&Is(i,Wt(n,{x:o,y:r}),a))return"ResizeNorthWest"}return ys(l.constraints,"ResizeEast",l.thumbsConstraints)&&Is(i,Wt(n,{x:o+e.actualSize.width,y:r+e.actualSize.height/2}),a)?"ResizeEast":ys(l.constraints,"ResizeWest",l.thumbsConstraints)&&Is(i,Wt(n,{x:o,y:r+e.actualSize.height/2}),a)?"ResizeWest":ys(l.constraints,"ResizeSouth",l.thumbsConstraints)&&Is(i,Wt(n,{x:o+e.actualSize.width/2,y:r+e.actualSize.height}),a)?"ResizeSouth":ys(l.constraints,"ResizeNorth",l.thumbsConstraints)&&Is(i,Wt(n,{x:o+e.actualSize.width/2,y:r}),a)?"ResizeNorth":null}function Is(t,e,i){return t.x>=e.x-i&&t.x<=e.x+i&&t.y>=e.y-i&&t.y<=e.y+i}function As(t){return t.selectedItems.nodes.length>0||t.selectedItems.connectors.length>0}function Ms(t){return 1===t.selectedItems.connectors.length&&!t.selectedItems.nodes.length}function Rs(t,e,i){if(void 0===i&&(i=!0),e instanceof Ud)return!0;if(e instanceof gp)for(;e;){if(-1!==t.selectedItems.nodes.indexOf(e))return!0;if(i)break;e=t.nameTable[e.parentId]}else if(e instanceof Vd&&-1!==t.selectedItems.connectors.indexOf(e))return!0;return!1}function Ds(t,e){if(e+=360,e%=360,-1===t.indexOf("Resize"))return Vp[t];var i=Vp[t];return e>=0&&e<25||e>=160&&e<=205||e>=340&&e<=360?i:e>=25&&e<=70||e>=205&&e<=250?"n-resize"===i||"s-resize"===i?"ne-resize":"nw-resize"===i||"se-resize"===i?"n-resize":"e-resize"===i||"w-resize"===i?"nw-resize":"e-resize":e>=70&&e<=115||e>=250&&e<=295?"n-resize"===i||"s-resize"===i?"e-resize":"nw-resize"===i||"se-resize"===i?"ne-resize":"e-resize"===i||"w-resize"===i?"n-resize":"nw-resize":e>=115&&e<=155||e>=295&&e<=340?"n-resize"===i||"s-resize"===i?"nw-resize":"nw-resize"===i||"se-resize"===i?"e-resize":"e-resize"===i||"w-resize"===i?"ne-resize":Vp[t]:"n-resize"}function Bs(t,e){var i,o={};if(c(t))return t;if("string"==typeof t||"number"==typeof t)return t;if(c(t.isHeader))for(var r=0,s=Object.keys(e);r<s.length;r++){var a=s[r];if(!c(e[a])&&"string"==typeof e[a]){var l=e[a].split(".");c(t[l.length>1?l[0]:e[a]])||c(i=n(e[a],t))||(o[e[a]]=i)}}else!c(t.isHeader)&&t.isHeader&&(o=t);return o}function Ns(t,e){for(var i=h({},t),n=0,o=Object.keys(i);n<o.length;n++){var s=o[n];e.indexOf(s)<0&&r(i,s)}return i}function Hs(){if(R(this.element,{role:"textbox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-live":"assertive","aria-valuenow":""}),this.mask){for(var t=this.mask.split("]"),e=0;e<t.length;e++)if("\\"===t[e][t[e].length-1]){t[e]=t[e]+"]";for(var i=t[e].split("["),n=0;n<i.length;n++)"\\"===i[n][i[n].length-1]&&(i[n]=i[n]+"["),Xs.call(this,i[n])}else if((i=t[e].split("[")).length>1)for(var o=!1,n=0;n<i.length;n++)"\\"===i[n]?(this.customRegExpCollec.push("["),this.hiddenMask+=i[n]+"["):""===i[n]?o=!0:""!==i[n]&&o||n===i.length-1?(this.customRegExpCollec.push("["+i[n]+"]"),this.hiddenMask+=this.promptChar,o=!1):Xs.call(this,i[n]);else Xs.call(this,i[0]);if(this.escapeMaskValue=this.hiddenMask,this.promptMask=this.hiddenMask.replace(/[09?LCAa#&]/g,this.promptChar),!c(this.customCharacters))for(e=0;e<this.promptMask.length;e++)c(this.customCharacters[this.promptMask[e]])||(this.promptMask=this.promptMask.replace(new RegExp(this.promptMask[e],"g"),this.promptChar));var r=0;if(this.hiddenMask.match(new RegExp(/\\/)))for(e=0;e<this.hiddenMask.length;e++){n=0;e>=2&&(n=e),n-=r=this.hiddenMask.length-this.promptMask.length,e>0&&"\\"!==this.hiddenMask[e-1]&&(">"===this.hiddenMask[e]||"<"===this.hiddenMask[e]||"|"===this.hiddenMask[e])&&(this.promptMask=this.promptMask.substring(0,n)+this.promptMask.substring(e+1-r,this.promptMask.length),this.escapeMaskValue=this.escapeMaskValue.substring(0,n)+this.escapeMaskValue.substring(e+1-r,this.escapeMaskValue.length)),"\\"===this.hiddenMask[e]&&(this.promptMask=this.promptMask.substring(0,n)+this.hiddenMask[e+1]+this.promptMask.substring(e+2-r,this.promptMask.length),this.escapeMaskValue=this.escapeMaskValue.substring(0,n)+this.escapeMaskValue[e+1]+this.escapeMaskValue.substring(e+2-r,this.escapeMaskValue.length))}else this.promptMask=this.promptMask.replace(/[>|<]/g,""),this.escapeMaskValue=this.hiddenMask.replace(/[>|<]/g,"");R(this.element,{"aria-invalid":"false"})}}function zs(){ga.call(this,this.promptMask),ua.call(this,this.value)}function js(){Ma.add(this.element,"keydown",$s,this),Ma.add(this.element,"keypress",ia,this),Ma.add(this.element,"keyup",oa,this),Ma.add(this.element,"input",Js,this),Ma.add(this.element,"focus",Ys,this),Ma.add(this.element,"blur",Gs,this),Ma.add(this.element,"paste",Zs,this),Ma.add(this.element,"cut",Ks,this),Ma.add(this.element,"drop",Qs,this),this.enabled&&Fs.call(this)}function Vs(){Ma.remove(this.element,"keydown",$s),Ma.remove(this.element,"keypress",ia),Ma.remove(this.element,"keyup",oa),Ma.remove(this.element,"input",Js),Ma.remove(this.element,"focus",Ys),Ma.remove(this.element,"blur",Gs),Ma.remove(this.element,"paste",Zs),Ma.remove(this.element,"cut",Ks)}function Fs(){this.showClearButton&&Ma.add(this.inputObj.clearButton,"mousedown touchstart",_s,this)}function _s(t){t.preventDefault(),this.inputObj.clearButton.classList.contains("e-clear-icon-hide")||Ws.call(this,t)}function Ws(t){var e=this.element.value;ga.call(this,this.promptMask),this.redoCollec.unshift({value:this.promptMask,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),na.call(this,t,e),this.element.setSelectionRange(0,0)}function Us(t){return t.value}function qs(t,e){var i="",n=0,o=!1,r=c(e)?c(t)||c(this)?e:t.value:e;if(r!==this.promptMask)for(var s=0;s<this.customRegExpCollec.length;s++)o&&(o=!1),">"!==this.customRegExpCollec[n]&&"<"!==this.customRegExpCollec[n]&&"|"!==this.customRegExpCollec[n]&&"\\"!==this.customRegExpCollec[n]||(--s,o=!0),o||r[s]===this.promptChar||c(this.customRegExpCollec[n])||c(this.regExpCollec[this.customRegExpCollec[n]])&&!(this.customRegExpCollec[n].length>2&&"["===this.customRegExpCollec[n][0]&&"]"===this.customRegExpCollec[n][this.customRegExpCollec[n].length-1])&&(c(this.customCharacters)||c(this.customCharacters[this.customRegExpCollec[n]]))||""===r||(i+=r[s]),++n;return(null===this.mask||""===this.mask&&void 0!==this.value)&&(i=r),i}function Xs(t){for(var e=0;e<t.length;e++)this.hiddenMask+=t[e],"\\"!==t[e]&&this.customRegExpCollec.push(t[e])}function Ys(t){var e=this;this.promptMask.length>0?this.focusEventArgs={selectionStart:0,selectionEnd:this.promptMask.length}:this.focusEventArgs={selectionStart:0,selectionEnd:this.element.value.length};var i={};if(l(i,this.focusEventArgs),this.trigger("focus",i),this.focusEventArgs=i,this.mask)if(this.isFocus=!0,""===this.element.value?ga.call(this,this.promptMask):ga.call(this,this.element.value),za.isDevice||"11.0"!==za.info.version){var n=za.isDevice&&za.isIos?450:0;setTimeout(function(){e.element.setSelectionRange(e.focusEventArgs.selectionStart,e.focusEventArgs.selectionEnd)},n)}else this.element.setSelectionRange(this.focusEventArgs.selectionStart,this.focusEventArgs.selectionEnd)}function Gs(t){if(this.mask&&(this.isFocus=!1,this.placeholder&&this.element.value===this.promptMask&&"Always"!==this.floatLabelType)){ga.call(this,"");var e=this.element.parentNode.querySelector(".e-float-text");"Auto"===this.floatLabelType&&!c(e)&&e.classList.contains(xg)&&P([e],xg)}}function Zs(t){var e=this;if(this.mask){var i=this.element.selectionStart,n=this.element.selectionEnd,o=this.element.value;ga.call(this,""),this._callPasteHandler=!0,setTimeout(function(){var t=e.element.value.replace(/ /g,"");e.redoCollec.length>0&&e.redoCollec[0].value===e.element.value&&(t=qs.call(e,e.element)),ga.call(e,o),e.element.selectionStart=i,e.element.selectionEnd=n;var r=0;e.maskKeyPress=!0;do{aa.call(e,t[r],!1,null),++r}while(r<t.length);if(e.maskKeyPress=!1,e._callPasteHandler=!1,e.element.value===o){var s=0;e.maskKeyPress=!0;do{aa.call(e,t[s],!1,null),++s}while(s<t.length);e.maskKeyPress=!1}},1)}}function Ks(t){var e=this;if(this.mask){var i=this.element.selectionStart,n=this.element.selectionEnd;this.undoCollec.push({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd});var o=this.element.value.substring(0,i)+this.promptMask.substring(i,n)+this.element.value.substring(n);setTimeout(function(){ga.call(e,o),e.element.selectionStart=e.element.selectionEnd=i},0)}}function Qs(t){t.preventDefault()}function Js(t){if(h(t,{ctrlKey:!1,keyCode:229}),this.mask){if(""===this.element.value&&this.redoCollec.unshift({value:this.promptMask,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),1===this.element.value.length&&(this.element.value=this.element.value+this.promptMask,this.element.setSelectionRange(1,1)),this._callPasteHandler||ea.call(this,t),this.element.value.length>this.promptMask.length){var e=this.element.selectionStart,i=this.element.value.length-this.promptMask.length,n=this.element.value.substring(e-i,e);this.maskKeyPress=!1;var o=0;do{aa.call(this,n[o],t.ctrlKey,t),++o}while(o<n.length)}var r=qs.call(this,this.element);this.prevValue=r,this.value=r,""===r&&(ga.call(this,this.promptMask),this.element.setSelectionRange(0,0))}}function $s(t){if(this.mask){229!==t.keyCode&&(!t.ctrlKey||89!==t.keyCode&&90!==t.keyCode||t.preventDefault(),ea.call(this,t));var e=this.element.value;if(t.ctrlKey&&(89===t.keyCode||90===t.keyCode)){var i=void 0;90===t.keyCode&&this.undoCollec.length>0&&e!==this.undoCollec[this.undoCollec.length-1].value?(i=this.undoCollec[this.undoCollec.length-1],this.redoCollec.unshift({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),ga.call(this,i.value),this.element.selectionStart=i.startIndex,this.element.selectionEnd=i.endIndex,this.undoCollec.splice(this.undoCollec.length-1,1)):89===t.keyCode&&this.redoCollec.length>0&&e!==this.redoCollec[0].value&&(i=this.redoCollec[0],this.undoCollec.push({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),ga.call(this,i.value),this.element.selectionStart=i.startIndex,this.element.selectionEnd=i.endIndex,this.redoCollec.splice(0,1))}}}function ta(){var t,e=this.element.selectionStart,i=this.element.selectionEnd;this.redoCollec.length>0?(t=this.redoCollec[0],ga.call(this,t.value),t.startIndex-e==1?(this.element.selectionStart=t.startIndex,this.element.selectionEnd=t.endIndex):(this.element.selectionStart=e+1,this.element.selectionEnd=i+1)):(ga.call(this,this.promptMask),this.element.selectionStart=this.element.selectionEnd=e)}function ea(t){var e,i=!1,n=!1;this.element.value.length<this.promptMask.length&&(i=!0,ta.call(this),e=this.element.value);var o=this.element.selectionStart,r=this.element.selectionEnd,s=this.element.selectionStart,a=this.element.selectionEnd,l=this.hiddenMask.replace(/[>|\\<]/g,""),h=l[s-1];this.element.parentNode;if(i||8===t.keyCode||46===t.keyCode){this.undoCollec.push({value:this.element.value,startIndex:this.element.selectionStart,endIndex:a});var d=!1;if(s>0||(8===t.keyCode||46===t.keyCode)&&s<this.element.value.length&&this.element.selectionEnd-s!==this.element.value.length){var p=s;s!==a?(s=a,46===t.keyCode&&(d=!0)):46===t.keyCode?++p:--p;for(var u=s;8===t.keyCode||i||d?u>p:u<p;8===t.keyCode||i||d?u--:u++)for(var g=s;8===t.keyCode||i||d?g>0:g<this.element.value.length;8===t.keyCode||i||d?g--:g++){var m=void 0;(8===t.keyCode||d)&&(o!==r&&o!==s||o===r)||i?(h=l[g-1],m=s-1):(h=l[g],m=s,++s);var f=this.element.value[m];if(c(this.regExpCollec[h])&&!c(this.customCharacters)&&c(this.customCharacters[h])&&this.hiddenMask[m]!==this.promptChar&&"["!==this.customRegExpCollec[m][0]&&"]"!==this.customRegExpCollec[m][this.customRegExpCollec[m].length-1]||this.promptMask[m]!==this.promptChar&&c(this.customCharacters))this.element.selectionStart=this.element.selectionEnd=m,t.preventDefault(),46!==t.keyCode||d||++this.element.selectionStart;else{var v=this.element.value,y=this.promptChar,b=v.substring(0,m)+y+v.substring(s,v.length);ga.call(this,b),t.preventDefault(),this.element.selectionStart=this.element.selectionEnd=m,n=!0}if(s=this.element.selectionStart,!n&&8===t.keyCode||d||!n&&46!==t.keyCode?m=s-1:(m=s,n=!1),f=this.element.value[m],o!==r&&this.element.selectionStart===o||this.promptMask[m]===this.promptChar||f!==this.promptMask[m]&&this.promptMask[m]!==this.promptChar&&!c(this.customCharacters))break}}0===this.element.selectionStart&&this.element.selectionEnd===this.element.value.length&&(ga.call(this,this.promptMask),t.preventDefault(),this.element.selectionStart=this.element.selectionEnd=s),this.redoCollec.unshift({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),na.call(this,t,e)}}function ia(t){if(this.mask){var e=this.element.value;if(!t.ctrlKey||t.ctrlKey&&"KeyA"!==t.code&&"KeyY"!==t.code&&"KeyZ"!==t.code&&"KeyX"!==t.code&&"KeyC"!==t.code&&"KeyV"!==t.code){this.maskKeyPress=!0;var i=t.key;"Spacebar"===i&&(i=String.fromCharCode(t.keyCode)),i?i&&1===i.length&&(aa.call(this,i,t.ctrlKey,t),t.preventDefault()):(this.isIosInvalid=!0,aa.call(this,String.fromCharCode(t.keyCode),t.ctrlKey,t),t.preventDefault(),this.isIosInvalid=!1)}na.call(this,t,e)}}function na(t,e){if(!c(this.changeEventArgs)){var i={};this.changeEventArgs={value:this.element.value,maskedValue:this.element.value,isInteraction:!1},this.mask&&(this.changeEventArgs.value=qs.call(this,this.element)),c(t)||(this.changeEventArgs.isInteraction=!0,this.changeEventArgs.event=t),l(i,this.changeEventArgs),this.trigger("change",i)}R(this.element,{"aria-valuenow":this.element.value})}function oa(t){if(this.mask){var e=void 0;if(this.maskKeyPress||229!==t.keyCode)da.call(this);else{var i=void 0;if(1===this.element.value.length&&(this.element.value=this.element.value+this.promptMask,this.element.setSelectionRange(1,1)),this.element.value.length>this.promptMask.length){var n=this.element.selectionStart,o=this.element.value.length-this.promptMask.length,r=this.element.value.substring(n-o,n);if(this.undoCollec.length>0){e=this.undoCollec[this.undoCollec.length-1];var s=this.element.selectionStart;i=e.value;var a=e.value.substring(s-o,s);e=this.redoCollec[0],r=r.trim();var l=za.isAndroid&&""===r;l||a===r||e.value.substring(s-o,s)===r?l&&ha.call(this,t,s-1,this.element.selectionEnd-1,r,t.ctrlKey,!1):aa.call(this,r,t.ctrlKey,t)}else i=this.promptMask,aa.call(this,r,t.ctrlKey,t);this.maskKeyPress=!1,na.call(this,t,i)}}var h=qs.call(this,this.element);(0!==this.element.selectionStart||this.promptMask!==this.element.value||""!==h||""===h&&this.value!==h)&&(this.prevValue=h,this.value=h)}else na.call(this,t),this.value=this.element.value;if(0===this.element.selectionStart&&0===this.element.selectionEnd){var c=this.element;setTimeout(function(){c.setSelectionRange(0,0)},0)}}function ra(t){if(t.length>1&&this.promptMask.length+t.length<this.element.value.length){var e=this.redoCollec[0].value.substring(0,this.redoCollec[0].startIndex)+t+this.redoCollec[0].value.substring(this.redoCollec[0].startIndex,this.redoCollec[0].value.length);ga.call(this,e),this.element.selectionStart=this.element.selectionEnd=this.redoCollec[0].startIndex+t.length}this.element.selectionStart=this.element.selectionStart-t.length,this.element.selectionEnd=this.element.selectionEnd-t.length}function sa(t){this.maskKeyPress||ra.call(this,t)}function aa(t,e,i){if(sa.call(this,t),!c(this)&&!c(t))for(var n,o,r=this.element.selectionStart,s=r,a=(this.element.selectionEnd,!1),l=this.element.value,h=!1,d=!1,p=0;p<t.length;p++){var u=t[p];if(r=this.element.selectionStart,this.element.selectionEnd,this.maskKeyPress||s!==r||(r+=p),!this.maskKeyPress||r<this.promptMask.length){for(m=r;m<this.promptMask.length;m++)n=this.escapeMaskValue[r],"\\"===this.hiddenMask[r]&&this.hiddenMask[r+1]===t&&(d=!0),(c(this.regExpCollec[n])&&(c(this.customCharacters)||!c(this.customCharacters)&&c(this.customCharacters[n]))&&this.hiddenMask[r]!==this.promptChar&&"["!==this.customRegExpCollec[r][0]&&"]"!==this.customRegExpCollec[r][this.customRegExpCollec[r].length-1]||this.promptMask[r]!==this.promptChar&&c(this.customCharacters)||this.promptChar===n&&this.escapeMaskValue===this.mask)&&(this.element.selectionStart=this.element.selectionEnd=r+1,r=this.element.selectionStart,n=this.hiddenMask[r]);if(c(this.customCharacters)||c(this.customCharacters[n]))!c(this.regExpCollec[n])&&u.match(new RegExp(this.regExpCollec[n]))&&this.promptMask[r]===this.promptChar?a=!0:this.promptMask[r]===this.promptChar&&"["===this.customRegExpCollec[r][0]&&"]"===this.customRegExpCollec[r][this.customRegExpCollec[r].length-1]&&u.match(new RegExp(this.customRegExpCollec[r]))&&(a=!0);else for(var g=this.customCharacters[n].split(","),m=0;m<g.length;m++)if(u.match(new RegExp("["+g[m]+"]"))){a=!0;break}if((!this.maskKeyPress||r<this.hiddenMask.length)&&a){if(0===p)if(this.maskKeyPress)this.undoCollec.push({value:l,startIndex:r,endIndex:r});else{var f=this.element.selectionStart,v=this.element.selectionEnd;this.redoCollec.length>0?(o=this.redoCollec[0].value,ga.call(this,o),this.undoCollec.push(this.redoCollec[0])):(this.undoCollec.push({value:this.promptMask,startIndex:r,endIndex:r}),o=this.promptMask,ga.call(this,o)),this.element.selectionStart=f,this.element.selectionEnd=v}r=this.element.selectionStart,la.call(this,i,r,u,o,d),h=!0,p===t.length-1&&this.redoCollec.unshift({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),a=!1}else r=this.element.selectionStart,ha.call(this,i,r,s,t,e,h);p!==t.length-1||a||(!za.isAndroid||za.isAndroid&&r<this.promptMask.length)&&this.redoCollec.unshift({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd})}else 1!==t.length||e||c(i)||ca.call(this)}}function la(t,e,i,n,o){if(this.hiddenMask.length>this.promptMask.length&&(i=pa.call(this,i,this.element.value)),!o){var r=this.element.value,s=r.substring(0,e)+i+r.substring(e+1,r.length);ga.call(this,s),this.element.selectionStart=this.element.selectionEnd=e+1}na.call(this,t,n)}function ha(t,e,i,n,o,r){if(!this.maskKeyPress){var s=void 0,a=this.element.value;e>=this.promptMask.length?ga.call(this,a.substring(0,e)):(i===e?ga.call(this,a.substring(0,e)+a.substring(e+1,a.length)):this.promptMask.length===this.element.value.length?ga.call(this,a.substring(0,e)+a.substring(e,a.length)):ga.call(this,a.substring(0,i)+a.substring(i+1,a.length)),this.element.selectionStart=this.element.selectionEnd=r||this.element.value[i]!==this.promptChar?e:i),s=this.element.value,na.call(this,t,s),ca.call(this)}1!==n.length||o||c(t)||ca.call(this)}function ca(){var t=this,e=this.element.parentNode,i=200;e.classList.contains(yg)||e.classList.contains(bg)?E([e],vg):E([this.element],vg),!0===this.isIosInvalid&&(i=400),R(this.element,{"aria-invalid":"true"}),setTimeout(function(){t.maskKeyPress||da.call(t)},i)}function da(){P([this.element.parentNode],vg),P([this.element],vg),R(this.element,{"aria-invalid":"false"})}function pa(t,e){var i,n,o=e,r=0;for(n=0;n<this.hiddenMask.length;n++)if("\\"===this.hiddenMask[n]&&(i=o.substring(0,n)+"\\"+o.substring(n,o.length)),">"!==this.hiddenMask[n]&&"<"!==this.hiddenMask[n]&&"|"!==this.hiddenMask[n]||(this.hiddenMask[n]!==o[n]&&(i=o.substring(0,n)+this.hiddenMask[n]+o.substring(n,o.length)),++r),i){if(i[n]===this.promptChar&&n>this.element.selectionStart||this.element.value.indexOf(this.promptChar)<0&&this.element.selectionStart+r===n){r=0;break}o=i}for(;n>=0&&i;){if(0===n||"\\"!==i[n-1]){this.element.value;if(">"===i[n]){t=t.toUpperCase();break}if("<"===i[n]){t=t.toLowerCase();break}if("|"===i[n])break}--n}return t}function ua(t){if(this.mask&&void 0!==t&&(""===t||this.prevValue!==t)){if(this.maskKeyPress=!0,ga.call(this,this.promptMask),""!==t&&(this.element.selectionStart=0,this.element.selectionEnd=0),null!==t)for(var e=0;e<t.length;e++)aa.call(this,t[e],!1,null);this.value=qs.call(this,this.element),this.maskKeyPress=!1;var i=this.element.parentNode.querySelector(".e-float-text");this.element.value===this.promptMask&&"Auto"===this.floatLabelType&&this.placeholder&&!c(i)&&i.classList.contains(xg)&&!this.isFocus&&(P([i],xg),E([i],Sg),ga.call(this,""))}(null===this.mask||""===this.mask&&void 0!==this.value)&&ga.call(this,this.value)}function ga(t,e){!this.isFocus&&"Auto"===this.floatLabelType&&this.placeholder&&c(this.value)&&(t="");var i=qs.call(this,e||this.element,t);null===i||""===i?(Wu.setValue(t,e||this.element,this.floatLabelType,!1),this.showClearButton&&this.inputObj.clearButton.classList.add("e-clear-icon-hide")):Wu.setValue(t,e||this.element,this.floatLabelType,this.showClearButton)}function ma(t){var e=fa(t);zs.call(e);var i=qs.call(this,this.element);this.prevValue=i,this.value=i,t.mask&&(Vs.call(e),js.call(e))}function fa(t){E([t.element],wg);var e={element:t.element,mask:t.mask,promptMask:"",hiddenMask:"",escapeMaskValue:"",promptChar:t.promptChar?t.promptChar.length>1?t.promptChar=t.promptChar[0]:t.promptChar:"_",value:t.value?t.value:null,regExpCollec:Cg,customRegExpCollec:[],customCharacters:t.customCharacters,undoCollec:[],redoCollec:[],maskKeyPress:!1,prevValue:""};return Hs.call(e),e}function va(t){return qs.call(ba(t),t.element)}function ya(t){return Us.call(ba(t),t.element)}function ba(t){var e;return!c(t)&&t.element.classList.contains(wg)&&(e=fa(t)),e}function wa(t){return Xf[t.toString()]}function xa(t){return Yf[t.toString()]}function Sa(t){return Gf[t.toString()]}function Ca(t){return Zf[t.toString()]}function La(t){return Kf[t.toString()]}function Ea(t){var e=t.offsetX-t.actualSize.width*t.pivot.x,i=t.offsetY-t.actualSize.height*t.pivot.y;return new ah(e,i,t.actualSize.width,t.actualSize.height)}function Pa(t,e){for(var i=0;i<e.length;i++)if(e[i].id===t)return!0;return!1}var ka="ej2_instances",Ta=0,Oa=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ia="GET",Aa=function(){function t(t,e,i,n){this.mode=!0,this.emitError=!0,this.options={},"string"==typeof t?(this.url=t,this.type=e?e.toUpperCase():Ia,this.mode=!!c(i)||i):"object"==typeof t&&(this.options=t,l(this,this.options)),this.type=this.type?this.type.toUpperCase():Ia,this.contentType=void 0!==this.contentType?this.contentType:n}return t.prototype.send=function(t){var e=this;this.data=c(t)?this.data:t;var i={cancel:!1};return new Promise(function(t,n){e.httpRequest=new XMLHttpRequest,e.httpRequest.onreadystatechange=function(){e.stateChange(t,n)},c(e.onLoad)||(e.httpRequest.onload=e.onLoad),c(e.onProgress)||(e.httpRequest.onprogress=e.onProgress),c(e.onAbort)||(e.httpRequest.onabort=e.onAbort),c(e.onError)||(e.httpRequest.onerror=e.onError),c(e.onUploadProgress)||(e.httpRequest.upload.onprogress=e.onUploadProgress),e.httpRequest.open(e.type,e.url,e.mode),c(e.data)||null===e.contentType||e.httpRequest.setRequestHeader("Content-Type",e.contentType||"application/json; charset=utf-8"),e.beforeSend&&e.beforeSend(i),i.cancel||e.httpRequest.send(c(e.data)?null:e.data)})},t.prototype.successHandler=function(t){return this.onSuccess&&this.onSuccess(t,this),t},t.prototype.failureHandler=function(t){return this.onFailure&&this.onFailure(this.httpRequest),t},t.prototype.stateChange=function(t,e){var i=this.httpRequest.responseText;if(this.dataType&&"json"===this.dataType.toLowerCase())if(""===i)i=void 0;else try{i=JSON.parse(i)}catch(t){}4===this.httpRequest.readyState&&(this.httpRequest.status>=200&&this.httpRequest.status<=299||304===this.httpRequest.status?t(this.successHandler(i)):this.emitError?e(new Error(this.failureHandler(this.httpRequest.statusText))):t())},t.prototype.getResponseHeader=function(t){var e,i;e={};for(var n=Oa.exec(this.httpRequest.getAllResponseHeaders());n;)e[n[1].toLowerCase()]=n[2],n=Oa.exec(this.httpRequest.getAllResponseHeaders());return i=e[t.toLowerCase()],c(i)?null:i},t}(),Ma=function(){function t(){}return t.addOrGetEventData=function(t){return"__eventList"in t?t.__eventList.events:(t.__eventList={},t.__eventList.events=[])},t.add=function(e,i,n,o,r){var s,a=t.addOrGetEventData(e);s=r?u(n,r):n,o&&(s=s.bind(o));for(var l=i.split(" "),h=0;h<l.length;h++)a.push({name:l[h],listener:n,debounce:s}),e.addEventListener(l[h],s);return s},t.remove=function(e,i,n){for(var o=t.addOrGetEventData(e),r=i.split(" "),s=0;s<r.length;s++)!function(t){var i,s=-1;o&&0!==o.length&&o.some(function(e,o){return e.name===r[t]&&e.listener===n&&(s=o,i=e.debounce,!0)}),-1!==s&&o.splice(s,1),i&&e.removeEventListener(r[t],i)}(s)},t.clearEvents=function(e){var i,n;n=h([],n,i=t.addOrGetEventData(e));for(var o=0;o<n.length;o++)e.removeEventListener(n[o].name,n[o].debounce),i.shift()},t.trigger=function(e,i,n){for(var o=0,r=t.addOrGetEventData(e);o<r.length;o++){var s=r[o];s.name===i&&s.debounce.call(this,n)}},t}(),Ra=/^svg|^path|^g/,Da=function(){function t(t){this.ranArray=[],this.boundedEvents={},c(t)||(this.context=t)}return t.prototype.on=function(t,e,i,n){if(!c(e)){var o=i||this.context;if(this.notExist(t))return void(this.boundedEvents[t]=[{handler:e,context:o}]);c(n)?this.isHandlerPresent(this.boundedEvents[t],e)||this.boundedEvents[t].push({handler:e,context:o}):-1===this.ranArray.indexOf(n)&&(this.ranArray.push(n),this.boundedEvents[t].push({handler:e,context:o,id:n}))}},t.prototype.off=function(t,e,i){if(!this.notExist(t)){var o=n(t,this.boundedEvents);if(e)for(var r=0;r<o.length;r++){if(i){o.splice(r,1);var s=this.ranArray.indexOf(i);-1!==s&&this.ranArray.splice(s,1);break}if(e===o[r].handler){o.splice(r,1);break}}else delete this.boundedEvents[t]}},t.prototype.notify=function(t,e){if(!this.notExist(t)){e&&(e.name=t);for(var i=0,o=n(t,this.boundedEvents).slice(0);i<o.length;i++){var r=o[i];r.handler.call(r.context,e)}}},t.prototype.destroy=function(){this.boundedEvents=this.context=void 0},t.prototype.notExist=function(t){return!1===this.boundedEvents.hasOwnProperty(t)},t.prototype.isHandlerPresent=function(t,e){for(var i=0,n=t;i<n.length;i++)if(n[i].handler===e)return!0;return!1},t}(),Ba=function(){function t(t,e){this.isProtectedOnChange=!0,this.properties={},this.changedProperties={},this.oldProperties={},this.refreshing=!1,this.finalUpdate=function(){},this.childChangedProperties={},this.modelObserver=new Da(this),d(e)||(this.element="string"==typeof e?document.querySelector(e):e,c(this.element)||(this.isProtectedOnChange=!1,this.addInstance())),d(t)||this.setProperties(t,!0),this.isDestroyed=!1}return t.prototype.setProperties=function(t,e){var i=this.isProtectedOnChange;this.isProtectedOnChange=!!e,l(this,t),!0!==e&&(l(this.changedProperties,t),this.dataBind()),this.finalUpdate(),this.changedProperties={},this.oldProperties={},this.isProtectedOnChange=i},t.callChildDataBind=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++){var o=n[i];if(e[o]instanceof Array)for(var r=0,s=e[o];r<s.length;r++){var a=s[r];void 0!==a.dataBind&&a.dataBind()}else e[o].dataBind()}},t.prototype.clearChanges=function(){this.finalUpdate(),this.changedProperties={},this.oldProperties={},this.childChangedProperties={}},t.prototype.dataBind=function(){if(t.callChildDataBind(this.childChangedProperties,this),Object.getOwnPropertyNames(this.changedProperties).length){var e=this.isProtectedOnChange,i=this.changedProperties,n=this.oldProperties;this.clearChanges(),this.isProtectedOnChange=!0,this.onPropertyChanged(i,n),this.isProtectedOnChange=e}},t.prototype.saveChanges=function(t,e,n){this.isProtectedOnChange||(this.oldProperties[t]=n,this.changedProperties[t]=e,this.finalUpdate(),this.finalUpdate=i(this.dataBind.bind(this)))},t.prototype.addEventListener=function(t,e){this.modelObserver.on(t,e)},t.prototype.removeEventListener=function(t,e){this.modelObserver.off(t,e)},t.prototype.trigger=function(t,e){if(!0!==this.isDestroyed){var i=this.isProtectedOnChange;this.isProtectedOnChange=!1,this.modelObserver.notify(t,e),this.isProtectedOnChange=i}},t.prototype.addInstance=function(){var t="e-"+this.getModuleName().toLowerCase();E([this.element],["e-control",t]),c(this.element.ej2_instances)?o("ej2_instances",[this],this.element):this.element.ej2_instances.push(this)},t.prototype.destroy=function(){var t=this;this.element.ej2_instances=this.element.ej2_instances.filter(function(e){return e!==t}),P([this.element],["e-"+this.getModuleName()]),0===this.element.ej2_instances.length&&P([this.element],["e-control"]),this.clearChanges(),this.modelObserver.destroy(),this.isDestroyed=!0},t}(),Na={OPERA:/(opera|opr)(?:.*version|)[ \/]([\w.]+)/i,EDGE:/(edge)(?:.*version|)[ \/]([\w.]+)/i,CHROME:/(chrome|crios)[ \/]([\w.]+)/i,PANTHOMEJS:/(phantomjs)[ \/]([\w.]+)/i,SAFARI:/(safari)[ \/]([\w.]+)/i,WEBKIT:/(webkit)[ \/]([\w.]+)/i,MSIE:/(msie|trident) ([\w.]+)/i,MOZILLA:/(mozilla)(?:.*? rv:([\w.]+)|)/i};"undefined"!=typeof window&&(window.browserDetails=window.browserDetails||{});var Ha,za=function(){function t(){}return t.extractBrowserDetail=function(){for(var e={culture:{}},i=[],n=0,o=Object.keys(Na);n<o.length;n++){var r=o[n];if(i=t.userAgent.match(Na[r])){if(e.name="opr"===i[1].toLowerCase()?"opera":i[1].toLowerCase(),e.name="crios"===i[1].toLowerCase()?"chrome":e.name,e.version=i[2],e.culture.name=e.culture.language=navigator.language,t.userAgent.match(/Trident\/7\./)){e.name="msie";break}var s=t.userAgent.match(/(version)[ \/]([\w.]+)/i);"safari"===e.name&&s&&(e.version=s[2]);break}}return e},t.getEvent=function(e){var i={start:{isPointer:"pointerdown",isTouch:"touchstart",isDevice:"mousedown"},move:{isPointer:"pointermove",isTouch:"touchmove",isDevice:"mousemove"},end:{isPointer:"pointerup",isTouch:"touchend",isDevice:"mouseup"},cancel:{isPointer:"pointercancel",isTouch:"touchcancel",isDevice:"mouseleave"}};return t.isPointer?i[e].isPointer:t.isTouch?i[e].isTouch+(t.isDevice?"":" "+i[e].isDevice):i[e].isDevice},t.getTouchStartEvent=function(){return t.getEvent("start")},t.getTouchEndEvent=function(){return t.getEvent("end")},t.getTouchMoveEvent=function(){return t.getEvent("move")},t.getTouchCancelEvent=function(){return t.getEvent("cancel")},t.getValue=function(e,i){var n=window.browserDetails;return void 0===n[e]?n[e]=i.test(t.userAgent):n[e]},Object.defineProperty(t,"userAgent",{get:function(){return t.uA},set:function(e){t.uA=e,window.browserDetails={}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"info",{get:function(){return d(window.browserDetails.info)?window.browserDetails.info=t.extractBrowserDetail():window.browserDetails.info},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isIE",{get:function(){return t.getValue("isIE",/msie|trident/i)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isTouch",{get:function(){return d(window.browserDetails.isTouch)?window.browserDetails.isTouch="ontouchstart"in window:window.browserDetails.isTouch},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isPointer",{get:function(){return d(window.browserDetails.isPointer)?window.browserDetails.isPointer="pointerEnabled"in window.navigator:window.browserDetails.isPointer},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isMSPointer",{get:function(){return d(window.browserDetails.isMSPointer)?window.browserDetails.isMSPointer="msPointerEnabled"in window.navigator:window.browserDetails.isMSPointer},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isDevice",{get:function(){return t.getValue("isDevice",/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini|mobile/i)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isIos",{get:function(){return t.getValue("isIos",/(ipad|iphone|ipod touch)/i)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isIos7",{get:function(){return t.getValue("isIos7",/(ipad|iphone|ipod touch);.*os 7_\d|(ipad|iphone|ipod touch);.*os 8_\d/i)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isAndroid",{get:function(){return t.getValue("isAndroid",/android/i)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isWebView",{get:function(){return d(window.browserDetails.isWebView)?(window.browserDetails.isWebView=!(d(window.cordova)&&d(window.PhoneGap)&&d(window.phonegap)&&"object"!==window.forge),window.browserDetails.isWebView):window.browserDetails.isWebView},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isWindows",{get:function(){return t.getValue("isWindows",/trident|windows phone|edge/i)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"touchStartEvent",{get:function(){return d(window.browserDetails.touchStartEvent)?window.browserDetails.touchStartEvent=t.getTouchStartEvent():window.browserDetails.touchStartEvent},enumerable:!0,configurable:!0}),Object.defineProperty(t,"touchMoveEvent",{get:function(){return d(window.browserDetails.touchMoveEvent)?window.browserDetails.touchMoveEvent=t.getTouchMoveEvent():window.browserDetails.touchMoveEvent},enumerable:!0,configurable:!0}),Object.defineProperty(t,"touchEndEvent",{get:function(){return d(window.browserDetails.touchEndEvent)?window.browserDetails.touchEndEvent=t.getTouchEndEvent():window.browserDetails.touchEndEvent},enumerable:!0,configurable:!0}),Object.defineProperty(t,"touchCancelEvent",{get:function(){return d(window.browserDetails.touchCancelEvent)?window.browserDetails.touchCancelEvent=t.getTouchCancelEvent():window.browserDetails.touchCancelEvent},enumerable:!0,configurable:!0}),t.uA="undefined"!=typeof navigator?navigator.userAgent:"",t}(),ja=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Va=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Fa=function(t){function e(e){var i=t.call(this,e,void 0)||this;return i.easing={ease:"cubic-bezier(0.250, 0.100, 0.250, 1.000)",linear:"cubic-bezier(0.250, 0.250, 0.750, 0.750)",easeIn:"cubic-bezier(0.420, 0.000, 1.000, 1.000)",easeOut:"cubic-bezier(0.000, 0.000, 0.580, 1.000)",easeInOut:"cubic-bezier(0.420, 0.000, 0.580, 1.000)",elasticInOut:"cubic-bezier(0.5,-0.58,0.38,1.81)",elasticIn:"cubic-bezier(0.17,0.67,0.59,1.81)",elasticOut:"cubic-bezier(0.7,-0.75,0.99,1.01)"},i}return ja(e,t),i=e,e.prototype.animate=function(t,e){e=e||{};var n=this.getModel(e);if("string"==typeof t)for(var o=0,r=Array.prototype.slice.call(B(t,document));o<r.length;o++){var s=r[o];n.element=s,i.delayAnimation(n)}else n.element=t,i.delayAnimation(n)},e.stop=function(t,e){t.style.animation="",t.removeAttribute("e-animate");var i=t.getAttribute("e-animation-id");if(i){var n=parseInt(i,10);cancelAnimationFrame(n),t.removeAttribute("e-animation-id")}e&&e.end&&e.end.call(this,e)},e.delayAnimation=function(t){t.delay?setTimeout(function(){i.applyAnimation(t)},t.delay):i.applyAnimation(t)},e.applyAnimation=function(t){var e=this;t.timeStamp=0;var i=0,n=0,o=0,r=0,s=t.duration;t.element.setAttribute("e-animate","true");var a=function(l){try{if(l){r=0===r?l:r,t.timeStamp=l+t.timeStamp-r,r=l,!i&&t.begin&&t.begin.call(e,t),i+=1;var h=t.timeStamp/i;t.timeStamp<s&&t.timeStamp+h<s&&t.element.getAttribute("e-animate")?(t.element.style.animation=t.name+" "+t.duration+"ms "+t.timingFunction,t.progress&&t.progress.call(e,t),requestAnimationFrame(a)):(cancelAnimationFrame(n),t.element.removeAttribute("e-animation-id"),t.element.removeAttribute("e-animate"),t.element.style.animation="",t.end&&t.end.call(e,t))}else o=performance.now(),n=requestAnimationFrame(a),t.element.setAttribute("e-animation-id",n.toString())}catch(i){cancelAnimationFrame(n),t.element.removeAttribute("e-animation-id"),t.fail&&t.fail.call(e,i)}};a()},e.prototype.getModel=function(t){return{name:t.name||this.name,delay:t.delay||this.delay,duration:void 0!==t.duration?t.duration:this.duration,begin:t.begin||this.begin,end:t.end||this.end,fail:t.fail||this.fail,progress:t.progress||this.progress,timingFunction:this.easing[t.timingFunction]?this.easing[t.timingFunction]:t.timingFunction||this.easing[this.timingFunction]}},e.prototype.onPropertyChanged=function(t,e){},e.prototype.getModuleName=function(){return"animation"},e.prototype.destroy=function(){},Va([et("FadeIn")],e.prototype,"name",void 0),Va([et(400)],e.prototype,"duration",void 0),Va([et("ease")],e.prototype,"timingFunction",void 0),Va([et(0)],e.prototype,"delay",void 0),Va([st()],e.prototype,"progress",void 0),Va([st()],e.prototype,"begin",void 0),Va([st()],e.prototype,"end",void 0),Va([st()],e.prototype,"fail",void 0),e=i=Va([at],e);var i}(Ba),_a=!1,Wa=function(){function t(t){this.rootId=t}return t.prototype.getOptionValue=function(t,e){return t[e]},t.prototype.createCanvas=function(t){var e=document.createElement("canvas");return e.setAttribute("id",this.rootId+"_canvas"),this.ctx=e.getContext("2d"),this.canvasObj=e,this.setCanvasSize(t.width,t.height),this.canvasObj},t.prototype.setCanvasSize=function(t,e){var i=document.getElementById(this.rootId),n=c(i)?null:i.getBoundingClientRect();c(this.width)?this.canvasObj.setAttribute("width",t?t.toString():n.width.toString()):this.canvasObj.setAttribute("width",this.width.toString()),c(this.height)?this.canvasObj.setAttribute("height",e?e.toString():"450"):this.canvasObj.setAttribute("height",this.height.toString())},t.prototype.setAttributes=function(t){this.ctx.lineWidth=this.getOptionValue(t,"stroke-width");var e=this.getOptionValue(t,"stroke-dasharray");if(!c(e)){var i=e.split(",");this.ctx.setLineDash([parseInt(i[0],10),parseInt(i[1],10)])}this.ctx.strokeStyle=this.getOptionValue(t,"stroke")},t.prototype.drawLine=function(t){this.ctx.save(),this.ctx.beginPath(),this.ctx.lineWidth=this.getOptionValue(t,"stroke-width"),this.ctx.strokeStyle=t.stroke,this.ctx.moveTo(t.x1,t.y1),this.ctx.lineTo(t.x2,t.y2),this.ctx.stroke(),this.ctx.restore(),this.dataUrl=this.canvasObj.toDataURL()},t.prototype.drawRectangle=function(t){var e=this.ctx,i=t.rx;this.ctx.save(),this.ctx.beginPath(),this.ctx.globalAlpha=this.getOptionValue(t,"opacity"),this.setAttributes(t),this.ctx.rect(t.x,t.y,t.width,t.height),null!==i&&i>=0?this.drawCornerRadius(t):("none"===t.fill&&(t.fill="transparent"),this.ctx.fillStyle=t.fill,this.ctx.fillRect(t.x,t.y,t.width,t.height),this.ctx.stroke()),this.ctx.restore(),this.ctx=e,this.dataUrl=this.canvasObj.toDataURL()},t.prototype.drawCornerRadius=function(t){var e=t.rx,i=t.x,n=t.y,o=t.width,r=t.height;"none"===t.fill&&(t.fill="transparent"),this.ctx.fillStyle=t.fill,o<2*e&&(e=o/2),r<2*e&&(e=r/2),this.ctx.beginPath(),this.ctx.moveTo(i+o-e,n),this.ctx.arcTo(i+o,n,i+o,n+r,e),this.ctx.arcTo(i+o,n+r,i,n+r,e),this.ctx.arcTo(i,n+r,i,n,e),this.ctx.arcTo(i,n,i+o,n,e),this.ctx.closePath(),this.ctx.fill(),this.ctx.stroke(),this.dataUrl=this.canvasObj.toDataURL()},t.prototype.drawPath=function(t,e){var i=t.d.split(" "),n=this.getOptionValue(t,"stroke-width"),o=this.ctx,r=!0;this.ctx.save(),this.ctx.beginPath(),e&&this.ctx.translate(e[0],e[1]),this.ctx.globalAlpha=t.opacity?t.opacity:this.getOptionValue(t,"fill-opacity"),this.setAttributes(t);for(var s=0;s<i.length;s+=3){var a=parseFloat(i[s+1]),l=parseFloat(i[s+2]);switch(i[s]){case"M":t.innerR||t.cx||this.ctx.moveTo(a,l);break;case"L":t.innerR||this.ctx.lineTo(a,l);break;case"C":var h=parseFloat(i[s+3]),c=parseFloat(i[s+4]),d=parseFloat(i[s+5]),p=parseFloat(i[s+6]);this.ctx.bezierCurveTo(a,l,h,c,d,p),s+=4;break;case"A":t.innerR?r&&(this.ctx.arc(t.x,t.y,t.radius,t.start,t.end,t.counterClockWise),this.ctx.arc(t.x,t.y,t.innerR,t.end,t.start,!t.counterClockWise),r=!1):t.cx?this.ctx.arc(t.cx,t.cy,t.radius,0,2*Math.PI,t.counterClockWise):(this.ctx.moveTo(t.x,t.y),this.ctx.arc(t.x,t.y,t.radius,t.start,t.end,t.counterClockWise),this.ctx.lineTo(t.x,t.y)),s+=5;break;case"z":this.ctx.closePath()}}"none"!==t.fill&&void 0!==t.fill&&(this.ctx.fillStyle=t.fill,this.ctx.fill()),n>0&&this.ctx.stroke(),this.ctx.restore(),this.ctx=o,this.dataUrl=this.canvasObj.toDataURL()},t.prototype.drawText=function(t,e){var i=this.getOptionValue(t,"font-weight");c(i)||"regular"!==i.toLowerCase()||(i="normal");var n=this.getOptionValue(t,"font-size"),o=this.getOptionValue(t,"font-family"),r=this.getOptionValue(t,"font-style").toLowerCase()+" "+i+" "+n+" "+o,s=this.getOptionValue(t,"text-anchor"),a=void 0!==t.opacity?t.opacity:1;"middle"===s&&(s="center"),this.ctx.save(),this.ctx.fillStyle=t.fill,this.ctx.font=r,this.ctx.textAlign=s,this.ctx.globalAlpha=a,t.baseline&&(this.ctx.textBaseline=t.baseline);this.ctx.translate(t.x+0,t.y),this.ctx.rotate(t.labelRotation*Math.PI/180),this.ctx.fillText(e,0,0),this.ctx.restore(),this.dataUrl=this.canvasObj.toDataURL()},t.prototype.drawCircle=function(t){var e=this.ctx;this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(t.cx,t.cy,t.r,0,2*Math.PI),this.ctx.fillStyle=t.fill,this.ctx.globalAlpha=t.opacity,this.ctx.fill(),this.setAttributes(t),this.ctx.stroke(),this.ctx.restore(),this.ctx=e,this.dataUrl=this.canvasObj.toDataURL()},t.prototype.drawPolyline=function(t){this.ctx.save(),this.ctx.beginPath();for(var e=t.points.split(" "),i=0;i<e.length-1;i++){var n=e[i].split(","),o=parseFloat(n[0]),r=parseFloat(n[1]);0===i?this.ctx.moveTo(o,r):this.ctx.lineTo(o,r)}this.ctx.lineWidth=this.getOptionValue(t,"stroke-width"),this.ctx.strokeStyle=t.stroke,this.ctx.stroke(),this.ctx.restore(),this.dataUrl=this.canvasObj.toDataURL()},t.prototype.drawEllipse=function(t){var e=this.ctx,i=Math.max(t.rx,t.ry),n=t.rx/i,o=t.ry/i;this.ctx.save(),this.ctx.beginPath(),this.ctx.translate(t.cx,t.cy),this.ctx.save(),this.ctx.scale(n,o),this.ctx.arc(0,0,i,0,2*Math.PI,!1),this.ctx.fillStyle=t.fill,this.ctx.fill(),this.ctx.restore(),this.ctx.lineWidth=this.getOptionValue(t,"stroke-width"),this.ctx.strokeStyle=t.stroke,this.ctx.stroke(),this.ctx.restore(),this.ctx=e,this.dataUrl=this.canvasObj.toDataURL()},t.prototype.drawImage=function(t){this.ctx.save();var e=new Image;c(t.href)||(e.src=t.href,this.ctx.drawImage(e,t.x,t.y,t.width,t.height)),this.ctx.restore(),this.dataUrl=this.canvasObj.toDataURL()},t.prototype.createLinearGradient=function(t){var e;return c(t[0].colorStop)||(e=this.ctx.createLinearGradient(0,0,0,this.canvasObj.height)),this.setGradientValues(t,e)},t.prototype.createRadialGradient=function(t){var e;return c(t[0].colorStop)||(e=this.ctx.createRadialGradient(0,0,0,0,0,this.canvasObj.height)),this.setGradientValues(t,e)},t.prototype.setGradientValues=function(t,e){var i;if(c(t[0].colorStop))i=t[0].color.toString();else{for(var n=0;n<=t.length-1;n++){var o=t[n].color,r=t[n].colorStop.slice(0,-1),s=parseInt(r,10)/100;e.addColorStop(s,o)}i=e.toString()}return this.dataUrl=this.canvasObj.toDataURL(),i},t.prototype.setElementAttributes=function(t,e){for(var i=Object.keys(t),n=Object.keys(t).map(function(e){return t[e]}),o=0;o<i.length;o++)e.setAttribute(i[o],n[o]);return e},t.prototype.updateCanvasAttributes=function(t){this.setElementAttributes(t,this.canvasObj);var e=this.ctx;if(!c(this.dataUrl)){var i=new Image;i.onload=function(){e.drawImage(i,0,0)},i.src=this.dataUrl}},t}(),Ua=function(){function t(t){this.loadedModules=[],this.parent=t}return t.prototype.inject=function(t,i){var n=t.length;if(0===n)return void this.clean();this.loadedModules.length&&this.clearUnusedModule(t);for(var r=0;r<n;r++)for(var s=t[r],a=0,l=i;a<l.length;a++){var h=l[a],c=s.member;if(h.prototype.getModuleName()===s.member&&!this.isModuleLoaded(c)){var d=e(h,s.args),p=this.getMemberName(c);s.isProperty?o(p,h,this.parent):o(p,d,this.parent);var u=s;u.member=p,this.loadedModules.push(u)}}},t.prototype.clean=function(){for(var t=0,e=this.loadedModules;t<e.length;t++){var i=e[t];i.isProperty||n(i.member,this.parent).destroy()}this.loadedModules=[]},t.prototype.clearUnusedModule=function(t){for(var e=this,i=t.map(function(t){return e.getMemberName(t.member)}),o=0,s=this.loadedModules.filter(function(t){return-1===i.indexOf(t.member)});o<s.length;o++){var a=s[o];a.isProperty||n(a.member,this.parent).destroy(),this.loadedModules.splice(this.loadedModules.indexOf(a),1),r(this.parent,a.member)}},t.prototype.getMemberName=function(t){return t[0].toLowerCase()+t.substring(1)+"Module"},t.prototype.isModuleLoaded=function(t){for(var e=0,i=this.loadedModules;e<i.length;e++)if(i[e].member===this.getMemberName(t))return!0;return!1},t}(),qa=function(){function t(t,e,i,o){this.properties={},this.changedProperties={},this.childChangedProperties={},this.oldProperties={},this.finalUpdate=function(){},this.callChildDataBind=n("callChildDataBind",Ba),this.parentObj=t,this.controlParent=this.parentObj.controlParent||this.parentObj,this.propName=e,this.setProperties(i,!0),this.isParentArray=o}return t.prototype.updateChange=function(t,e){!0===t?this.parentObj.childChangedProperties[e]=t:delete this.parentObj.childChangedProperties[e],this.parentObj.updateChange&&this.parentObj.updateChange(t,this.parentObj.propName)},t.prototype.updateTimeOut=function(){if(this.parentObj.updateTimeOut)this.parentObj.finalUpdate(),this.parentObj.updateTimeOut();else{var t=setTimeout(this.parentObj.dataBind.bind(this.parentObj)),e=function(){clearTimeout(t)};this.finalUpdate=e}},t.prototype.clearChanges=function(){this.finalUpdate(),this.updateChange(!1,this.propName),this.oldProperties={},this.changedProperties={}},t.prototype.setProperties=function(t,e){!0===e?(l(this,t),this.updateChange(!1,this.propName),this.clearChanges()):l(this,t)},t.prototype.dataBind=function(){if(this.callChildDataBind(this.childChangedProperties,this),this.isParentArray){var t=this.parentObj[this.propName].indexOf(this);Object.keys(this.changedProperties).length&&(o(this.propName+"."+t,this.changedProperties,this.parentObj.changedProperties),o(this.propName+"."+t,this.oldProperties,this.parentObj.oldProperties))}else this.parentObj.changedProperties[this.propName]=this.changedProperties,this.parentObj.oldProperties[this.propName]=this.oldProperties;this.clearChanges()},t.prototype.saveChanges=function(t,e,i){this.controlParent.isProtectedOnChange||(this.oldProperties[t]=i,this.changedProperties[t]=e,this.updateChange(!0,this.propName),this.finalUpdate(),this.updateTimeOut())},t}(),Xa={latn:{_digits:"0123456789",_type:"numeric"}},Ya={decimal:".",group:",",percentSign:"%",plusSign:"+",minusSign:"-",infinity:"",nan:"NaN",exponential:"E"},Ga=[0,1,2,3,4,5,6,7,8,9],Za=function(){function t(){}return t.getMainObject=function(t,e){return n("main."+e,t)},t.getNumberingSystem=function(t){return n("supplemental.numberingSystems",t)||this.numberingSystems},t.reverseObject=function(t,e){for(var i={},n=0,o=e||Object.keys(t);n<o.length;n++){var r=o[n];i.hasOwnProperty(t[r])||(i[t[r]]=r)}return i},t.getSymbolRegex=function(t){var e=t.map(function(t){return t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}).join("|");return new RegExp(e,"g")},t.getSymbolMatch=function(t){for(var e={},i=0,n=Object.keys(Ya);i<n.length;i++){var o=n[i];e[t[o]]=Ya[o]}return e},t.constructRegex=function(t){for(var e=t.length,i="",n=0;n<e;n++)i+=n!==e-1?t[n]+"|":t[n];return i},t.convertValueParts=function(t,e,i){return t.replace(e,function(t){return i[t]})},t.getDefaultNumberingSystem=function(t){var e={};return e.obj=n("numbers",t),e.nSystem=n("defaultNumberingSystem",e.obj),e},t.getCurrentNumericOptions=function(t,e,i){var o={},r=this.getDefaultNumberingSystem(t);if(!d(r.nSystem)){var s=n(r.nSystem+"._digits",e);d(s)||(o.numericPair=this.reverseObject(s,Ga),o.numberParseRegex=new RegExp(this.constructRegex(s),"g"),o.numericRegex="["+s[0]+"-"+s[9]+"]",i&&(o.numericRegex=s[0]+"-"+s[9],o.symbolNumberSystem=n("symbols-numberSystem-"+r.nSystem,r.obj),o.symbolMatch=this.getSymbolMatch(o.symbolNumberSystem),o.numberSystem=r.nSystem))}return o},t.getNumberMapper=function(t,e,i){var o={mapper:{}},r=this.getDefaultNumberingSystem(t);if(!d(r.nSystem)){o.numberSystem=r.nSystem,o.numberSymbols=n("symbols-numberSystem-"+r.nSystem,r.obj),o.timeSeparator=n("timeSeparator",o.numberSymbols);var s=n(r.nSystem+"._digits",e);if(!d(s))for(var a=0,l=Ga;a<l.length;a++){var h=l[a];o.mapper[h]=s[h]}}return o},t.nPair="numericPair",t.nRegex="numericRegex",t.numberingSystems=Xa,t}(),Ka={ms:"minimumSignificantDigits",ls:"maximumSignificantDigits",mf:"minimumFractionDigits",lf:"maximumFractionDigits"},Qa=["infinity","nan","group","decimal","exponential"],Ja=function(){function t(){}return t.numberFormatter=function(t,e,i){var n,o=this,r=h({},e),s={},a={},l=Ha.getDependables(i,t,!0);a.numberMapper=Za.getNumberMapper(l.parserObject,Za.getNumberingSystem(i),!0),a.currencySymbol=Ha.getCurrencySymbol(l.numericObject,r.currency||ul),a.percentSymbol=a.numberMapper.numberSymbols.percentSign,a.minusSymbol=a.numberMapper.numberSymbols.minusSign;var c=a.numberMapper.numberSymbols;if(e.format&&!Ha.formatRegex.test(e.format))s=Ha.customFormat(e.format,a,l.numericObject);else{h(r,Ha.getProperNumericSkeleton(e.format||"N")),r.isCurrency="currency"===r.type,r.isPercent="percent"===r.type,n=Ha.getSymbolPattern(r.type,a.numberMapper.numberSystem,l.numericObject,r.isAccount),r.groupOne=this.checkValueRange(r.maximumSignificantDigits,r.minimumSignificantDigits,!0),this.checkValueRange(r.maximumFractionDigits,r.minimumFractionDigits,!1,!0),d(r.fractionDigits)||(r.minimumFractionDigits=r.maximumFractionDigits=r.fractionDigits),d(r.useGrouping)&&(r.useGrouping=!0),r.isCurrency&&(n=n.replace(/\u00A4/g,Ha.defaultCurrency));var p=n.split(";");if(s.nData=Ha.getFormatData(p[1]||"-"+p[0],!0,a.currencySymbol),s.pData=Ha.getFormatData(p[0],!1,a.currencySymbol),r.useGrouping&&(r.groupSeparator=c[Qa[2]],r.groupData=this.getGroupingDetails(p[0])),d(r.minimumFractionDigits)&&(r.minimumFractionDigits=s.nData.minimumFraction),d(r.maximumFractionDigits)){var u=s.nData.maximumFraction;r.maximumFractionDigits=d(u)&&r.isPercent?0:u}var g=r.minimumFractionDigits,m=r.maximumFractionDigits;d(g)||d(m)||g>m&&(r.maximumFractionDigits=g)}return h(s.nData,r),h(s.pData,r),function(t){return isNaN(t)?c[Qa[1]]:isFinite(t)?o.intNumberFormatter(t,s,a):c[Qa[0]]}},t.getGroupingDetails=function(t){var e={},i=t.match(Ha.negativeDataRegex);if(i&&i[4]){var n=i[4],o=n.lastIndexOf(",");if(-1!==o){var r=n.split(".")[0];e.primary=r.length-o-1;var s=n.lastIndexOf(",",o-1);-1!==s&&(e.secondary=o-1-s)}}return e},t.checkValueRange=function(t,e,i,n){var o=n?"f":"s",r=0,s=Ka["l"+o],a=Ka["m"+o];if(d(t)||(this.checkRange(t,s,n),r++),d(e)||(this.checkRange(e,a,n),r++),2===r){if(!(t<e))return!0;v(a+"specified must be less than the"+s)}else i&&1===r&&v("Both"+a+"and"+a+"must be present");return!1},t.checkRange=function(t,e,i){var n=i?[0,20]:[1,21];(t<n[0]||t>n[1])&&v(e+"value must be within the range"+n[0]+"to"+n[1])},t.intNumberFormatter=function(t,e,i){var n;if(!d(e.nData.type)){t<0?(t*=-1,n=e.nData):n=0===t?e.zeroData||e.pData:e.pData;var o="";return n.isPercent&&(t*=100),n.groupOne?o=this.processSignificantDigits(t,n.minimumSignificantDigits,n.maximumSignificantDigits):(o=this.processFraction(t,n.minimumFractionDigits,n.maximumFractionDigits),n.minimumIntegerDigits&&(o=this.processMinimumIntegers(o,n.minimumIntegerDigits))),"scientific"===n.type&&(o=(o=t.toExponential(n.maximumFractionDigits)).replace("e",i.numberMapper.numberSymbols[Qa[4]])),o=o.replace(".",i.numberMapper.numberSymbols[Qa[3]]),n.useGrouping&&(o=this.groupNumbers(o,n.groupData.primary,n.groupSeparator||",",i.numberMapper.numberSymbols[Qa[3]]||".",n.groupData.secondary)),o=Za.convertValueParts(o,Ha.latnParseRegex,i.numberMapper.mapper),"N/A"===n.nlead?n.nlead:n.nlead+o+n.nend}},t.processSignificantDigits=function(t,e,i){var n=t+"";return n.length<e?t.toPrecision(e):(n=t.toPrecision(i),+n+"")},t.groupNumbers=function(t,e,i,n,o){for(var r=!c(o)&&0!==o,s=t.split(n),a=s[0],l=a.length,h="";l>e;)h=a.slice(l-e,l)+(h.length?i+h:""),l-=e,r&&(e=o,r=!1);return s[0]=a.slice(0,l)+(h.length?i:"")+h,s.join(n)},t.processFraction=function(t,e,i){var n=(t+"").split(".")[1],o=n?n.length:0;if(e&&o<e){var r="";if(0!==o){r+=t;for(var s=0;s<e-o;s++)r+="0";return r}return r=t.toFixed(e),t.toFixed(e)}return!c(i)&&(o>i||0===i)?t.toFixed(i):t+""},t.processMinimumIntegers=function(t,e){var i=t.split("."),n=i[0],o=n.length;if(o<e){for(var r=0;r<e-o;r++)n="0"+n;i[0]=n}return i.join(".")},t}();!function(t){function e(e,i,o){var r,s=o||"date";if(-1!==t.basicPatterns.indexOf(e)){if(r=n(s+"Formats."+e,i),"dateTime"===s){var a=n("dateFormats."+e,i),l=n("timeFormats."+e,i);r=r.replace("{1}",a).replace("{0}",l)}}else r=n("dateTimeFormats.availableFormats."+e,i);return r}function i(e,i,o){var r={};return r.parserObject=Za.getMainObject(e,i)||t.defaultObject,o?r.numericObject=n("numbers",r.parserObject):r.dateObject=n("dates.calendars.gregorian",r.parserObject),r}function o(t,e,i,o){return n(t+"Formats-numberSystem-"+e+(o?".accounting":".standard"),i)||(o?n(t+"Formats-numberSystem-"+e+".standard",i):"")}function r(e){var i=e.match(t.formatRegex),n={},o=i[1].toUpperCase();return n.isAccount="A"===o,n.type=t.patternMatcher[o],e.length>1&&(n.fractionDigits=parseInt(i[2],10)),n}function s(e,i,n,o){var r=o?{}:{nlead:"",nend:""},s=e.match(t.customRegex);if(s){o||(r.nlead=a(s[1],n),r.nend=a(s[10],n),r.groupPattern=s[4]);var l=s[7];if(l&&i){var h=l.match(w);c(h)?r.minimumFraction=0:r.minimumFraction=h.length,r.maximumFraction=l.length-1}}return r}function a(e,i){return e?e.replace(t.defaultCurrency,i):""}function l(t,e){return n("currencies."+e+".symbol",t)||"$"}function d(t,e,i){for(var n={},o=t.split(";"),r=["pData","nData","zeroData"],s=0;s<o.length;s++)n[r[s]]=p(o[s],e,i);return c(n.nData)&&(n.nData=h({},n.pData),n.nData.nlead=c(e)?"-"+n.nData.nlead:e.minusSymbol+n.nData.nlead),n}function p(e,i,n){var r={type:"decimal",minimumFractionDigits:0,maximumFractionDigits:0},s=e.match(t.customRegex);(c(s)||""===s[5]&&"N/A"!==e)&&(r.type=void 0),r.nlead=s[1],r.nend=s[10];var a=s[6];r.useGrouping=-1!==a.indexOf(","),a=a.replace(/,/g,"");var l=s[7];if(-1!==a.indexOf("0")&&(r.minimumIntegerDigits=a.length-a.indexOf("0")),c(l)||(r.minimumFractionDigits=l.lastIndexOf("0"),r.maximumFractionDigits=l.lastIndexOf("#"),-1===r.minimumFractionDigits&&(r.minimumFractionDigits=0),(-1===r.maximumFractionDigits||r.maximumFractionDigits<r.minimumFractionDigits)&&(r.maximumFractionDigits=r.minimumFractionDigits)),c(i)?h(r,u([r.nlead,r.nend],"%","%")):(h(r,u([r.nlead,r.nend],"$",i.currencySymbol)),r.isCurrency||h(r,u([r.nlead,r.nend],"%",i.percentSymbol))),!c(n)){var d=o(r.type,i.numberMapper.numberSystem,n,!1);r.useGrouping&&(r.groupSeparator=i.numberMapper.numberSymbols[x[2]],r.groupData=Ja.getGroupingDetails(d.split(";")[0])),r.nlead=r.nlead.replace(/\'/g,""),r.nend=r.nend.replace(/\'/g,"")}return r}function u(t,e,i){for(var n={nlead:t[0],nend:t[1]},o=0;o<2;o++){var r=t[o],s=r.indexOf(e);if(-1!==s&&(s<r.indexOf("'")||s>r.lastIndexOf("'"))){n[L[o]]=r.substr(0,s)+i+r.substr(s+1),n[L[e]]=!0,n.type=n.isCurrency?"currency":"percent";break}}return n}function g(t){var e=(n("dateFormats.short",t)||"").match(/[dM]([^dM])[dM]/i);return e?e[1]:"/"}function m(t,o,r,s){var a=i(r,t),l=o.format||e(o.skeleton,a.dateObject,o.type);if(s){if(-1!==(l=l.replace(S,function(t){return C[t]})).indexOf("z")){var h=l.match(/z/g).length,c=void 0,d={timeZone:{}};d.numMapper=Za.getNumberMapper(a.parserObject,Za.getNumberingSystem(r)),d.timeZone=n("dates.timeZoneNames",a.parserObject);var p=(new Date).getTimezoneOffset(),u=h<4?"+H;-H":d.timeZone.hourFormat;u=u.replace(/:/g,d.numMapper.timeSeparator),0===p?c=d.timeZone.gmtZeroFormat:(c=nl.getTimeZoneValue(p,u),c=d.timeZone.gmtFormat.replace(/\{0\}/,c)),l=l.replace(/[z]+/,'"'+c+'"')}l=l.replace(/ $/,"")}return l}function f(e,n,a){var c,d=i(a,e,!0),p={custom:!0},u={},g=(n.format||"").match(t.currencyFormatRegex);if(g){var m={};m.numberMapper=Za.getNumberMapper(d.parserObject,Za.getNumberingSystem(a),!0);var f=l(d.numericObject,n.currency||ul),w=o("currency",m.numberMapper.numberSystem,d.numericObject,/a/i.test(n.format)),x=(w=w.replace(/\u00A4/g,f)).split(";");u.hasNegativePattern=x.length>1,u.nData=s(x[1]||"-"+x[0],!0,f),u.pData=s(x[0],!1,f),g[2]||n.minimumFractionDigits||n.maximumFractionDigits||(c=s(w.split(";")[0],!0,"",!0).minimumFraction)}var S;if(t.formatRegex.test(n.format)||!n.format){if(h(p,r(n.format||"N")),p.custom=!1,S="###0",p.fractionDigits||n.minimumFractionDigits||n.maximumFractionDigits||c){p.fractionDigits&&(n.minimumFractionDigits=n.maximumFractionDigits=p.fractionDigits),S=v(S,c||p.fractionDigits||n.minimumFractionDigits||0,n.maximumFractionDigits||0)}if(n.minimumIntegerDigits&&(S=y(S,n.minimumIntegerDigits)),n.useGrouping&&(S=b(S)),"currency"===p.type){var C=S;S=u.pData.nlead+C+u.pData.nend,u.hasNegativePattern&&(S+=";"+u.nData.nlead+C+u.nData.nend)}"percent"===p.type&&(S+=" %")}else S=n.format.replace(/\'/g,'"');return S}function v(t,e,i){t+=".";for(var n=0;n<e;n++)t+="0";if(e<i)for(var o=i-e,r=0;r<o;r++)t+="#";return t}function y(t,e){for(var i=t.split("."),n="",o=0;o<e;o++)n+="0";return i[1]?n+"."+i[1]:n}function b(t){var e=t.split("."),i=e[0],n=3-i.length%3;t="";for(var o=(i=(n&&1===n?"#":2===n?"##":"")+i).length-1;o>0;o-=3)t=","+i[o-2]+i[o-1]+i[o]+t;return t=t.slice(1),e[1]?t+"."+e[1]:t}t.negativeDataRegex=/^(('[^']+'|''|[^*#@0,.E])*)(\*.)?((([#,]*[0,]*0+)(\.0*[0-9]*#*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,t.customRegex=/^(('[^']+'|''|[^*#@0,.])*)(\*.)?((([0#,]*[0,]*[0#]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,t.latnParseRegex=/0|1|2|3|4|5|6|7|8|9/g;var w=/[0-9]/g;t.defaultCurrency="$";var x=["infinity","nan","group","decimal"],S=/G|M|L|H|c|'| a|yy|y|EEEE|E/g,C={G:"",M:"m",L:"m",H:"h",c:"d","'":'"'," a":" AM/PM",yy:"yy",y:"yyyy",EEEE:"dddd",E:"ddd"};t.formatRegex=/(^[ncpae]{1})([0-1]?[0-9]|20)?$/i,t.currencyFormatRegex=/(^[ca]{1})([0-1]?[0-9]|20)?$/i,t.curWithoutNumberRegex=/(c|a)$/gi;var L={$:"isCurrency","%":"isPercent","-":"isNegative",0:"nlead",1:"nend"};t.dateParseRegex=/([a-z])\1*|'([^']|'')+'|''|./gi,t.basicPatterns=["short","medium","long","full"],t.defaultObject={dates:{calendars:{gregorian:{months:{"stand-alone":{abbreviated:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},narrow:{1:"J",2:"F",3:"M",4:"A",5:"M",6:"J",7:"J",8:"A",9:"S",10:"O",11:"N",12:"D"},wide:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}}},days:{"stand-alone":{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},narrow:{sun:"S",mon:"M",tue:"T",wed:"W",thu:"T",fri:"F",sat:"S"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}}},dayPeriods:{format:{wide:{am:"AM",pm:"PM"}}},eras:{eraNames:{0:"Before Christ","0-alt-variant":"Before Common Era",1:"Anno Domini","1-alt-variant":"Common Era"},eraAbbr:{0:"BC","0-alt-variant":"BCE",1:"AD","1-alt-variant":"CE"},eraNarrow:{0:"B","0-alt-variant":"BCE",1:"A","1-alt-variant":"CE"}},dateFormats:{full:"EEEE, MMMM d, y",long:"MMMM d, y",medium:"MMM d, y",short:"M/d/yy"},timeFormats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats:{full:"{1} 'at' {0}",long:"{1} 'at' {0}",medium:"{1}, {0}",short:"{1}, {0}",availableFormats:{d:"d",E:"ccc",Ed:"d E",Ehm:"E h:mm a",EHm:"E HH:mm",Ehms:"E h:mm:ss a",EHms:"E HH:mm:ss",Gy:"y G",GyMMM:"MMM y G",GyMMMd:"MMM d, y G",GyMMMEd:"E, MMM d, y G",h:"h a",H:"HH",hm:"h:mm a",Hm:"HH:mm",hms:"h:mm:ss a",Hms:"HH:mm:ss",hmsv:"h:mm:ss a v",Hmsv:"HH:mm:ss v",hmv:"h:mm a v",Hmv:"HH:mm v",M:"L",Md:"M/d",MEd:"E, M/d",MMM:"LLL",MMMd:"MMM d",MMMEd:"E, MMM d",MMMMd:"MMMM d",ms:"mm:ss",y:"y",yM:"M/y",yMd:"M/d/y",yMEd:"E, M/d/y",yMMM:"MMM y",yMMMd:"MMM d, y",yMMMEd:"E, MMM d, y",yMMMM:"MMMM y"}}}},timeZoneNames:{hourFormat:"+HH:mm;-HH:mm",gmtFormat:"GMT{0}",gmtZeroFormat:"GMT"}},numbers:{currencies:{USD:{displayName:"US Dollar",symbol:"$","symbol-alt-narrow":"$"},EUR:{displayName:"Euro",symbol:"","symbol-alt-narrow":""},GBP:{displayName:"British Pound","symbol-alt-narrow":""}},defaultNumberingSystem:"latn",minimumGroupingDigits:"1","symbols-numberSystem-latn":{decimal:".",group:",",list:";",percentSign:"%",plusSign:"+",minusSign:"-",exponential:"E",superscriptingExponent:"",perMille:"",infinity:"",nan:"NaN",timeSeparator:":"},"decimalFormats-numberSystem-latn":{standard:"#,##0.###"},"percentFormats-numberSystem-latn":{standard:"#,##0%"},"currencyFormats-numberSystem-latn":{standard:"#,##0.00",accounting:"#,##0.00;(#,##0.00)"},"scientificFormats-numberSystem-latn":{standard:"#E0"}}},t.monthIndex={3:"abbreviated",4:"wide",5:"narrow",1:"abbreviated"},t.month="months",t.days="days",t.patternMatcher={C:"currency",P:"percent",N:"decimal",A:"currency",E:"scientific"},t.getResultantPattern=e,t.getDependables=i,t.getSymbolPattern=o,t.getProperNumericSkeleton=r,t.getFormatData=s,t.getCurrencySymbol=l,t.customFormat=d,t.isCurrencyPercent=u,t.getDateSeparator=g,t.getActualDateTimeFormat=m,t.getActualNumberFormat=f}(Ha||(Ha={}));var $a,tl=["sun","mon","tue","wed","thu","fri","sat"],el={m:"getMinutes",h:"getHours",H:"getHours",s:"getSeconds",d:"getDate"},il={M:"month",d:"day",E:"weekday",c:"weekday",y:"year",m:"minute",h:"hour",H:"hour",s:"second",L:"month",a:"designator",z:"timeZone",Z:"timeZone",G:"era"},nl=function(){function t(){}return t.dateFormat=function(t,e,i){var o=this,r=Ha.getDependables(i,t),s={},a=e.format||Ha.getResultantPattern(e.skeleton,r.dateObject,e.type);if(s.dateSeperator=Ha.getDateSeparator(r.dateObject),d(a))v("Format options or type given must be invalid");else{s.pattern=a,s.numMapper=Za.getNumberMapper(r.parserObject,Za.getNumberingSystem(i));for(var l=0,h=a.match(/\/MMMMM|MMMM|MMM|a|LLL|EEEEE|EEEE|E|K|ccc|G+|z+/gi)||[];l<h.length;l++){var c=h[l],p=c.length,u=c[0];switch("K"===u&&(u="h"),u){case"E":case"c":s.weekday=r.dateObject[Ha.days]["stand-alone"][Ha.monthIndex[p]];break;case"M":case"L":s.month=r.dateObject[Ha.month]["stand-alone"][Ha.monthIndex[p]];break;case"a":s.designator=n("dayPeriods.format.wide",r.dateObject);break;case"G":var g=p<=3?"eraAbbr":4===p?"eraNames":"eraNarrow";s.era=n("eras."+g,r.dateObject);break;case"z":s.timeZone=n("dates.timeZoneNames",r.parserObject)}}}return function(t){return isNaN(t.getDate())?null:o.intDateFormatter(t,s)}},t.intDateFormatter=function(t,e){for(var i="",n=0,o=e.pattern.match(Ha.dateParseRegex);n<o.length;n++){var r=o[n],s=r.length,a=r[0];"K"===a&&(a="h");var l=void 0,h=void 0,c=void 0,d="";switch(a){case"M":case"L":l=t.getMonth()+1,s>2?i+=e.month[l]:h=!0;break;case"E":case"c":i+=e.weekday[tl[t.getDay()]];break;case"H":case"h":case"m":case"s":case"d":h=!0,l=t[el[a]](),"h"===a&&(l=l%12||12);break;case"y":c=!0,d+=t.getFullYear(),2===s&&(d=d.substr(d.length-2));break;case"a":var p=t.getHours()<12?"am":"pm";i+=e.designator[p];break;case"G":var u=t.getFullYear()<0?0:1;i+=e.era[u];break;case"'":i+="''"===r?"'":r.replace(/\'/g,"");break;case"z":var g=t.getTimezoneOffset(),m=s<4?"+H;-H":e.timeZone.hourFormat;m=m.replace(/:/g,e.numMapper.timeSeparator),0===g?i+=e.timeZone.gmtZeroFormat:(c=!0,d=this.getTimeZoneValue(g,m)),d=e.timeZone.gmtFormat.replace(/\{0\}/,d);break;case":":i+=e.numMapper.numberSymbols.timeSeparator;break;case"/":i+=e.dateSeperator;break;default:i+=r}h&&(c=!0,d=this.checkTwodigitNumber(l,s)),c&&(i+=Za.convertValueParts(d,Ha.latnParseRegex,e.numMapper.mapper))}return i},t.checkTwodigitNumber=function(t,e){var i=t+"";return 2===e&&2!==i.length?"0"+i:i},t.getTimeZoneValue=function(t,e){var i=this,n=e.split(";")[t>0?1:0],o=Math.abs(t);return n=n.replace(/HH?|mm/g,function(t){var e=t.length,n=-1!==t.indexOf("H");return i.checkTwodigitNumber(Math.floor(n?o/60:o%60),e)})},t}(),ol=/^[0-9]*$/,rl={minute:"setMinutes",hour:"setHours",second:"setSeconds",day:"setDate",month:"setMonth"},sl=function(){function t(){}return t.dateParser=function(t,e,i){var o,r=this,s=Ha.getDependables(i,t),a=Za.getCurrentNumericOptions(s.parserObject,Za.getNumberingSystem(i)),l={},h=e.format||Ha.getResultantPattern(e.skeleton,s.dateObject,e.type),p="";if(d(h))v("Format options or type given must be invalid");else{l={pattern:h,evalposition:{}};for(var u=h.match(Ha.dateParseRegex)||[],g=u.length,m=0,f=0,y=!1,b=a.numericRegex,w=0;w<g;w++){var x=u[w],S=x.length,C="K"===x[0]?"h":x[0],L=void 0,E=void 0,P=il[C],k=2===S?"":"?";switch(y&&(m=f,y=!1),C){case"E":case"c":var T=Za.reverseObject(s.dateObject[Ha.days]["stand-alone"][Ha.monthIndex[S]]);p+="("+Object.keys(T).join("|")+")";break;case"M":case"L":case"d":case"m":case"s":case"h":case"H":E=!0,("M"===C||"L"===C)&&S>2?(l[P]=Za.reverseObject(s.dateObject.months["stand-alone"][Ha.monthIndex[S]]),p+="("+Object.keys(l[P]).join("|")+")"):(L=!0,p+="("+b+b+k+")"),"h"===C&&(l.hour12=!0);break;case"y":E=L=!0,p+=2===S?"("+b+b+")":"("+b+"{"+S+",})";break;case"a":E=!0,l[P]=Za.reverseObject(n("dayPeriods.format.wide",s.dateObject)),p+="("+Object.keys(l[P]).join("|")+")";break;case"G":E=!0;var O=S<=3?"eraAbbr":4===S?"eraNames":"eraNarrow";l[P]=Za.reverseObject(n("eras."+O,s.dateObject)),p+="("+Object.keys(l[P]).join("|")+"?)";break;case"z":E=0!==(new Date).getTimezoneOffset(),l[P]=n("dates.timeZoneNames",s.parserObject);var I=l[P],A=(o=S<4)?"+H;-H":I.hourFormat;p+="("+this.parseTimeZoneRegx(A,I,b)+")?",y=!0,f=o?6:12;break;case"'":p+="("+x.replace(/\'/g,"")+")?";break;default:p+="([\\D])"}E&&(l.evalposition[P]={isNumber:L,pos:w+1+m,hourOnly:o}),w!==g-1||c(p)||(l.parserRegex=new RegExp("^"+p+"$"))}}return function(t){var e=r.internalDateParse(t,l,a);return c(e)||!Object.keys(e).length?null:r.getDateObject(e)}},t.getDateObject=function(t,e){var i=e||new Date;i.setMilliseconds(0);var n=["hour","minute","second","month","day"],o=t.year,r=t.designator,s=t.timeZone;d(o)||((o+"").length<=2&&(o+=100*Math.floor(i.getFullYear()/100)),i.setFullYear(o));for(var a=0,l=n;a<l.length;a++){var h=l[a],c=t[h];if(!d(c))if("month"===h){if((c-=1)<0||c>11)return new Date("invalid");var p=i.getDate();i.setDate(1),i[rl[h]](c);var u=new Date(i.getFullYear(),c+1,0).getDate();i.setDate(p<u?p:u)}else{if("day"===h){var g=new Date(i.getFullYear(),i.getMonth()+1,0).getDate();if(c<1||c>g)return null}i[rl[h]](c)}}if(!d(r)){var m=i.getHours();"pm"===r?i.setHours(m+(12===m?0:12)):12===m&&i.setHours(0)}if(!d(s)){var f=s-i.getTimezoneOffset();0!==f&&i.setMinutes(i.getMinutes()+f)}return i},t.internalDateParse=function(t,e,i){var n=t.match(e.parserRegex),o={hour:0,minute:0,second:0};i.numericRegex;if(c(n))return null;for(var r=0,s=Object.keys(e.evalposition);r<s.length;r++){var a=s[r],l=e.evalposition[a],h=n[l.pos];if(l.isNumber)o[a]=this.internalNumberParser(h,i);else if("timeZone"!==a||d(h))o[a]=e[a][h];else{var p=l.pos,u=void 0,g=n[p+1],m=!d(g);l.hourOnly?u=60*this.getZoneValue(m,g,n[p+4],i):(u=60*this.getZoneValue(m,g,n[p+7],i),u+=this.getZoneValue(m,n[p+4],n[p+10],i)),c(u)||(o[a]=u)}}return e.hour12&&(o.hour12=!0),o},t.internalNumberParser=function(t,e){return t=Za.convertValueParts(t,e.numberParseRegex,e.numericPair),ol.test(t)?+t:null},t.parseTimeZoneRegx=function(t,e,i){var n,o,r=e.gmtFormat,s="("+i+")("+i+")";return n=t.replace("+","\\+"),n=-1!==t.indexOf("HH")?n.replace(/HH|mm/g,"("+s+")"):n.replace(/H|m/g,"("+s+"?)"),o=n.split(";").map(function(t){return r.replace("{0}",t)}),n=o.join("|")+"|"+e.gmtZeroFormat},t.getZoneValue=function(t,e,i,n){var o=t?e:i;if(!o)return 0;var r=this.internalNumberParser(o,n);return t?-r:r},t}(),al=["minusSign","infinity"],ll=function(){function t(){}return t.numberParser=function(t,e,i){var n,o=this,r=Ha.getDependables(i,t,!0),s={custom:!0};Ha.formatRegex.test(e.format)||!e.format?(h(s,Ha.getProperNumericSkeleton(e.format||"N")),s.custom=!1):h(s,Ha.customFormat(e.format,null,null)),n=Za.getCurrentNumericOptions(r.parserObject,Za.getNumberingSystem(i),!0),s.symbolRegex=Za.getSymbolRegex(Object.keys(n.symbolMatch)),s.infinity=n.symbolNumberSystem[al[1]];var a=Ha.getSymbolPattern(s.type,n.numberSystem,r.numericObject,s.isAccount);if(a){var l=(a=a.replace(/\u00A4/g,Ha.defaultCurrency)).split(";");s.nData=Ha.getFormatData(l[1]||"-"+l[0],!0,""),s.pData=Ha.getFormatData(l[0],!0,"")}return function(t){return o.getParsedNumber(t,s,n)}},t.getParsedNumber=function(t,e,i){var n,o,r,s,a,l;if(-1!==t.indexOf(e.infinity))return 1/0;t=Za.convertValueParts(t,e.symbolRegex,i.symbolMatch),0===(t=Za.convertValueParts(t,i.numberParseRegex,i.numericPair)).indexOf(".")&&(t="0"+t);var h=t.match(/^([^0-9]*)(([0-9,]*[0-9]+)(\.[0-9]+)?)([Ee][+-]?[0-9]+)?([^0-9]*)$/);if(c(h))return NaN;s=h[1],r=h[2];var d=h[5];return a=h[6],n=e.custom?s===e.nData.nlead&&a===e.nData.nend:-1!==s.indexOf(e.nData.nlead)&&-1!==a.indexOf(e.nData.nend),o=n?e.nData.isPercent:e.pData.isPercent,r=r.replace(/,/g,""),d&&(r+=d),l=+r,("percent"===e.type||o)&&(l/=100),(e.custom||e.fractionDigits)&&(l=parseFloat(l.toFixed(e.custom?n?e.nData.maximumFractionDigits:e.pData.maximumFractionDigits:e.fractionDigits))),n&&(l*=-1),l},t}(),hl=new Da,cl=!1,dl={},pl="en-US",ul="USD",gl=["numericObject","dateObject"],ml=function(){function t(t){t&&(this.culture=t)}return t.prototype.getDateFormat=function(t){return nl.dateFormat(this.getCulture(),t||{type:"date",skeleton:"short"},dl)},t.prototype.getNumberFormat=function(t){return t&&!t.currency&&(t.currency=ul),Ja.numberFormatter(this.getCulture(),t||{},dl)},t.prototype.getDateParser=function(t){return sl.dateParser(this.getCulture(),t||{skeleton:"short",type:"date"},dl)},t.prototype.getNumberParser=function(t){return ll.numberParser(this.getCulture(),t||{format:"N"},dl)},t.prototype.formatNumber=function(t,e){return this.getNumberFormat(e)(t)},t.prototype.formatDate=function(t,e){return this.getDateFormat(e)(t)},t.prototype.parseDate=function(t,e){return this.getDateParser(e)(t)},t.prototype.parseNumber=function(t,e){return this.getNumberParser(e)(t)},t.prototype.getDatePattern=function(t,e){return Ha.getActualDateTimeFormat(this.getCulture(),t,dl,e)},t.prototype.getNumberPattern=function(t){return Ha.getActualNumberFormat(this.getCulture(),t,dl)},t.prototype.getCulture=function(){return this.culture||pl},t}(),fl=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),vl=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},yl=0,bl=0,wl=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.randomId=S(),n.needsID=!1,c(n.enableRtl)&&n.setProperties({enableRtl:cl},!0),c(n.locale)&&n.setProperties({locale:pl},!0),n.moduleLoader=new Ua(n),n.localObserver=new Da(n),n.detectFunction=new Function("args","var prop = Object.keys(args); if(prop.length){this[prop[0]] = args[prop[0]];}"),hl.on("notifyExternalChange",n.detectFunction,n,n.randomId),d(i)||n.appendTo(),n}return fl(e,t),e.prototype.requiredModules=function(){return[]},e.prototype.destroy=function(){this.isDestroyed||(this.enablePersistence&&this.setPersistData(),this.localObserver.destroy(),this.refreshing||(this.trigger("destroyed",{cancel:!1}),t.prototype.destroy.call(this),this.moduleLoader.clean(),hl.off("notifyExternalChange",this.detectFunction,this.randomId)))},e.prototype.refresh=function(){this.refreshing=!0,this.moduleLoader.clean(),this.destroy(),this.clearChanges(),this.localObserver=new Da(this),this.preRender(),this.injectModules(),this.render(),this.refreshing=!1},e.prototype.appendTo=function(e){if(c(e)||"string"!=typeof e?c(e)||(this.element=e):this.element=document.querySelector(e),!c(this.element)){this.isProtectedOnChange=!1,this.needsID&&!this.element.id&&(this.element.id=this.getUniqueID(this.getModuleName())),this.enablePersistence&&(this.mergePersistData(),window.addEventListener("unload",this.setPersistData.bind(this)));var i=n("ej2_instances",this.element);i&&-1!==i.indexOf(this)||t.prototype.addInstance.call(this),this.preRender(),this.injectModules(),this.render(),this.trigger("created")}},e.prototype.dataBind=function(){this.injectModules(),t.prototype.dataBind.call(this)},e.prototype.on=function(t,e,i){if("string"==typeof t)this.localObserver.on(t,e,i);else for(var n=0,o=t;n<o.length;n++){var r=o[n];this.localObserver.on(r.event,r.handler,r.context)}},e.prototype.off=function(t,e){if("string"==typeof t)this.localObserver.off(t,e);else for(var i=0,n=t;i<n.length;i++){var o=n[i];this.localObserver.off(o.event,o.handler)}},e.prototype.notify=function(t,e){!0!==this.isDestroyed&&this.localObserver.notify(t,e)},e.prototype.getInjectedModules=function(){return this.injectedModules},e.Inject=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.prototype.injectedModules||(this.prototype.injectedModules=[]);for(var i=0;i<t.length;i++)-1===this.prototype.injectedModules.indexOf(t[i])&&this.prototype.injectedModules.push(t[i])},e.prototype.injectModules=function(){this.injectedModules&&this.injectedModules.length&&this.moduleLoader.inject(this.requiredModules(),this.injectedModules)},e.prototype.mergePersistData=function(){var t=window.localStorage.getItem(this.getModuleName()+this.element.id);c(t)||""===t||this.setProperties(JSON.parse(t),!0)},e.prototype.setPersistData=function(){this.isDestroyed||window.localStorage.setItem(this.getModuleName()+this.element.id,this.getPersistData())},e.prototype.clearTemplate=function(t){},e.prototype.getUniqueID=function(t){return this.isHistoryChanged()&&(yl=0),$a=this.pageID(location.href),bl=history.length,t+"_"+$a+"_"+yl++},e.prototype.pageID=function(t){var e=0;if(0===t.length)return e;for(var i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e&=e;return Math.abs(e)},e.prototype.isHistoryChanged=function(){return $a!==this.pageID(location.href)||bl!==history.length},e.prototype.addOnPersist=function(t){for(var e=this,i={},r=0,s=t;r<s.length;r++){var a=s[r],l=void 0;d(l=n(a,this))||o(a,this.getActualProperties(l),i)}return JSON.stringify(i,function(t,i){return e.getActualProperties(i)})},e.prototype.getActualProperties=function(t){return t instanceof qa?n("properties",t):t},e.prototype.ignoreOnPersist=function(t){return JSON.stringify(this.iterateJsonProperties(this.properties,t))},e.prototype.iterateJsonProperties=function(t,e){for(var i={},n=this,o=0,r=Object.keys(t);o<r.length;o++)!function(o){if(-1===e.indexOf(o)){var r=t[o];if("object"!=typeof r||r instanceof Array)i[o]=r;else{var s=e.filter(function(t){return new RegExp(o+".").test(t)}).map(function(t){return t.replace(o+".","")});i[o]=n.iterateJsonProperties(n.getActualProperties(r),s)}}}(r[o]);return i},vl([et(!1)],e.prototype,"enablePersistence",void 0),vl([et()],e.prototype,"enableRtl",void 0),vl([et()],e.prototype,"locale",void 0),e=vl([at],e)}(Ba);!function(){"undefined"!=typeof window&&window.addEventListener("popstate",function(){yl=0})}();var xl,Sl=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Cl=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Ll={left:0,top:0,bottom:0,right:0},El=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Sl(e,t),Cl([et(0)],e.prototype,"left",void 0),Cl([et(0)],e.prototype,"top",void 0),e}(qa),Pl=function(t){function e(e,n){var o=t.call(this,n,e)||this;return o.dragLimit=i.getDefaultPosition(),o.borderWidth=i.getDefaultPosition(),o.padding=i.getDefaultPosition(),o.diffX=0,o.diffY=0,o.droppables={},o.bind(),o}return Sl(e,t),i=e,e.prototype.bind=function(){this.toggleEvents(),za.isIE&&E([this.element],"e-block-touch"),this.droppables[this.scope]={}},e.getDefaultPosition=function(){return h({},Ll)},e.prototype.toggleEvents=function(t){var e;d(this.handle)||(e=D(this.handle,this.element)),t?Ma.remove(e||this.element,za.touchStartEvent,this.initialize):Ma.add(e||this.element,za.touchStartEvent,this.initialize,this)},e.prototype.initialize=function(t){if(this.target=t.currentTarget,this.preventDefault&&!d(t.changedTouches)&&t.preventDefault(),!this.abort||c(N(t.target,this.abort))){this.element.setAttribute("aria-grabbed","true");var e=this.getCoordinates(t);if(this.initialPosition={x:e.pageX,y:e.pageY},!this.clone){var i=this.element.getBoundingClientRect();this.relativeXPosition=e.pageX-i.left,this.relativeYPosition=e.pageY-i.top}Ma.add(document,za.touchMoveEvent,this.intDragStart,this),Ma.add(document,za.touchEndEvent,this.intDestroy,this),this.toggleEvents(!0),document.body.classList.add("e-prevent-select"),Ma.trigger(document.documentElement,za.touchStartEvent,t)}},e.prototype.intDragStart=function(t){var e=!d(t.changedTouches);if(!e||1===t.changedTouches.length){e&&t.preventDefault();var i,n=this.getCoordinates(t),o=getComputedStyle(this.element);this.margin={left:parseInt(o.marginLeft,10),top:parseInt(o.marginTop,10),right:parseInt(o.marginRight,10),bottom:parseInt(o.marginBottom,10)};var r=this.element;if(this.clone&&this.dragTarget){var s=N(t.target,this.dragTarget);c(s)||(r=s)}this.offset=this.calculateParentPosition(r),this.position=this.getMousePosition(t);var a=this.initialPosition.x-n.pageX,l=this.initialPosition.y-n.pageY;if(Math.sqrt(a*a+l*l)>=this.distance){var h=this.getHelperElement(t);if(!h||c(h))return;var p=this.helperElement=h;if(this.parentClientRect=this.calculateParentPosition(p.offsetParent),this.dragStart){var u=this.getProperTargetElement(t);this.trigger("dragStart",{event:t,element:r,target:u})}this.dragArea?this.setDragArea():(this.dragLimit={left:0,right:0,bottom:0,top:0},this.borderWidth={top:0,left:0}),i={left:this.position.left-this.parentClientRect.left,top:this.position.top-this.parentClientRect.top},this.clone&&!this.enableTailMode&&(this.diffX=this.position.left-this.offset.left,this.diffY=this.position.top-this.offset.top);var g=this.getProcessedPositionValue({top:i.top-this.diffY+"px",left:i.left-this.diffX+"px"});j(p,this.getDragPosition({position:"absolute",left:g.left,top:g.top})),Ma.remove(document,za.touchMoveEvent,this.intDragStart),Ma.remove(document,za.touchEndEvent,this.intDestroy),T(p)?(Ma.add(document,za.touchMoveEvent,this.intDrag,this),Ma.add(document,za.touchEndEvent,this.intDragStop,this),this.setGlobalDroppables(!1,this.element,p)):(this.toggleEvents(),document.body.classList.remove("e-prevent-select"))}}},e.prototype.elementInViewport=function(t){for(this.top=t.offsetTop,this.left=t.offsetLeft,this.width=t.offsetWidth,this.height=t.offsetHeight;t.offsetParent;)t=t.offsetParent,this.top+=t.offsetTop,this.left+=t.offsetLeft;return this.top>=window.pageYOffset&&this.left>=window.pageXOffset&&this.top+this.height<=window.pageYOffset+window.innerHeight&&this.left+this.width<=window.pageXOffset+window.innerWidth},e.prototype.getProcessedPositionValue=function(t){return this.queryPositionInfo?this.queryPositionInfo(t):t},e.prototype.calculateParentPosition=function(t){if(c(t))return{left:0,top:0};var e=t.getBoundingClientRect(),i=getComputedStyle(t);return{left:e.left+window.pageXOffset-parseInt(i.marginLeft,10),top:e.top+window.pageYOffset-parseInt(i.marginTop,10)}},e.prototype.intDrag=function(t){if(d(t.changedTouches)||1===t.changedTouches.length){var e,i;this.position=this.getMousePosition(t);var n=this.getDocumentWidthHeight("Height");n<this.position.top&&(this.position.top=n);var o=this.getDocumentWidthHeight("Width");if(o<this.position.left&&(this.position.left=o),this.drag){var r=this.getProperTargetElement(t);this.trigger("drag",{event:t,element:this.element,target:r})}var s=this.checkTargetElement(t);s.target&&s.instance?(s.instance.dragData[this.scope]=this.droppables[this.scope],s.instance.intOver(t,s.target),this.hoverObject=s):this.hoverObject&&(this.hoverObject.instance.intOut(t,s.target),this.hoverObject.instance.dragData[this.scope]=null,this.hoverObject=null);var a=this.droppables[this.scope].helper;this.parentClientRect=this.calculateParentPosition(this.helperElement.offsetParent);var l=this.parentClientRect.left,h=this.parentClientRect.top,c=this.getCoordinates(t),p=c.pageX,u=c.pageY,g=this.position.left-this.diffX,m=this.position.top-this.diffY;if(this.dragArea){var f=getComputedStyle(a);if(this.pageX!==p||this.skipDistanceCheck){var v=a.offsetWidth+(parseFloat(f.marginLeft)+parseFloat(f.marginRight));e=this.dragLimit.left>g?this.dragLimit.left:this.dragLimit.right<g+v?this.dragLimit.right-v:g}if(this.pageY!==u||this.skipDistanceCheck){var y=a.offsetHeight+(parseFloat(f.marginTop)+parseFloat(f.marginBottom));i=this.dragLimit.top>m?this.dragLimit.top:this.dragLimit.bottom<m+y?this.dragLimit.bottom-y:m}}else e=g,i=m;var b=h+this.borderWidth.top,w=l+this.borderWidth.left,x=this.getProcessedPositionValue({top:i-b+"px",left:e-w+"px"});j(a,this.getDragPosition(x)),!this.elementInViewport(a)&&this.enableAutoScroll&&this.helperElement.scrollIntoView(),this.position.left=e,this.position.top=i,this.pageX=p,this.pageY=u}},e.prototype.getDragPosition=function(t){var e=h({},t);return this.axis&&("x"===this.axis?delete e.top:"y"===this.axis&&delete e.left),e},e.prototype.getDocumentWidthHeight=function(t){var e=document.body,i=document.documentElement;return Math.max(e["scroll"+t],i["scroll"+t],e["offset"+t],i["offset"+t],i["client"+t])},e.prototype.intDragStop=function(t){if(d(t.changedTouches)||1===t.changedTouches.length){if(-1!==["touchend","pointerup","mouseup"].indexOf(t.type)){if(this.dragStop){var e=this.getProperTargetElement(t);this.trigger("dragStop",{event:t,element:this.element,target:e,helper:this.helperElement})}this.intDestroy(t)}else this.element.setAttribute("aria-grabbed","false");var i=this.checkTargetElement(t);i.target&&i.instance&&(i.instance.dragStopCalled=!0,i.instance.dragData[this.scope]=this.droppables[this.scope],i.instance.intDrop(t,i.target)),this.setGlobalDroppables(!0),document.body.classList.remove("e-prevent-select")}},e.prototype.intDestroy=function(t){this.toggleEvents(),document.body.classList.remove("e-prevent-select"),this.element.setAttribute("aria-grabbed","false"),Ma.remove(document,za.touchMoveEvent,this.intDragStart),Ma.remove(document,za.touchEndEvent,this.intDragStop),Ma.remove(document,za.touchEndEvent,this.intDestroy),Ma.remove(document,za.touchMoveEvent,this.intDrag)},e.prototype.onPropertyChanged=function(t,e){},e.prototype.getModuleName=function(){return"draggable"},e.prototype.setDragArea=function(){var t,e,i,n=0,o=0;if(i="string"===typeof this.dragArea?D(this.dragArea):this.dragArea){var r=i.getBoundingClientRect();t=r.width?r.width:r.right-r.left,e=r.height?r.height:r.bottom-r.top;for(var s=["Top","Left","Bottom","Right"],a=getComputedStyle(i),l=0;l<s.length;l++){var h=s[l],c=a["border"+h+"Width"],d=a["padding"+h],p=h.toLowerCase();this.borderWidth[p]=isNaN(parseFloat(c))?0:parseFloat(c),this.padding[p]=isNaN(parseFloat(d))?0:parseFloat(d)}n=r.top,o=r.left,this.dragLimit.left=o+this.borderWidth.left+this.padding.left,this.dragLimit.top=n+this.borderWidth.top+this.padding.top,this.dragLimit.right=o+t-(this.borderWidth.right+this.padding.right),this.dragLimit.bottom=n+e-(this.borderWidth.bottom+this.padding.bottom)}},e.prototype.getProperTargetElement=function(t){var e,i=this.getCoordinates(t),n=this.helperElement.style.display||"";return f(t.target,this.helperElement)||-1!==t.type.indexOf("touch")?(this.helperElement.style.display="none",e=document.elementFromPoint(i.clientX,i.clientY),this.helperElement.style.display=n):e=t.target,e},e.prototype.getMousePosition=function(t){var e=this.getCoordinates(t),i=this.clone?e.pageX:e.pageX-this.relativeXPosition,n=this.clone?e.pageY:e.pageY-this.relativeYPosition;return{left:i-(this.margin.left+this.cursorAt.left),top:n-(this.margin.top+this.cursorAt.top)}},e.prototype.getCoordinates=function(t){return t.type.indexOf("touch")>-1?t.changedTouches[0]:t},e.prototype.getHelperElement=function(t){var e;return this.clone?this.helper?e=this.helper({sender:t,element:this.target}):(e=L("div",{className:"e-drag-helper e-block-touch",innerHTML:"Draggable"}),document.body.appendChild(e)):e=this.element,e},e.prototype.setGlobalDroppables=function(t,e,i){this.droppables[this.scope]=t?null:{draggable:e,helper:i,draggedElement:this.element}},e.prototype.checkTargetElement=function(t){var e=this.getProperTargetElement(t),i=this.getDropInstance(e);if(!i&&e&&!c(e.parentNode)){var n=N(e.parentNode,".e-droppable")||e.parentElement;n&&(i=this.getDropInstance(n))}return{target:e,instance:i}},e.prototype.getDropInstance=function(t){var e,i=t&&t.ej2_instances;if(i)for(var n=0,o=i;n<o.length;n++){var r=o[n];if("droppable"===r.getModuleName()){e=r;break}}return e},e.prototype.destroy=function(){this.toggleEvents(!0),t.prototype.destroy.call(this)},Cl([it({},El)],e.prototype,"cursorAt",void 0),Cl([et(!0)],e.prototype,"clone",void 0),Cl([et()],e.prototype,"dragArea",void 0),Cl([st()],e.prototype,"drag",void 0),Cl([st()],e.prototype,"dragStart",void 0),Cl([st()],e.prototype,"dragStop",void 0),Cl([et(1)],e.prototype,"distance",void 0),Cl([et()],e.prototype,"handle",void 0),Cl([et()],e.prototype,"abort",void 0),Cl([et()],e.prototype,"helper",void 0),Cl([et("default")],e.prototype,"scope",void 0),Cl([et("")],e.prototype,"dragTarget",void 0),Cl([et()],e.prototype,"axis",void 0),Cl([et()],e.prototype,"queryPositionInfo",void 0),Cl([et(!1)],e.prototype,"enableTailMode",void 0),Cl([et(!1)],e.prototype,"skipDistanceCheck",void 0),Cl([et(!0)],e.prototype,"preventDefault",void 0),Cl([et(!1)],e.prototype,"enableAutoScroll",void 0),e=i=Cl([at],e);var i}(Ba),kl=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Tl=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Ol=function(t){function e(e,i){var n=t.call(this,i,e)||this;return n.mouseOver=!1,n.dragData={},n.dragStopCalled=!1,n.bind(),n}return kl(e,t),e.prototype.bind=function(){this.wireEvents()},e.prototype.wireEvents=function(){Ma.add(this.element,za.touchEndEvent,this.intDrop,this)},e.prototype.onPropertyChanged=function(t,e){},e.prototype.getModuleName=function(){return"droppable"},e.prototype.intOver=function(t,e){if(!this.mouseOver){var i=this.dragData[this.scope];this.trigger("over",{event:t,target:e,dragData:i}),this.mouseOver=!0}},e.prototype.intOut=function(t,e){this.mouseOver&&(this.trigger("out",{evt:t,target:e}),this.mouseOver=!1)},e.prototype.intDrop=function(t,e){if(this.dragStopCalled){this.dragStopCalled=!1;var i,n=!0,o=this.dragData[this.scope],r=!!o&&(o.helper&&T(o.helper));r&&(i=this.isDropArea(t,o.helper,e),this.accept&&(n=F(o.helper,this.accept))),r&&this.drop&&i.canDrop&&n&&this.trigger("drop",{event:t,target:i.target,droppedElement:o.helper,dragData:o}),this.mouseOver=!1}},e.prototype.isDropArea=function(t,e,i){var n={canDrop:!0,target:i||t.target},o="touchend"===t.type;if(o||n.target===e){e.style.display="none";var r=o?t.changedTouches[0]:t,s=document.elementFromPoint(r.clientX,r.clientY);n.canDrop=!1,n.canDrop=f(s,this.element),n.canDrop&&(n.target=s),e.style.display=""}return n},e.prototype.destroy=function(){Ma.remove(this.element,za.touchEndEvent,this.intDrop),t.prototype.destroy.call(this)},Tl([et()],e.prototype,"accept",void 0),Tl([et("default")],e.prototype,"scope",void 0),Tl([st()],e.prototype,"drop",void 0),Tl([st()],e.prototype,"over",void 0),Tl([st()],e.prototype,"out",void 0),e=Tl([at],e)}(Ba),Il=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Al=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Ml={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,space:32,escape:27,pageup:33,pagedown:34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,insert:45,delete:46,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,plus:187,comma:188,minus:189,dot:190,forwardslash:191,graveaccent:192,openbracket:219,backslash:220,closebracket:221,singlequote:222},Rl=function(t){function e(e,n){var o=t.call(this,n,e)||this;return o.keyPressHandler=function(t){for(var e=t.altKey,n=t.ctrlKey,r=t.shiftKey,s=t.which,a=0,l=Object.keys(o.keyConfigs);a<l.length;a++)for(var h=l[a],c=0,d=o.keyConfigs[h].split(",");c<d.length;c++){var p=d[c],u=i.getKeyConfigData(p.trim());e===u.altKey&&n===u.ctrlKey&&r===u.shiftKey&&s===u.keyCode&&(t.action=h,o.keyAction&&o.keyAction(t))}},o.bind(),o}return Il(e,t),i=e,e.prototype.destroy=function(){this.unwireEvents(),t.prototype.destroy.call(this)},e.prototype.onPropertyChanged=function(t,e){},e.prototype.bind=function(){this.wireEvents()},e.prototype.getModuleName=function(){return"keyboard"},e.prototype.wireEvents=function(){this.element.addEventListener(this.eventName,this.keyPressHandler)},e.prototype.unwireEvents=function(){this.element.removeEventListener(this.eventName,this.keyPressHandler)},e.getKeyConfigData=function(t){if(t in this.configCache)return this.configCache[t];var e=t.toLowerCase().split("+"),n={altKey:-1!==e.indexOf("alt"),ctrlKey:-1!==e.indexOf("ctrl"),shiftKey:-1!==e.indexOf("shift"),keyCode:null};return e[e.length-1].length>1&&Number(e[e.length-1])?n.keyCode=Number(e[e.length-1]):n.keyCode=i.getKeyCode(e[e.length-1]),i.configCache[t]=n,n},e.getKeyCode=function(t){return Ml[t]||t.toUpperCase().charCodeAt(0)},e.configCache={},Al([et({})],e.prototype,"keyConfigs",void 0),Al([et("keyup")],e.prototype,"eventName",void 0),Al([st()],e.prototype,"keyAction",void 0),e=i=Al([at],e);var i}(Ba),Dl=function(){function t(t,e,i){this.controlName=t,this.localeStrings=e,this.setLocale(i||pl)}return t.prototype.setLocale=function(e){var i=this.intGetControlConstant(t.locale,e);this.currentLocale=i||this.localeStrings},t.load=function(t){this.locale=h(this.locale,t,{},!0)},t.prototype.getConstant=function(t){return this.currentLocale[t]||this.localeStrings[t]||""},t.prototype.intGetControlConstant=function(t,e){return t[e]?t[e][this.controlName]:null},t.locale={},t}(),Bl=function(){function t(t){this.svgLink="http://www.w3.org/2000/svg",this.rootId=t}return t.prototype.getOptionValue=function(t,e){return t[e]},t.prototype.createSvg=function(t){return c(t.id)&&(t.id=this.rootId+"_svg"),this.svgObj=document.getElementById(t.id),c(document.getElementById(t.id))&&(this.svgObj=document.createElementNS(this.svgLink,"svg")),this.svgObj=this.setElementAttributes(t,this.svgObj),this.setSVGSize(t.width,t.height),this.svgObj},t.prototype.setSVGSize=function(t,e){var i=document.getElementById(this.rootId),n=c(i)?null:i.getBoundingClientRect();c(this.width)||this.width<=0?this.svgObj.setAttribute("width",t?t.toString():n.width.toString()):this.svgObj.setAttribute("width",this.width.toString()),c(this.height)||this.height<=0?this.svgObj.setAttribute("height",e?e.toString():"450"):this.svgObj.setAttribute("height",this.height.toString())},t.prototype.drawPath=function(t){var e=document.getElementById(t.id);return null===e&&(e=document.createElementNS(this.svgLink,"path")),e=this.setElementAttributes(t,e)},t.prototype.drawLine=function(t){var e=document.getElementById(t.id);return null===e&&(e=document.createElementNS(this.svgLink,"line")),e=this.setElementAttributes(t,e)},t.prototype.drawRectangle=function(t){var e=document.getElementById(t.id);return null===e&&(e=document.createElementNS(this.svgLink,"rect")),e=this.setElementAttributes(t,e)},t.prototype.drawCircle=function(t){var e=document.getElementById(t.id);return null===e&&(e=document.createElementNS(this.svgLink,"circle")),e=this.setElementAttributes(t,e)},t.prototype.drawPolyline=function(t){var e=document.getElementById(t.id);return null===e&&(e=document.createElementNS(this.svgLink,"polyline")),e=this.setElementAttributes(t,e)},t.prototype.drawEllipse=function(t){var e=document.getElementById(t.id);return null===e&&(e=document.createElementNS(this.svgLink,"ellipse")),e=this.setElementAttributes(t,e)},t.prototype.drawPolygon=function(t){var e=document.getElementById(t.id);return null===e&&(e=document.createElementNS(this.svgLink,"polygon")),e=this.setElementAttributes(t,e)},t.prototype.drawImage=function(t){var e=document.createElementNS(this.svgLink,"image");return e.setAttributeNS(null,"height",t.height.toString()),e.setAttributeNS(null,"width",t.width.toString()),e.setAttributeNS("http://www.w3.org/1999/xlink","href",t.href),e.setAttributeNS(null,"x",t.x.toString()),e.setAttributeNS(null,"y",t.y.toString()),e.setAttributeNS(null,"id",t.id),e.setAttributeNS(null,"visibility",t.visibility),c(this.getOptionValue(t,"clip-path"))||e.setAttributeNS(null,"clip-path",this.getOptionValue(t,"clip-path")),c(t.preserveAspectRatio)||e.setAttributeNS(null,"preserveAspectRatio",t.preserveAspectRatio),e},t.prototype.createText=function(t,e){var i=document.createElementNS(this.svgLink,"text");return i=this.setElementAttributes(t,i),c(e)||(i.textContent=e),i},t.prototype.createTSpan=function(t,e){var i=document.createElementNS(this.svgLink,"tspan");return i=this.setElementAttributes(t,i),c(e)||(i.textContent=e),i},t.prototype.createTitle=function(t){var e=document.createElementNS(this.svgLink,"title");return e.textContent=t,e},t.prototype.createDefs=function(){return document.createElementNS(this.svgLink,"defs")},t.prototype.createClipPath=function(t){var e=document.createElementNS(this.svgLink,"clipPath");return e=this.setElementAttributes(t,e)},t.prototype.createForeignObject=function(t){var e=document.createElementNS(this.svgLink,"foreignObject");return e=this.setElementAttributes(t,e)},t.prototype.createGroup=function(t){var e=document.createElementNS(this.svgLink,"g");return e=this.setElementAttributes(t,e)},t.prototype.createPattern=function(t,e){var i=document.createElementNS(this.svgLink,e);return i=this.setElementAttributes(t,i)},t.prototype.createRadialGradient=function(t,e,i){var n;if(c(t[0].colorStop))n=t[0].color.toString();else{var o={id:this.rootId+"_"+e+"radialGradient",cx:i.cx+"%",cy:i.cy+"%",r:i.r+"%",fx:i.fx+"%",fy:i.fy+"%"};this.drawGradient("radialGradient",o,t),n="url(#"+this.rootId+"_"+e+"radialGradient)"}return n},t.prototype.createLinearGradient=function(t,e,i){var n;if(c(t[0].colorStop))n=t[0].color.toString();else{var o={id:this.rootId+"_"+e+"linearGradient",x1:i.x1+"%",y1:i.y1+"%",x2:i.x2+"%",y2:i.y2+"%"};this.drawGradient("linearGradient",o,t),n="url(#"+this.rootId+"_"+e+"linearGradient)"}return n},t.prototype.drawGradient=function(t,e,i){var n=this.createDefs(),o=document.createElementNS(this.svgLink,t);o=this.setElementAttributes(e,o);for(var r=0;r<i.length;r++){var s=document.createElementNS(this.svgLink,"stop");s.setAttribute("offset",i[r].colorStop),s.setAttribute("stop-color",i[r].color),s.setAttribute("stop-opacity","1"),o.appendChild(s)}return n.appendChild(o),n},t.prototype.drawClipPath=function(t){var e=this.createDefs(),i=this.createClipPath({id:t.id}),n=this.drawRectangle(t);return i.appendChild(n),e.appendChild(i),e},t.prototype.drawCircularClipPath=function(t){var e=this.createDefs(),i=this.createClipPath({id:t.id}),n=this.drawCircle(t);return i.appendChild(n),e.appendChild(i),e},t.prototype.setElementAttributes=function(t,e){for(var i=Object.keys(t),n=0;n<i.length;n++)e.setAttribute(i[n],t[i[n]]);return e},t}(),Nl=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Hl=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},zl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Nl(e,t),Hl([et(50)],e.prototype,"swipeThresholdDistance",void 0),e}(qa),jl=/(Up|Down)/,Vl=function(t){function e(e,i){var n=t.call(this,i,e)||this;return n.touchAction=!0,n.tapCount=0,n.startEvent=function(t){if(!0===n.touchAction){var e=t.changedTouches?t.changedTouches[0]:t;void 0!==t.changedTouches&&(n.touchAction=!1),n.isTouchMoved=!1,n.movedDirection="",n.startPoint=n.lastMovedPoint={clientX:e.clientX,clientY:e.clientY},n.startEventData=e,n.hScrollLocked=n.vScrollLocked=!1,n.tStampStart=Date.now(),n.timeOutTapHold=setTimeout(function(){n.tapHoldEvent(t)},n.tapHoldThreshold),Ma.add(n.element,za.touchMoveEvent,n.moveEvent,n),Ma.add(n.element,za.touchEndEvent,n.endEvent,n),Ma.add(n.element,za.touchCancelEvent,n.cancelEvent,n)}},n.moveEvent=function(t){var e=t.changedTouches?t.changedTouches[0]:t;n.movedPoint=e,n.isTouchMoved=!(e.clientX===n.startPoint.clientX&&e.clientY===n.startPoint.clientY);var i={};n.isTouchMoved&&(clearTimeout(n.timeOutTapHold),n.calcScrollPoints(t),i=h(i,{},{startEvents:n.startEventData,originalEvent:t,startX:n.startPoint.clientX,startY:n.startPoint.clientY,distanceX:n.distanceX,distanceY:n.distanceY,scrollDirection:n.scrollDirection,velocity:n.getVelocity(e)}),n.trigger("scroll",i),n.lastMovedPoint={clientX:e.clientX,clientY:e.clientY})},n.cancelEvent=function(t){clearTimeout(n.timeOutTapHold),clearTimeout(n.timeOutTap),n.tapCount=0,n.swipeFn(t),Ma.remove(n.element,za.touchCancelEvent,n.cancelEvent)},n.endEvent=function(t){n.swipeFn(t),n.isTouchMoved||"function"==typeof n.tap&&(n.trigger("tap",{originalEvent:t,tapCount:++n.tapCount}),n.timeOutTap=setTimeout(function(){n.tapCount=0},n.tapThreshold)),n.modeclear()},n.swipeFn=function(t){clearTimeout(n.timeOutTapHold),clearTimeout(n.timeOutTap);var e=t;t.changedTouches&&(e=t.changedTouches[0]);var i=e.clientX-n.startPoint.clientX,o=e.clientY-n.startPoint.clientY;i=Math.floor(i<0?-1*i:i),o=Math.floor(o<0?-1*o:i),n.isTouchMoved=i>1||o>1,n.endPoint=e,n.calcPoints(t);var r={originalEvent:t,startEvents:n.startEventData,startX:n.startPoint.clientX,startY:n.startPoint.clientY,distanceX:n.distanceX,distanceY:n.distanceY,swipeDirection:n.movedDirection,velocity:n.getVelocity(e)};if(n.isTouchMoved){var s=void 0,a=n.swipeSettings.swipeThresholdDistance;s=h(s,n.defaultArgs,r);var l=!1,c=n.element,d=n.isScrollable(c),p=jl.test(n.movedDirection);(a<n.distanceX&&!p||a<n.distanceY&&p)&&(l=!d||n.checkSwipe(c,p)),l&&n.trigger("swipe",s)}n.modeclear()},n.modeclear=function(){n.modeClear=setTimeout(function(){n.touchAction=!0},"function"!=typeof n.tap?0:10),n.lastTapTime=(new Date).getTime(),Ma.remove(n.element,za.touchMoveEvent,n.moveEvent),Ma.remove(n.element,za.touchEndEvent,n.endEvent),Ma.remove(n.element,za.touchCancelEvent,n.cancelEvent)},n.bind(),n}return Nl(e,t),e.prototype.onPropertyChanged=function(t,e){},e.prototype.bind=function(){this.wireEvents(),za.isIE&&this.element.classList.add("e-block-touch")},e.prototype.destroy=function(){this.unwireEvents(),t.prototype.destroy.call(this)},e.prototype.wireEvents=function(){Ma.add(this.element,za.touchStartEvent,this.startEvent,this)},e.prototype.unwireEvents=function(){Ma.remove(this.element,za.touchStartEvent,this.startEvent)},e.prototype.getModuleName=function(){return"touch"},e.prototype.isScrollable=function(t){var e=getComputedStyle(t),i=e.overflow+e.overflowX+e.overflowY;return!!/(auto|scroll)/.test(i)},e.prototype.tapHoldEvent=function(t){this.tapCount=0,this.touchAction=!0;var e;Ma.remove(this.element,za.touchMoveEvent,this.moveEvent),Ma.remove(this.element,za.touchEndEvent,this.endEvent),e={originalEvent:t},this.trigger("tapHold",e),Ma.remove(this.element,za.touchCancelEvent,this.cancelEvent)},e.prototype.calcPoints=function(t){var e=t.changedTouches?t.changedTouches[0]:t;this.defaultArgs={originalEvent:t},this.distanceX=Math.abs(Math.abs(e.clientX)-Math.abs(this.startPoint.clientX)),this.distanceY=Math.abs(Math.abs(e.clientY)-Math.abs(this.startPoint.clientY)),this.distanceX>this.distanceY?this.movedDirection=e.clientX>this.startPoint.clientX?"Right":"Left":this.movedDirection=e.clientY<this.startPoint.clientY?"Up":"Down"},e.prototype.calcScrollPoints=function(t){var e=t.changedTouches?t.changedTouches[0]:t;this.defaultArgs={originalEvent:t},this.distanceX=Math.abs(Math.abs(e.clientX)-Math.abs(this.lastMovedPoint.clientX)),this.distanceY=Math.abs(Math.abs(e.clientY)-Math.abs(this.lastMovedPoint.clientY)),(this.distanceX>this.distanceY||!0===this.hScrollLocked)&&!1===this.vScrollLocked?(this.scrollDirection=e.clientX>this.lastMovedPoint.clientX?"Right":"Left",this.hScrollLocked=!0):(this.scrollDirection=e.clientY<this.lastMovedPoint.clientY?"Up":"Down",this.vScrollLocked=!0)},e.prototype.getVelocity=function(t){var e=t.clientX,i=t.clientY,n=Date.now(),o=e-this.startPoint.clientX,r=i-this.startPoint.clientX,s=n-this.tStampStart;return Math.sqrt(o*o+r*r)/s},e.prototype.checkSwipe=function(t,e){var i=["scroll","offset"],n=e?["Height","Top"]:["Width","Left"];return t[i[0]+n[0]]<=t[i[1]+n[0]]||(0===t[i[0]+n[1]]||t[i[1]+n[0]]+t[i[0]+n[1]]>=t[i[0]+n[0]])},Hl([st()],e.prototype,"tap",void 0),Hl([st()],e.prototype,"tapHold",void 0),Hl([st()],e.prototype,"swipe",void 0),Hl([st()],e.prototype,"scroll",void 0),Hl([et(350)],e.prototype,"tapThreshold",void 0),Hl([et(750)],e.prototype,"tapHoldThreshold",void 0),Hl([it({},zl)],e.prototype,"swipeSettings",void 0),e=Hl([at],e)}(Ba),Fl=new RegExp("\\n|\\r|\\s\\s+","g"),_l=new RegExp(/'|"/g),Wl=new RegExp("if ?\\("),Ul=new RegExp("else if ?\\("),ql=new RegExp("else"),Xl=new RegExp("for ?\\("),Yl=new RegExp("(/if|/for)"),Gl=new RegExp("\\((.*)\\)",""),Zl=new RegExp("^[0-9]+$","g"),Kl=new RegExp("[\\w\"'.\\s+]+","g"),Ql=new RegExp('"(.*?)"',"g"),Jl=new RegExp("\\${([^}]*)}","g"),$l=/^[\n\r.]+\<tr|^\<tr/,th=/^[\n\r.]+\<svg|^\<path|^\<g/,eh={compile:(new(function(){function t(){}return t.prototype.compile=function(t,e){return void 0===e&&(e={}),Et(t,e)},t}())).compile},ih=Object.freeze({Ajax:Aa,Animation:Fa,rippleEffect:pt,get isRippleEnabled(){return _a},enableRipple:yt,Base:Ba,getComponent:_,Browser:za,CanvasRenderer:Wa,Component:wl,ChildProperty:qa,Position:El,Draggable:Pl,Droppable:Ol,EventHandler:Ma,onIntlChange:hl,get rightToLeft(){return cl},cldrData:dl,get defaultCulture(){return pl},get defaultCurrencyCode(){return ul},Internationalization:ml,setCulture:bt,setCurrencyCode:wt,loadCldr:xt,enableRtl:St,getNumericObject:Ct,getDefaultDateObject:Lt,KeyboardEvents:Rl,L10n:Dl,ModuleLoader:Ua,Property:et,Complex:it,ComplexFactory:nt,Collection:ot,CollectionFactory:rt,Event:st,NotifyPropertyChanges:at,CreateBuilder:ct,SvgRenderer:Bl,SwipeSettings:zl,Touch:Vl,compile:Tt,setTemplateEngine:Ot,getTemplateEngine:It,createInstance:e,setImmediate:i,getValue:n,setValue:o,deleteObject:r,isObject:s,getEnumValue:a,merge:l,extend:h,isNullOrUndefined:c,isUndefined:d,getUniqueID:p,debounce:u,queryParams:g,isObjectArray:m,compareElementParent:f,throwError:v,print:y,formatUnit:b,getInstance:w,addInstance:x,uniqueID:S,createElement:L,addClass:E,removeClass:P,isVisible:T,prepend:O,append:I,detach:A,remove:M,attributes:R,select:D,selectAll:B,closest:N,siblings:H,getAttributeOrDefault:z,setStyleAttribute:j,classList:V,matches:F,Observer:Da}),nh=function(){function t(t,e){this.width=t,this.height=e}return t.prototype.isEmpty=function(){return 0===this.height&&0===this.width},t.prototype.clone=function(){return new t(this.width,this.height)},t}(),oh=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),rh=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},sh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return oh(e,t),e.equals=function(t,e){return t===e||!(!t||!e)&&(!t||!e||t.x===e.x&&t.y===e.y)},e.isEmptyPoint=function(t){return!t.x||!t.y},e.transform=function(t,e,i){var n={x:0,y:0};return n.x=Math.round(100*(t.x+i*Math.cos(e*Math.PI/180)))/100,n.y=Math.round(100*(t.y+i*Math.sin(e*Math.PI/180)))/100,n},e.findLength=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},e.findAngle=function(t,e){var i=Math.atan2(e.y-t.y,e.x-t.x);return i=180*i/Math.PI,(i%=360)<0&&(i+=360),i},e.distancePoints=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},e.adjustPoint=function(t,e,i,n){var o,r=i?{x:t.x,y:t.y}:{x:e.x,y:e.y};return t.x===e.x?t.y<e.y&&i||t.y>e.y&&!i?r.y+=n:r.y-=n:t.y===e.y?t.x<e.x&&i||t.x>e.x&&!i?r.x+=n:r.x-=n:i?(o=this.findAngle(t,e),r=this.transform(t,o,n)):(o=this.findAngle(e,t),r=this.transform(e,o,n)),r},e.direction=function(t,e){return Math.abs(e.x-t.x)>Math.abs(e.y-t.y)?t.x<e.x?"Right":"Left":t.y<e.y?"Bottom":"Top"},rh([et(0)],e.prototype,"x",void 0),rh([et(0)],e.prototype,"y",void 0),e}(qa),ah=function(){function t(t,e,i,n){this.x=Number.MAX_VALUE,this.y=Number.MAX_VALUE,this.width=0,this.height=0,void 0===t||void 0===e?(t=e=Number.MAX_VALUE,i=n=0):(void 0===i&&(i=0),void 0===n&&(n=0)),this.x=t,this.y=e,this.width=i,this.height=n}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topLeft",{get:function(){return{x:this.left,y:this.top}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topRight",{get:function(){return{x:this.right,y:this.top}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomLeft",{get:function(){return{x:this.left,y:this.bottom}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomRight",{get:function(){return{x:this.right,y:this.bottom}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"middleLeft",{get:function(){return{x:this.left,y:this.y+this.height/2}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"middleRight",{get:function(){return{x:this.right,y:this.y+this.height/2}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topCenter",{get:function(){return{x:this.x+this.width/2,y:this.top}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomCenter",{get:function(){return{x:this.x+this.width/2,y:this.bottom}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"center",{get:function(){return{x:this.x+this.width/2,y:this.y+this.height/2}},enumerable:!0,configurable:!0}),t.prototype.equals=function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height},t.prototype.uniteRect=function(t){var e=Math.max(Number.NaN===this.right||this.x===Number.MAX_VALUE?t.right:this.right,t.right),i=Math.max(Number.NaN===this.bottom||this.y===Number.MAX_VALUE?t.bottom:this.bottom,t.bottom);return this.x=Math.min(this.left,t.left),this.y=Math.min(this.top,t.top),this.width=e-this.x,this.height=i-this.y,this},t.prototype.unitePoint=function(t){if(this.x===Number.MAX_VALUE)return this.x=t.x,void(this.y=t.y);var e=Math.min(this.left,t.x),i=Math.min(this.top,t.y),n=Math.max(this.right,t.x),o=Math.max(this.bottom,t.y);this.x=e,this.y=i,this.width=n-this.x,this.height=o-this.y},t.prototype.Inflate=function(t){return this.x-=t,this.y-=t,this.width+=2*t,this.height+=2*t,this},t.prototype.intersects=function(t){return!(this.right<t.left||this.left>t.right||this.top>t.bottom||this.bottom<t.top)},t.prototype.containsRect=function(t){return this.left<=t.left&&this.right>=t.right&&this.top<=t.top&&this.bottom>=t.bottom},t.prototype.containsPoint=function(t,e){return void 0===e&&(e=0),this.left-e<=t.x&&this.right+e>=t.x&&this.top-e<=t.y&&this.bottom+e>=t.y},t.toBounds=function(e){for(var i=new t,n=0,o=e;n<o.length;n++){var r=o[n];i.unitePoint(r)}return i},t.empty=new t(Number.MAX_VALUE,Number.MIN_VALUE,0,0),t}();!function(t){t[t.Identity=0]="Identity",t[t.Translation=1]="Translation",t[t.Scaling=2]="Scaling",t[t.Unknown=4]="Unknown"}(xl||(xl={}));var lh,hh=function(){function t(t,e,i,n,o,r,s){this.m11=t,this.m12=e,this.m21=i,this.m22=n,this.offsetX=o,this.offsetY=r,this.type=s}return t}(),ch=function(){function t(){}return t.getContext=function(t){return t.getContext("2d")},t.setCanvasSize=function(t,e,i){t&&(t.setAttribute("width",e.toString()),t.setAttribute("height",i.toString()))},t.prototype.renderGradient=function(t,e,i,n){var o,r,s;if("None"!==t.gradient.type){for(h=0;h<t.gradient.stops.length;h++)o=void 0!==o?t.gradient.stops[h].offset:Math.max(o,t.gradient.stops[h].offset),r=void 0!==r?t.gradient.stops[h].offset:Math.min(r,t.gradient.stops[h].offset);if("Linear"===t.gradient.type){var a=t.gradient;s=e.createLinearGradient(i+a.x1,n+a.y1,i+a.x2,n+a.y2)}else{var l=t.gradient;s=e.createRadialGradient(i+l.fx,n+l.fy,0,i+l.cx,n+l.cy,l.r)}for(var h=0;h<t.gradient.stops.length;h++){var c=t.gradient.stops[h],d=r<0?(o+c.offset)/(2*o):c.offset/o;s.addColorStop(d,c.color)}e.fillStyle=s}return e},t.prototype.renderShadow=function(e,i,n){void 0===n&&(n=null);var o=t.getContext(i);o.save(),o.beginPath(),o.strokeStyle=o.fillStyle=e.shadow.color,o.globalAlpha=e.shadow.opacity;var r={x:0,y:0},s=sh.transform(r,e.shadow.angle,e.shadow.distance),a=e.x+s.x,l=e.y+s.y,h=a+e.width*e.pivotX,c=l+e.height*e.pivotY;this.rotateContext(i,e.angle,h,c),n?(o.translate(a,l),this.renderPath(i,e,n),o.translate(-a,-l)):(o.rect(a,l,e.width,e.height),o.fillRect(a,l,e.width,e.height)),o.fill(),o.stroke(),o.closePath(),o.restore()},t.createCanvas=function(t,e,i){var n=document.createElement("canvas");return n.setAttribute("id",t),this.setCanvasSize(n,e,i),n},t.prototype.setStyle=function(e,i){var n=t.getContext(e);"none"===i.fill&&(i.fill="transparent"),"none"===i.stroke&&(i.stroke="transparent"),n.strokeStyle=i.stroke,n.lineWidth=i.strokeWidth,0===i.strokeWidth&&(n.strokeStyle="transparent"),n.globalAlpha=i.opacity;var o=[];i.dashArray&&(o=this.parseDashArray(i.dashArray)),n.setLineDash(o),i.gradient&&"None"!==i.gradient.type?this.renderGradient(i,n,0,0):n.fillStyle=i.fill},t.prototype.rotateContext=function(e,i,n,o){var r=t.getContext(e);r.translate(n,o),r.rotate(i*Math.PI/180),r.translate(-n,-o)},t.prototype.setFontStyle=function(e,i){var n=t.getContext(e),o="";i.italic&&(o+="italic "),i.bold&&(o+="bold "),o+=i.fontSize+"px ",o+=i.fontFamily,n.font=o},t.prototype.parseDashArray=function(t){for(var e=[],i=-1!==t.indexOf(" ")?" ":",",n=0,o=t.split(i);n<o.length;n++){var r=o[n];e.push(Number(r))}return e},t.prototype.drawRectangle=function(e,i){if(!0===i.visible)if(i.cornerRadius)i.data=Rt(i.cornerRadius,i.height,i.width),this.drawPath(e,i);else{var n=t.getContext(e);i.shadow&&this.renderShadow(i,e),n.save(),n.beginPath();i.cornerRadius;var o=i.x+i.width*i.pivotX,r=i.y+i.height*i.pivotY;this.rotateContext(e,i.angle,o,r),this.setStyle(e,i),n.rect(i.x,i.y,i.width,i.height),n.fillRect(i.x,i.y,i.width,i.height),n.fill(),n.stroke(),n.closePath(),n.restore()}},t.prototype.drawPath=function(e,i){var n=[];n=Bt(n=At(i.data)),i.shadow&&this.renderShadow(i,e,n);var o=t.getContext(e);o.save(),o.beginPath();var r=i.y+i.height*i.pivotY,s=i.x+i.width*i.pivotX;this.rotateContext(e,i.angle,s,r),this.setStyle(e,i),o.translate(i.x,i.y),this.renderPath(e,i,n),o.fill(),o.translate(-i.x,-i.y),o.stroke(),o.restore()},t.prototype.renderPath=function(e,i,n){if(!0===i.visible){var o,r=t.getContext(e),s=void 0,a=void 0,l=void 0,h=void 0,c=void 0,d=void 0,p=void 0,u=void 0,g=void 0,m=n;for(p=0,u=0,g=0,o=m.length;g<o;++g){var f=m[g],v=f.command;switch("x1"in f&&(l=f.x1),"x2"in f&&(c=f.x2),"y1"in f&&(h=f.y1),"y2"in f&&(d=f.y2),"x"in f&&(p=f.x),"y"in f&&(u=f.y),v){case"M":r.moveTo(p,u),f.x=p,f.y=u;break;case"L":r.lineTo(p,u),f.x=p,f.y=u;break;case"C":r.bezierCurveTo(l,h,c,d,p,u),f.x=p,f.y=u,f.x1=l,f.y1=h,f.x2=c,f.y2=d;break;case"Q":r.quadraticCurveTo(l,h,p,u),f.x=p,f.y=u,f.x1=l,f.y1=h;break;case"A":var y={x:s,y:a},b=f.r1,w=f.r2,x=f.angle*(Math.PI/180),S=f.largeArc,C=f.sweep,L={x:p,y:u},E={x:Math.cos(x)*(y.x-L.x)/2+Math.sin(x)*(y.y-L.y)/2,y:-Math.sin(x)*(y.x-L.x)/2+Math.cos(x)*(y.y-L.y)/2},P=Math.pow(E.x,2)/Math.pow(b,2)+Math.pow(E.y,2)/Math.pow(w,2);P>1&&(b*=Math.sqrt(P),w*=Math.sqrt(P));var k=Math.pow(w,2)*Math.pow(E.x,2),T=(S===C?-1:1)*Math.sqrt((Math.pow(b,2)*Math.pow(w,2)-Math.pow(b,2)*Math.pow(E.y,2)-k)/(Math.pow(b,2)*Math.pow(E.y,2)+Math.pow(w,2)*Math.pow(E.x,2)));isNaN(T)&&(T=0);var O={x:T*b*E.y/w,y:T*-w*E.x/b},I={x:(y.x+L.x)/2+Math.cos(x)*O.x-Math.sin(x)*O.y,y:(y.y+L.y)/2+Math.sin(x)*O.x+Math.cos(x)*O.y},A=this.a([1,0],[(E.x-O.x)/b,(E.y-O.y)/w]),M=[(E.x-O.x)/b,(E.y-O.y)/w],R=[(-E.x-O.x)/b,(-E.y-O.y)/w],D=this.a(M,R);if(this.r(M,R)<=-1&&(D=Math.PI),this.r(M,R)>=1&&(D=0),f.centp=I,f.xAxisRotation=x,f.rx=b,f.ry=w,f.a1=A,f.ad=D,f.sweep=C,null!=r){var B=b>w?b:w,N=b>w?1:b/w,H=b>w?w/b:1;r.save(),r.translate(I.x,I.y),r.rotate(x),r.scale(N,H),r.arc(0,0,B,A,A+D,!C),r.scale(1/N,1/H),r.rotate(-x),r.translate(-I.x,-I.y),r.restore()}break;case"Z":case"z":r.closePath(),p=s,u=a}s=p,a=u}}},t.prototype.drawText=function(e,i){if(i.content&&!0===i.visible){var n=t.getContext(e);n.save(),this.setStyle(e,i);var o=i.x+i.width*i.pivotX,r=i.y+i.height*i.pivotY;this.rotateContext(e,i.angle,o,r),this.setFontStyle(e,i);var s=0,a=[];a=i.childNodes;var l=i.wrapBounds;if(n.fillStyle=i.color,l){var h=this.labelAlign(i,l,a);for(s=0;s<a.length;s++){var c=a[s],d=h.x+c.x-l.x,p=h.y+c.dy*s+.8*i.fontSize;if(l.width>i.width&&"Wrap"!==i.textOverflow&&(c.text=de(c.text,i)),n.fillText(c.text,d,p),"Underline"===i.textDecoration||"Overline"===i.textDecoration||"LineThrough"===i.textDecoration){var u=d,g=void 0,m=d+n.measureText(c.text).width,f=void 0;switch(i.textDecoration){case"Underline":g=p+2,f=p+2;break;case"Overline":g=h.y+c.dy*s,f=h.y+c.dy*s;break;case"LineThrough":g=(p+h.y+c.dy*s)/2+2,f=(p+h.y+c.dy*s)/2+2}n.beginPath(),n.moveTo(u,g),n.lineTo(m,f),n.strokeStyle=i.color,n.lineWidth=.08*i.fontSize,n.globalAlpha=i.opacity,n.stroke()}}}n.restore()}},t.prototype.drawImage=function(e,i){if(i.visible){var n=t.getContext(e);n.save();var o=i.x+i.width*i.pivotX,r=i.y+i.height*i.pivotY;(new Image).src=i.source,n.translate(o,r),n.rotate(i.angle*Math.PI/180);var s=new Image;s.src=i.source,this.image(n,s,-i.width/2,-i.height/2,i.width,i.height,i),n.rotate(-i.angle*Math.PI/180),n.translate(-o,-r),n.restore()}},t.prototype.image=function(t,e,i,n,o,r,s){t.beginPath();var a=e.width,l=e.height,h=o,c=r,d=0,p=0;if(s&&"None"!==s.alignment){var u=s.alignment.toLowerCase().substr(1,3),g=s.alignment.toLowerCase().substr(5,3);if("Slice"===s.scale){var m=function(){d=h,p=l*h/a},f=function(){d=a*c/l,p=c};h>c?(m(),c>p&&f()):h===c?a>l?f():m():(f(),h>d&&m());var v=this.getSliceOffset(u,d,h,a),y=this.getSliceOffset(g,p,c,l),b=a-v,w=l-y,x=d-v*(d/a),S=p-y*(p/l),C=document.createElement("canvas");C.setAttribute("width",o.toString()),C.setAttribute("height",r.toString()),C.getContext("2d").drawImage(e,v,y,b,w,0,0,x,S),t.drawImage(C,i,n,o,r)}else if("Meet"===s.scale){var L=l/a,E=c/h;d=E>L?h:c/L,p=E>L?h*L:c,i+=this.getMeetOffset(u,d,h),n+=this.getMeetOffset(g,p,c),t.drawImage(e,0,0,a,l,i,n,d,p)}else t.drawImage(e,i,n,o,r)}else t.drawImage(e,i,n,o,r);t.closePath()},t.prototype.getSliceOffset=function(t,e,i,n){switch(t){case"min":return 0;case"mid":return(e-i)/2*n/e;case"max":return(e-i)*n/e;default:return 0}},t.prototype.getMeetOffset=function(t,e,i){var n=Math.max(e,i),o=Math.min(e,i);switch(t){case"min":return 0;case"mid":return(n-o)/2;case"max":return n-o;default:return 0}},t.prototype.m=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},t.prototype.r=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(this.m(t)*this.m(e))},t.prototype.a=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(this.r(t,e))},t.prototype.labelAlign=function(t,e,i){var n=new nh(e.width,i.length*t.fontSize),o={x:0,y:0},r=t.x,s=t.y,a=.5*t.width,l=.5*t.height;return"left"===t.textAlign?a=0:"center"===t.textAlign?a=e.width>t.width&&("Ellipsis"===t.textOverflow||"Clip"===t.textOverflow)?0:.5*t.width:"right"===t.textAlign&&(a=1*t.width),o.x=r+a+(e?e.x:0),o.y=s+l-n.height/2,o},t}(),dh=function(){function t(){}return t.prototype.renderShadow=function(t,e,i,n){void 0===i&&(i=null);var o,r,s={x:0,y:0},a=sh.transform(s,t.shadow.angle,t.shadow.distance),l=t.x+a.x,h=t.y+a.y;t.width,t.pivotX,t.height,t.pivotY;n&&(r=n.getElementById(e.id+"_shadow")),r||(o=i?"path":"rect",r=document.createElementNS("http://www.w3.org/2000/svg",o),e.appendChild(r));var c={id:e.id+"_shadow",fill:t.shadow.color,stroke:t.shadow.color,opacity:t.shadow.opacity.toString(),transform:"rotate("+t.angle+","+(t.x+t.width*t.pivotX)+","+(t.y+t.height*t.pivotY)+")translate("+(t.x+a.x)+","+(t.y+a.y)+")"};if(n){var d=n.getElementById(e.id);d&&d.insertBefore(r,d.firstChild)}ei(r,c),i?i&&this.renderPath(r,t,i):ei(r,{width:t.width,height:t.height})},t.prototype.parseDashArray=function(t){return[]},t.prototype.drawRectangle=function(t,e,i,n,o,r,s){e.shadow&&!n&&this.renderShadow(e,t,void 0,r);var a;a=e.id===t.id?e.id+"_container":e.id;var l;r&&(l=r.getElementById(a)),l&&!o||(l=document.createElementNS("http://www.w3.org/2000/svg","rect"),t.appendChild(l));var h;r&&!e.shadow&&(h=r.getElementById(e.id+"_groupElement_shadow"))&&h.parentNode.removeChild(h);var c={id:a,x:e.x.toString(),y:e.y.toString(),width:e.width.toString(),height:e.height.toString(),visibility:e.visible?"visible":"hidden",transform:"rotate("+e.angle+","+(e.x+e.width*e.pivotX)+","+(e.y+e.height*e.pivotY)+")",rx:e.cornerRadius||0,ry:e.cornerRadius||0,opacity:e.opacity,"aria-label":s||""};e.class&&(c.class=e.class);s||(c["pointer-events"]="none"),ei(l,c),this.setSvgStyle(l,e,i)},t.prototype.updateSelectionRegion=function(t,e){var i;i=t.parentNode.getElementById(e.id);var n;n={id:e.id,x:e.x.toString(),y:e.y.toString(),width:e.width.toString(),height:e.height.toString(),transform:"rotate("+e.angle+","+(e.x+e.width*e.pivotX)+","+(e.y+e.height*e.pivotY)+")",class:"e-diagram-selected-region"},i||(i=document.createElementNS("http://www.w3.org/2000/svg","rect"),t.appendChild(i)),this.setSvgStyle(i,e),ei(i,n)},t.prototype.createGElement=function(t,e){return Ge(t,e)},t.prototype.drawLine=function(t,e){var i=document.createElementNS("http://www.w3.org/2000/svg","line");this.setSvgStyle(i,e);var n=e.x+e.width*e.pivotX,o=e.y+e.height*e.pivotY,r={id:e.id,x1:e.startPoint.x+e.x,y1:e.startPoint.y+e.y,x2:e.endPoint.x+e.x,y2:e.endPoint.y+e.y,stroke:e.stroke,"stroke-width":e.strokeWidth.toString(),opacity:e.opacity.toString(),transform:"rotate("+e.angle+" "+n+" "+o+")",visibility:e.visible?"visible":"hidden"};e.class&&(r.class=e.class),ei(i,r),t.appendChild(i)},t.prototype.drawCircle=function(t,e,i,n){var o=document.createElementNS("http://www.w3.org/2000/svg","circle");this.setSvgStyle(o,e);var r=e.class||"";i||(r+=" e-disabled");var s={id:e.id,cx:e.centerX,cy:e.centerY,r:e.radius,visibility:e.visible?"visible":"hidden",class:r,"aria-label":n?n["aria-label"]:""};o.style.display=e.visible?"block":"none",ei(o,s),t.appendChild(o)},t.prototype.drawPath=function(t,e,i,n,o,r){var s=Math.floor(10*Math.random()+1);t.id,s.toString();var a=[];a=Bt(a=At(e.data)),e.shadow&&this.renderShadow(e,t,a,o);var l;o&&!e.shadow&&(l=o.getElementById(e.id+"_groupElement_shadow"))&&l.parentNode.removeChild(l);var h;o&&(h=o.getElementById(e.id)),h&&!n||(h=document.createElementNS("http://www.w3.org/2000/svg","path"),t.appendChild(h)),this.renderPath(h,e,a);var c={id:e.id,transform:"rotate("+e.angle+","+(e.x+e.width*e.pivotX)+","+(e.y+e.height*e.pivotY)+")translate("+e.x+","+e.y+")",visibility:e.visible?"visible":"hidden",opacity:e.opacity,"aria-label":r||""};e.class&&(c.class=e.class),ei(h,c),this.setSvgStyle(h,e,i)},t.prototype.renderPath=function(t,e,i){var n,o,r,s,a,l,h,c,d=i,p="";for(a=0,l=0,c=0,h=d.length;c<h;++c){var u=d[c],g=u.command;switch("x1"in u&&(n=u.x1),"x2"in u&&(r=u.x2),"y1"in u&&(o=u.y1),"y2"in u&&(s=u.y2),"x"in u&&(a=u.x),"y"in u&&(l=u.y),g){case"M":p=p+"M"+a.toString()+","+l.toString()+" ";break;case"L":p=p+"L"+a.toString()+","+l.toString()+" ";break;case"C":p=p+"C"+n.toString()+","+o.toString()+","+r.toString()+","+s.toString()+",",p+=a.toString()+","+l.toString()+" ";break;case"Q":p=p+"Q"+n.toString()+","+o.toString()+","+a.toString()+","+l.toString()+" ";break;case"A":p=p+"A"+u.r1.toString()+","+u.r2.toString()+","+u.angle.toString()+",",p+=u.largeArc.toString()+","+u.sweep+","+a.toString()+","+l.toString()+" ";break;case"Z":case"z":p+="Z "}}t.setAttribute("d",p)},t.prototype.setSvgFontStyle=function(t,e){t.style.fontStyle=e.italic?"italic":"normal",t.style.fontWeight=e.bold?"bold":"normal",t.style.fontSize=e.fontSize.toString()+"px",t.style.fontFamily=e.fontFamily},t.prototype.drawText=function(t,e,i,n,o){if(void 0!==e.content){var r=void 0,s=void 0,a=void 0,l=void 0,h=void 0,c=void 0,d=0,p=0,u=0,g=void 0;if(i&&(g=i.getElementById(e.id+"_text")),g){if(e.doWrap)for(;g.firstChild;)g.removeChild(g.firstChild)}else e.doWrap=!0,g=document.createElementNS("http://www.w3.org/2000/svg","text"),"pre-wrap"===e.whiteSpace&&g.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),t.appendChild(g);var m=e.x+e.width*e.pivotX,f=e.y+e.height*e.pivotY;if(e.doWrap)for(this.setSvgStyle(g,e,o),this.setSvgFontStyle(g,e),r=document.createTextNode(e.content),s=e.childNodes,a=e.wrapBounds,l=this.svgLabelAlign(e,a,s),a.width>e.width&&"Wrap"!==e.textOverflow&&(s[0].text=de(e.content,e)),u=0;u<s.length;u++)c=document.createElementNS("http://www.w3.org/2000/svg","tspan"),r=document.createTextNode(s[u].text),h=s[u],d=l.x+h.x-a.x,p=l.y+h.dy*u+.8*e.fontSize,ei(c,{x:d.toString(),y:p.toString()}),g.setAttribute("fill",h.text),c.appendChild(r),g.appendChild(c);e.textDecoration&&"LineThrough"===e.textDecoration&&(e.textDecoration=le(e.textDecoration)),ei(g,{id:e.id+"_text",fill:e.color,visibility:e.visible?"visible":"hidden","text-decoration":e.textDecoration,transform:"rotate("+e.angle+","+m+","+f+")translate("+e.x+","+e.y+")",opacity:e.opacity,"aria-label":n||""})}},t.prototype.drawImage=function(t,e,i){var n;e.id;i&&(n=i.getElementById(e.id+"image")),n||(n=document.createElementNS("http://www.w3.org/2000/svg","image"),t.appendChild(n));var o=new Image;o.src=e.source;var r="None"!==e.scale?e.scale:"",s=e.alignment,a=s.charAt(0).toLowerCase()+s.slice(1);r&&(a+=" "+r.charAt(0).toLowerCase()+r.slice(1)),ei(n,{id:e.id+"image",x:e.x.toString(),y:e.y.toString(),transform:"rotate("+e.angle+","+(e.x+e.width*e.pivotX)+","+(e.y+e.height*e.pivotY)+")",width:e.width.toString(),visibility:e.visible?"visible":"hidden",height:e.height.toString(),preserveAspectRatio:a}),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o.src.toString())},t.prototype.drawHTMLContent=function(t,e,i){var n;if(e){var o=void 0;for(o=0;o<e.childNodes.length;o++)e.childNodes[o].id===t.id+"_html_element"&&(n=e.childNodes[o])}n||((n=Ye("div",{id:t.id+"_html_element",class:"foreign-object"})).appendChild(t.template.cloneNode(!0)),e.appendChild(n)),n.setAttribute("style","height:"+t.actualSize.height+"px; width:"+t.actualSize.width+"px;left:"+t.corners.x+"px; top:"+t.corners.y+"px;position:absolute;transform:rotate("+t.parentTransform+"deg);pointer-events:all;visibility:"+(t.visible?"visible":"hidden")+";")},t.prototype.drawNativeContent=function(t,e,i,n,o){var r,s;o&&(r=o.getElementById(t.id+"_native_element"),s=o.getElementById(t.id+"_clip")),r||((r=document.createElementNS("http://www.w3.org/2000/svg","g")).setAttribute("id",t.id+"_native_element"),r.appendChild(t.template.cloneNode(!0)),e.appendChild(r)),s&&r.removeChild(s),r.setAttribute("style","visibility:"+(t.visible?"visible":"hidden")+";"),this.setNativTransform(t,r,i,n),"Slice"===t.scale&&this.drawClipPath(t,r,i,n,o),ei(r,t.description?{"aria-label":t.description}:{})},t.prototype.setNativTransform=function(t,e,i,n){var o=0!==t.contentSize.width?t.contentSize.width:1,r=0!==t.contentSize.height?t.contentSize.height:1,s=t.templatePosition.x*n/o,a=t.templatePosition.y*i/r;e.setAttribute("transform","rotate("+t.parentTransform+","+t.offsetX+","+t.offsetY+") translate("+(t.offsetX-s-n*t.pivot.x)+","+(t.offsetY-a-i*t.pivot.y)+") scale("+n/o+","+i/r+")")},t.prototype.drawClipPath=function(t,e,i,n,o){var r=t.contentSize.width,s=t.contentSize.height,a=(t.actualSize.width,t.actualSize.height,t.width/(n/r)),l=t.height/(i/s),h=t.templatePosition.x+(t.width>=t.height?0:(r-a)/2),c=t.templatePosition.y+(t.height>=t.width?0:(s-l)/2),d=o.getElementById(t.id+"_clip");(d=document.createElementNS("http://www.w3.org/2000/svg","clipPath")).setAttribute("id",t.id+"_clip"),e.appendChild(d);var p=o.getElementById(t.id+"_clip_rect");return p=document.createElementNS("http://www.w3.org/2000/svg","rect"),d.appendChild(p),ei(p,{id:t.id+"_clip_rect",width:a.toString(),height:l.toString(),x:h.toString(),y:c.toString()}),e.setAttribute("clip-path","url(#"+t.id+"_clip)"),e},t.prototype.renderGradient=function(t,e,i){var n,o,r,s=je(i),a=s.getElementById(i+"gradient_pattern");a||(a=Ge("defs",{id:i+"gradient_pattern"}),s.insertBefore(a,s.firstChild));var l,h;if("None"!==t.gradient.type){for(c=0;c<t.gradient.stops.length;c++)n=n?Math.max(n,t.gradient.stops[c].offset):t.gradient.stops[c].offset,o=o?Math.min(o,t.gradient.stops[c].offset):t.gradient.stops[c].offset;"Linear"===t.gradient.type?((h=t.gradient).id=e.id+"_linear",(r=s.getElementById(e.id+"_linear"))&&r.parentNode.removeChild(r),r=this.createLinearGradient(h),a.appendChild(r)):((l=t.gradient).id=e.id+"_radial",r=s.getElementById(e.id+"_radial"),(r=s.getElementById(e.id+"_linear"))&&r.parentNode.removeChild(r),r=this.createRadialGradient(l),a.appendChild(r));for(var c=0;c<t.gradient.stops.length;c++){var d=t.gradient.stops[c],p=o<0?(n+d.offset)/(2*n):d.offset/n,u=document.createElementNS("http://www.w3.org/2000/svg","stop");ei(u,{offset:p.toString(),style:"stop-color:"+d.color}),r.appendChild(u)}}return r},t.prototype.createLinearGradient=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");return ei(e,{id:t.id,x1:t.x1+"%",y1:t.y1+"%",x2:t.x2+"%",y2:t.y2+"%"}),e},t.prototype.createRadialGradient=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","radialGradient");return ei(e,{id:t.id,cx:t.cx+"%",cy:t.cy+"%",r:t.r+"%",fx:t.fx+"%",fy:t.fy+"%"}),e},t.prototype.setSvgStyle=function(t,e,i){"none"===e.fill&&(e.fill="transparent"),"none"===e.stroke&&(e.stroke="transparent");var n,o=[];void 0!==e.dashArray&&(o=(new ch).parseDashArray(e.dashArray)),n=e.gradient&&"None"!==e.gradient.type?"url(#"+this.renderGradient(e,t,i).id+")":e.fill,e.stroke&&t.setAttribute("stroke",e.stroke),void 0!==e.strokeWidth&&t.setAttribute("stroke-width",e.strokeWidth.toString()),o&&t.setAttribute("stroke-dasharray",o.toString()),n&&t.setAttribute("fill",n)},t.prototype.svgLabelAlign=function(t,e,i){var n=new nh(e.width,i.length*t.fontSize),o={x:0,y:0},r=.5*t.width,s=.5*t.height;return"left"===t.textAlign?r=0:"center"===t.textAlign?r=e.width>t.width&&("Ellipsis"===t.textOverflow||"Clip"===t.textOverflow)?0:.5*t.width:"right"===t.textAlign&&(r=1*t.width),o.x=0+r+(e?e.x:0),o.y=0+s-n.height/2,o},t}();!function(t){t[t.Visible=1]="Visible",t[t.Hidden=2]="Hidden",t[t.Hover=4]="Hover",t[t.Connect=8]="Connect"}(lh||(lh={}));var ph;!function(t){t[t.None=0]="None",t[t.ShowHorizontalLines=1]="ShowHorizontalLines",t[t.ShowVerticalLines=2]="ShowVerticalLines",t[t.ShowLines=3]="ShowLines",t[t.SnapToHorizontalLines=4]="SnapToHorizontalLines",t[t.SnapToVerticalLines=8]="SnapToVerticalLines",t[t.SnapToLines=12]="SnapToLines",t[t.SnapToObject=16]="SnapToObject",t[t.All=31]="All"}(ph||(ph={}));var uh;!function(t){t[t.None=1]="None",t[t.ConnectorSourceThumb=2]="ConnectorSourceThumb",t[t.ConnectorTargetThumb=4]="ConnectorTargetThumb",t[t.ResizeSouthEast=8]="ResizeSouthEast",t[t.ResizeSouthWest=16]="ResizeSouthWest",t[t.ResizeNorthEast=32]="ResizeNorthEast",t[t.ResizeNorthWest=64]="ResizeNorthWest",t[t.ResizeEast=128]="ResizeEast",t[t.ResizeWest=256]="ResizeWest",t[t.ResizeSouth=512]="ResizeSouth",t[t.ResizeNorth=1024]="ResizeNorth",t[t.Rotate=2048]="Rotate",t[t.UserHandle=4096]="UserHandle",t[t.ToolTip=8192]="ToolTip",t[t.ResizeAll=2046]="ResizeAll",t[t.All=16382]="All"}(uh||(uh={}));var gh;!function(t){t[t.None=1]="None",t[t.Select=2]="Select",t[t.Delete=4]="Delete",t[t.Drag=8]="Drag",t[t.DragSourceEnd=16]="DragSourceEnd",t[t.DragTargetEnd=32]="DragTargetEnd",t[t.DragSegmentThumb=64]="DragSegmentThumb",t[t.AllowDrop=128]="AllowDrop",t[t.Bridging=256]="Bridging",t[t.BridgeObstacle=512]="BridgeObstacle",t[t.InheritBridging=1024]="InheritBridging",t[t.PointerEvents=2048]="PointerEvents",t[t.Tooltip=4096]="Tooltip",t[t.InheritTooltip=8192]="InheritTooltip",t[t.Interaction=4218]="Interaction",t[t.ReadOnly=16384]="ReadOnly",t[t.Default=11838]="Default"}(gh||(gh={}));var mh;!function(t){t[t.ReadOnly=2]="ReadOnly",t[t.InheritReadOnly=4]="InheritReadOnly"}(mh||(mh={}));var fh;!function(t){t[t.None=0]="None",t[t.Select=2]="Select",t[t.Drag=4]="Drag",t[t.Rotate=8]="Rotate",t[t.Shadow=16]="Shadow",t[t.PointerEvents=32]="PointerEvents",t[t.Delete=64]="Delete",t[t.InConnect=128]="InConnect",t[t.OutConnect=256]="OutConnect",t[t.Individual=512]="Individual",t[t.Expandable=1024]="Expandable",t[t.AllowDrop=2048]="AllowDrop",t[t.Inherit=78]="Inherit",t[t.ResizeNorthEast=4096]="ResizeNorthEast",t[t.ResizeEast=8192]="ResizeEast",t[t.ResizeSouthEast=16384]="ResizeSouthEast",t[t.ResizeSouth=32768]="ResizeSouth",t[t.ResizeSouthWest=65536]="ResizeSouthWest",t[t.ResizeWest=131072]="ResizeWest",t[t.ResizeNorthWest=262144]="ResizeNorthWest",t[t.ResizeNorth=524288]="ResizeNorth",t[t.Resize=1044480]="Resize",t[t.AspectRatio=1048576]="AspectRatio",t[t.Tooltip=2097152]="Tooltip",t[t.InheritTooltip=4194304]="InheritTooltip",t[t.ReadOnly=8388608]="ReadOnly",t[t.Default=5240814]="Default"}(fh||(fh={}));var vh;!function(t){t[t.Rotate=2]="Rotate",t[t.ConnectorSource=4]="ConnectorSource",t[t.ConnectorTarget=8]="ConnectorTarget",t[t.ResizeNorthEast=16]="ResizeNorthEast",t[t.ResizeEast=32]="ResizeEast",t[t.ResizeSouthEast=64]="ResizeSouthEast",t[t.ResizeSouth=128]="ResizeSouth",t[t.ResizeSouthWest=256]="ResizeSouthWest",t[t.ResizeWest=512]="ResizeWest",t[t.ResizeNorthWest=1024]="ResizeNorthWest",t[t.ResizeNorth=2048]="ResizeNorth",t[t.Default=4094]="Default"}(vh||(vh={}));var yh;!function(t){t[t.None=1]="None",t[t.Bridging=2]="Bridging",t[t.UndoRedo=4]="UndoRedo",t[t.Tooltip=8]="Tooltip",t[t.UserInteraction=16]="UserInteraction",t[t.ApiUpdate=32]="ApiUpdate",t[t.PageEditable=48]="PageEditable",t[t.Zoom=64]="Zoom",t[t.PanX=128]="PanX",t[t.PanY=256]="PanY",t[t.Pan=384]="Pan",t[t.Default=500]="Default"}(yh||(yh={}));var bh;!function(t){t[t.None=0]="None",t[t.SingleSelect=1]="SingleSelect",t[t.MultipleSelect=2]="MultipleSelect",t[t.ZoomPan=4]="ZoomPan",t[t.DrawOnce=8]="DrawOnce",t[t.ContinuousDraw=16]="ContinuousDraw",t[t.Default=3]="Default"}(bh||(bh={}));var wh;!function(t){t[t.Self=1]="Self",t[t.Parent=2]="Parent"}(wh||(wh={}));var xh;!function(t){t[t.Canvas=0]="Canvas",t[t.Svg=1]="Svg"}(xh||(xh={}));var Sh;!function(t){t[t.None=0]="None",t[t.Control=1]="Control",t[t.Meta=1]="Meta",t[t.Alt=2]="Alt",t[t.Shift=4]="Shift"}(Sh||(Sh={}));var Ch;!function(t){t[t.None=null]="None",t[t.Number0=0]="Number0",t[t.Number1=1]="Number1",t[t.Number2=2]="Number2",t[t.Number3=3]="Number3",t[t.Number4=4]="Number4",t[t.Number5=5]="Number5",t[t.Number6=6]="Number6",t[t.Number7=7]="Number7",t[t.Number8=8]="Number8",t[t.Number9=9]="Number9",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.Left=37]="Left",t[t.Up=38]="Up",t[t.Right=39]="Right",t[t.Down=40]="Down",t[t.Escape=27]="Escape",t[t.Space=32]="Space",t[t.PageUp=33]="PageUp",t[t.PageDown=34]="PageDown",t[t.End=35]="End",t[t.Home=36]="Home",t[t.Delete=46]="Delete",t[t.Tab=9]="Tab",t[t.Enter=13]="Enter",t[t.BackSpace=8]="BackSpace",t[t.F1=112]="F1",t[t.F2=113]="F2",t[t.F3=114]="F3",t[t.F4=115]="F4",t[t.F5=116]="F5",t[t.F6=117]="F6",t[t.F7=118]="F7",t[t.F8=119]="F8",t[t.F9=120]="F9",t[t.F10=121]="F10",t[t.F11=122]="F11",t[t.F12=123]="F12",t[t.Star=56]="Star",t[t.Plus=187]="Plus",t[t.Minus=189]="Minus"}(Ch||(Ch={}));var Lh;!function(t){t[t.Render=2]="Render",t[t.PublicMethod=4]="PublicMethod",t[t.ToolAction=8]="ToolAction",t[t.UndoRedo=16]="UndoRedo",t[t.TextEdit=32]="TextEdit",t[t.Group=64]="Group",t[t.Clear=128]="Clear"}(Lh||(Lh={}));var Eh;!function(t){t[t.Zero=0]="Zero",t[t.One=1]="One",t[t.Two=2]="Two",t[t.Three=3]="Three",t[t.Four=4]="Four",t[t.Five=5]="Five"}(Eh||(Eh={}));var Ph;!function(t){t[t.collectionChange=0]="collectionChange",t[t.rotateChange=1]="rotateChange",t[t.positionChange=2]="positionChange",t[t.propertyChange=3]="propertyChange",t[t.selectionChange=4]="selectionChange",t[t.sizeChange=5]="sizeChange",t[t.drop=6]="drop",t[t.sourcePointChange=7]="sourcePointChange",t[t.targetPointChange=8]="targetPointChange",t[t.connectionChange=9]="connectionChange",t[t.animationComplete=10]="animationComplete",t[t.click=11]="click",t[t.doubleClick=12]="doubleClick",t[t.scrollChange=13]="scrollChange",t[t.dragEnter=14]="dragEnter",t[t.dragLeave=15]="dragLeave",t[t.dragOver=16]="dragOver",t[t.textEdit=17]="textEdit",t[t.paletteSelectionChange=18]="paletteSelectionChange",t[t.historyChange=19]="historyChange"}(Ph||(Ph={}));var kh;!function(t){t[t.None=1]="None",t[t.Drag=2]="Drag",t[t.Draw=4]="Draw"}(kh||(kh={}));var Th,Oh,Ih,Ah,Mh,Rh,Dh,Bh=function(){function t(){this.pivot={x:.5,y:.5},this.isDirt=!0,this.visible=!0,this.offsetX=0,this.offsetY=0,this.cornerRadius=0,this.minHeight=void 0,this.minWidth=void 0,this.maxWidth=void 0,this.maxHeight=void 0,this.width=void 0,this.height=void 0,this.rotateAngle=0,this.margin={left:0,right:0,top:0,bottom:0},this.horizontalAlignment="Auto",this.verticalAlignment="Auto",this.relativeMode="Point",this.transform=wh.Self|wh.Parent,this.style={fill:"white",strokeColor:"black",opacity:1,strokeWidth:1},this.desiredSize=new nh,this.actualSize=new nh,this.parentTransform=0,this.isSvgRender=!1,this.bounds=new ah(0,0,0,0),this.corners=new ah(0,0,0,0),this.shadow=null,this.description="",this.staticSize=!1,this.isRectElement=!1,this.position=void 0,this.unitMode=void 0,this.float=!1,this.floatingBounds=void 0,this.id=te()}return t.prototype.setOffsetWithRespectToBounds=function(t,e,i){this.unitMode=i,this.position={x:t,y:e}},t.prototype.getAbsolutePosition=function(t){if(void 0!==this.position)return"Absolute"===this.unitMode?this.position:{x:this.position.x*t.width,y:this.position.y*t.height}},Object.defineProperty(t.prototype,"outerBounds",{get:function(){return this.floatingBounds||this.bounds},set:function(t){this.floatingBounds=t},enumerable:!0,configurable:!0}),t.prototype.measure=function(t){var e=void 0!==this.width?this.width:(t.width||0)-this.margin.left-this.margin.right,i=void 0!==this.height?this.height:(t.height||0)-this.margin.top-this.margin.bottom;return this.desiredSize=new nh(e,i),this.desiredSize=this.validateDesiredSize(this.desiredSize,t),this.desiredSize},t.prototype.arrange=function(t){return this.actualSize=t,this.updateBounds(),this.actualSize},t.prototype.updateBounds=function(){this.bounds=ee(this)},t.prototype.validateDesiredSize=function(t,e){return!this.isRectElement||this.width||this.minWidth||this.maxWidth||(t.width=50),!this.isRectElement||this.height||this.minHeight||this.maxHeight||(t.height=50),(void 0===t||void 0!==this.width&&void 0!==this.height)&&((t=t||new nh).width=void 0===this.width?(e.width||0)-this.margin.left-this.margin.right:this.width,t.height=void 0===this.height?(e.height||0)-this.margin.top-this.margin.bottom:this.height),void 0!==this.minWidth&&(t.width=Math.max(t.width,this.minWidth)),void 0!==this.minHeight&&(t.height=Math.max(t.height,this.minHeight)),void 0!==this.maxWidth&&(t.width=Math.min(t.width,this.maxWidth)),void 0!==this.maxHeight&&(t.height=Math.min(t.height,this.maxHeight)),t},t}(),Nh=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Hh=function(t){function e(){var e=t.call(this)||this;return e.pathData="",e.transformPath=!0,e.absolutePath="",e.absoluteBounds=new ah,e}return Nh(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this.pathData},set:function(t){this.pathData!==t&&(this.pathData=t,this.isDirt=!0)},enumerable:!0,configurable:!0}),e.prototype.getPoints=function(){var t=this;return this.pointTimer||(this.pointTimer=setTimeout(function(){t.points=null,t.pointTimer=null},200)),this.points=this.points||ve(this),ye(this,this.points)},e.prototype.measure=function(t){return this.staticSize&&void 0!==this.width&&void 0!==this.height?this.absoluteBounds=new ah(this.offsetX-this.width*this.pivot.x,this.offsetY-this.height*this.pivot.y,this.width,this.height):this.isDirt&&(this.transformPath||void 0===this.width||void 0===this.height)&&(this.absoluteBounds=be(this.data?this.data:"")),void 0===this.width?this.desiredSize=new nh(this.absoluteBounds.width,this.height||this.absoluteBounds.height):void 0===this.height?this.desiredSize=new nh(this.width||this.absoluteBounds.width,this.absoluteBounds.height):this.desiredSize=new nh(this.width,this.height),this.desiredSize=this.validateDesiredSize(this.desiredSize,t),this.desiredSize},e.prototype.arrange=function(t){return(this.isDirt||this.actualSize.width!==t.width||this.actualSize.height!==t.height)&&(this.isDirt=!0,this.absolutePath=this.updatePath(this.data,this.absoluteBounds,t),this.staticSize||(this.points=null)),this.actualSize=this.desiredSize,this.updateBounds(),this.isDirt=!1,this.actualSize},e.prototype.updatePath=function(t,e,i){var n=!1,o="",r=-e.x,s=-e.y,a=[];return i.width===e.width&&i.height===e.height||(r=i.width/Number(e.width?e.width:1),s=i.height/Number(e.height?e.height:1),n=!0),a=At(t),a=jt(a),o=(n||this.isDirt)&&this.transformPath?Nt(a,r,s,n,e.x,e.y,0,0):Vt(a),n=!1,o},e}(Bh),zh=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),jh=function(t){function e(){var e=t.call(this)||this;return e.imageSource="",e.imageScale="None",e.imageAlign="None",e.stretch="Stretch",e}return zh(e,t),Object.defineProperty(e.prototype,"source",{get:function(){return this.imageSource},set:function(t){this.imageSource=t,this.isDirt=!0},enumerable:!0,configurable:!0}),e.prototype.measure=function(t){return this.isDirt&&("Stretch"!==this.stretch||void 0===this.width&&void 0===this.height)&&(this.contentSize=Pe(this.source,this.contentSize),this.isDirt=!1),void 0!==this.width&&void 0!==this.height?(this.desiredSize=new nh(this.width,this.height),this.contentSize=this.desiredSize):this.desiredSize=this.contentSize,this.desiredSize=this.validateDesiredSize(this.desiredSize,t),this.desiredSize},e.prototype.arrange=function(t){return this.actualSize=new nh(this.desiredSize.width,this.desiredSize.height),this.updateBounds(),this.actualSize},e}(Bh),Vh=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Fh=function(t){function e(){var e=t.call(this)||this;return e.textContent="",e.hyperlink={color:"blue"},e.doWrap=!0,e.textNodes=[],e.style={color:"black",fill:"white",strokeColor:"black",strokeWidth:1,fontFamily:"Arial",fontSize:12,whiteSpace:"CollapseSpace",textWrapping:"WrapWithOverflow",textAlign:"Center",italic:!1,bold:!1,textDecoration:"None",strokeDashArray:"",opacity:5,gradient:null,textOverflow:"Wrap"},e}return Vh(e,t),Object.defineProperty(e.prototype,"content",{get:function(){return this.textContent},set:function(t){this.textContent!==t&&(this.textContent=t,this.isDirt=!0,this.doWrap=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"childNodes",{get:function(){return this.textNodes},set:function(t){this.textNodes=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wrapBounds",{get:function(){return this.textWrapBounds},set:function(t){this.textWrapBounds=t},enumerable:!0,configurable:!0}),e.prototype.refreshTextElement=function(){this.isDirt=!0},e.prototype.measure=function(t){var e;return e=this.isDirt?Ee(this,this.style,this.content,this.width):this.desiredSize,void 0===this.width||void 0===this.height?this.desiredSize=new nh(e.width,e.height):this.desiredSize=new nh(this.width,this.height),this.desiredSize=this.validateDesiredSize(this.desiredSize,t),this.desiredSize},e.prototype.arrange=function(t){return(t.width!==this.actualSize.width||t.height!==this.actualSize.height||this.isDirt)&&(this.doWrap=!0),this.actualSize=t,this.updateBounds(),this.isDirt=!1,this.actualSize},e}(Bh),_h=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Wh=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Uh=function(t){switch(t.type){case"Linear":return Kh;case"Radial":return Qh;default:return Kh}},qh=function(){function t(t,e,i,n){this.left=t,this.right=e,this.top=i,this.bottom=n}return t}(),Xh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _h(e,t),Wh([et(0)],e.prototype,"left",void 0),Wh([et(0)],e.prototype,"right",void 0),Wh([et(0)],e.prototype,"top",void 0),Wh([et(0)],e.prototype,"bottom",void 0),e}(qa),Yh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _h(e,t),Wh([et(45)],e.prototype,"angle",void 0),Wh([et(5)],e.prototype,"distance",void 0),Wh([et(.7)],e.prototype,"opacity",void 0),Wh([et("lightgrey")],e.prototype,"color",void 0),e}(qa),Gh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _h(e,t),Wh([et("")],e.prototype,"color",void 0),Wh([et(0)],e.prototype,"offset",void 0),Wh([et(1)],e.prototype,"opacity",void 0),e}(qa),Zh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _h(e,t),Wh([ot([],Gh)],e.prototype,"stops",void 0),Wh([et("None")],e.prototype,"type",void 0),Wh([et("")],e.prototype,"id",void 0),e}(qa),Kh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _h(e,t),Wh([et(0)],e.prototype,"x1",void 0),Wh([et(0)],e.prototype,"x2",void 0),Wh([et(0)],e.prototype,"y1",void 0),Wh([et(0)],e.prototype,"y2",void 0),e}(Zh),Qh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _h(e,t),Wh([et(0)],e.prototype,"cx",void 0),Wh([et(0)],e.prototype,"cy",void 0),Wh([et(0)],e.prototype,"fx",void 0),Wh([et(0)],e.prototype,"fy",void 0),Wh([et(50)],e.prototype,"r",void 0),e}(Zh),Jh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _h(e,t),Wh([et("white")],e.prototype,"fill",void 0),Wh([et("black")],e.prototype,"strokeColor",void 0),Wh([et("")],e.prototype,"strokeDashArray",void 0),Wh([et(1)],e.prototype,"strokeWidth",void 0),Wh([et(1)],e.prototype,"opacity",void 0),Wh([nt(Uh)],e.prototype,"gradient",void 0),e}(qa),$h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _h(e,t),Wh([et("transparent")],e.prototype,"fill",void 0),e}(Jh),tc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _h(e,t),Wh([et("black")],e.prototype,"color",void 0),Wh([et("Arial")],e.prototype,"fontFamily",void 0),Wh([et(12)],e.prototype,"fontSize",void 0),Wh([et(!1)],e.prototype,"italic",void 0),Wh([et(!1)],e.prototype,"bold",void 0),Wh([et("CollapseSpace")],e.prototype,"whiteSpace",void 0),Wh([et("WrapWithOverflow")],e.prototype,"textWrapping",void 0),Wh([et("Center")],e.prototype,"textAlign",void 0),Wh([et("None")],e.prototype,"textDecoration",void 0),Wh([et("Wrap")],e.prototype,"textOverflow",void 0),e}(Jh),ec=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ic=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.padding=new qh(0,0,0,0),e.desiredBounds=void 0,e.measureChildren=!0,e.prevRotateAngle=0,e}return ec(e,t),e.prototype.hasChildren=function(){return void 0!==this.children&&this.children.length>0},e.prototype.measure=function(t){this.desiredBounds=void 0;var i,n,o=void 0;if(this.hasChildren()){for(var r=0;r<this.children.length;r++){var s="Stretch"===(i=this.children[r]).horizontalAlignment||"Stretch"===i.verticalAlignment;(this.measureChildren||s||i instanceof e&&void 0!==i.measureChildren)&&i.measure(t),n=this.GetChildrenBounds(i),"Stretch"!==i.horizontalAlignment&&"Stretch"!==i.verticalAlignment&&(void 0===this.desiredBounds?this.desiredBounds=n:this.desiredBounds.uniteRect(n))}if(void 0!==this.desiredBounds&&0!==this.rotateAngle){var a={x:this.desiredBounds.x+this.desiredBounds.width*this.pivot.x,y:this.desiredBounds.y+this.desiredBounds.height*this.pivot.y},l=ge(this.rotateAngle,void 0,void 0,a);this.desiredBounds.x=l.x-this.desiredBounds.width*this.pivot.x,this.desiredBounds.y=l.y-this.desiredBounds.height*this.pivot.y}this.desiredBounds&&(o=new nh(this.desiredBounds.width,this.desiredBounds.height))}return o=this.validateDesiredSize(o,t),this.stretchChildren(o),this.desiredSize=o,o},e.prototype.arrange=function(t){var i,n=this.desiredBounds;if(n){this.offsetX,this.offsetY;if(this.offsetX=n.x+n.width*this.pivot.x,this.offsetY=n.y+n.height*this.pivot.y,this.hasChildren())for(var o=0;o<this.children.length;o++){var r=!1;"Stretch"===(i=this.children[o]).horizontalAlignment&&(i.offsetX=this.offsetX,i.parentTransform=this.parentTransform+this.rotateAngle,r=!0),"Stretch"===i.verticalAlignment&&(i.offsetY=this.offsetY,i.parentTransform=this.parentTransform+this.rotateAngle,r=!0),(r||this.measureChildren||i instanceof e&&void 0!==i.measureChildren)&&i.arrange(i.desiredSize)}}return this.actualSize=t,this.updateBounds(),this.prevRotateAngle=this.rotateAngle,t},e.prototype.stretchChildren=function(t){if(this.hasChildren())for(var i=0,n=this.children;i<n.length;i++){var o=n[i];"Stretch"!==o.horizontalAlignment&&void 0!==o.desiredSize.width||(o.desiredSize.width=t.width-o.margin.left-o.margin.right),"Stretch"!==o.verticalAlignment&&void 0!==o.desiredSize.height||(o.desiredSize.height=t.height-o.margin.top-o.margin.bottom),o instanceof e&&o.stretchChildren(o.desiredSize)}},e.prototype.applyPadding=function(t){t.width+=this.padding.left+this.padding.right,t.height+=this.padding.top+this.padding.bottom},e.prototype.findChildOffsetFromCenter=function(t,e){var i=me({x:e.x-t.desiredSize.width/2,y:e.y-t.desiredSize.height/2},t);i=ge(t.rotateAngle,e.x,e.y,i),i=ge(this.rotateAngle+this.parentTransform,this.offsetX,this.offsetY,i),t.offsetX=i.x,t.offsetY=i.y},e.prototype.GetChildrenBounds=function(t){var e;e=t.desiredSize.clone();t.rotateAngle,this.rotateAngle;var i={x:t.offsetX,y:t.offsetY},n=i.x-e.width*t.pivot.x,o=i.y-e.height*t.pivot.y,r=n+e.width,s=o+e.height,a={x:n,y:o},l={x:r,y:o},h={x:n,y:s},c={x:r,y:s};return a=ge(t.rotateAngle,t.offsetX,t.offsetY,a),l=ge(t.rotateAngle,t.offsetX,t.offsetY,l),h=ge(t.rotateAngle,t.offsetX,t.offsetY,h),c=ge(t.rotateAngle,t.offsetX,t.offsetY,c),0!==this.rotateAngle&&(a=ge(-this.rotateAngle,void 0,void 0,a),l=ge(-this.rotateAngle,void 0,void 0,l),h=ge(-this.rotateAngle,void 0,void 0,h),c=ge(-this.rotateAngle,void 0,void 0,c)),ah.toBounds([a,l,h,c])},e}(Bh),nc=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),oc=function(t){function e(){var e=t.call(this)||this;return e.data="",e.scale="Stretch",e}return nc(e,t),Object.defineProperty(e.prototype,"content",{get:function(){return this.data},set:function(t){this.data=t,this.template=ti(this,!1),this.isDirt=!0},enumerable:!0,configurable:!0}),e.prototype.measure=function(t){if(this.isDirt){var e=ke(this.template);this.contentSize=new nh,this.contentSize.width=e.width,this.contentSize.height=e.height;var i=e.x,n=e.y;this.templatePosition={x:i,y:n},this.isDirt=!1}if(void 0===this.width||void 0===this.height){var o=Te(this.template);this.desiredSize=new nh(o.width,o.height)}else this.desiredSize=new nh(this.width,this.height);return this.desiredSize=this.validateDesiredSize(this.desiredSize,t),this.desiredSize},e.prototype.arrange=function(t){return this.actualSize=new nh(this.desiredSize.width,this.desiredSize.height),this.updateBounds(),this.actualSize},e}(Bh),rc=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),sc=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.measureChildren=void 0,e}return rc(e,t),e.prototype.measure=function(e){var i=void 0,n=void 0;if(this.hasChildren()){for(var o=0,r=this.children;o<r.length;o++){var s=r[o];s.measure(e);var a=s.desiredSize.clone();0!==s.rotateAngle&&(a=ue(a,s.rotateAngle));var l=a.width+s.margin.right,h=a.height+s.margin.bottom,c=new ah(s.margin.left,s.margin.top,l,h);s.float&&void 0!==s.getAbsolutePosition(a)||(void 0===n?n=c:n.uniteRect(c))}if(n){var d=0,p=0;d=Math.max(n.left,0),p=Math.max(n.top,0),i=new nh(n.width+d,n.height+p)}}return i=t.prototype.validateDesiredSize.call(this,i,e),t.prototype.stretchChildren.call(this,i),i.width+=this.padding.left+this.padding.right,i.height+=this.padding.top+this.padding.bottom,this.desiredSize=i,i},e.prototype.arrange=function(e){if(this.outerBounds=new ah,this.hasChildren()){var i=void 0,n=void 0;i=this.offsetY-e.height*this.pivot.y+this.padding.top,n=this.offsetX-e.width*this.pivot.x+this.padding.left;for(var o=0,r=this.children;o<r.length;o++){var s=r[o];if(0!=(s.transform&wh.Parent)){s.parentTransform=this.parentTransform+this.rotateAngle;var a=s.desiredSize.clone();0!==s.rotateAngle&&(a=ue(a,s.rotateAngle));var l=void 0,h={x:0,y:0},c=n,d=i;if("Point"===s.relativeMode){var p=s.getAbsolutePosition(e);void 0!==p&&(c+=p.x,d+=p.y)}h={x:(l="Object"===s.relativeMode?this.alignChildBasedOnParent(s,a,e,c,d):this.alignChildBasedOnaPoint(s,c,d)).x+a.width/2,y:l.y+a.height/2},t.prototype.findChildOffsetFromCenter.call(this,s,h)}s.arrange(s.desiredSize),this.outerBounds.uniteRect(s.outerBounds)}}return this.actualSize=e,this.updateBounds(),this.outerBounds.uniteRect(this.bounds),e},e.prototype.alignChildBasedOnParent=function(t,e,i,n,o){switch(t.horizontalAlignment){case"Auto":case"Left":n+=t.margin.left;break;case"Right":n+=i.width-e.width-t.margin.right;break;case"Stretch":case"Center":n+=i.width/2-e.width/2}switch(t.verticalAlignment){case"Auto":case"Top":o+=t.margin.top;break;case"Bottom":o+=i.height-e.height-t.margin.bottom;break;case"Stretch":case"Center":o+=i.height/2-e.height/2}return{x:n,y:o}},e.prototype.alignChildBasedOnaPoint=function(t,e,i){switch(t.horizontalAlignment){case"Auto":case"Left":e+=t.margin.left;break;case"Stretch":case"Center":e-=t.desiredSize.width*t.pivot.x;break;case"Right":e-=t.desiredSize.width+t.margin.right}switch(t.verticalAlignment){case"Auto":case"Top":i+=t.margin.top;break;case"Stretch":case"Center":i-=t.desiredSize.height*t.pivot.y;break;case"Bottom":i-=t.desiredSize.height+t.margin.bottom}return{x:e,y:i}},e}(ic),ac={Rectangle:"M0,0 L50,0 L50,50 L0,50 z",Ellipse:"M80.5,12.5 C80.5,19.127417 62.59139,24.5 40.5,24.5 C18.40861,24.5 0.5,19.127417 0.5,12.5C0.5,5.872583 18.40861,0.5 40.5,0.5 C62.59139,0.5 80.5,5.872583 80.5,12.5 z",Hexagon:"M30,0 L60,0 L90,30 L60,60 L30,60 L0,30 L30,0 z",Parallelogram:"M30,0 L60,0 L45,30 L15,30 z",Triangle:"M45,0 L90,45 L0,45 L45,0 z",Plus:"M696.6084,158.2656 L674.8074,158.2656 L674.8074,136.4656 L658.4084,136.4656 L658.4084,158.2656 L636.6084,158.2656L636.6084,174.6646 L658.4084,174.6646 L658.4084,196.4656 L674.8074,196.4656 L674.8074,174.6646 L696.6084,174.6646L696.6084,158.2656 z",Star:"M540.3643,137.9336 L546.7973,159.7016 L570.3633,159.7296 L550.7723,171.9366 L558.9053,194.9966 L540.3643,179.4996L521.8223,194.9966 L529.9553,171.9366 L510.3633,159.7296 L533.9313,159.7016 L540.3643,137.9336 z",Pentagon:"M30,0 L60,30 L50,70 L10,70 L0,30 L30,0 z",Heptagon:"M223.7783,195.7134 L207.1303,174.8364 L213.0713,148.8034 L237.1303,137.2174 L261.1883,148.8034 L267.1303,174.8364L250.4813,195.7134 L223.7783,195.7134 z",Octagon:"M98.7319,196.4653 L81.1579,178.8923 L81.1579,154.0393 L98.7319,136.4653 L123.5849,136.4653L141.1579,154.0393 L141.1579,178.8923 L123.5849,196.4653 L98.7319,196.4653 z",Trapezoid:"M127.2842,291.4492 L95.0322,291.4492 L81.1582,256.3152 L141.1582,256.3152 L127.2842,291.4492 z",Decagon:"M657.3379,302.4141 L642.3369,291.5161 L636.6089,273.8821 L642.3369,256.2481 L657.3379,245.3511 L675.8789,245.3511L690.8789,256.2481 L696.6089,273.8821L690.8789,291.5161 L675.8789,302.4141 L657.3379,302.4141 z",RightTriangle:"M836.293,292.9238 L776.293,292.9238 L776.293,254.8408 L836.293,292.9238 z",Cylinder:"M 542.802,362.009C 542.802,368.452 525.341,373.676 503.802,373.676C 482.263,373.676 464.802,368.452 464.802,362.009L 464.802,466.484C 464.802,472.928 482.263,478.151 503.802,478.151C 525.341,478.151 542.802,472.928 542.802,466.484L 542.802,362.016C 542.802,368.459 525.341,373.534 503.802,373.534C 482.263,373.534 464.802,368.31 464.802,361.867L 464.802,362.016C 464.802,355.572 482.263,350.349 503.802,350.349C 525.341,350.349 542.802,355.572 542.802,362.016",Diamond:"M397.784,287.875 L369.5,316.159 L341.216,287.875 L369.5,259.591 L397.784,287.875 z"},lc=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),hc=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},cc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return lc(e,t),hc([et("")],e.prototype,"id",void 0),hc([et("Center")],e.prototype,"horizontalAlignment",void 0),hc([et("Center")],e.prototype,"verticalAlignment",void 0),hc([it({},Xh)],e.prototype,"margin",void 0),hc([et(12)],e.prototype,"width",void 0),hc([et(12)],e.prototype,"height",void 0),hc([it({},Jh)],e.prototype,"style",void 0),hc([et("Square")],e.prototype,"shape",void 0),hc([et(lh.Connect)],e.prototype,"visibility",void 0),hc([et("")],e.prototype,"pathData",void 0),hc([et(kh.None)],e.prototype,"constraints",void 0),hc([et()],e.prototype,"addInfo",void 0),e}(qa),dc=function(t){function e(e,i,n,o){return t.call(this,e,i,n,o)||this}return lc(e,t),hc([it({x:.5,y:.5},sh)],e.prototype,"offset",void 0),e}(cc),pc=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uc=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},gc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pc(e,t),uc([et("blue")],e.prototype,"color",void 0),uc([et("")],e.prototype,"content",void 0),uc([et("")],e.prototype,"link",void 0),uc([et("None")],e.prototype,"textDecoration",void 0),e}(qa),mc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pc(e,t),uc([et("")],e.prototype,"content",void 0),uc([et(!0)],e.prototype,"visibility",void 0),uc([et(mh.InheritReadOnly)],e.prototype,"constraints",void 0),uc([it(void 0,gc)],e.prototype,"hyperlink",void 0),uc([et("")],e.prototype,"id",void 0),uc([et()],e.prototype,"width",void 0),uc([et()],e.prototype,"height",void 0),uc([it({strokeWidth:0,strokeColor:"transparent",fill:"transparent"},tc)],e.prototype,"style",void 0),uc([et("Center")],e.prototype,"horizontalAlignment",void 0),uc([et("Center")],e.prototype,"verticalAlignment",void 0),uc([it({},Xh)],e.prototype,"margin",void 0),uc([et("Shape")],e.prototype,"type",void 0),uc([et()],e.prototype,"addInfo",void 0),e}(qa),fc=function(t){function e(e,i,n,o){return t.call(this,e,i,n,o)||this}return pc(e,t),uc([it({x:.5,y:.5},sh)],e.prototype,"offset",void 0),e}(mc),vc=function(t){function e(e,i,n,o){return t.call(this,e,i,n,o)||this}return pc(e,t),uc([et(.5)],e.prototype,"offset",void 0),uc([it({x:0,y:0},sh)],e.prototype,"displacement",void 0),uc([et("Center")],e.prototype,"alignment",void 0),e}(mc),yc={X:"M14,14 L106,106 M106,14 L14,106",Circle:"M0,50 A50,50,0 1 1 100,50 A50,50,0 1 1 0,50 Z",Square:"M0,0 L10,0 L10,10 L0,10 z"},bc={OpenArrow:"M15.9,23 L5,16 L15.9,9 L17,10.7 L8.7,16 L17,21.3Z",Square:"M0,0 L10,0 L10,10 L0,10 z",Fletch:"M14.8,10c0,0-3.5,6,0.2,12c0,0-2.5-6-10.9-6C4.1,16,11.3,16,14.8,10z",OpenFetch:"M6,17c-0.6,0-1-0.4-1-1s0.4-1,1-1c10.9,0,11-5,11-5c0-0.6,0.4-1,1-1s1,0.4,1,1C19,10.3,18.9,17,6,17C6,17,6,17,6,17z M18,23c-0.5,0-1-0.4-1-1c0-0.2-0.3-5-11-5c-0.6,0-1-0.5-1-1s0.4-1,1-1c0,0,0,0,0,0c12.9,0,13,6.7,13,7    C19,22.6,18.6,23,18,23z",IndentedArrow:"M17,10c0,0-4.5,5.5,0,12L5,16L17,10z",OutdentedArrow:"M14.6,10c0,0,5.4,6,0,12L5,16L14.6,10z",DoubleArrow:"M19,10 L19,22 L13,16Z M12,10 L12,22 L6,16Z",Arrow:"M15,10 L15,22 L5,16Z",Diamond:"M12,23l-7-7l7-7l6.9,7L12,23z",Circle:"M0,50 A50,50,0 1 1 100,50 A50,50,0 1 1 0,50 Z"},wc={Process:"M419.511,76.687L359.511,76.687L359.511,43.086L419.511,43.086z",Decision:"M 253.005,115.687L 200.567,146.071L 148.097,115.687L 200.534,85.304L 253.005,115.687 Z",Document:"M 60 31.9 c 0 0 -11 -7.7 -30 0 s -30 0 -30 0 V 0 h 60 V 31.9 Z",PreDefinedProcess:"M 0,0 L 50,0 L 50,50 L 0,50 Z  M 8.334,0 L 8.334,50 M 41.667,0 L 41.667,50",Terminator:"M 269.711,29.33C 269.71,44.061 257.77,56 243.04,56L 158.058,56C 143.33,56 131.39,44.061 131.39,29.33L 131.39,29.33C 131.391,14.6057 143.33,2.669 158.058,2.669L 243.044,2.669C 257.772,2.669 269.711,14.6057 269.711,29.333 Z",PaperTap:"M0.0009,17.2042 L0.0009,47.165 C0.001,47.165 14.403,53.5455 25.00,47.165 C35.599,40.7852 44.403,43.5087 50.00,47.165L50.001,17.2042 M50.001,32.7987 L50.001,2.8405 C50.001,2.8405 35.599,-3.5427 25.001,2.8405C14.403,9.2237 5.599,6.494 0.0009,2.8405 L0.0009,32.7987",DirectData:"M 132.62 0 L 17.38 0 C 7.78 0 0 13.43 0 30 C 0 46.57 7.78 60 17.38 60 L 132.62 60 M 132.62 0C 123.02 0 115.24 13.43 115.24 30 C 115.24 46.57 123.02 60 132.62 60 C 142.22 60 150 46.57 150 30 C 150 13.43 142.22 0 132.62 0 z ",SequentialData:"M0.0029,24.999 C0.0029,11.1922 10.433,0.0021 23.295,0.0021 C36.159,0.00216 46.585,11.1922 46.585,24.999C46.585,38.8057 36.159,49.9979 23.295,49.9979 C10.433,49.9979 0.0029,38.8057 0.0029,24.999 z M23.294,49.999 L50.002,49.999",Sort:"M50.001,24.9971 L25.001,49.9971 L0.00097,24.9971 L25.001,-0.00286865 L50.001,24.9971 z M0.000976562,24.9971 L50.001,24.9971",MultiDocument:"M43.6826,40 C44.8746,40.6183 45.8586,41.3502 46.8366,42.1122 L46.8366,4.74487 L3.09857,4.74487 L3.09857,10.9544 M46.837,35.143 C48.027,35.765 49.025,36.604 50.003,37.369 L50.003,0.002 L6.264,0.002 L6.264,4.744 M43.682,47.113 L43.682,10.765 L0.0025,10.7652 L0.0025,47.1132 C0.0025,47.1132 12.5846,53.6101 21.8426,47.1132 C31.1006,40.6163 38.792,43.393 43.6826,47.1132 z",Collate:"M50.001,0.0028 L25.001,25.0029 L0.00097,0.0028 L50.001,0.002 z M0.0009,50.002 L25.001,25.002L50.001,50.002 L0.0009,50.0029 z",SummingJunction:"M7.3252,42.6768 L42.6772,7.3247 M42.6768,42.6768 L7.3248,7.3247 M0.0009,25.001 C0.0009,11.193 11.197,0.0009 25.001,0.0009 C38.809,0.0009 50.001,11.193 50.001,25.001 C50.001,38.809 38.809,50.001 25.001,50.001 C11.197,50.00 0.0009,38.809 0.0009,25.00 z",Or:"M 0 50 L 100 50 M 50 100 L 50 0.0 M 0 50 C 0 22.384 22.392 0 50 0 C 77.616 0 100 22.384 100 50 C 100 77.616 77.616 100 50 100 C 22.392 100 0 77.616 0 50 Z",InternalStorage:"M 0 3.81946A 2.5,3.81946 0 0,1 2.5,0L 47.5 0A 2.5,3.81946 0 0,1 50,3.81946L 50 45.836A 2.5,3.819446 0 0,1 47.5,49.652778L 2.5 49.652778A 2.5,3.819446 0 0,1 0,45.8336L 0 3.819446ZM 0 11.45834L 50 11.4583334M 12.5 0L 12.5 49.652778",Extract:"M0,35 L30,0 L60,35 Z",ManualOperation:"M46.4,28.8 L14.8,28.8 L0,0 L60,0 Z",Merge:"M60,0 L30,35 L0,0 Z",OffPageReference:"M60,33.3 L30.1,39 L0,33.3 L0,0 L60,0 Z",SequentialAccessStorage:"M 60 30 C 60 13.4 46.6 0 30 0 S 0 13.4 0 30 s 13.4 30 30 30 h 28.6 v -6.5 h -9.9C 55.5 48 60 39.5 60 30 Z",Annotation:"M49.9984,50.0029 L-0.00271199,50.0029 L-0.00271199,0.00286865 L49.9984,0.00286865",Annotation2:"M49.9977,50.0029 L25.416,50.0029 L25.416,0.00286865 L49.9977,0.00286865 M25.4166,25.0029 L-0.00227869,25.0029",Data:"M 10 0 L 40 0 L 30 40 L 0 40 Z",Card:"M275,60 L400,60 L400,110 L260,110 L260,75 Z",Delay:"M0,0 L12.029,0 C14.212999,0 16,1.7869979 16,3.9709952 C16,6.1549926 14.212999,7.9409904 12.029,7.9409904 L0,7.9409904 z",Preparation:"M 1048.17 572 C 1051.06 568.86 1055.17 567.05 1059.5 567 L 1094.51 567 C 1098.84 567.05 1102.95 568.86 1105.84 572 L 1126.43 595 C 1127.01 596.28 1127.01 597.72 1126.43 599 L 1105.84 622 C 1102.95 625.14 1098.84 626.95 1094.51 627 L 1059.5 627 C 1055.17 626.95 1051.06 625.14 1048.17 622 L 1027.58 599 C 1027 597.72 1027 596.28 1027.58 595 L 1048.17 572 Z",Display:"M47.8809,19.2914 L32.7968,-0.00594145 L11.3902,-0.00594145 C7.93166,-0.00594145 0.00124586,11.187 0.00124586,24.9968C0.00124586,38.8032 7.93166,49.9962 11.3902,49.9962 L32.7968,49.99 L47.615,31.038 C47.615,31.0388 52.798,24.9968 47.880,19.2914 z",ManualInput:"M 912 732 L 1006.85 707 C 1008.2 707 1009.5 707.53 1010.46 708.46 C 1011.41 709.4 1011.95 710.67 1011.95 712 L 1011.95 762C 1012 764.41 1010.28 766.52 1007.87 767 L 917.1 767 C 915.75 767 914.45 766.47 913.49 765.54 C 912.54 764.6 912 763.33 912 762 L 912 732 Z",LoopLimit:"M 8 9 L 27 9 L 33 15 L 33 26 C 33 27 33 27 32 27 L 4 27 C 3 27 2 27 2 26 L 2 15 L 8 9 Z",StoredData:"M 5.55 0L 50 0A 1.5,30 0 0,1 50,0A 5.555,25 0 0,0 50,50A 1.5,30 0 0,1 50,50L 5.555 50A 5.55,25 0 0,1 5.555,0Z"},xc=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Sc=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Cc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return xc(e,t),Sc([et("None")],e.prototype,"shape",void 0),Sc([et("white")],e.prototype,"fill",void 0),Sc([et("Auto")],e.prototype,"horizontalAlignment",void 0),Sc([et("Auto")],e.prototype,"verticalAlignment",void 0),Sc([et(10)],e.prototype,"width",void 0),Sc([et(10)],e.prototype,"height",void 0),Sc([it({x:.5,y:1},sh)],e.prototype,"offset",void 0),Sc([et("#1a1a1a")],e.prototype,"borderColor",void 0),Sc([et(1)],e.prototype,"borderWidth",void 0),Sc([it({},Xh)],e.prototype,"margin",void 0),Sc([et("")],e.prototype,"pathData",void 0),Sc([et("")],e.prototype,"content",void 0),Sc([et(0)],e.prototype,"cornerRadius",void 0),Sc([it({left:2,right:2,top:2,bottom:2},Xh)],e.prototype,"padding",void 0),e}(qa),Lc=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ec=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Pc={RTL:"e-rtl",BUTTON:"e-btn",PRIMARY:"e-primary",ICONBTN:"e-icon-btn"},kc=function(t){function e(e,i){return t.call(this,e,i)||this}return Lc(e,t),e.prototype.preRender=function(){},e.prototype.render=function(){this.initialize()},e.prototype.initialize=function(){this.cssClass&&E([this.element],this.cssClass.split(" ")),this.isPrimary&&this.element.classList.add(Pc.PRIMARY),this.content&&(this.element.innerHTML=this.content),this.setIconCss(),this.enableRtl&&this.element.classList.add(Pc.RTL),this.disabled?this.controlStatus(this.disabled):this.wireEvents(),this.removeRippleEffect=pt(this.element,{selector:"."+Pc.BUTTON})},e.prototype.controlStatus=function(t){this.element.disabled=t},e.prototype.setIconCss=function(){if(this.iconCss){var t=L("span",{className:"e-btn-icon "+this.iconCss});this.element.textContent.trim()?t.classList.add("e-icon-"+this.iconPosition.toLowerCase()):this.element.classList.add(Pc.ICONBTN);var e=this.element.childNodes[0];e&&"Left"===this.iconPosition?this.element.insertBefore(t,e):this.element.appendChild(t)}},e.prototype.wireEvents=function(){this.isToggle&&Ma.add(this.element,"click",this.btnClickHandler,this)},e.prototype.unWireEvents=function(){this.isToggle&&Ma.remove(this.element,"click",this.btnClickHandler)},e.prototype.btnClickHandler=function(){this.element.classList.contains("e-active")?this.element.classList.remove("e-active"):this.element.classList.add("e-active")},e.prototype.destroy=function(){var e,i=this.element;t.prototype.destroy.call(this),P([this.element],[Pc.PRIMARY,Pc.RTL,Pc.ICONBTN,"e-success","e-info","e-danger","e-warning","e-flat","e-outline","e-small","e-bigger","e-active","e-round"]),["e-ripple","disabled"].forEach(function(t){i.removeAttribute(t)}),this.content&&(i.innerHTML=i.innerHTML.replace(this.content,"")),(e=i.querySelector("span.e-btn-icon"))&&A(e),this.unWireEvents(),this.removeRippleEffect()},e.prototype.getModuleName=function(){return"btn"},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.onPropertyChanged=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++)switch(n[i]){case"isPrimary":t.isPrimary?this.element.classList.add(Pc.PRIMARY):this.element.classList.remove(Pc.PRIMARY);break;case"disabled":this.controlStatus(t.disabled),this.unWireEvents();break;case"iconCss":var o=this.element.querySelector("span.e-btn-icon");o?(o.className="e-btn-icon "+t.iconCss,this.element.textContent.trim()&&("Left"===this.iconPosition?o.classList.add("e-icon-left"):o.classList.add("e-icon-right"))):this.setIconCss();break;case"iconPosition":(o=this.element.querySelector("span.e-btn-icon"))&&A(o),this.setIconCss();break;case"cssClass":e.cssClass&&P([this.element],e.cssClass.split(" ")),t.cssClass&&E([this.element],t.cssClass.split(" "));break;case"enableRtl":t.enableRtl?this.element.classList.add(Pc.RTL):this.element.classList.remove(Pc.RTL);break;case"content":ci(this.element)||this.element.classList.remove(Pc.ICONBTN),this.element.innerHTML=t.content,this.setIconCss();break;case"isToggle":t.isToggle?Ma.add(this.element,"click",this.btnClickHandler,this):(Ma.remove(this.element,"click",this.btnClickHandler),P([this.element],["e-active"]))}},Ec([et("Left")],e.prototype,"iconPosition",void 0),Ec([et("")],e.prototype,"iconCss",void 0),Ec([et(!1)],e.prototype,"disabled",void 0),Ec([et(!1)],e.prototype,"isPrimary",void 0),Ec([et("")],e.prototype,"cssClass",void 0),Ec([et("")],e.prototype,"content",void 0),Ec([et(!1)],e.prototype,"isToggle",void 0),e=Ec([at],e)}(wl),Tc=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Oc=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Ic="e-ripple-container",Ac="e-checkbox-wrapper",Mc=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.isKeyPressed=!1,n}return Tc(e,t),e.prototype.changeState=function(t){var e,i,n=this.getWrapper().getElementsByClassName("e-frame")[0];_a&&(i=this.getWrapper().getElementsByClassName(Ic)[0]),"check"===t?(n.classList.remove("e-stop"),n.classList.add("e-check"),i&&(i.classList.remove("e-ripple-stop"),i.classList.add("e-ripple-check")),e="true",this.element.checked=!0):"uncheck"===t?(P([n],["e-check","e-stop"]),i&&P([i],["e-ripple-check","e-ripple-stop"]),e="false",this.element.checked=!1):(n.classList.remove("e-check"),n.classList.add("e-stop"),i&&(i.classList.remove("e-ripple-check"),i.classList.add("e-ripple-stop")),e="mixed",this.element.indeterminate=!0),this.getWrapper().setAttribute("aria-checked",e)},e.prototype.clickHandler=function(t){this.focusOutHandler(),this.indeterminate?(this.changeState(this.checked?"check":"uncheck"),this.indeterminate=!1,this.element.indeterminate=!1):this.checked?(this.changeState("uncheck"),this.checked=!1):(this.changeState("check"),this.checked=!0);var e={checked:this.element.checked,event:t};this.trigger("change",e)},e.prototype.destroy=function(){var e=this,i=this.getWrapper();t.prototype.destroy.call(this),this.disabled||this.unWireEvents(),"INPUT"===this.tagName?(i.parentNode.insertBefore(this.element,i),A(i),this.element.checked=!1,this.indeterminate&&(this.element.indeterminate=!1),["name","value","disabled"].forEach(function(t){e.element.removeAttribute(t)})):(["role","aria-checked","class"].forEach(function(t){i.removeAttribute(t)}),this.element.id&&i.setAttribute("id",this.element.id),i.innerHTML="")},e.prototype.focusHandler=function(){this.isKeyPressed&&this.getWrapper().classList.add("e-focus")},e.prototype.focusOutHandler=function(){this.getWrapper().classList.remove("e-focus")},e.prototype.getModuleName=function(){return"checkbox"},e.prototype.getPersistData=function(){return this.addOnPersist(["checked","indeterminate"])},e.prototype.getWrapper=function(){return this.element.parentElement.parentElement},e.prototype.initialize=function(){this.name&&this.element.setAttribute("name",this.name),this.value&&this.element.setAttribute("value",this.value),this.checked&&this.changeState("check"),this.indeterminate&&this.changeState(),this.disabled&&this.setDisabled()},e.prototype.initWrapper=function(){var t=this.element.parentElement;t.classList.contains(Ac)||(t=L("div",{className:Ac,attrs:{role:"checkbox","aria-checked":"false"}}),this.element.parentNode.insertBefore(t,this.element));var e=L("label",{attrs:{for:this.element.id}}),i=L("span",{className:"e-icons e-frame"});if(this.enableRtl&&t.classList.add("e-rtl"),this.cssClass&&E([t],this.cssClass.split(" ")),t.appendChild(e),e.appendChild(this.element),e.appendChild(i),_a){var n=L("span",{className:Ic});"Before"===this.labelPosition?e.appendChild(n):e.insertBefore(n,i),pt(n,{duration:400,isCenterRipple:!0})}this.label&&this.setText(this.label)},e.prototype.keyDownHandler=function(){this.isKeyPressed=!0},e.prototype.labelMouseHandler=function(t){gi(t,this.getWrapper().getElementsByClassName(Ic)[0])},e.prototype.mouseDownHandler=function(){this.isKeyPressed=!1},e.prototype.onPropertyChanged=function(t,e){for(var i=this.getWrapper(),n=0,o=Object.keys(t);n<o.length;n++)switch(o[n]){case"checked":this.indeterminate=!1,this.element.indeterminate=!1,this.changeState(t.checked?"check":"uncheck");break;case"indeterminate":t.indeterminate?this.changeState():(this.element.indeterminate=!1,this.changeState(this.checked?"check":"uncheck"));break;case"disabled":t.disabled?(this.setDisabled(),this.unWireEvents()):(this.element.disabled=!1,i.classList.remove("e-checkbox-disabled"),i.setAttribute("aria-disabled","false"),this.wireEvents());break;case"cssClass":e.cssClass&&i.classList.remove(e.cssClass),i.classList.add(t.cssClass);break;case"enableRtl":t.enableRtl?i.classList.add("e-rtl"):i.classList.remove("e-rtl");break;case"label":this.setText(t.label);break;case"labelPosition":var r=i.getElementsByClassName("e-label")[0],s=i.getElementsByTagName("label")[0];A(r),"After"===t.labelPosition?s.appendChild(r):s.insertBefore(r,i.getElementsByClassName("e-frame")[0]);break;case"name":this.element.setAttribute("name",t.name);break;case"value":this.element.setAttribute("value",t.value)}},e.prototype.preRender=function(){var t=this.element;this.tagName=this.element.tagName,t=hi("EJS-CHECKBOX","checkbox",t,Ac,"checkbox"),this.element=t,"checkbox"!==this.element.getAttribute("type")&&this.element.setAttribute("type","checkbox"),this.element.id||(this.element.id=p("e-"+this.getModuleName()))},e.prototype.render=function(){this.initWrapper(),this.initialize(),this.disabled||this.wireEvents()},e.prototype.setDisabled=function(){var t=this.getWrapper();this.element.disabled=!0,t.classList.add("e-checkbox-disabled"),t.setAttribute("aria-disabled","true")},e.prototype.setText=function(t){var e=this.getWrapper().getElementsByClassName("e-label")[0];if(e)e.textContent=t;else{e=L("span",{className:"e-label",innerHTML:t});var i=this.getWrapper().getElementsByTagName("label")[0];"Before"===this.labelPosition?i.insertBefore(e,this.getWrapper().getElementsByClassName("e-frame")[0]):i.appendChild(e)}},e.prototype.unWireEvents=function(){var t=this.getWrapper();Ma.remove(this.element,"click",this.clickHandler),Ma.remove(document,"keydown",this.keyDownHandler),Ma.remove(t,"mousedown",this.mouseDownHandler),Ma.remove(this.element,"focus",this.focusHandler),Ma.remove(this.element,"focusout",this.focusOutHandler);var e=t.getElementsByTagName("label")[0];Ma.remove(e,"mousedown",this.labelMouseHandler),Ma.remove(e,"mouseup",this.labelMouseHandler)},e.prototype.wireEvents=function(){var t=this.getWrapper();Ma.add(this.element,"click",this.clickHandler,this),Ma.add(document,"keydown",this.keyDownHandler,this),Ma.add(t,"mousedown",this.mouseDownHandler,this),Ma.add(this.element,"focus",this.focusHandler,this),Ma.add(this.element,"focusout",this.focusOutHandler,this);var e=t.getElementsByTagName("label")[0];Ma.add(e,"mousedown",this.labelMouseHandler,this),Ma.add(e,"mouseup",this.labelMouseHandler,this)},Oc([st()],e.prototype,"change",void 0),Oc([et(!1)],e.prototype,"checked",void 0),Oc([et("")],e.prototype,"cssClass",void 0),Oc([et(!1)],e.prototype,"disabled",void 0),Oc([et(!1)],e.prototype,"indeterminate",void 0),Oc([et("")],e.prototype,"label",void 0),Oc([et("After")],e.prototype,"labelPosition",void 0),Oc([et("")],e.prototype,"name",void 0),Oc([et("")],e.prototype,"value",void 0),e=Oc([at],e)}(wl),Rc=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Dc=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Bc=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.isKeyPressed=!1,n}return Rc(e,t),i=e,e.prototype.changeHandler=function(t){this.checked=!0,this.dataBind();var e={value:this.value,event:t};this.trigger("change",e)},e.prototype.updateChange=function(t){for(var e,n=this.element.getAttribute("name"),o=document.querySelectorAll('input.e-radio[name="'+n+'"]'),r=0;r<o.length;r++)(e=o[r])!==this.element&&(w(e,i).checked=!1)},e.prototype.destroy=function(){var e=this,i=this.element.parentElement;t.prototype.destroy.call(this),this.disabled||this.unWireEvents(),"INPUT"===this.tagName?(i.parentNode.insertBefore(this.element,i),A(i),this.element.checked=!1,["name","value","disabled"].forEach(function(t){e.element.removeAttribute(t)})):(["role","aria-checked","class"].forEach(function(t){i.removeAttribute(t)}),this.element.id&&i.setAttribute("id",this.element.id),i.innerHTML="")},e.prototype.focusHandler=function(){this.isKeyPressed&&this.getLabel().classList.add("e-focus")},e.prototype.focusOutHandler=function(){this.getLabel().classList.remove("e-focus")},e.prototype.getModuleName=function(){return"radio"},e.prototype.getPersistData=function(){return this.addOnPersist(["checked"])},e.prototype.getLabel=function(){return this.element.nextElementSibling},e.prototype.initialize=function(){this.initWrapper(),this.name&&this.element.setAttribute("name",this.name),this.value&&this.element.setAttribute("value",this.value),this.checked&&(this.element.checked=!0),this.disabled&&this.setDisabled()},e.prototype.initWrapper=function(){var t,e=this.element.parentElement;e.classList.contains("e-radio-wrapper")||(e=L("div",{className:"e-radio-wrapper"}),this.element.parentNode.insertBefore(e,this.element));var i=L("label",{attrs:{for:this.element.id}});e.appendChild(this.element),e.appendChild(i),_a&&(t=L("span",{className:"e-ripple-container"}),i.appendChild(t),pt(t,{duration:400,isCenterRipple:!0})),this.enableRtl&&i.classList.add("e-rtl"),this.cssClass&&E([i],this.cssClass.split(" ")),this.label&&this.setText(this.label)},e.prototype.keyDownHandler=function(){this.isKeyPressed=!0},e.prototype.labelRippleHandler=function(t){gi(t,this.getLabel().getElementsByClassName("e-ripple-container")[0])},e.prototype.mouseDownHandler=function(){this.isKeyPressed=!1},e.prototype.onPropertyChanged=function(t,e){for(var i=this.getLabel(),n=0,o=Object.keys(t);n<o.length;n++)switch(o[n]){case"checked":t.checked&&this.updateChange(t.checked),this.element.checked=t.checked;break;case"disabled":t.disabled?(this.setDisabled(),this.unWireEvents()):(this.element.disabled=!1,this.wireEvents());break;case"cssClass":e.cssClass&&P([i],e.cssClass.split(" ")),E([i],t.cssClass.split(" "));break;case"enableRtl":t.enableRtl?i.classList.add("e-rtl"):i.classList.remove("e-rtl");break;case"label":this.setText(t.label);break;case"labelPosition":"Before"===t.labelPosition?i.classList.add("e-right"):i.classList.remove("e-right");break;case"name":this.element.setAttribute("name",t.name);break;case"value":this.element.setAttribute("value",t.value)}},e.prototype.preRender=function(){var t=this.element;this.tagName=this.element.tagName,t=hi("EJS-RADIOBUTTON","radio",t,"e-radio-wrapper","radio"),this.element=t,"radio"!==this.element.getAttribute("type")&&this.element.setAttribute("type","radio"),this.element.id||(this.element.id=p("e-"+this.getModuleName()))},e.prototype.render=function(){this.initialize(),this.disabled||this.wireEvents()},e.prototype.setDisabled=function(){this.element.disabled=!0},e.prototype.setText=function(t){var e=this.getLabel(),i=e.getElementsByClassName("e-label")[0];i?i.textContent=t:(i=L("span",{className:"e-label",innerHTML:t}),e.appendChild(i)),"Before"===this.labelPosition?this.getLabel().classList.add("e-right"):this.getLabel().classList.remove("e-right")},e.prototype.unWireEvents=function(){var t=this.getLabel();Ma.remove(this.element,"change",this.changeHandler),Ma.remove(document,"keydown",this.keyDownHandler),Ma.remove(t,"mousedown",this.mouseDownHandler),Ma.remove(this.element,"focus",this.focusHandler),Ma.remove(this.element,"focusout",this.focusOutHandler);var e=t.getElementsByClassName("e-label")[0];e&&(Ma.remove(e,"mousedown",this.labelRippleHandler),Ma.remove(e,"mouseup",this.labelRippleHandler))},e.prototype.wireEvents=function(){var t=this.getLabel();Ma.add(this.element,"change",this.changeHandler,this),Ma.add(document,"keydown",this.keyDownHandler,this),Ma.add(t,"mousedown",this.mouseDownHandler,this),Ma.add(this.element,"focus",this.focusHandler,this),Ma.add(this.element,"focusout",this.focusOutHandler,this);var e=t.getElementsByClassName("e-label")[0];e&&(Ma.add(e,"mousedown",this.labelRippleHandler,this),Ma.add(e,"mouseup",this.labelRippleHandler,this))},Dc([st()],e.prototype,"change",void 0),Dc([et(!1)],e.prototype,"checked",void 0),Dc([et("")],e.prototype,"cssClass",void 0),Dc([et(!1)],e.prototype,"disabled",void 0),Dc([et("")],e.prototype,"label",void 0),Dc([et("After")],e.prototype,"labelPosition",void 0),Dc([et("")],e.prototype,"name",void 0),Dc([et("")],e.prototype,"value",void 0),e=i=Dc([at],e);var i}(wl),Nc=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Hc=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},zc="e-ripple-container",jc=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.isKeyPressed=!1,n.isDrag=!1,n}return Nc(e,t),e.prototype.changeState=function(t){var e,i,n=this.getWrapper(),o=n.querySelector(".e-switch-inner"),r=n.querySelector(".e-switch-handle");_a&&(i=n.getElementsByClassName(zc)[0]),t?(E([o,r],"e-switch-active"),e="true",this.element.checked=!0,this.checked=!0,i&&E([i],["e-ripple-check"])):(P([o,r],"e-switch-active"),e="false",this.element.checked=!1,this.checked=!1,i&&P([i],["e-ripple-check"])),n.setAttribute("aria-checked",e)},e.prototype.clickHandler=function(t){this.isDrag=!1,this.focusOutHandler(),this.changeState(!this.checked),this.element.focus();var e={checked:this.element.checked,event:t};this.trigger("change",e)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.disabled||this.unWireEvents(),di(this,this.getWrapper(),this.tagName)},e.prototype.focusHandler=function(){this.isKeyPressed&&this.getWrapper().classList.add("e-focus")},e.prototype.focusOutHandler=function(){this.getWrapper().classList.remove("e-focus")},e.prototype.getModuleName=function(){return"switch"},e.prototype.getPersistData=function(){return this.addOnPersist(["checked"])},e.prototype.getWrapper=function(){return this.element.parentElement},e.prototype.initialize=function(){this.name&&this.element.setAttribute("name",this.name),this.value&&this.element.setAttribute("value",this.value),this.checked&&this.changeState(!0),this.disabled&&this.setDisabled(),(this.onLabel||this.offLabel)&&this.setLabel(this.onLabel,this.offLabel)},e.prototype.initWrapper=function(){var t=this.element.parentElement;t.classList.contains("e-switch-wrapper")||(t=L("div",{className:"e-switch-wrapper",attrs:{role:"switch","aria-checked":"false"}}),this.element.parentNode.insertBefore(t,this.element));var e=L("span",{className:"e-switch-inner"}),i=L("span",{className:"e-switch-on"}),n=L("span",{className:"e-switch-off"}),o=L("span",{className:"e-switch-handle"});if(t.appendChild(this.element),e.appendChild(i),e.appendChild(n),t.appendChild(e),t.appendChild(o),_a){var r=L("span",{className:zc});o.appendChild(r),pt(r,{duration:400,isCenterRipple:!0})}this.enableRtl&&t.classList.add("e-rtl"),this.cssClass&&E([t],this.cssClass.split(" "))},e.prototype.onPropertyChanged=function(t,e){for(var i=this.getWrapper(),n=0,o=Object.keys(t);n<o.length;n++)switch(o[n]){case"checked":this.changeState(t.checked);break;case"disabled":t.disabled?(this.setDisabled(),this.unWireEvents()):(this.element.disabled=!1,i.classList.remove("e-switch-disabled"),i.setAttribute("aria-disabled","false"),this.wireEvents());break;case"value":this.element.setAttribute("value",t.value);break;case"name":this.element.setAttribute("name",t.name);break;case"onLabel":case"offLabel":this.setLabel(t.onLabel,t.offLabel);break;case"enableRtl":t.enableRtl?i.classList.add("e-rtl"):i.classList.remove("e-rtl");break;case"cssClass":e.cssClass&&i.classList.remove(e.cssClass),i.classList.add(t.cssClass)}},e.prototype.preRender=function(){var t=this.element;this.tagName=this.element.tagName,pi(this,"EJS-SWITCH","e-switch-wrapper",t,this.getModuleName())},e.prototype.render=function(){this.initWrapper(),this.initialize(),this.disabled||this.wireEvents()},e.prototype.rippleHandler=function(t){gi(t,this.getWrapper().getElementsByClassName(zc)[0]),"mousedown"===t.type&&t.currentTarget.classList.contains("e-switch-wrapper")&&1===t.which&&(this.isDrag=!0,this.isKeyPressed=!1)},e.prototype.rippleTouchHandler=function(t){var e=this.getWrapper().getElementsByClassName(zc)[0];if(e){var i=document.createEvent("MouseEvents");i.initEvent(t,!1,!0),e.dispatchEvent(i)}},e.prototype.setDisabled=function(){var t=this.getWrapper();this.element.disabled=!0,t.classList.add("e-switch-disabled"),t.setAttribute("aria-disabled","true")},e.prototype.setLabel=function(t,e){var i=this.getWrapper();t&&(i.querySelector(".e-switch-on").textContent=t),e&&(i.querySelector(".e-switch-off").textContent=e)},e.prototype.switchFocusHandler=function(){this.isKeyPressed=!0},e.prototype.switchMouseUp=function(t){var e=t.target;this.getWrapper().getElementsByClassName(zc)[0];"touchmove"===t.type&&t.preventDefault(),"touchstart"===t.type&&(this.isDrag=!0,this.rippleTouchHandler("mousedown")),this.isDrag&&("mouseup"===t.type&&e.className.indexOf("e-switch")<0||"touchend"===t.type)&&(this.clickHandler(t),this.rippleTouchHandler("mouseup"),t.preventDefault())},e.prototype.toggle=function(){this.clickHandler()},e.prototype.wireEvents=function(){var t=this.getWrapper();t.querySelector(".e-switch-handle");Ma.add(t,"click",this.clickHandler,this),Ma.add(this.element,"focus",this.focusHandler,this),Ma.add(this.element,"focusout",this.focusOutHandler,this),Ma.add(document,"mouseup",this.switchMouseUp,this),Ma.add(document,"keydown",this.switchFocusHandler,this),Ma.add(t,"mousedown mouseup",this.rippleHandler,this),Ma.add(t,"touchstart touchmove touchend",this.switchMouseUp,this)},e.prototype.unWireEvents=function(){var t=this.getWrapper();t.querySelector(".e-switch-handle");Ma.remove(t,"click",this.clickHandler),Ma.remove(this.element,"focus",this.focusHandler),Ma.remove(this.element,"focusout",this.focusOutHandler),Ma.remove(document,"mouseup",this.switchMouseUp),Ma.remove(document,"keydown",this.switchFocusHandler),Ma.remove(t,"mousedown mouseup",this.rippleHandler),Ma.remove(t,"touchstart touchmove touchend",this.switchMouseUp)},Hc([st()],e.prototype,"change",void 0),Hc([et(!1)],e.prototype,"checked",void 0),Hc([et("")],e.prototype,"cssClass",void 0),Hc([et(!1)],e.prototype,"disabled",void 0),Hc([et("")],e.prototype,"name",void 0),Hc([et("")],e.prototype,"onLabel",void 0),Hc([et("")],e.prototype,"offLabel",void 0),Hc([et("")],e.prototype,"value",void 0),e=Hc([at],e)}(wl),Vc=Object.freeze({wrapperInitialize:hi,getTextNode:ci,destroy:di,preRender:pi,createCheckBox:ui,rippleMouseHandler:gi,Button:kc,CheckBox:Mc,RadioButton:Bc,Switch:jc}),Fc=!1,_c=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Wc=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Uc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _c(e,t),Wc([et("left")],e.prototype,"X",void 0),Wc([et("top")],e.prototype,"Y",void 0),e}(qa),qc={ROOT:"e-popup",RTL:"e-rtl",OPEN:"e-popup-open",CLOSE:"e-popup-close"},Xc=function(t){function e(e,i){var n=t.call(this,i,e)||this;return n.fixedParent=!1,n}return _c(e,t),e.prototype.onPropertyChanged=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++)switch(n[i]){case"width":j(this.element,{width:b(t.width)});break;case"height":j(this.element,{height:b(t.height)});break;case"zIndex":j(this.element,{zIndex:t.zIndex});break;case"enableRtl":this.setEnableRtl();break;case"position":case"relateTo":this.refreshPosition();break;case"offsetX":var o=t.offsetX-e.offsetX;this.element.style.left=(parseInt(this.element.style.left,10)+o).toString()+"px";break;case"offsetY":var r=t.offsetY-e.offsetY;this.element.style.top=(parseInt(this.element.style.top,10)+r).toString()+"px";break;case"content":this.setContent();break;case"actionOnScroll":"none"!==t.actionOnScroll?this.wireScrollEvents():this.unwireScrollEvents()}},e.prototype.getModuleName=function(){return"popup"},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.destroy=function(){this.element.classList.remove(qc.ROOT,qc.RTL),this.unwireEvents(),t.prototype.destroy.call(this)},e.prototype.render=function(){this.element.classList.add(qc.ROOT);var t={};1e3!==this.zIndex&&(t.zIndex=this.zIndex),"auto"!==this.width&&(t.width=b(this.width)),"auto"!==this.height&&(t.height=b(this.height)),j(this.element,t),this.setEnableRtl(),this.setContent(),this.wireEvents()},e.prototype.wireEvents=function(){za.isDevice&&Ma.add(window,"orientationchange",this.orientationOnChange,this),"none"!==this.actionOnScroll&&this.wireScrollEvents()},e.prototype.wireScrollEvents=function(){if(this.getRelateToElement())for(var t=0,e=this.getScrollableParent(this.getRelateToElement());t<e.length;t++){var i=e[t];Ma.add(i,"scroll",this.scrollRefresh,this)}},e.prototype.unwireEvents=function(){za.isDevice&&Ma.remove(window,"orientationchange",this.orientationOnChange),"none"!==this.actionOnScroll&&this.unwireScrollEvents()},e.prototype.unwireScrollEvents=function(){if(this.getRelateToElement())for(var t=0,e=this.getScrollableParent(this.getRelateToElement());t<e.length;t++){var i=e[t];Ma.remove(i,"scroll",this.scrollRefresh)}},e.prototype.getRelateToElement=function(){var t=""===this.relateTo||c(this.relateTo)?document.body:this.relateTo;return this.setProperties({relateTo:t},!0),"string"==typeof this.relateTo?document.querySelector(this.relateTo):this.relateTo},e.prototype.scrollRefresh=function(t){if("reposition"===this.actionOnScroll?this.element.offsetParent===t.target||this.element.offsetParent&&"BODY"===this.element.offsetParent.tagName&&null==t.target.parentElement||this.refreshPosition():"hide"===this.actionOnScroll&&this.hide(),"none"!==this.actionOnScroll&&this.getRelateToElement()){var e=this.isElementOnViewport(this.getRelateToElement(),t.target);e||this.targetInvisibleStatus?e&&(this.targetInvisibleStatus=!1):(this.trigger("targetExitViewport"),this.targetInvisibleStatus=!0)}},e.prototype.isElementOnViewport=function(t,e){for(var i=this.getScrollableParent(t),n=0;n<i.length;n++)if(!this.isElementVisible(t,i[n]))return!1;return!0},e.prototype.isElementVisible=function(t,e){var i=t.getBoundingClientRect();if(!i.height||!i.width)return!1;if(e.getBoundingClientRect){var n=e.getBoundingClientRect();return!(i.bottom<n.top||i.bottom>n.bottom||i.right>n.right||i.left<n.left)}var o=window,r={top:o.scrollY,left:o.scrollX,right:o.scrollX+o.outerWidth,bottom:o.scrollY+o.outerHeight},s=fi(t),a={top:s.top,left:s.left,right:s.left+i.width,bottom:s.top+i.height},l={top:r.bottom-a.top,left:r.right-a.left,bottom:a.bottom-r.top,right:a.right-r.left};return l.top>0&&l.left>0&&l.right>0&&l.bottom>0},e.prototype.preRender=function(){},e.prototype.setEnableRtl=function(){this.reposition(),this.enableRtl?this.element.classList.add(qc.RTL):this.element.classList.remove(qc.RTL)},e.prototype.setContent=function(){c(this.content)||(this.element.innerHTML="","string"==typeof this.content?this.element.textContent=this.content:this.element.appendChild(this.content))},e.prototype.orientationOnChange=function(){var t=this;setTimeout(function(){t.refreshPosition()},200)},e.prototype.refreshPosition=function(t){c(t)||this.checkFixedParent(t),this.reposition(),this.checkCollision()},e.prototype.reposition=function(){var t,e=this.getRelateToElement();if("number"==typeof this.position.X&&"number"==typeof this.position.Y)t={left:this.position.X,top:this.position.Y};else if(e){var i=this.element.style.display;this.element.style.display="block",t=this.getAnchorPosition(e,this.element,this.position,this.offsetX,this.offsetY),this.element.style.display=i}else t={left:0,top:0};this.element.style.left=t.left+"px",this.element.style.top=t.top+"px"},e.prototype.getAnchorPosition=function(t,e,i,n,o){var r=e.getBoundingClientRect(),s=t.getBoundingClientRect(),a=t,l={left:0,top:0};switch(l=e.offsetParent&&"BODY"===e.offsetParent.tagName&&"BODY"===t.tagName?fi(t):mi(a,e),i.X){default:case"left":break;case"center":"container"===this.targetType?l.left+=s.width/2-r.width/2:l.left+=s.width/2;break;case"right":"container"===this.targetType?l.left+=s.width-r.width:l.left+=s.width}switch(i.Y){default:case"top":break;case"center":"container"===this.targetType?l.top+=s.height/2-r.height/2:l.top+=s.height/2;break;case"bottom":"container"===this.targetType?l.top+=s.height-r.height:l.top+=s.height}return l.left+=n,l.top+=o,l},e.prototype.callFlip=function(t){var e=this.getRelateToElement();Ii(this.element,e,this.offsetX,this.offsetY,this.position.X,this.position.Y,this.viewPortElement,t,this.fixedParent)},e.prototype.callFit=function(t){if(0!==Oi(this.element,this.viewPortElement).length)if(c(this.viewPortElement)){var e=Ti(this.element,this.viewPortElement,t);this.element.style.left=e.left+"px",this.element.style.top=e.top+"px"}else{var i=this.element.getBoundingClientRect(),n=this.viewPortElement.getBoundingClientRect();t&&!0===t.Y&&(n.top>i.top?this.element.style.top="0px":n.bottom<i.bottom&&(this.element.style.top=parseInt(this.element.style.top,10)-(i.bottom-n.bottom)+"px")),t&&!0===t.X&&(n.right<i.right?this.element.style.left=parseInt(this.element.style.left,10)-(i.right-n.right)+"px":n.left>i.left&&(this.element.style.left=parseInt(this.element.style.left,10)+(n.left-i.left)+"px"))}},e.prototype.checkCollision=function(){var t=this.collision.X,e=this.collision.Y;"none"===t&&"none"===e||("flip"===t&&"flip"===e?this.callFlip({X:!0,Y:!0}):"fit"===t&&"fit"===e?this.callFit({X:!0,Y:!0}):("flip"===t?this.callFlip({X:!0,Y:!1}):"flip"===e&&this.callFlip({Y:!0,X:!1}),"fit"===t?this.callFit({X:!0,Y:!1}):"fit"===e&&this.callFit({X:!1,Y:!0})))},e.prototype.show=function(t){var e=this;1e3===this.zIndex&&(this.zIndex=Qi(this.element),j(this.element,{zIndex:this.zIndex})),t=c(t)||"object"!=typeof t?this.showAnimation:t,"none"===this.collision.X&&"none"===this.collision.Y||(P([this.element],qc.CLOSE),E([this.element],qc.OPEN),this.checkCollision(),P([this.element],qc.OPEN),E([this.element],qc.CLOSE)),c(t)?(P([this.element],qc.CLOSE),E([this.element],qc.OPEN),this.trigger("open")):(t.begin=function(){e.isDestroyed||(P([e.element],qc.CLOSE),E([e.element],qc.OPEN))},t.end=function(){e.isDestroyed||e.trigger("open")},new Fa(t).animate(this.element))},e.prototype.hide=function(t){var e=this;c(t=c(t)||"object"!=typeof t?this.hideAnimation:t)?(P([this.element],qc.OPEN),E([this.element],qc.CLOSE),this.trigger("close")):(t.end=function(){e.isDestroyed||(P([e.element],qc.OPEN),E([e.element],qc.CLOSE),e.trigger("close"))},new Fa(t).animate(this.element))},e.prototype.getScrollableParent=function(t){return this.checkFixedParent(t),Ki(t,this.fixedParent)},e.prototype.checkFixedParent=function(t){for(var e=t.parentElement;e&&"HTML"!==e.tagName;){var i=getComputedStyle(e);"fixed"===i.position&&this.element.offsetParent&&"BODY"===this.element.offsetParent.tagName&&(this.element.style.position="fixed",this.fixedParent=!0),e=e.parentElement,c(this.element.offsetParent)&&"fixed"===i.position&&"fixed"===this.element.style.position&&(this.fixedParent=!0)}},Wc([et("auto")],e.prototype,"height",void 0),Wc([et("auto")],e.prototype,"width",void 0),Wc([et(null)],e.prototype,"content",void 0),Wc([et("container")],e.prototype,"targetType",void 0),Wc([et(null)],e.prototype,"viewPortElement",void 0),Wc([et({X:"none",Y:"none"})],e.prototype,"collision",void 0),Wc([et("")],e.prototype,"relateTo",void 0),Wc([it({},Uc)],e.prototype,"position",void 0),Wc([et(0)],e.prototype,"offsetX",void 0),Wc([et(0)],e.prototype,"offsetY",void 0),Wc([et(1e3)],e.prototype,"zIndex",void 0),Wc([et(!1)],e.prototype,"enableRtl",void 0),Wc([et("reposition")],e.prototype,"actionOnScroll",void 0),Wc([et(null)],e.prototype,"showAnimation",void 0),Wc([et(null)],e.prototype,"hideAnimation",void 0),Wc([st()],e.prototype,"open",void 0),Wc([st()],e.prototype,"close",void 0),Wc([st()],e.prototype,"targetExitViewport",void 0),e=Wc([at],e)}(wl),Yc=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Gc=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Zc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yc(e,t),Gc([et()],e.prototype,"buttonModel",void 0),Gc([et()],e.prototype,"click",void 0),e}(qa),Kc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yc(e,t),Gc([et("Fade")],e.prototype,"effect",void 0),Gc([et(400)],e.prototype,"duration",void 0),Gc([et(0)],e.prototype,"delay",void 0),e}(qa),Qc="e-dialog",Jc=function(t){function e(e,i){return t.call(this,e,i)||this}return Yc(e,t),e.prototype.render=function(){this.initialize(),this.initRender(),this.wireEvents()},e.prototype.preRender=function(){var t=this;this.headerContent=null;for(var e=[],i=0;i<this.element.classList.length;i++)c(this.element.classList[i].match("e-control"))&&c(this.element.classList[i].match(Qc))||e.push(this.element.classList[i]);P([this.element],e),this.clonedEle=this.element.cloneNode(!0),this.closeIconClickEventHandler=function(e){t.hide(e)},this.dlgOverlayClickEventHandler=function(e){t.trigger("overlayClick",e)};var n={close:"Close"};if(this.l10n=new Dl("dialog",n,this.locale),c(this.target)){var o=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.target=document.body,this.isProtectedOnChange=o}},e.prototype.keyDown=function(t){var e=this;if(9===t.keyCode&&this.isModal){var i=void 0;c(this.btnObj)||(i=this.btnObj[this.btnObj.length-1]),c(i)||document.activeElement!==i.element||t.shiftKey||(t.preventDefault(),this.focusableElements(this.element).focus()),document.activeElement===this.focusableElements(this.element)&&t.shiftKey&&(t.preventDefault(),c(i)||i.element.focus())}var n=document.activeElement,o=["input","textarea"].indexOf(n.tagName.toLowerCase())>-1,r=!1;if(o||(r=n.hasAttribute("contenteditable")&&"true"===n.getAttribute("contenteditable")),27===t.keyCode&&this.closeOnEscape&&this.hide(t),13===t.keyCode&&!t.ctrlKey&&"textarea"!==n.tagName.toLowerCase()&&o&&!c(this.primaryButtonEle)||13===t.keyCode&&t.ctrlKey&&("textarea"===n.tagName.toLowerCase()||r)&&!c(this.primaryButtonEle)){var s;this.buttons.some(function(t,e){s=e;var i=t.buttonModel;return!c(i)&&!0===i.isPrimary})&&"function"==typeof this.buttons[s].click&&setTimeout(function(){e.buttons[s].click.call(e,t)})}},e.prototype.initialize=function(){c(this.target)||(this.targetEle="string"==typeof this.target?document.querySelector(this.target):this.target),E([this.element],Qc),za.isDevice&&E([this.element],"e-device"),this.setCSSClass(),this.setMaxHeight()},e.prototype.initRender=function(){var t=this;this.initialRender=!0,R(this.element,{role:"dialog"}),1e3===this.zIndex&&(this.zIndex=Qi(this.element)),this.setTargetContent(),""===this.header||c(this.header)||this.setHeader(),this.showCloseIcon&&this.renderCloseIcon(),this.setContent(),""===this.footerTemplate||c(this.footerTemplate)?c(this.buttons[0].buttonModel)||this.setButton():this.setFooterTemplate(),!this.allowDragging||this.isModal||c(this.headerContent)||this.setAllowDragging(),R(this.element,{"aria-modal":this.isModal?"true":"false"}),this.isModal&&this.setIsModal(),c(this.targetEle)||(this.isModal?this.targetEle.appendChild(this.dlgContainer):this.targetEle.appendChild(this.element)),this.popupObj=new Xc(this.element,{height:this.height,width:this.width,zIndex:this.zIndex,relateTo:this.target,actionOnScroll:"none",open:function(e){t.focusContent();var i={container:t.isModal?t.dlgContainer:t.element,element:t.element,target:t.target};t.trigger("open",i)},close:function(e){t.unBindEvent(t.element),t.isModal&&(t.dlgContainer.style.display="none"),t.trigger("close",t.closeArgs),c(t.storeActiveElement)||t.storeActiveElement.focus()}}),this.positionChange(),this.setEnableRTL(),E([this.element],"e-popup-close"),this.isModal&&this.setOverlayZindex(),this.visible?this.show():this.isModal&&(this.dlgOverlay.style.display="none"),this.initialRender=!1},e.prototype.setOverlayZindex=function(t){var e;e=c(t)?parseInt(this.element.style.zIndex,10)?parseInt(this.element.style.zIndex,10):this.zIndex:t,this.dlgOverlay.style.zIndex=(e-1).toString(),this.dlgContainer.style.zIndex=e.toString()},e.prototype.positionChange=function(){this.isModal?(this.dlgContainer.classList.add("e-dlg-"+this.position.X+"-"+this.position.Y),"number"==typeof this.position.X&&"number"==typeof this.position.Y&&this.setPopupPosition()):this.setPopupPosition()},e.prototype.setPopupPosition=function(){this.popupObj.setProperties({position:{X:this.position.X,Y:this.position.Y}})},e.prototype.setAllowDragging=function(){var t=this;this.dragObj=new Pl(this.element,{clone:!1,handle:".e-dlg-header-content",dragStart:function(e){t.trigger("dragStart",e)},dragStop:function(e){t.trigger("dragStop",e)},drag:function(e){t.trigger("drag",e)}}),c(this.targetEle)||(this.dragObj.dragArea=this.targetEle)},e.prototype.setButton=function(){this.buttonContent=[],this.btnObj=[];for(e=0;e<this.buttons.length;e++){var t=L("button",{attrs:{type:"button"}});this.buttonContent.push(t.outerHTML)}this.setFooterTemplate();for(var e=0;e<this.buttons.length;e++)this.btnObj[e]=new kc(this.buttons[e].buttonModel),"function"==typeof this.buttons[e].click&&Ma.add(this.ftrTemplateContent.children[e],"click",this.buttons[e].click,this),this.btnObj[e].appendTo(this.ftrTemplateContent.children[e]),this.btnObj[e].element.classList.add("e-flat"),this.primaryButtonEle=this.element.getElementsByClassName("e-primary")[0]},e.prototype.setContent=function(){R(this.element,{"aria-describedby":this.element.id+"_dialog-content"}),this.contentEle=L("div",{className:"e-dlg-content",id:this.element.id+"_dialog-content"}),this.innerContentElement?this.contentEle.appendChild(this.innerContentElement):(c(this.content)||""===this.content)&&this.initialRender||("string"==typeof this.content?this.contentEle.innerHTML=this.content:this.content instanceof HTMLElement?this.contentEle.appendChild(this.content):this.setTemplate(this.content,this.contentEle)),c(this.headerContent)?this.element.insertBefore(this.contentEle,this.element.children[0]):this.element.insertBefore(this.contentEle,this.element.children[1]),"auto"===this.height&&this.setMaxHeight()},e.prototype.setTemplate=function(t,e){for(var i=[],n=0,o=Tt(t)({});n<o.length;n++){var r=o[n];i.push(r)}I([].slice.call(i),e)},e.prototype.setMaxHeight=function(){var t=this.element.style.display;this.element.style.display="none",this.element.style.maxHeight=c(this.target)?window.innerHeight-20+"px":this.targetEle.offsetHeight-20+"px",this.element.style.display=t},e.prototype.setEnableRTL=function(){this.enableRtl?E([this.element],"e-rtl"):P([this.element],"e-rtl")},e.prototype.setTargetContent=function(){if(c(this.content)||""===this.content){var t=""!==this.element.innerHTML.replace(/\s/g,"");if(this.element.children.length>0||t)for(this.innerContentElement=document.createDocumentFragment();0!==this.element.childNodes.length;)this.innerContentElement.appendChild(this.element.childNodes[0])}},e.prototype.setHeader=function(){this.headerEle?this.headerEle.innerHTML="":this.headerEle=L("div",{id:this.element.id+"_title",className:"e-dlg-header"}),this.createHeaderContent(),this.headerContent.appendChild(this.headerEle),this.setTemplate(this.header,this.headerEle),R(this.element,{"aria-labelledby":this.element.id+"_title"}),this.element.insertBefore(this.headerContent,this.element.children[0])},e.prototype.setFooterTemplate=function(){this.ftrTemplateContent?this.ftrTemplateContent.innerHTML="":this.ftrTemplateContent=L("div",{className:"e-footer-content"}),""===this.footerTemplate||c(this.footerTemplate)?this.ftrTemplateContent.innerHTML=this.buttonContent.join(""):this.setTemplate(this.footerTemplate,this.ftrTemplateContent),this.element.appendChild(this.ftrTemplateContent)},e.prototype.createHeaderContent=function(){c(this.headerContent)&&(this.headerContent=L("div",{className:"e-dlg-header-content"}))},e.prototype.renderCloseIcon=function(){this.closeIcon=L("button",{className:"e-dlg-closeicon-btn",attrs:{type:"button"}}),this.closeIconBtnObj=new kc({cssClass:"e-flat",iconCss:"e-icon-dlg-close e-icons"}),this.closeIconTitle(),c(this.headerContent)?(this.createHeaderContent(),O([this.closeIcon],this.headerContent),this.element.insertBefore(this.headerContent,this.element.children[0])):O([this.closeIcon],this.headerContent),this.closeIconBtnObj.appendTo(this.closeIcon)},e.prototype.closeIconTitle=function(){this.l10n.setLocale(this.locale);var t=this.l10n.getConstant("close");this.closeIcon.setAttribute("title",t)},e.prototype.setCSSClass=function(t){this.cssClass&&E([this.element],this.cssClass.split(" ")),t&&P([this.element],t.split(" "))},e.prototype.setIsModal=function(){this.dlgContainer=L("div",{className:"e-dlg-container"}),this.element.classList.remove("e-popup-open"),this.element.parentNode.insertBefore(this.dlgContainer,this.element),this.dlgContainer.appendChild(this.element),E([this.element],"e-dlg-modal"),this.dlgOverlay=L("div",{className:"e-dlg-overlay"}),this.dlgOverlay.style.zIndex=(this.zIndex-1).toString(),this.dlgContainer.appendChild(this.dlgOverlay)},e.prototype.getValidFocusNode=function(t){for(var e,i=0;i<t.length;i++)if(((e=t[i]).clientHeight>0||"a"===e.tagName.toLowerCase()&&e.hasAttribute("href"))&&e.tabIndex>-1&&!e.disabled&&!this.disableElement(e,'[disabled],[aria-disabled="true"],[type="hidden"]'))return e;return e},e.prototype.focusableElements=function(t){if(!c(t)){var e=t.querySelectorAll('input,select,textarea,button,a,[contenteditable="true"],[tabindex]');return this.getValidFocusNode(e)}return null},e.prototype.getAutoFocusNode=function(t){var e=t.querySelector(".e-dlg-closeicon-btn"),i=t.querySelectorAll("[autofocus]"),n=this.getValidFocusNode(i);if(c(n)){if(n=this.focusableElements(this.contentEle),!c(n))return e=n;if(!c(this.primaryButtonEle))return this.element.querySelector(".e-primary")}else e=n;return e},e.prototype.disableElement=function(t,e){var i=t?t.matches||t.webkitMatchesSelector||t.msMatchesSelector:null;if(i)for(;t;t=t.parentNode)if(t instanceof Element&&i.call(t,e))return t;return null},e.prototype.focusContent=function(){var t=this.getAutoFocusNode(this.element);(c(t)?this.element:t).focus(),this.bindEvent(this.element)},e.prototype.bindEvent=function(t){Ma.add(t,"keydown",this.keyDown,this)},e.prototype.unBindEvent=function(t){Ma.remove(t,"keydown",this.keyDown)},e.prototype.getModuleName=function(){return"dialog"},e.prototype.onPropertyChanged=function(t,e){if(this.element.classList.contains(Qc))for(var i=0,n=Object.keys(t);i<n.length;i++)switch(n[i]){case"content":c(this.content)||""===this.content?c(this.contentEle)||(A(this.contentEle),this.contentEle=null):c(this.contentEle)||"dialog"===this.contentEle.getAttribute("role")?this.setContent():(this.contentEle.innerHTML="","string"==typeof this.content?this.contentEle.innerHTML=this.content:this.contentEle.appendChild(this.content),this.setMaxHeight());break;case"header":""===this.header||c(this.header)?A(this.headerEle):this.setHeader();break;case"footerTemplate":if(""===this.footerTemplate||c(this.footerTemplate)){if(!this.ftrTemplateContent)return;A(this.ftrTemplateContent),this.ftrTemplateContent=null,this.buttons=[{}]}else this.setFooterTemplate(),this.buttons=[{}];break;case"showCloseIcon":this.element.getElementsByClassName("e-icon-dlg-close").length>0?this.showCloseIcon||""!==this.header&&!c(this.header)?this.showCloseIcon||A(this.closeIcon):(A(this.headerContent),this.headerContent=null):(this.renderCloseIcon(),this.wireEvents());break;case"locale":this.showCloseIcon&&this.closeIconTitle();break;case"visible":this.visible?this.show():this.hide();break;case"isModal":this.updateIsModal();break;case"height":j(this.element,{height:b(t.height)});break;case"width":j(this.element,{width:b(t.width)});break;case"zIndex":this.popupObj.zIndex=this.zIndex,this.isModal&&this.setOverlayZindex(this.zIndex);break;case"cssClass":this.setCSSClass(e.cssClass);break;case"buttons":c(this.buttons[0].buttonModel)||(c(this.ftrTemplateContent)||(A(this.ftrTemplateContent),this.ftrTemplateContent=null),this.footerTemplate="",this.setButton());break;case"allowDragging":!this.allowDragging||this.isModal||c(this.headerContent)?this.dragObj.destroy():this.setAllowDragging();break;case"target":this.popupObj.relateTo=t.target;break;case"position":this.positionChange();break;case"enableRtl":this.setEnableRTL()}},e.prototype.updateIsModal=function(){if(this.element.setAttribute("aria-modal",this.isModal?"true":"false"),this.isModal)this.setIsModal(),this.element.style.top="0px",this.element.style.left="0px",c(this.targetEle)||this.targetEle.appendChild(this.dlgContainer);else{for(P([this.element],"e-dlg-modal"),P([document.body],"e-scroll-disabled"),A(this.dlgOverlay);this.dlgContainer.firstChild;)this.dlgContainer.parentElement.insertBefore(this.dlgContainer.firstChild,this.dlgContainer);this.dlgContainer.parentElement.removeChild(this.dlgContainer)}this.visible&&this.show(),this.positionChange()},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.destroy=function(){if(this.element.classList.contains(Qc)){this.unWireEvents(),t.prototype.destroy.call(this);var e=[Qc,"e-rtl","e-dlg-modal"];if(P([this.element,this.element],e),this.popupObj.element.classList.contains("e-popup")&&this.popupObj.destroy(),!c(this.btnObj))for(var i=void 0;i<this.btnObj.length;i++)this.btnObj[i].destroy();for(this.isModal&&(A(this.dlgOverlay),this.dlgContainer.parentNode.insertBefore(this.element,this.dlgContainer),A(this.dlgContainer)),this.element.innerHTML="";this.element.attributes.length>0;)this.element.removeAttribute(this.element.attributes[0].name);for(var n=0;n<this.clonedEle.attributes.length;n++)this.element.setAttribute(this.clonedEle.attributes[n].name,this.clonedEle.attributes[n].value)}},e.prototype.wireEvents=function(){this.showCloseIcon&&Ma.add(this.closeIcon,"click",this.closeIconClickEventHandler,this),this.isModal&&Ma.add(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler,this)},e.prototype.unWireEvents=function(){if(this.showCloseIcon&&Ma.remove(this.closeIcon,"click",this.closeIconClickEventHandler),this.isModal&&Ma.remove(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler),!c(this.buttons[0].buttonModel))for(var t=0;t<this.buttons.length;t++)"function"==typeof this.buttons[t].click&&Ma.remove(this.ftrTemplateContent.children[t],"click",this.buttons[t].click)},e.prototype.refreshPosition=function(){this.popupObj.refreshPosition()},e.prototype.show=function(t){if(this.element.classList.contains(Qc)&&(!this.element.classList.contains("e-popup-open")||!c(t))){c(t)||this.fullScreen(t);var e={cancel:!1,element:this.element,container:this.isModal?this.dlgContainer:this.element,target:this.target};if(this.trigger("beforeOpen",e),e.cancel)return;this.storeActiveElement=document.activeElement,this.element.tabIndex=-1,this.isModal&&!c(this.dlgOverlay)&&(this.dlgOverlay.style.display="block",this.dlgContainer.style.display="flex",c(this.targetEle)?E([document.body],"e-scroll-disabled"):(this.targetEle===document.body?this.dlgContainer.style.position="fixed":this.dlgContainer.style.position="absolute",this.dlgOverlay.style.position="absolute",this.element.style.position="relative",E([this.targetEle],"e-scroll-disabled")));var i={name:this.animationSettings.effect+"In",duration:this.animationSettings.duration,delay:this.animationSettings.delay};"None"===this.animationSettings.effect?this.popupObj.show():this.popupObj.show(i),this.dialogOpen=!0;var n=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.visible=!0,this.isProtectedOnChange=n}},e.prototype.hide=function(t){if(this.element.classList.contains(Qc)){var e={cancel:!1,isInteraction:!!t,element:this.element,target:this.target,container:this.isModal?this.dlgContainer:this.element,event:t};if(this.trigger("beforeClose",e),this.closeArgs=e,!e.cancel){this.isModal&&(this.dlgOverlay.style.display="none",c(this.targetEle)?P([document.body],"e-scroll-disabled"):P([this.targetEle],"e-scroll-disabled"));var i={name:this.animationSettings.effect+"Out",duration:this.animationSettings.duration,delay:this.animationSettings.delay};"None"===this.animationSettings.effect?this.popupObj.hide():this.popupObj.hide(i),this.dialogOpen=!1;var n=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.visible=!1,this.isProtectedOnChange=n}}},e.prototype.fullScreen=function(t){this.element.offsetTop,this.element.offsetLeft;if(t){E([this.element],"e-dlg-fullscreen");var e=this.element.style.display;this.element.style.display="none",this.element.style.maxHeight=c(this.target)?window.innerHeight+"px":this.targetEle.offsetHeight+"px",this.element.style.display=e,E([document.body],"e-scroll-disabled"),this.allowDragging&&!c(this.dragObj)&&this.dragObj.destroy()}else P([this.element],"e-dlg-fullscreen"),P([document.body],"e-scroll-disabled"),!this.allowDragging||this.isModal||c(this.headerContent)||this.setAllowDragging();return t},Gc([et("")],e.prototype,"content",void 0),Gc([et(!1)],e.prototype,"showCloseIcon",void 0),Gc([et(!1)],e.prototype,"isModal",void 0),Gc([et("")],e.prototype,"header",void 0),Gc([et(!0)],e.prototype,"visible",void 0),Gc([et("auto")],e.prototype,"height",void 0),Gc([et("100%")],e.prototype,"width",void 0),Gc([et("")],e.prototype,"cssClass",void 0),Gc([et(1e3)],e.prototype,"zIndex",void 0),Gc([et(null)],e.prototype,"target",void 0),Gc([et("")],e.prototype,"footerTemplate",void 0),Gc([et(!1)],e.prototype,"allowDragging",void 0),Gc([ot([{}],Zc)],e.prototype,"buttons",void 0),Gc([et(!0)],e.prototype,"closeOnEscape",void 0),Gc([it({},Kc)],e.prototype,"animationSettings",void 0),Gc([it({X:"center",Y:"center"},Uc)],e.prototype,"position",void 0),Gc([st()],e.prototype,"created",void 0),Gc([st()],e.prototype,"open",void 0),Gc([st()],e.prototype,"beforeOpen",void 0),Gc([st()],e.prototype,"close",void 0),Gc([st()],e.prototype,"beforeClose",void 0),Gc([st()],e.prototype,"dragStart",void 0),Gc([st()],e.prototype,"dragStop",void 0),Gc([st()],e.prototype,"drag",void 0),Gc([st()],e.prototype,"overlayClick",void 0),e=Gc([at],e)}(wl),$c=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),td=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},ed=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $c(e,t),td([et({effect:"FadeIn",duration:150,delay:0})],e.prototype,"open",void 0),td([et({effect:"FadeOut",duration:150,delay:0})],e.prototype,"close",void 0),e}(qa),id=function(t){function e(e,i){return t.call(this,e,i)||this}return $c(e,t),e.prototype.initialize=function(){this.formatPosition(),E([this.element],"e-tooltip")},e.prototype.formatPosition=function(){0===this.position.indexOf("Top")||0===this.position.indexOf("Bottom")?(t=this.position.split(/(?=[A-Z])/),this.tooltipPositionY=t[0],this.tooltipPositionX=t[1]):(e=this.position.split(/(?=[A-Z])/),this.tooltipPositionX=e[0],this.tooltipPositionY=e[1]);var t,e},e.prototype.renderArrow=function(){this.setTipClass(this.position);var t=L("div",{className:"e-arrow-tip "+this.tipClass});t.appendChild(L("div",{className:"e-arrow-tip-outer "+this.tipClass})),t.appendChild(L("div",{className:"e-arrow-tip-inner "+this.tipClass})),this.tooltipEle.appendChild(t)},e.prototype.setTipClass=function(t){0===t.indexOf("Right")?this.tipClass="e-tip-left":0===t.indexOf("Bottom")?this.tipClass="e-tip-top":0===t.indexOf("Left")?this.tipClass="e-tip-right":this.tipClass="e-tip-bottom"},e.prototype.renderPopup=function(t){var e=this.mouseTrail?{top:0,left:0}:this.getTooltipPosition(t);this.popupObj=new Xc(this.tooltipEle,{height:this.height,width:this.width,position:{X:e.left,Y:e.top},enableRtl:this.enableRtl,open:this.openPopupHandler.bind(this),close:this.closePopupHandler.bind(this)})},e.prototype.getTooltipPosition=function(t){this.tooltipEle.style.display="none";var e=fi(t,this.tooltipPositionX,this.tooltipPositionY);this.tooltipEle.style.display="";var i=this.calculateTooltipOffset(this.position);return this.collisionFlipFit(t,e.left+i.left,e.top+i.top)},e.prototype.reposition=function(t){var e=this.getTooltipPosition(t);this.popupObj.position={X:e.left,Y:e.top},this.popupObj.dataBind()},e.prototype.openPopupHandler=function(){this.trigger("afterOpen",this.tooltipEventArgs)},e.prototype.closePopupHandler=function(){this.clear(),this.trigger("afterClose",this.tooltipEventArgs)},e.prototype.calculateTooltipOffset=function(t){var e={top:0,left:0},i=this.tooltipEle.offsetWidth,n=this.tooltipEle.offsetHeight,o=this.tooltipEle.querySelector(".e-arrow-tip"),r=o?o.offsetWidth:0,s=o?o.offsetHeight:0,a=this.showTipPointer?0:8,l=s/2+2+(this.tooltipEle.offsetHeight-this.tooltipEle.clientHeight),h=r/2+2+(this.tooltipEle.offsetWidth-this.tooltipEle.clientWidth);switch(this.mouseTrail&&(a+=2),t){case"RightTop":e.left+=r+a,e.top-=n-l;break;case"RightCenter":e.left+=r+a,e.top-=n/2;break;case"RightBottom":e.left+=r+a,e.top-=l;break;case"BottomRight":e.top+=s+a,e.left-=h;break;case"BottomCenter":e.top+=s+a,e.left-=i/2;break;case"BottomLeft":e.top+=s+a,e.left-=i-h;break;case"LeftBottom":e.left-=r+i+a,e.top-=l;break;case"LeftCenter":e.left-=r+i+a,e.top-=n/2;break;case"LeftTop":e.left-=r+i+a,e.top-=n-l;break;case"TopLeft":e.top-=n+s+a,e.left-=i-h;break;case"TopRight":e.top-=n+s+a,e.left-=h;break;default:e.top-=n+s+a,e.left-=i/2}return e.left+=this.offsetX,e.top+=this.offsetY,e},e.prototype.updateTipPosition=function(t){var e=this.tooltipEle.querySelectorAll(".e-arrow-tip,.e-arrow-tip-outer,.e-arrow-tip-inner");P(e,["e-tip-bottom","e-tip-top","e-tip-left","e-tip-right"]),this.setTipClass(t),E(e,this.tipClass)},e.prototype.adjustArrow=function(t,e,i,n){if(!1!==this.showTipPointer){this.updateTipPosition(e);var o,r,s=this.tooltipEle.clientWidth,a=this.tooltipEle.clientHeight,l=this.tooltipEle.querySelector(".e-arrow-tip"),h=this.tooltipEle.querySelector(".e-arrow-tip-inner"),c=l.offsetWidth,d=l.offsetHeight;if("e-tip-bottom"===this.tipClass||"e-tip-top"===this.tipClass)"e-tip-bottom"===this.tipClass?(r="99.9%",h.style.top="-"+(d-2)+"px"):(r=-(d-1)+"px",h.style.top="-"+(d-6)+"px"),o=(p="Center"!==i||s>t.offsetWidth||this.mouseTrail)&&"Left"===i||!p&&"End"===this.tipPointerPosition?s-c-2+"px":p&&"Right"===i||!p&&"Start"===this.tipPointerPosition?"2px":s/2-c/2+"px";else{"e-tip-right"===this.tipClass?(o="99.9%",h.style.left="-"+(c-2)+"px"):(o=-(c-1)+"px",h.style.left=c-2-c+"px");var p="Center"!==n||a>t.offsetHeight||this.mouseTrail;r=p&&"Top"===n||!p&&"End"===this.tipPointerPosition?a-d-2+"px":p&&"Bottom"===n||!p&&"Start"===this.tipPointerPosition?"2px":a/2-d/2+"px"}l.style.top=r,l.style.left=o}},e.prototype.renderContent=function(t){var e=this.tooltipEle.querySelector(".e-tip-content");t&&!c(t.getAttribute("title"))&&(t.setAttribute("data-content",t.getAttribute("title")),t.removeAttribute("title")),c(this.content)?t&&!c(t.getAttribute("data-content"))&&(e.innerHTML=t.getAttribute("data-content")):(e.innerHTML="",this.content instanceof HTMLElement?e.appendChild(this.content):"string"==typeof this.content?e.innerHTML=this.content:I(Tt(this.content)(),e))},e.prototype.renderCloseIcon=function(){if(this.isSticky){var t=L("div",{className:"e-icons e-tooltip-close"});this.tooltipEle.appendChild(t),Ma.add(t,za.touchStartEvent,this.onStickyClose,this)}},e.prototype.addDescribedBy=function(t,e){var i=(t.getAttribute("aria-describedby")||"").split(/\s+/);i.indexOf(e)<0&&i.push(e),R(t,{"aria-describedby":i.join(" ").trim(),"data-tooltip-id":e})},e.prototype.removeDescribedBy=function(t){var e=t.getAttribute("data-tooltip-id"),i=(t.getAttribute("aria-describedby")||"").split(/\s+/),n=i.indexOf(e);-1!==n&&i.splice(n,1),t.removeAttribute("data-tooltip-id");var o=i.join(" ").trim();o?t.setAttribute("aria-describedby",o):t.removeAttribute("aria-describedby")},e.prototype.tapHoldHandler=function(t){clearTimeout(this.autoCloseTimer),this.targetHover(t.originalEvent)},e.prototype.touchEndHandler=function(t){var e=this;if(!this.isSticky){var i=function(){e.close()};this.autoCloseTimer=setTimeout(i,1500)}},e.prototype.targetClick=function(t){var e;c(e=this.target?N(t.target,this.target):this.element)||(null===e.getAttribute("data-tooltip-id")?this.targetHover(t):this.isSticky||this.hideTooltip(this.animation.close,t,e))},e.prototype.targetHover=function(t){var e;if(e=this.target?N(t.target,this.target):this.element,!c(e)&&null===e.getAttribute("data-tooltip-id")){for(var i=0,n=[].slice.call(document.querySelectorAll("[data-tooltip-id= "+this.ctrlId+"_content]"));i<n.length;i++){var o=n[i];this.restoreElement(o)}this.showTooltip(e,this.animation.open,t),this.wireMouseEvents(t,e)}},e.prototype.showTooltip=function(t,e,i){var n=this;if(clearTimeout(this.showTimer),clearTimeout(this.hideTimer),this.tooltipEventArgs=i?{type:i.type,cancel:!1,target:t,event:i,element:this.tooltipEle}:{type:null,cancel:!1,target:t,event:null,element:this.tooltipEle},this.trigger("beforeRender",this.tooltipEventArgs),this.tooltipEventArgs.cancel)return this.isHidden=!0,void this.clear();if(this.isHidden=!1,c(this.tooltipEle)?(this.ctrlId=p(this.element.getAttribute("id")?this.element.getAttribute("id"):"tooltip"),this.tooltipEle=L("div",{className:"e-tooltip-wrap e-popup",attrs:{role:"tooltip","aria-hidden":"false",id:this.ctrlId+"_content"},styles:"width:"+b(this.width)+";height:"+b(this.height)+";position:absolute;"}),this.cssClass&&E([this.tooltipEle],this.cssClass.split(" ")),za.isDevice&&E([this.tooltipEle],"e-bigger"),"auto"!==this.width&&(this.tooltipEle.style.maxWidth=b(this.width)),this.tooltipEle.appendChild(L("div",{className:"e-tip-content"})),document.body.appendChild(this.tooltipEle),this.addDescribedBy(t,this.ctrlId+"_content"),this.renderContent(t),E([this.tooltipEle],"e-popup-open"),this.showTipPointer&&this.renderArrow(),this.renderCloseIcon(),this.renderPopup(t)):(this.adjustArrow(t,this.position,this.tooltipPositionX,this.tooltipPositionY),this.addDescribedBy(t,this.ctrlId+"_content"),this.renderContent(t),Fa.stop(this.tooltipEle),this.reposition(t)),P([this.tooltipEle],"e-popup-open"),E([this.tooltipEle],"e-popup-close"),this.tooltipEventArgs=i?{type:i.type,cancel:!1,target:t,event:i,element:this.tooltipEle}:{type:null,cancel:!1,target:t,event:null,element:this.tooltipEle},this.trigger("beforeOpen",this.tooltipEventArgs),this.tooltipEventArgs.cancel)return this.isHidden=!0,void this.clear();var o={name:e.effect,duration:e.duration,delay:e.delay,timingFunction:"easeOut"};if("None"===e.effect&&(o=void 0),this.openDelay>0){var r=function(){n.popupObj&&n.popupObj.show(o)};this.showTimer=setTimeout(r,this.openDelay)}else this.popupObj.show(o)},e.prototype.checkCollision=function(t,e,i){var n={left:e,top:i,position:this.position,horizontal:this.tooltipPositionX,vertical:this.tooltipPositionY},o=Oi(this.tooltipEle,this.target?this.element:null,e,i);return o.length>0&&(n.horizontal=o.indexOf("left")>=0?"Right":o.indexOf("right")>=0?"Left":this.tooltipPositionX,n.vertical=o.indexOf("top")>=0?"Bottom":o.indexOf("bottom")>=0?"Top":this.tooltipPositionY),n},e.prototype.collisionFlipFit=function(t,e,i){var n=this.checkCollision(t,e,i),o=n.position;if(this.tooltipPositionY!==n.vertical&&(o=0===this.position.indexOf("Bottom")||0===this.position.indexOf("Top")?n.vertical+this.tooltipPositionX:this.tooltipPositionX+n.vertical),this.tooltipPositionX!==n.horizontal&&(0===o.indexOf("Left")&&(n.vertical="LeftTop"===o||"LeftCenter"===o?"Top":"Bottom",o=n.vertical+"Left"),0===o.indexOf("Right")&&(n.vertical="RightTop"===o||"RightCenter"===o?"Top":"Bottom",o=n.vertical+"Right"),n.horizontal=this.tooltipPositionX),this.tooltipEventArgs={type:null,cancel:!1,target:t,event:null,element:this.tooltipEle,collidedPosition:o},this.trigger("beforeCollision",this.tooltipEventArgs),n.position!==o){var r=fi(t,this.tooltipPositionX,n.vertical);this.adjustArrow(t,o,n.horizontal,n.vertical);var s=this.calculateTooltipOffset(o);n.position=o,n.left=r.left+s.left,n.top=r.top+s.top}else this.adjustArrow(t,o,n.horizontal,n.vertical);var a={left:n.left,top:n.top},l=Ti(this.tooltipEle,this.target?this.element:null,{X:!0,Y:!1},a).left;if(this.showTipPointer&&(0===o.indexOf("Bottom")||0===o.indexOf("Top"))){var h=this.tooltipEle.querySelector(".e-arrow-tip"),c=parseInt(h.style.left,10)-(l-n.left);c<0?c=0:c+h.offsetWidth>this.tooltipEle.clientWidth&&(c=this.tooltipEle.clientWidth-h.offsetWidth),h.style.left=c.toString()+"px"}return a.left=l,a},e.prototype.hideTooltip=function(t,e,i){var n,o=this;if(e?(n=this.target?i||e.target:this.element,this.tooltipEventArgs={type:e.type,cancel:!1,target:n,event:e,element:this.tooltipEle}):(n=document.querySelector("[data-tooltip-id= "+this.ctrlId+"_content]"),this.tooltipEventArgs={type:null,cancel:!1,target:n,event:null,element:this.tooltipEle}),!c(n))if(this.trigger("beforeClose",this.tooltipEventArgs),this.tooltipEventArgs.cancel)this.isHidden=!1;else{this.restoreElement(n),this.isHidden=!0;var r={name:t.effect,duration:t.duration,delay:t.delay,timingFunction:"easeIn"};if("None"===t.effect&&(r=void 0),this.closeDelay>0){var s=function(){o.popupObj&&o.popupObj.hide(r)};this.hideTimer=setTimeout(s,this.closeDelay)}else this.popupObj.hide(r)}},e.prototype.restoreElement=function(t){this.unwireMouseEvents(t),c(t.getAttribute("data-content"))||(t.setAttribute("title",t.getAttribute("data-content")),t.removeAttribute("data-content")),this.removeDescribedBy(t)},e.prototype.clear=function(){this.tooltipEle&&(P([this.tooltipEle],"e-popup-close"),E([this.tooltipEle],"e-popup-open")),this.isHidden&&(this.popupObj&&this.popupObj.destroy(),this.tooltipEle&&M(this.tooltipEle),this.tooltipEle=null,this.popupObj=null)},e.prototype.onMouseOut=function(t){this.hideTooltip(this.animation.close,t)},e.prototype.onStickyClose=function(t){this.close()},e.prototype.onMouseMove=function(t){var e=0,i=0;t.type.indexOf("touch")>-1?(t.preventDefault(),e=t.touches[0].pageX,i=t.touches[0].pageY):(e=t.pageX,i=t.pageY),Fa.stop(this.tooltipEle),P([this.tooltipEle],"e-popup-close"),E([this.tooltipEle],"e-popup-open"),this.adjustArrow(t.target,this.position,this.tooltipPositionX,this.tooltipPositionY);var n=this.calculateTooltipOffset(this.position),o=e+n.left+this.offsetX,r=i+n.top+this.offsetY,s=this.checkCollision(t.target,o,r);if(this.tooltipPositionX!==s.horizontal||this.tooltipPositionY!==s.vertical){var a=0===this.position.indexOf("Bottom")||0===this.position.indexOf("Top")?s.vertical+s.horizontal:s.horizontal+s.vertical;s.position=a,this.adjustArrow(t.target,s.position,s.horizontal,s.vertical);var l=this.calculateTooltipOffset(s.position);s.left=e+l.left-this.offsetX,s.top=i+l.top-this.offsetY}this.tooltipEle.style.left=s.left+"px",this.tooltipEle.style.top=s.top+"px"},e.prototype.keyDown=function(t){this.tooltipEle&&27===t.keyCode&&this.close()},e.prototype.touchEnd=function(t){this.tooltipEle&&null===N(t.target,".e-tooltip")&&this.close()},e.prototype.scrollHandler=function(t){this.tooltipEle&&this.close()},e.prototype.render=function(){this.initialize(),this.wireEvents(this.opensOn)},e.prototype.preRender=function(){this.tipClass="e-tip-bottom",this.tooltipPositionX="Center",this.tooltipPositionY="Top",this.isHidden=!0},e.prototype.wireEvents=function(t){for(var e=0,i=this.getTriggerList(t);e<i.length;e++){var n=i[e];if("Custom"===n)return;"Focus"===n&&this.wireFocusEvents(),"Click"===n&&Ma.add(this.element,za.touchStartEvent,this.targetClick,this),"Hover"===n&&(za.isDevice?(this.touchModule=new Vl(this.element,{tapHoldThreshold:500,tapHold:this.tapHoldHandler.bind(this)}),Ma.add(this.element,za.touchEndEvent,this.touchEndHandler,this)):Ma.add(this.element,"mouseover",this.targetHover,this))}Ma.add(document,"touchend",this.touchEnd,this),Ma.add(document,"scroll",this.scrollHandler,this),Ma.add(document,"keydown",this.keyDown,this)},e.prototype.getTriggerList=function(t){return"Auto"===t&&(t=za.isDevice?"Hover":"Hover Focus"),t.split(" ")},e.prototype.wireFocusEvents=function(){if(c(this.target))Ma.add(this.element,"focus",this.targetHover,this);else for(var t=0,e=[].slice.call(this.element.querySelectorAll(this.target));t<e.length;t++){var i=e[t];Ma.add(i,"focus",this.targetHover,this)}},e.prototype.wireMouseEvents=function(t,e){this.tooltipEle&&(this.isSticky||("focus"===t.type&&Ma.add(e,"blur",this.onMouseOut,this),"mouseover"===t.type&&Ma.add(e,"mouseleave",this.onMouseOut,this)),this.mouseTrail&&Ma.add(e,"mousemove touchstart mouseenter",this.onMouseMove,this))},e.prototype.unwireEvents=function(t){for(var e=0,i=this.getTriggerList(t);e<i.length;e++){var n=i[e];if("Custom"===n)return;"Focus"===n&&this.unwireFocusEvents(),"Click"===n&&Ma.remove(this.element,za.touchStartEvent,this.targetClick),"Hover"===n&&(za.isDevice?(this.touchModule&&this.touchModule.destroy(),Ma.remove(this.element,za.touchEndEvent,this.touchEndHandler)):Ma.remove(this.element,"mouseover",this.targetHover))}Ma.remove(document,"touchend",this.touchEnd),Ma.remove(document,"scroll",this.scrollHandler),Ma.remove(document,"keydown",this.keyDown)},e.prototype.unwireFocusEvents=function(){if(c(this.target))Ma.remove(this.element,"focus",this.targetHover);else for(var t=0,e=[].slice.call(this.element.querySelectorAll(this.target));t<e.length;t++){var i=e[t];Ma.remove(i,"focus",this.targetHover)}},e.prototype.unwireMouseEvents=function(t){if(!this.isSticky)for(var e=0,i=this.getTriggerList(this.opensOn);e<i.length;e++){var n=i[e];"Focus"===n&&Ma.remove(t,"blur",this.onMouseOut),"Hover"!==n||za.isDevice||Ma.remove(t,"mouseleave",this.onMouseOut)}this.mouseTrail&&Ma.remove(t,"mousemove touchstart mouseenter",this.onMouseMove)},e.prototype.getModuleName=function(){return"tooltip"},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.onPropertyChanged=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++)switch(n[i]){case"width":this.tooltipEle&&(this.tooltipEle.style.width=b(t.width));break;case"height":this.tooltipEle&&(this.tooltipEle.style.height=b(t.height));break;case"content":this.tooltipEle&&this.renderContent();break;case"opensOn":this.unwireEvents(e.opensOn),this.wireEvents(t.opensOn);break;case"position":this.formatPosition();var o=document.querySelector("[data-tooltip-id= "+this.ctrlId+"_content]");if(this.tooltipEle&&o){var r=this.tooltipEle.querySelector(".e-arrow-tip-inner");r.style.top=r.style.left=null,this.reposition(o)}break;case"tipPointerPosition":var s=document.querySelector("[data-tooltip-id= "+this.ctrlId+"_content]");this.tooltipEle&&s&&this.reposition(s);break;case"offsetX":if(this.tooltipEle){var a=t.offsetX-e.offsetX;this.tooltipEle.style.left=(parseInt(this.tooltipEle.style.left,10)+a).toString()+"px"}break;case"offsetY":if(this.tooltipEle){var l=t.offsetY-e.offsetY;this.tooltipEle.style.top=(parseInt(this.tooltipEle.style.top,10)+l).toString()+"px"}break;case"cssClass":this.tooltipEle&&(e.cssClass&&P([this.tooltipEle],e.cssClass.split(" ")),t.cssClass&&E([this.tooltipEle],t.cssClass.split(" ")));break;case"enableRtl":this.tooltipEle&&(this.enableRtl?E([this.tooltipEle],"e-rtl"):P([this.tooltipEle],"e-rtl"))}},e.prototype.open=function(t,e){void 0===e&&(e=this.animation.open),"none"!==t.style.display&&this.showTooltip(t,e)},e.prototype.close=function(t){void 0===t&&(t=this.animation.close),this.hideTooltip(t)},e.prototype.refresh=function(t){this.tooltipEle&&this.renderContent(t),this.popupObj&&t&&this.reposition(t)},e.prototype.destroy=function(){t.prototype.destroy.call(this),P([this.element],"e-tooltip"),this.unwireEvents(this.opensOn),this.popupObj&&this.popupObj.destroy(),this.tooltipEle&&M(this.tooltipEle),this.tooltipEle=null,this.popupObj=null},td([et("auto")],e.prototype,"width",void 0),td([et("auto")],e.prototype,"height",void 0),td([et()],e.prototype,"content",void 0),td([et()],e.prototype,"target",void 0),td([et("TopCenter")],e.prototype,"position",void 0),td([et(0)],e.prototype,"offsetX",void 0),td([et(0)],e.prototype,"offsetY",void 0),td([et(!0)],e.prototype,"showTipPointer",void 0),td([et("Auto")],e.prototype,"tipPointerPosition",void 0),td([et("Auto")],e.prototype,"opensOn",void 0),td([et(!1)],e.prototype,"mouseTrail",void 0),td([et(!1)],e.prototype,"isSticky",void 0),td([it({},ed)],e.prototype,"animation",void 0),td([et(0)],e.prototype,"openDelay",void 0),td([et(0)],e.prototype,"closeDelay",void 0),td([et()],e.prototype,"cssClass",void 0),td([et(!1)],e.prototype,"enableRtl",void 0),td([st()],e.prototype,"beforeRender",void 0),td([st()],e.prototype,"beforeOpen",void 0),td([st()],e.prototype,"afterOpen",void 0),td([st()],e.prototype,"beforeClose",void 0),td([st()],e.prototype,"afterClose",void 0),td([st()],e.prototype,"beforeCollision",void 0),td([st()],e.prototype,"created",void 0),td([st()],e.prototype,"destroyed",void 0),e=td([at],e)}(wl),nd={},od=null,rd=null,sd=30,ad=30,ld=30,hd="e-spin-show",cd="e-spin-hide",dd="e-spin-material",pd="e-spin-fabric",ud="e-spin-bootstrap",gd="e-spin-high-contrast",md="e-spinner-pane",fd="e-spinner-inner",vd="e-path-circle",yd="e-path-arc",bd="e-spin-label",wd="e-spin-template",xd=Object.freeze({PositionData:Uc,Popup:Xc,getScrollableParent:Ki,getZindexPartial:Qi,calculateRelativeBasedPosition:mi,calculatePosition:fi,fit:Ti,isCollide:Oi,flip:Ii,ButtonProps:Zc,AnimationSettings:Kc,Dialog:Jc,Animation:ed,Tooltip:id,createSpinner:Ji,showSpinner:An,hideSpinner:Rn,setSpinner:Dn}),Sd=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Cd=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Ld=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Sd(e,t),Cd([et("")],e.prototype,"content",void 0),Cd([et("TopLeft")],e.prototype,"position",void 0),Cd([et("Mouse")],e.prototype,"relativeMode",void 0),Cd([et(!0)],e.prototype,"showTipPointer",void 0),Cd([et("auto")],e.prototype,"width",void 0),Cd([et("auto")],e.prototype,"height",void 0),Cd([et()],e.prototype,"animation",void 0),e}(qa),Ed=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Pd=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},kd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ed(e,t),Pd([et("")],e.prototype,"id",void 0),Pd([et(-1)],e.prototype,"zIndex",void 0),Pd([it({},Xh)],e.prototype,"margin",void 0),Pd([et(!0)],e.prototype,"visible",void 0),Pd([ot([],dc)],e.prototype,"ports",void 0),Pd([et(!0)],e.prototype,"isExpanded",void 0),Pd([it({},Ld)],e.prototype,"tooltip",void 0),Pd([it({},Cc)],e.prototype,"expandIcon",void 0),Pd([it({},Cc)],e.prototype,"collapseIcon",void 0),Pd([et(!1)],e.prototype,"excludeFromLayout",void 0),Pd([et()],e.prototype,"addInfo",void 0),e}(qa),Td=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Od=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Id=function(t){switch(t.type){case"Bpmn":return Bd;default:return Dd}},Ad=function(t){switch(t.type){case"Straight":return Hd;case"Bezier":return zd;case"Orthogonal":return jd;default:return Hd}},Md=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Td(e,t),Od([et(10)],e.prototype,"width",void 0),Od([et(10)],e.prototype,"height",void 0),Od([et("Arrow")],e.prototype,"shape",void 0),Od([it({fill:"black",strokeColor:"black",strokeWidth:1},Jh)],e.prototype,"style",void 0),Od([it({x:0,y:.5},sh)],e.prototype,"pivot",void 0),Od([et("")],e.prototype,"pathData",void 0),e}(qa),Rd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Td(e,t),Od([et(0)],e.prototype,"angle",void 0),Od([et(0)],e.prototype,"distance",void 0),e}(qa),Dd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Td(e,t),Od([et("None")],e.prototype,"type",void 0),e}(qa),Bd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Td(e,t),Od([et("Sequence")],e.prototype,"flow",void 0),Od([et("Normal")],e.prototype,"sequence",void 0),Od([et("Default")],e.prototype,"message",void 0),Od([et("Default")],e.prototype,"association",void 0),e}(Dd),Nd=function(t){function e(e,i,n,o){var r=t.call(this,e,i,n,o)||this;return r.points=[],r}return Td(e,t),Od([et("Straight")],e.prototype,"type",void 0),e}(qa),Hd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Td(e,t),Od([it({x:0,y:0},sh)],e.prototype,"point",void 0),e}(Nd),zd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Td(e,t),Od([it({x:0,y:0},sh)],e.prototype,"point1",void 0),Od([it({x:0,y:0},sh)],e.prototype,"point2",void 0),Od([it({angle:0,distance:0},Rd)],e.prototype,"vector1",void 0),Od([it({angle:0,distance:0},Rd)],e.prototype,"vector2",void 0),e}(Hd),jd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Td(e,t),Od([et(null)],e.prototype,"length",void 0),Od([et(null)],e.prototype,"direction",void 0),e}(Nd),Vd=function(t){function e(e,i,n,o){var r=t.call(this,e,i,n,o)||this;return r.parentId="",r.bridges=[],r}return Td(e,t),e.prototype.init=function(t){this.id||(this.id=te());var e,i=new sc,n=new Hh;n.id=this.id+"_path";var o=new Hh,r=new Hh;n=this.getSegmentElement(this,n);var s,a=[];switch(a=this.getConnectorPoints(this.type),a=this.clipDecorators(this,a),s=ah.toBounds(a),i.width=s.width,i.height=s.height,i.offsetX=s.x+i.pivot.x*s.width,i.offsetY=s.y+i.pivot.y*s.height,this.shape.type){case"Bpmn":switch(this.shape.flow){case"Sequence":e=this.getBpmnSequenceFlow();break;case"Association":(e=new Hh).visible=!1,this.getBpmnAssociationFlow();break;case"Message":e=this.getBpmnMessageFlow(),n=this.getSegmentElement(this,n),this.updateShapePosition(this,e)}}var l=this.intermediatePoints;if("Bezier"===this.type){var h=this.segments[0],c=this.segments[this.segments.length-1];l=[sh.isEmptyPoint(c.point2)?c.bezierPoint2:c.point2,sh.isEmptyPoint(h.point1)?h.bezierPoint1:h.point1]}var d=t.getDescription;this.sourceWrapper&&this.sourceWrapper.style.strokeWidth;if(o=this.getDecoratorElement(a[0],l[1],this.sourceDecorator,!0,d),r=this.getDecoratorElement(a[a.length-1],l[l.length-2],this.targetDecorator,!1,d),o.id=this.id+"_srcDec",r.id=this.id+"_tarDec",n.style=this.style,n.style.fill="transparent",void 0!==d){var p=d(this,t);n.description=p||this.id}i.style.strokeColor="transparent",i.style.fill="transparent",i.style.strokeWidth=0,i.children=[n,o,r],i.id=this.id,void 0!==e&&i.children.push(e),i.offsetX=n.offsetX,i.offsetY=n.offsetY,i.width=n.width,i.height=n.height;for(var u=0;this.annotations,u<this.annotations.length;u++)i.children.push(this.getAnnotationElement(this.annotations[u],this.intermediatePoints,s,d));return this.wrapper=i,i},e.prototype.getBpmnSequenceFlow=function(){var t,e=new Hh,i=new Hh;if("Normal"===this.shape.sequence&&"Bezier"!==this.type&&(this.targetDecorator.shape="Arrow",this.targetDecorator.style.fill="black"),"Default"===this.shape.sequence){e=this.getSegmentElement(this,e);for(var n=this.intermediatePoints,o=0;o<n.length-1;o++)length+=this.distance(n[o],n[o+1]),t=this.findPath(n[o],n[o+1]),i.data=t[0],i.id=this.id+"_"+this.shape.sequence,i.offsetX=t[1].x,i.offsetY=t[1].y,i.rotateAngle=45,i.transform=wh.Self;this.targetDecorator.shape="Arrow",this.targetDecorator.style.fill="black"}return"Conditional"===this.shape.sequence&&(this.targetDecorator.shape="Arrow",this.sourceDecorator.shape="Diamond",this.sourceDecorator.style.fill="white",this.targetDecorator.style.fill="black",this.sourceDecorator.width=20,this.sourceDecorator.height=10),i},e.prototype.getBpmnAssociationFlow=function(){"Default"===this.shape.association&&(this.targetDecorator.shape="Arrow",this.targetDecorator.style.fill="black"),"Directional"===this.shape.association&&(this.style.strokeDashArray="2 2",this.targetDecorator.style.fill="black",this.targetDecorator.shape="Arrow"),"BiDirectional"===this.shape.association&&(this.style.strokeDashArray="2 2",this.targetDecorator.shape="Arrow",this.targetDecorator.style.fill="black",this.sourceDecorator.shape="Arrow",this.sourceDecorator.style.fill="white",this.sourceDecorator.width=5,this.sourceDecorator.height=10)},e.prototype.getBpmnMessageFlow=function(){var t=new Hh;return this.style.strokeDashArray="4 4",this.targetDecorator.shape="Arrow",this.targetDecorator.width=5,this.targetDecorator.height=10,this.sourceDecorator.shape="Circle","InitiatingMessage"!==this.shape.message&&"NonInitiatingMessage"!==this.shape.message||(t.id=this.id+"_"+this.shape.message,t.width=25,t.height=15,t.data="M0,0 L19.8,12.8 L40,0 L0, 0 L0, 25.5 L40, 25.5 L 40, 0",t.horizontalAlignment="Center",t.verticalAlignment="Center",t.transform=wh.Self,t.style.fill="NonInitiatingMessage"===this.shape.message?"lightgrey":"white"),t},e.prototype.distance=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},e.prototype.findPath=function(t,e){var i={x:t.x,y:t.y},n=this.distance(t,e);n=Math.min(30,n/2);var o=vo(t,e),r=sh.transform({x:i.x,y:i.y},o,n),s=sh.transform({x:r.x,y:r.y},o,-12),a=sh.transform({x:s.x,y:s.y},o,24);return["M"+s.x+" "+s.y+" L"+a.x+" "+a.y,r]},e.prototype.getAnnotationElement=function(t,e,i,n){t.id=t.id||te();var o=new Fh;o.constraints=t.constraints,o.visible=t.visibility,o.horizontalAlignment=t.horizontalAlignment,o.verticalAlignment=t.verticalAlignment,void 0!==i.width&&(o.width=(t.width||i.width)-t.margin.left-t.margin.right),o.margin=t.margin,o.id=this.id+"_"+t.id,0===i.width&&(i.width=this.style.strokeWidth),0===i.height&&(i.height=this.style.strokeWidth),o.content=t.content,o.style=t.style;var r,s=fe(n);return s&&(r=s(t,this)),o.description=r||o.id,this.updateAnnotation(t,e,i,o),o.style.textOverflow="Wrap",o},e.prototype.updateAnnotation=function(t,e,i,n){var o,r,s,a,l,h,c={x:0,y:0};t.margin={left:0,right:0,top:0,bottom:0},n.refreshTextElement(),n.width=(t.width||i.width)-n.margin.left-n.margin.right,r=(o=is(e,t,i)).point,0===i.width&&(i.width=this.style.strokeWidth),0===i.height&&(i.height=this.style.strokeWidth),h={x:(r.x-i.x)/i.width,y:(r.y-i.y)/i.height},c.x=i.width*h.x,c.y=i.height*h.y,a=(s=rs(t,o.angle,e)).hAlign,l=s.vAlign;var d,p;"left"===a?(d="Left",c.x+=t.displacement.x):"right"===a?(d="Right",c.x-=t.displacement.x):"center"===a&&(d="Center"),"top"===l?(p="Top",c.y+=t.displacement.y):"bottom"===l?(p="Bottom",c.y-=t.displacement.y):"center"===l&&(p="Center"),n.horizontalAlignment=d,n.verticalAlignment=p,n.setOffsetWithRespectToBounds(c.x,c.y,"Absolute"),n.relativeMode="Point"},e.prototype.getConnectorPoints=function(t,e,i){Math.abs(this.sourcePoint.x-this.targetPoint.x),Math.abs(this.sourcePoint.y-this.targetPoint.y);var n=(e=_n(this,i)).slice(0);return n&&n.length>0&&(this.sourcePoint=n[0],this.targetPoint=n[n.length-1]),n},e.prototype.clipDecorator=function(t,e,i){var n={x:0,y:0},o={x:0,y:0},r={x:0,y:0},s=e.length;o=i?e[0]:e[s-1],r=i?e[1]:e[s-2];var a=sh.distancePoints(o,r);a=0===a?1:a;var l=t.style.strokeWidth-1;n.x=Math.round(o.x+l*(r.x-o.x)/a),n.y=Math.round(o.y+l*(r.y-o.y)/a);var h=1,c=i?t.sourceWrapper:t.targetWrapper;return c&&(h=c.style.strokeWidth),(i&&"None"!==t.sourceDecorator.shape||!i&&"None"!==t.targetDecorator.shape)&&(n=sh.adjustPoint(n,r,!0,h/2)),n},e.prototype.clipDecorators=function(t,e){return"None"!==t.sourceDecorator.shape&&(e[0]=this.clipDecorator(t,e,!0)),"None"!==t.targetDecorator.shape&&(e[e.length-1]=this.clipDecorator(t,e,!1)),e},e.prototype.updateSegmentElement=function(t,e,i){var n,o=new ah;if(n=this.getSegmentPath(t,e),"Bezier"===t.type){if(this.segments.length>0)for(var r=0;r<this.segments.length;r++){var s=this.segments[r],a=t.segments[r],l=sh.isEmptyPoint(s.point1)?a.bezierPoint1:a.point1,h=sh.isEmptyPoint(s.point2)?a.bezierPoint2:a.point2;o.uniteRect(er(s.points[0],l,h,s.points[1],t))}}else o=ah.toBounds(e);return i.width=o.width,i.height=o.height,i.offsetX=o.x+i.width/2,i.offsetY=o.y+i.height/2,i.data=n,t.wrapper&&(t.wrapper.offsetX=i.offsetX,t.wrapper.offsetY=i.offsetY,t.wrapper.width=o.width,t.wrapper.height=o.height),i},e.prototype.getSegmentElement=function(t,e){var i=[];return i=this.getConnectorPoints(t.type),this.intermediatePoints=i,e.staticSize=!0,e=this.updateSegmentElement(t,i,e)},e.prototype.getDecoratorElement=function(t,e,i,n,o){var r=new Hh;if(r.transform=wh.Self,this.updateDecoratorElement(r,t,e,i),void 0!==o){var s=o(i,this);r.description=s||"source"}return r},e.prototype.bridgePath=function(t,e,i){var n=e;if(t.bridges.length>0)if("Straight"===t.type)for(o=0;o<t.bridges.length;o++)(r=t.bridges[o]).rendered||(n+=" L"+r.startPoint.x+" "+r.startPoint.y,n+=r.path,r.rendered=!0);else if("Orthogonal"===t.type)for(var o=0;o<t.bridges.length;o++){var r=t.bridges[o];r.segmentPointIndex===i&&(r.rendered||r.segmentPointIndex===i&&(n+=" L"+r.startPoint.x+" "+r.startPoint.y,n+=r.path,r.rendered=!0))}return n},e.prototype.updateDecoratorElement=function(t,e,i,n){var o,r;t.offsetX=e.x,t.offsetY=e.y,r=sh.findAngle(e,i),o=si(n.shape,n);var s=new nh(n.width,n.height);t.pivot.x=n.pivot.x,t.pivot.y=n.pivot.y,t.style=n.style,t.rotateAngle=r,t.data=o,t.width=s.width,t.height=s.height},e.prototype.getSegmentPath=function(t,e){for(var i,n,o,r="",s=[],a=0;a<e.length;)s.push({x:e[a].x,y:e[a].y}),a++;for(var l=0;l<t.bridges.length;l++)t.bridges[l].rendered=!1;if(s=this.clipDecorators(t,s),this.cornerRadius>0&&"Bezier"!==this.type)for(var h=0;h<s.length-1;h++){i=s[h],0===h&&(r="M"+i.x+" "+i.y);var c=sh.distancePoints(s[h],s[h+1]);c>0&&(n=h<s.length-2?c<2*this.cornerRadius?sh.adjustPoint(s[h],s[h+1],!1,c/2):sh.adjustPoint(s[h],s[h+1],!1,this.cornerRadius):s[h+1],h>0&&(c<2*this.cornerRadius?(o=sh.adjustPoint(s[h],s[h+1],!0,c/2),h<s.length-2&&(n=null)):o=sh.adjustPoint(s[h],s[h+1],!0,this.cornerRadius)),o&&(r+="Q"+i.x+" "+i.y+" "+o.x+" "+o.y),n&&(t.bridges.length>0&&(r=this.bridgePath(t,r,h),"Orthogonal"===t.type&&(r=this.bridgePath(t,r,h+1))),r+=" L"+n.x+" "+n.y))}else if("Bezier"===this.type){for(var d=void 0,p=this.segments,u=0;u<p.length;u++)s.length>2&&(p[u].bezierPoint1={x:0,y:0},p[u].bezierPoint2={x:0,y:0}),!sh.isEmptyPoint(p[u].point1)||p[u].vector1.angle||p[u].vector1.distance?p[u].vector1.angle||p[u].vector1.distance?p[u].bezierPoint1=sh.transform(s[u],p[u].vector1.angle,p[u].vector1.distance):p[u].bezierPoint1={x:p[u].point1.x||p[u].bezierPoint1.x,y:p[u].point1.y||p[u].bezierPoint1.y}:((t.sourceID||this.sourcePortID)&&this.sourceWrapper&&(d=Jo(this.sourceWrapper.bounds,s[u],!0)),p[u].bezierPoint1=tr(s[u],s[u+1],d)),!sh.isEmptyPoint(p[u].point2)||p[u].vector2.angle||p[u].vector2.distance?p[u].vector2.angle||p[u].vector2.distance?p[u].bezierPoint2=sh.transform(s[u+1],p[u].vector2.angle,p[u].vector2.distance):p[u].bezierPoint2={x:p[u].point2.x||p[u].bezierPoint2.x,y:p[u].point2.y||p[u].bezierPoint2.y}:((t.targetID||this.targetPortID)&&this.targetWrapper&&(d=Jo(this.targetWrapper.bounds,s[u+1],!0)),p[u].bezierPoint2=tr(s[u+1],s[u],d));s.splice(1,0,{x:p[0].bezierPoint1.x,y:p[0].bezierPoint1.y}),s.splice(s.length-1,0,{x:p[p.length-1].bezierPoint2.x,y:p[p.length-1].bezierPoint2.y}),s=this.clipDecorators(t,s);for(var g=0;g<p.length;g++){0===g&&(r="M"+s[0].x+" "+s[0].y);var m=g===p.length-1?s[s.length-1].x+" "+s[s.length-1].y:p[g].points[p[g].points.length-1].x+" "+p[g].points[p[g].points.length-1].y;r+="C"+p[g].bezierPoint1.x+" "+p[g].bezierPoint1.y+" "+p[g].bezierPoint2.x+" "+p[g].bezierPoint2.y+" "+m}}else for(var f=0;f<s.length;f++)i=s[f],0===f&&(r="M"+i.x+" "+i.y),f>0&&(r=this.bridgePath(t,r,f),r+=" L"+i.x+" "+i.y);return r},e.prototype.updateShapeElement=function(t){var e;switch(t.shape.type){case"Bpmn":t.wrapper.children[3]instanceof Hh&&(e=t.wrapper.children[3]),"Message"===t.shape.flow&&this.updateShapePosition(t,e)}},e.prototype.updateShapePosition=function(t,e){for(var i,n,o=0,r=this.intermediatePoints,s=0;s<r.length-1;s++){var a=.5*(o+=this.distance(r[s],r[s+1]));o>=a&&(i=vo(r[s],r[s+1]),n=sh.transform(r[s],i,a))}e.offsetX=n.x,e.offsetY=n.y},e.prototype.scale=function(t,e,i,n,o){var r=0,s=0;if(this.wrapper&&this.wrapper.outerBounds){var a=Ko(this),l=(this.wrapper.bounds.width||this.style.strokeWidth||1)-2,h=(this.wrapper.bounds.height||this.style.strokeWidth||1)-2;r=a.width-l,s=a.height-h,t=(i-Math.max(r,s))/l,e=(n-Math.max(r,s))/h,r=s=Math.min(r,s)}t=e=Math.min(t,e);var c=_t();qt(c,-(o=o||this.wrapper).rotateAngle,o.offsetX,o.offsetY),Xt(c,t,e,o.offsetX,o.offsetY),qt(c,o.rotateAngle,o.offsetX,o.offsetY);var d=Ut(c,this.intermediatePoints);return this.sourcePoint=d[0],this.targetPoint=d[d.length-1],d=this.intermediatePoints=_n(this),fs(this,d),{x:r,y:s}},Od([nt(Id)],e.prototype,"shape",void 0),Od([et(gh.Default)],e.prototype,"constraints",void 0),Od([et(10)],e.prototype,"bridgeSpace",void 0),Od([ot([],vc)],e.prototype,"annotations",void 0),Od([it({},sh)],e.prototype,"sourcePoint",void 0),Od([it({},sh)],e.prototype,"targetPoint",void 0),Od([rt(Ad)],e.prototype,"segments",void 0),Od([et("")],e.prototype,"sourceID",void 0),Od([et("")],e.prototype,"targetID",void 0),Od([et(10)],e.prototype,"hitPadding",void 0),Od([et("Straight")],e.prototype,"type",void 0),Od([et(0)],e.prototype,"cornerRadius",void 0),Od([it({shape:"None"},Md)],e.prototype,"sourceDecorator",void 0),Od([it({shape:"Arrow"},Md)],e.prototype,"targetDecorator",void 0),Od([it({},Ld)],e.prototype,"tooltip",void 0),Od([et("")],e.prototype,"sourcePortID",void 0),Od([et("")],e.prototype,"targetPortID",void 0),Od([it({strokeWidth:1,strokeColor:"black"},$h)],e.prototype,"style",void 0),Od([et(null)],e.prototype,"wrapper",void 0),e}(kd),Fd=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),_d=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Wd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fd(e,t),_d([et("")],e.prototype,"name",void 0),_d([et("")],e.prototype,"pathData",void 0),_d([et("#000000")],e.prototype,"backgroundColor",void 0),_d([et("top")],e.prototype,"side",void 0),_d([et("")],e.prototype,"borderColor",void 0),_d([et(.5)],e.prototype,"borderWidth",void 0),_d([et(25)],e.prototype,"size",void 0),_d([et("white")],e.prototype,"pathColor",void 0),_d([et(10)],e.prototype,"displacement",void 0),_d([et(!0)],e.prototype,"visible",void 0),_d([et(0)],e.prototype,"offset",void 0),_d([it({},Xh)],e.prototype,"margin",void 0),_d([et("Center")],e.prototype,"horizontalAlignment",void 0),_d([et("Center")],e.prototype,"verticalAlignment",void 0),e}(qa),Ud=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fd(e,t),e.prototype.init=function(t){var e=new ic;if(e.measureChildren=!1,e.children=[],this.nodes||this.connectors){for(var i=0;i<this.nodes.length;i++){o=t.nameTable[this.nodes[i].id].wrapper;e.children.push(o)}for(var n=0;n<this.connectors.length;n++){var o=t.nameTable[this.connectors[n].id].wrapper;e.children.push(o)}}return this.wrapper=e,e},_d([et(null)],e.prototype,"wrapper",void 0),_d([ot([],gp)],e.prototype,"nodes",void 0),_d([ot([],Vd)],e.prototype,"connectors",void 0),_d([et()],e.prototype,"width",void 0),_d([et()],e.prototype,"height",void 0),_d([et(0)],e.prototype,"rotateAngle",void 0),_d([et(0)],e.prototype,"offsetX",void 0),_d([et(0)],e.prototype,"offsetY",void 0),_d([it({x:.5,y:.5},sh)],e.prototype,"pivot",void 0),_d([et("CompleteIntersect")],e.prototype,"rubberBandSelectionMode",void 0),_d([ot([],Wd)],e.prototype,"userHandles",void 0),_d([et(uh.All)],e.prototype,"constraints",void 0),e}(qa),qd=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Xd=function(t){function e(){var e=t.call(this)||this;return e.data="",e}return qd(e,t),Object.defineProperty(e.prototype,"content",{get:function(){return this.data},set:function(t){this.data=t,this.template=ti(this,!0),this.isDirt=!0},enumerable:!0,configurable:!0}),e}(Bh),Yd=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Gd=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Zd=function(t){switch(t.type){case"Basic":return ip;case"Flow":return np;case"Path":return Qd;case"Image":return tp;case"Text":return ep;case"Bpmn":return up;case"Native":return Jd;case"HTML":return $d;default:return ip}},Kd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yd(e,t),Gd([et("Basic")],e.prototype,"type",void 0),e}(qa),Qd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yd(e,t),Gd([et("Path")],e.prototype,"type",void 0),Gd([et("")],e.prototype,"data",void 0),e}(Kd),Jd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yd(e,t),Gd([et("Native")],e.prototype,"type",void 0),Gd([et("")],e.prototype,"content",void 0),Gd([et("Stretch")],e.prototype,"scale",void 0),e}(Kd),$d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yd(e,t),Gd([et("HTML")],e.prototype,"type",void 0),Gd([et("")],e.prototype,"content",void 0),e}(Kd),tp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yd(e,t),Gd([et("Image")],e.prototype,"type",void 0),Gd([et("")],e.prototype,"source",void 0),Gd([et("")],e.prototype,"scale",void 0),Gd([et("None")],e.prototype,"align",void 0),e}(Kd),ep=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yd(e,t),Gd([et("Text")],e.prototype,"type",void 0),Gd([et("")],e.prototype,"content",void 0),Gd([it({},Xh)],e.prototype,"margin",void 0),e}(Kd),ip=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yd(e,t),Gd([et("Basic")],e.prototype,"type",void 0),Gd([et("Rectangle")],e.prototype,"shape",void 0),Gd([et(0)],e.prototype,"cornerRadius",void 0),Gd([ot([],sh)],e.prototype,"points",void 0),e}(Kd),np=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yd(e,t),Gd([et("Flow")],e.prototype,"type",void 0),Gd([et("Terminator")],e.prototype,"shape",void 0),e}(Kd),op=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yd(e,t),Gd([et("None")],e.prototype,"type",void 0),e}(qa),rp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yd(e,t),Gd([et("None")],e.prototype,"type",void 0),Gd([et(!1)],e.prototype,"collection",void 0),e}(qa),sp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yd(e,t),Gd([et("None")],e.prototype,"type",void 0),Gd([et("None")],e.prototype,"loop",void 0),Gd([et(!1)],e.prototype,"call",void 0),Gd([et(!1)],e.prototype,"compensation",void 0),e}(qa),ap=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yd(e,t),Gd([et("Start")],e.prototype,"event",void 0),Gd([et("None")],e.prototype,"trigger",void 0),e}(qa),lp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yd(e,t),Gd([et("None")],e.prototype,"trigger",void 0),Gd([et("Start")],e.prototype,"event",void 0),Gd([et("")],e.prototype,"id",void 0),Gd([it({},sh)],e.prototype,"offset",void 0),Gd([ot([],fc)],e.prototype,"annotations",void 0),Gd([ot([],dc)],e.prototype,"ports",void 0),Gd([et()],e.prototype,"width",void 0),Gd([et()],e.prototype,"height",void 0),Gd([it({},Xh)],e.prototype,"margin",void 0),Gd([et("Center")],e.prototype,"horizontalAlignment",void 0),Gd([et("Center")],e.prototype,"verticalAlignment",void 0),Gd([et(!0)],e.prototype,"visible",void 0),e}(qa),hp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yd(e,t),Gd([it({id:"success",event:"End",offset:{x:1,y:.5}},lp)],e.prototype,"success",void 0),Gd([it({id:"failure",event:"Intermediate",trigger:"Error",offset:{x:.25,y:1}},lp)],e.prototype,"failure",void 0),Gd([it({id:"cancel",event:"Intermediate",trigger:"Cancel",offset:{x:.75,y:1}},lp)],e.prototype,"cancel",void 0),e}(qa),cp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yd(e,t),Gd([et("None")],e.prototype,"type",void 0),Gd([et(!1)],e.prototype,"adhoc",void 0),Gd([et("Default")],e.prototype,"boundary",void 0),Gd([et(!1)],e.prototype,"compensation",void 0),Gd([et("None")],e.prototype,"loop",void 0),Gd([et(!0)],e.prototype,"collapsed",void 0),Gd([ot([],lp)],e.prototype,"events",void 0),Gd([it({},hp)],e.prototype,"transaction",void 0),Gd([et(void 0)],e.prototype,"processes",void 0),e}(qa),dp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yd(e,t),Gd([et("Task")],e.prototype,"activity",void 0),Gd([it({},sp)],e.prototype,"task",void 0),Gd([it({},cp)],e.prototype,"subProcess",void 0),e}(qa),pp=function(t){function e(e,i,n,o){return t.call(this,e,i,n,o)||this}return Yd(e,t),Gd([et("")],e.prototype,"text",void 0),Gd([et("")],e.prototype,"id",void 0),Gd([et()],e.prototype,"angle",void 0),Gd([et()],e.prototype,"height",void 0),Gd([et()],e.prototype,"width",void 0),Gd([et()],e.prototype,"length",void 0),e}(qa),up=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yd(e,t),Gd([et("Bpmn")],e.prototype,"type",void 0),Gd([et("Event")],e.prototype,"shape",void 0),Gd([it({},ap)],e.prototype,"event",void 0),Gd([it({},op)],e.prototype,"gateway",void 0),Gd([it({},rp)],e.prototype,"dataObject",void 0),Gd([it({},dp)],e.prototype,"activity",void 0),Gd([ot([],pp)],e.prototype,"annotations",void 0),e}(Kd),gp=function(t){function e(e,i,n,o){var r=t.call(this,e,i,n,o)||this;return r.parentId="",r.processId="",r.outEdges=[],r.inEdges=[],r}return Yd(e,t),Object.defineProperty(e.prototype,"actualSize",{get:function(){return null!==this.wrapper?this.wrapper.actualSize:new nh(this.width||0,this.height||0)},enumerable:!0,configurable:!0}),e.prototype.init=function(t){var e,i=new Bh;switch(this.shape.changedProperties={},this.shape.oldProperties={},this.shape.type){case"Path":var n=new Hh;n.data=this.shape.data,i=n;break;case"Image":var o=new jh;o.source=this.shape.source,o.imageAlign=this.shape.align,o.imageScale=this.shape.scale,i=o;break;case"Text":var r=new Fh;r.content=this.shape.content,i=r,e=this.style,i.style=e;break;case"Basic":if("Rectangle"===this.shape.shape)(i=a=new Bh).cornerRadius=this.shape.cornerRadius;else if("Polygon"===this.shape.shape){var s=new Hh;s.data=Dt(this.shape.points),i=s}else{var a=new Hh,l=oi(this.shape.shape);a.data=l,i=a}break;case"Flow":var h=new Hh,c=li(this.shape.shape);h.data=c,i=h;break;case"Bpmn":if(t.bpmnModule){i=t.bpmnModule.initBPMNContent(i,this,t);var d=this.shape.activity.subProcess;if(d.processes&&d.processes.length)for(var p=0,u=this.shape.activity.subProcess.processes;p<u.length;p++){var g=u[p];!t.nameTable[g]||t.nameTable[g].processId&&t.nameTable[g].processId!==this.id||(t.nameTable[g].processId=this.id,d.collapsed&&t.updateElementVisibility(t.nameTable[g].wrapper,t.nameTable[g],!d.collapsed),i.children.push(t.nameTable[g].wrapper))}}break;case"Native":var m=new oc;m.content=this.shape.content,m.scale=this.shape.scale,i=m;break;case"HTML":var f=new Xd;f.content=this.shape.content,i=f}return i.id=this.id+"_content",i.relativeMode="Object",void 0!==this.width&&(i.width=this.width),i.horizontalAlignment="Stretch",void 0!==this.height&&(i.height=this.height),void 0!==this.minHeight&&(i.minHeight=this.minHeight),void 0!==this.maxHeight&&(i.maxHeight=this.maxHeight),void 0!==this.minWidth&&(i.minWidth=this.minWidth),void 0!==this.maxWidth&&(i.maxWidth=this.maxWidth),"Rectangle"!==this.shape.shape||this.shape.cornerRadius||(i.isRectElement=!0),i.verticalAlignment="Stretch",this.shape instanceof ep&&(i.margin=this.shape.margin),pr(this)&&0!=(this.constraints&fh.Shadow)&&(i.shadow=this.shadow),"Bpmn"===this.shape.type&&"Message"!==this.shape.shape&&"DataSource"!==this.shape.shape||"Text"!==this.shape.type&&(i.style=this.style),i},e.prototype.initContainer=function(){this.id||(this.id=te());var t=this.children?new ic:new sc;return t.id=this.id,t.offsetX=this.offsetX,t.offsetY=this.offsetY,t.visible=this.visible,t.style.fill=this.backgroundColor,t.style.strokeColor=this.borderColor,t.style.strokeWidth=this.borderWidth,t.rotateAngle=this.rotateAngle,t.minHeight=this.minHeight,t.minWidth=this.minWidth,t.maxHeight=this.maxHeight,t.maxWidth=this.maxWidth,t.pivot=this.pivot,t.margin=this.margin,this.wrapper=t,t},e.prototype.initPorts=function(t,e){this.wrapper;for(var i,n=0;this.ports,n<this.ports.length;n++){i=this.initPortWrapper(this.ports[n]);var o=void 0,r=fe(t);r&&(o=r(i,this)),i.description=o||i.id,e.children.push(i)}},e.prototype.getIconOffet=function(t,e){var i,n;return"BottomToTop"===t.orientation?(i=e.offset.x,n=1-e.offset.y):"LeftToRight"===t.orientation?(i=e.offset.y,n=e.offset.x):"RightToLeft"===t.orientation?(i=1-e.offset.y,n=e.offset.x):(i=e.offset.x,n=e.offset.y),{x:i,y:n}},e.prototype.initIcons=function(t,e,i){this.wrapper;var n,o=this.isExpanded?this.expandIcon:this.collapseIcon;if("None"!==o.shape){var r=new sc;r.float=!0;var s=[];r.id=this.id+"_icon_content",r.children=s,r.height=o.height,r.width=o.width,r.style.strokeColor="transparent",r.margin=o.margin,r.horizontalAlignment="Center",r.verticalAlignment="Center",r.visible=this.visible,n=this.getIconOffet(e,o),r.setOffsetWithRespectToBounds(n.x,n.y,"Fraction"),r.relativeMode="Point",this.initIconSymbol(o,r,t);var a=void 0,l=fe(t);l&&(a=l(o,this)),r.description=a||r.id,i.children.push(r)}},e.prototype.initAnnotations=function(t,e){for(var i,n=0;this.annotations,n<this.annotations.length;n++){i=this.initAnnotationWrapper(this.annotations[n]);var o=void 0,r=fe(t);r&&(o=r(i,this)),i.description=o||i.id,e.children.push(i)}},e.prototype.initPortWrapper=function(t){t.id=t.id||te();var e=new Hh;e.height=t.height,e.width=t.width;var i="Custom"===t.shape?t.pathData:ri(t.shape);e.id=this.id+"_"+t.id,e.margin=t.margin,e.data=i;var n=t.style;return e.style={fill:n.fill,strokeColor:n.strokeColor,gradient:null,opacity:n.opacity,strokeDashArray:n.strokeDashArray,strokeWidth:n.strokeWidth},e.horizontalAlignment=t.horizontalAlignment,e.verticalAlignment=t.verticalAlignment,e.setOffsetWithRespectToBounds(t.offset.x,t.offset.y,"Fraction"),void 0===this.width&&void 0===this.height||(e.float=!0),e.relativeMode="Point",e.visible=!(!ws(t,lh.Visible)||ws(t,lh.Hover)||ws(t,lh.Connect)),e},e.prototype.initAnnotationWrapper=function(t){t.id=t.id||te();var e=t,i=new Fh;i.constraints=t.constraints,i.height=t.height,i.width=t.width,i.visible=t.visibility,i.id=this.id+"_"+t.id;var n=t.style,o=t.hyperlink.link?t.hyperlink:void 0;return i.style={fill:n.fill,strokeColor:n.strokeColor,strokeWidth:n.strokeWidth,bold:n.bold,textWrapping:n.textWrapping,color:o?o.color||i.hyperlink.color:n.color,whiteSpace:n.whiteSpace,fontFamily:n.fontFamily,fontSize:n.fontSize,italic:n.italic,gradient:null,opacity:n.opacity,strokeDashArray:n.strokeDashArray,textAlign:n.textAlign,textOverflow:t.style.textOverflow,textDecoration:o?o.textDecoration||i.hyperlink.textDecoration:n.textDecoration},i.hyperlink.link=t.hyperlink.link||void 0,i.hyperlink.content=t.hyperlink.content||void 0,i.hyperlink.textDecoration=t.hyperlink.textDecoration||void 0,i.content=o?o.content||i.hyperlink.link:t.content,void 0!==this.width&&(i.width=this.width-t.margin.left-t.margin.right),i.margin=t.margin,i.horizontalAlignment=t.horizontalAlignment,i.verticalAlignment=t.verticalAlignment,i.setOffsetWithRespectToBounds(e.offset.x,e.offset.y,"Fraction"),void 0===this.width&&void 0===this.height||(i.float=!0),i.relativeMode="Point",i},e.prototype.initIconContainer=function(t,e){var i=new Bh;return i.id=e.id+"_rect",i.height=t.height,i.width=t.width,i.visible=e.visible,i.margin=t.margin,i.cornerRadius=t.cornerRadius,i.style={fill:t.fill,strokeColor:t.borderColor,strokeWidth:t.borderWidth},i.setOffsetWithRespectToBounds(.5,.5,"Fraction"),i.horizontalAlignment="Center",i.verticalAlignment="Center",i.relativeMode="Object",i.description=i.description||"Click here to expand or collapse",i},e.prototype.initIconSymbol=function(t,e,i){var n;if(e.children.push(this.initIconContainer(t,e)),"Template"===t.shape)(n=new oc).content=t.content,n.height=10,n.width=10;else{(n=new Hh).data=ai(t);var o=be(n.data);n.height=o.height<10?o.height:10-(t.padding.bottom+t.padding.top),n.width=o.width<10?o.width:10-(t.padding.left+t.padding.right)}n.id=e.id+"_shape",n.horizontalAlignment="Center",n.verticalAlignment="Center",n.visible=e.visible,n.visible=e.visible,n.style={fill:"black",strokeColor:t.borderColor,strokeWidth:t.borderWidth},n.setOffsetWithRespectToBounds(.5,.5,"Fraction"),n.relativeMode="Object",n.description=e.description||"Click here to expand or collapse",e.children.push(n)},Gd([ot([],fc)],e.prototype,"annotations",void 0),Gd([et(0)],e.prototype,"offsetX",void 0),Gd([et(0)],e.prototype,"offsetY",void 0),Gd([it({x:.5,y:.5},sh)],e.prototype,"pivot",void 0),Gd([et()],e.prototype,"width",void 0),Gd([et()],e.prototype,"height",void 0),Gd([et()],e.prototype,"minWidth",void 0),Gd([et()],e.prototype,"minHeight",void 0),Gd([et()],e.prototype,"maxWidth",void 0),Gd([et()],e.prototype,"maxHeight",void 0),Gd([et(0)],e.prototype,"rotateAngle",void 0),Gd([it({},tc)],e.prototype,"style",void 0),Gd([et("transparent")],e.prototype,"backgroundColor",void 0),Gd([et("none")],e.prototype,"borderColor",void 0),Gd([et(0)],e.prototype,"borderWidth",void 0),Gd([et()],e.prototype,"data",void 0),Gd([nt(Zd)],e.prototype,"shape",void 0),Gd([et(null)],e.prototype,"wrapper",void 0),Gd([et(fh.Default)],e.prototype,"constraints",void 0),Gd([it({},Yh)],e.prototype,"shadow",void 0),Gd([et()],e.prototype,"children",void 0),e}(kd),mp=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),fp=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},vp=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.offset=0,n.scale=1,n}return mp(e,t),e.prototype.preRender=function(){this.unWireEvents(),this.wireEvents()},e.prototype.render=function(){this.updateRulerGeometry()},e.prototype.getModuleName=function(){return"Ruler"},e.prototype.destroy=function(){this.unWireEvents(),this.notify("destroy",{}),t.prototype.destroy.call(this),this.element.classList.remove("e-ruler")},e.prototype.getPersistData=function(){var t=["loaded"];return this.addOnPersist(t)},e.prototype.onPropertyChanged=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++)switch(n[i]){case"length":case"interval":case"segmentWidth":case"tickAlignment":case"markerColor":case"thickness":this.updateRuler()}},e.prototype.updateRulerGeometry=function(){this.element.style.textAlign="left",this.renderRulerSpace(),this.updateRuler()},e.prototype.renderRulerSpace=function(){var t=this.getRulerGeometry(),e=document.getElementById(this.element.id+"_ruler_space");return e||((e=document.createElement("div")).setAttribute("id",this.element.id+"_ruler_space"),e.style.height=t.height+"px",e.style.width=t.width+"px",e.style.cssFloat="left",this.element.appendChild(e)),e},e.prototype.updateRuler=function(){var t=this.getRulerSize(),e=this.getRulerGeometry(),i=0,n=0,o=new nh,r=this.getRulerSVG(e);if(r&&(i=this.length,o.height=t,n=this.offset,i&&i!==1/0)){var s=i+this.segmentWidth,a=n;this.updateSegments(a,s+Math.abs(a),r,t)}},e.prototype.updateSegments=function(t,e,i,n){for(var o=t,r={trans:0};o<e;){var s=this.getNewSegment(o,i);s&&(i.appendChild(s.segment),o=this.updateSegment(t,e,s,o,r,n))}},e.prototype.updateSegment=function(t,e,i,n,o,r){var s=this.updateSegmentWidth(this.scale);n===t?(this.startValue=Math.floor(t/s)*s/this.scale,this.startValue=this.startValue%1!=0?Number(this.startValue.toFixed(1)):this.startValue,i.label.textContent=this.startValue.toString(),this.defStartValue=n=this.startValue*this.scale,"Horizontal"===this.orientation?this.hRulerOffset=t-n:this.vRulerOffset=t-n):(this.startValue=n/this.scale,this.startValue=this.startValue%1!=0?Number(this.startValue.toFixed(1)):this.startValue,i.label.textContent=this.startValue.toString()),this.updateTickLabel(i,r);var a="Horizontal"===this.orientation?o.trans+.5+",0.5":"0.5,"+(o.trans+.5);return i.segment.setAttribute("transform","translate("+a+")"),o.trans+=s,n+=s},e.prototype.updateTickLabel=function(t,e){var i=t.segment.lastChild.getBBox(),n="Horizontal"===this.orientation,o="RightOrBottom"===this.tickAlignment,r=n?2:0,s=n?o?e/2+5.5-5.5:e/2+5.5:i.height,a=o?-(i.width+2)+","+(e/2-i.height):-(i.width+2)+","+(e/2-i.height/2),l=n?{x:r,y:s}:{x:r,y:s,transform:"rotate(270)translate("+a+")"};ei(t.segment.lastChild,l)},e.prototype.getNewSegment=function(t,e){var i=this.createNewTicks(t,e);return{segment:i,label:this.createTickLabel(e,i)}},e.prototype.createNewTicks=function(t,e){var i,n,o,r=this.updateSegmentWidth(this.scale);o=Ge("g",{class:"e-ruler-segment"});for(var s=0;s<this.interval;s++)n=r/this.interval,i=this.createTick(e,n,s+1,t),o.appendChild(i);return o},e.prototype.getLinePoint=function(t,e,i){var n=this.updateSegmentWidth(this.scale),o=this.getRulerSize();return e*=i-1,i=e%n==0?o:.3*o},e.prototype.createTick=function(t,e,i,n){var o,r,s,a=this.getLinePoint(t,e,i),l=this.getRulerSize(),h="Horizontal"===this.orientation,c="RightOrBottom"===this.tickAlignment,d=fe(this.arrangeTick);r={ruler:void 0,tickLength:a,tickInterval:this.segmentWidth/this.interval*(i-1)},d&&d(r),a=r.tickLength;var p=e*(i-1),u=h?p:c?l:0,g=h?p:c?l-a:l-(l-a);return s={x1:u,y1:h?c?l:l-(l-a):p,x2:g,y2:h?c?l-a:0:p,"stroke-width":"1",stroke:"black"},(o=Ge("line",s)).setAttribute("class","e-ruler-tick"),o},e.prototype.createTickLabel=function(t,e){var i;return e&&(i=Ge("text",{class:"e-ruler-tick-label"}),e.appendChild(i)),i},e.prototype.updateSegmentWidth=function(t){if(100!==this.segmentWidth)return this.segmentWidth;var e,i=1;for(e=100,e=100/Math.pow(2,Math.round(Math.log(t)/Math.log(2)));e>100;)i/=10,e/=10;for(;e<25;)i*=10,e*=10;return e>=25&&e%25!=0&&(e=25*Math.round(e/25)),e*t/i},e.prototype.createMarkerLine=function(t,e,i){var n;return e&&((n=t.getElementById(e.id+"_marker"))&&n.parentNode.removeChild(n),n=Ge("line",i)),n},e.prototype.drawRulerMarker=function(t,e,i){var n,o,r,s,a,l,h,c="Horizontal"===this.orientation,d=t.getElementsByTagName("svg");for(a=0;a<d.length;a++){d[a]&&(n=d[a]);break}if(n){o=this.getRulerSize(),l={id:t.id+"_marker",x1:0,y1:0,x2:c?0:o,y2:c?o:0,stroke:this.markerColor,"stroke-width":1.5,class:"e-d-ruler-marker"},h=this.createMarkerLine(n,t,l),r=this.scale,s=this.offset-this.defStartValue;var p=(c?e.x:e.y)*r+i+s;h.setAttribute("transform","translate("+(c?p+.5+" 0.5":"0.5 "+(p+.5))+")"),n.appendChild(h)}},e.prototype.getRulerGeometry=function(){return new nh(this.element?this.element.getBoundingClientRect().width:0,this.element?this.element.getBoundingClientRect().height:0)},e.prototype.getRulerSize=function(){return this.thickness},e.prototype.getRulerSVG=function(t){var e,i,n=this.getRulerSize();if(this.element&&(e=document.getElementById(this.element.id+"_ruler_space"))){if(i=Ge("svg",{id:this.element.id+"_Ruler_svg",width:"Horizontal"===this.orientation?t.width+200:n+"px",height:"Horizontal"===this.orientation?n:t.height+200+"px",style:"position:inherit;"}),e.childNodes.length>0)for(var o=e.childNodes.length-1;o>=0;o--)e.childNodes[o].parentNode.removeChild(e.childNodes[o]);e.appendChild(i)}return i},e.prototype.wireEvents=function(){},e.prototype.unWireEvents=function(){},fp([et(5)],e.prototype,"interval",void 0),fp([et(100)],e.prototype,"segmentWidth",void 0),fp([et("Horizontal")],e.prototype,"orientation",void 0),fp([et("RightOrBottom")],e.prototype,"tickAlignment",void 0),fp([et("red")],e.prototype,"markerColor",void 0),fp([et(25)],e.prototype,"thickness",void 0),fp([et(null)],e.prototype,"arrangeTick",void 0),fp([et(400)],e.prototype,"length",void 0),e}(wl),yp=function(t){return t&&(t=void 0!==t.sourceID||void 0!==t.sourcePoint||void 0!==t.targetID||void 0!==t.targetPoint||void 0!==t.type?Vd:gp),t},bp=function(){function t(t,e,i){this.renderer=null,this.isSvgMode=!0,this.diagramId=t,this.element=Ae(this.diagramId),this.svgRenderer=e,this.isSvgMode=i,this.renderer=i?new dh:new ch}return t.prototype.setCursor=function(t,e){t.style.cursor=e},t.prototype.setLayers=function(){this.iconSvgLayer=this.element.getElementsByClassName("e-ports-expand-layer")[0],this.adornerSvgLayer=this.element.getElementsByClassName("e-adorner-layer")[0],this.nativeSvgLayer=this.element.getElementsByClassName("e-native-layer")[0],this.diagramSvgLayer=this.element.getElementsByClassName("e-diagram-layer")[0]},t.prototype.getAdornerLayer=function(){return De(this.diagramId)},t.prototype.getParentSvg=function(t,e,i){return this.diagramId&&t&&t.id?t.id.split("_icon_content").length>1||t.id.split("_nodeport").length>1?this.iconSvgLayer:e&&"selector"===e?this.adornerSvgLayer:t instanceof oc?this.nativeSvgLayer:this.diagramSvgLayer:i},t.prototype.getParentElement=function(t,e,i){var n=e;if(i&&this.diagramId&&t&&t.id){t.id.split("_icon_content").length>1?(n=i.getElementById(this.diagramId+"_diagramExpander"),e=null):t.id.split("_nodeport").length>1?n=i.getElementById(this.diagramId+"_diagramPorts"):t instanceof oc?(n=i.getElementById(this.diagramId+"_nativeLayer"),e=null):n=i.getElementById(this.diagramId+"_diagramLayer");var o=this.getGroupElement(t,e||n);n=o.g,o.svg&&(i=o.svg)}return{g:n,svg:i}},t.prototype.getGroupElement=function(t,e){var i,n,o=this.getParentSvg(t);if(e&&o){if(o&&!(i=o.getElementById(t.id+"_groupElement"))&&o!==this.nativeSvgLayer){var r=this.nativeSvgLayer;i=r.getElementById(t.id+"_groupElement"),n=r}i||(i=this.svgRenderer.createGElement("g",{id:t.id+"_groupElement"}),e.appendChild(i))}return{g:i,svg:n}},t.prototype.renderElement=function(t,e,i,n,o,r){t instanceof ic?this.renderContainer(t,e,i,n,o,r):t instanceof jh?this.renderImageElement(t,e,n,o):t instanceof Hh?this.renderPathElement(t,e,n,o):t instanceof Fh?this.renderTextElement(t,e,n,o):t instanceof oc?this.renderNativeElement(t,e,n,o):t instanceof Xd?this.renderHTMLElement(t,e,i,n,o):this.renderRect(t,e,n,o)},t.prototype.drawSelectionRectangle=function(t,e,i,n,o,r){t=(t+r.tx)*r.scale,e=(e+r.ty)*r.scale;var s={width:i*r.scale,height:n*r.scale,x:t+.5,y:e+.5,fill:"transparent",stroke:"gray",angle:0,pivotX:.5,pivotY:.5,strokeWidth:1,dashArray:"6 3",opacity:1,visible:!0,id:o.id+"_selected_region"},a=this.getAdornerLayer();this.svgRenderer.updateSelectionRegion(a,s)},t.prototype.renderHighlighter=function(t,e,i){var n=t.actualSize.width||2,o=t.actualSize.height||2,r=t.offsetX-n*t.pivot.x,s=t.offsetY-o*t.pivot.y;r=(r+i.tx)*i.scale,s=(s+i.ty)*i.scale;var a={width:n*i.scale,height:o*i.scale,x:r,y:s,fill:"transparent",stroke:"#8CC63F",angle:t.rotateAngle,pivotX:t.pivot.x,pivotY:t.pivot.y,strokeWidth:4,dashArray:"",opacity:1,cornerRadius:0,visible:!0,id:e.id+"_highlighter",class:"e-diagram-highlighter"};this.svgRenderer.drawRectangle(e,a,this.diagramId)},t.prototype.drawLine=function(t,e){this.svgRenderer.drawLine(t,e)},t.prototype.drawPath=function(t,e){this.svgRenderer.drawPath(t,e,this.diagramId)},t.prototype.renderResizeHandle=function(t,e,i,n,o,r,s,a){var l=t.offsetX-t.actualSize.width*t.pivot.x,h=t.offsetY-t.actualSize.height*t.pivot.y,c=t.actualSize.height,d=t.actualSize.width;i&vh.Rotate&&(this.renderPivotLine(t,e,r,o,s),this.renderRotateThumb(t,e,r,o,s)),this.renderBorder(t,e,r,a);var p=t.actualSize.width*n,u=t.actualSize.height*n;p>=40&&u>=40&&(o&uh.ResizeNorthWest&&this.renderCircularHandle("resizeNorthWest",t,l,h,e,bs(o,"ResizeNorthWest"),i&vh.ResizeNorthWest,r,void 0,s,{"aria-label":"Thumb to resize the selected object on top left side direction"},void 0,"e-diagram-resize-handle e-northwest"),o&uh.ResizeNorthEast&&this.renderCircularHandle("resizeNorthEast",t,l+d,h,e,bs(o,"ResizeNorthEast"),i&vh.ResizeNorthEast,r,void 0,s,{"aria-label":"Thumb to resize the selected object on top right side direction"},void 0,"e-diagram-resize-handle e-northeast"),o&uh.ResizeSouthWest&&this.renderCircularHandle("resizeSouthWest",t,l,h+c,e,bs(o,"ResizeSouthWest"),i&vh.ResizeSouthWest,r,void 0,s,{"aria-label":"Thumb to resize the selected object on bottom left side direction"},void 0,"e-diagram-resize-handle e-southwest"),o&uh.ResizeSouthEast&&this.renderCircularHandle("resizeSouthEast",t,l+d,h+c,e,bs(o,"ResizeSouthEast"),i&vh.ResizeSouthEast,r,void 0,s,{"aria-label":"Thumb to resize the selected object on bottom right side direction"},void 0,"e-diagram-resize-handle e-southeast")),o&uh.ResizeNorth&&this.renderCircularHandle("resizeNorth",t,l+d/2,h,e,bs(o,"ResizeNorth"),i&vh.ResizeNorth,r,void 0,s,{"aria-label":"Thumb to resize the selected object on top side direction"},void 0,"e-diagram-resize-handle e-north"),o&uh.ResizeSouth&&this.renderCircularHandle("resizeSouth",t,l+d/2,h+c,e,bs(o,"ResizeSouth"),i&vh.ResizeSouth,r,void 0,s,{"aria-label":"Thumb to resize the selected object on bottom side direction"},void 0,"e-diagram-resize-handle e-south"),o&uh.ResizeWest&&this.renderCircularHandle("resizeWest",t,l,h+c/2,e,bs(o,"ResizeWest"),i&vh.ResizeWest,r,void 0,s,{"aria-label":"Thumb to resize the selected object on left side direction"},void 0,"e-diagram-resize-handle e-west"),o&uh.ResizeEast&&this.renderCircularHandle("resizeEast",t,l+d,h+c/2,e,bs(o,"ResizeEast"),i&vh.ResizeEast,r,void 0,s,{"aria-label":"Thumb to resize the selected object on right side direction"},void 0,"e-diagram-resize-handle e-east")},t.prototype.renderEndPointHandle=function(t,e,i,n,o,r,s,a){var l,h,c=t.sourcePoint,d=t.targetPoint,p=t.wrapper;if(this.renderCircularHandle("connectorSourceThumb",p,c.x,c.y,e,bs(n,"ConnectorSourceThumb"),i&vh.ConnectorSource,o,r,void 0,{"aria-label":"Thumb to move the source point of the connector"},void 0,"e-diagram-endpoint-handle e-targetend"),this.renderCircularHandle("connectorTargetThumb",p,d.x,d.y,e,bs(n,"ConnectorTargetThumb"),i&vh.ConnectorTarget,o,s,void 0,{"aria-label":"Thumb to move the target point of the connector"},void 0,"e-diagram-endpoint-handle e-targetend"),a)if(("Straight"===t.type||"Bezier"===t.type)&&t.segments.length>0)for(l=0;l<t.segments.length-1;l++)h=t.segments[l],this.renderCircularHandle("segementThumb_"+(l+1),p,h.point.x,h.point.y,e,!0,i&vh.ConnectorSource,o,r,null,null,l);else for(l=0;l<t.segments.length;l++){var u=t.segments[l];this.renderOrthogonalThumbs("orthoThumb_"+(l+1),p,u,e,bs(n,"ConnectorSourceThumb"),o)}if("Bezier"===t.type)for(l=0;l<t.segments.length;l++){var g=t.segments[l],m=sh.isEmptyPoint(g.point1)?g.bezierPoint1:g.point1;this.renderCircularHandle("bezierPoint_"+(l+1)+"_1",p,m.x,m.y,e,bs(n,"ConnectorSourceThumb"),i&vh.ConnectorSource,o,void 0,void 0,{"aria-label":"Thumb to move the source point of the connector"},void 0,"e-diagram-bezier-handle e-source"),bs(n,"ConnectorSourceThumb")&&this.renderBezierLine("bezierLine_"+(l+1)+"_1",p,e,g.points[0],sh.isEmptyPoint(g.point1)?g.bezierPoint1:g.point1,o),m=sh.isEmptyPoint(g.point2)?g.bezierPoint2:g.point2,this.renderCircularHandle("bezierPoint_"+(l+1)+"_2",p,m.x,m.y,e,bs(n,"ConnectorTargetThumb"),i&vh.ConnectorTarget,o,void 0,void 0,{"aria-label":"Thumb to move the target point of the connector"},void 0,"e-diagram-bezier-handle e-target"),bs(n,"ConnectorTargetThumb")&&this.renderBezierLine("bezierLine_"+(l+1)+"_2",p,e,g.points[1],sh.isEmptyPoint(g.point2)?g.bezierPoint2:g.point2,o)}},t.prototype.renderOrthogonalThumbs=function(t,e,i,n,o,r){var s,a,l,h=0;for(h=0;h<i.points.length-1;h++)l=sh.distancePoints(i.points[h],i.points[h+1]),s=i.points[h].y.toFixed(2)===i.points[h+1].y.toFixed(2)?"horizontal":"vertical",a=l>=50,this.renderOrthogonalThumb(t+"_"+(h+1),e,(i.points[h].x+i.points[h+1].x)/2,(i.points[h].y+i.points[h+1].y)/2,n,a,s,r)},t.prototype.renderOrthogonalThumb=function(t,e,i,n,o,r,s,a){var l,h,c;"horizontal"===s?(l="M0,7 L15,0 L30,7 L15,14 z",h=-15,c=-7):(l="M7,0 L0,15 L7,30 L14,15 z",h=-7,c=-15);var d={x:(i+a.tx)*a.scale+h,y:(n+a.ty)*a.scale+c,angle:0,fill:"#e2e2e2",stroke:"black",strokeWidth:1,dashArray:"",data:l,width:20,height:20,pivotX:0,pivotY:0,opacity:1,visible:r,id:t};this.svgRenderer.drawPath(o,d,this.diagramId)},t.prototype.renderPivotLine=function(t,e,i,n,o){var r=t,s=!!(n&uh.Rotate);o&&(s=!1);var a=this.getBaseAttributes(r,i);a.fill="None",a.stroke="black",a.strokeWidth=1,a.dashArray="2,3",a.visible=s;var l=i.scale;a.x*=l,a.y*=l,a.width*=l,a.height*=l,a.id="pivotLine",a.class="e-diagram-pivot-line";var h={x:r.actualSize.width*r.pivot.x*l,y:-20},c={x:r.actualSize.width*r.pivot.x*l,y:0};a.startPoint=h,a.endPoint=c,this.svgRenderer.drawLine(e,a)},t.prototype.renderBezierLine=function(t,e,i,n,o,r){var s=this.getBaseAttributes(e,r);s.id=t,s.stroke="black",s.strokeWidth=1,s.dashArray="3,3",s.fill="None",s.class="e-diagram-bezier-line",s.x=0,s.y=0;var a=r.scale,l={x:(n.x+r.tx)*a,y:(n.y+r.ty)*a},h={x:(o.x+r.tx)*a,y:(o.y+r.ty)*a};s.startPoint=l,s.endPoint=h,this.svgRenderer.drawLine(i,s)},t.prototype.renderCircularHandle=function(t,e,i,n,o,r,s,a,l,h,c,d,p){var u=e,g=7,m={x:i,y:n};if(0!==u.rotateAngle||0!==u.parentTransform){var f=_t();qt(f,u.rotateAngle+u.parentTransform,u.offsetX,u.offsetY),m=Wt(f,m)}var v=this.getBaseAttributes(u);v.stroke="black",v.strokeWidth=1,void 0!==d?(g=5,v.id="segmentEnd_"+d,v.fill="#e2e2e2"):(g=7,v.fill=l?"#8CC63F":"white"),v.centerX=(m.x+a.tx)*a.scale,v.centerY=(m.y+a.ty)*a.scale,v.radius=g,v.angle=0,v.id=t,v.visible=r,v.class=p,l&&(v.class+=" e-connected"),h&&(v.visible=!1),this.svgRenderer.drawCircle(o,v,s,c)},t.prototype.renderBorder=function(t,e,i,n){var o=t,r=this.getBaseAttributes(o,i);r.x*=i.scale,r.y*=i.scale,r.width*=i.scale,r.height*=i.scale,r.fill="transparent",r.stroke="#097F7F",r.strokeWidth=.6,r.dashArray="6,3",r.class="e-diagram-border",r.id="borderRect",n||(r.class+=" e-disabled"),r.cornerRadius=0;var s=this.getParentSvg(t,"selector");this.svgRenderer.drawRectangle(e,r,this.diagramId,void 0,!0,s)},t.prototype.renderUserHandler=function(t,e,i){for(var n=t.wrapper,o=0,r=t.userHandles;o<r.length;o++){var s=r[o],a=(new Hh,void 0),l=s.pathData;(a=vs(t,s,i)).x=(a.x+i.tx)*i.scale,a.y=(a.y+i.ty)*i.scale,s.visible&&(s.visible=!!(t.constraints&uh.UserHandle));var h=this.getBaseAttributes(n);h.id=s.name+"_userhandle",h.fill=s.backgroundColor,h.stroke=s.borderColor,h.strokeWidth=s.borderWidth,h.centerX=a.x,h.centerY=a.y,h.radius=.5*s.size,h.class="e-diagram-userhandle-circle",h.angle=0,h.visible=s.visible,h.opacity=1,this.svgRenderer.drawCircle(e,h,1,{"aria-label":s.name+"user handle"});var c=[];c=jt(c=At(l));var d=be(l),p=Nt(c,(s.size-.45*s.size)/d.width,(s.size-.45*s.size)/d.height,!0,d.x,d.y,0,0);d=be(p);var u={x:a.x-d.width/2,y:a.y-d.height/2,angle:0,id:"",class:"e-diagram-userhandle-path",fill:s.pathColor,stroke:s.backgroundColor,strokeWidth:.5,dashArray:"",data:p,width:s.size-5,height:s.size-5,pivotX:0,pivotY:0,opacity:1,visible:s.visible};this.svgRenderer.drawPath(e,u,this.diagramId,void 0,void 0,{"aria-label":s.name+"user handle"})}},t.prototype.renderRotateThumb=function(t,e,i,n,o){new Hh;var r,s=new nh;s.width=18,s.height=16;var a=t.offsetY-t.actualSize.height*t.pivot.y,l=t.offsetX-t.actualSize.width*t.pivot.x,h=!!(n&uh.Rotate);o&&(h=!1);var c=l+t.pivot.x*t.actualSize.width,d=a;if(c=(c+i.tx)*i.scale,d=(d+i.ty)*i.scale,r={x:c-.5*s.width,y:d-30-.5*s.height},0!==t.rotateAngle||0!==t.parentTransform){var p=_t();qt(p,t.rotateAngle+t.parentTransform,(i.tx+t.offsetX)*i.scale,(i.ty+t.offsetY)*i.scale),r=Wt(p,r)}var u={x:r.x,y:r.y,angle:t.rotateAngle,fill:"#231f20",stroke:"black",strokeWidth:.5,dashArray:"",data:"M 16.856144362449648 10.238890446662904 L 18.000144362449646 3.437890446662903L 15.811144362449646 4.254890446662903 C 14.837144362449646 2.5608904466629028 13.329144362449647  1.2598904466629026 11.485144362449645 0.5588904466629026 C 9.375144362449646 - 0.24510955333709716 7.071144362449646  - 0.18010955333709716 5.010144362449646 0.7438904466629028 C 2.942144362449646 1.6678904466629028 1.365144362449646 3.341890446662903 0.558144362449646 5.452890446662903 C - 0.244855637550354 7.567890446662903 - 0.17985563755035394 9.866890446662904 0.7431443624496461 11.930890446662904 C 1.6681443624496461 13.994890446662904 3.343144362449646 15.575890446662903 5.457144362449647 16.380890446662903 C 6.426144362449647 16.7518904466629 7.450144362449647 16.9348904466629 8.470144362449647 16.9348904466629 C 9.815144362449647 16.9348904466629 11.155144362449647 16.6178904466629 12.367144362449647 15.986890446662901 L 11.351144362449647 14.024890446662901 C 9.767144362449647 14.8468904466629 7.906144362449647 14.953890446662902 6.237144362449647 14.3178904466629 C 4.677144362449647 13.7218904466629 3.444144362449647 12.5558904466629 2.758144362449647 11.028890446662901 C 2.078144362449646 9.501890446662903 2.031144362449646 7.802890446662903 2.622144362449646 6.243890446662903 C 3.216144362449646 4.6798904466629025 4.387144362449646 3.442890446662903 5.914144362449646 2.760890446662903 C 7.437144362449646 2.078890446662903 9.137144362449646 2.0298904466629026 10.700144362449645 2.6258904466629027 C 11.946144362449646 3.100890446662903 12.971144362449646 3.9538904466629026 13.686144362449646 5.049890446662903 L 11.540144362449645 5.850890446662903 L 16.856144362449648 10.238890446662904 Z",width:20,height:20,pivotX:0,pivotY:0,opacity:1,visible:h,id:t.id,class:"e-diagram-rotate-handle"};u.id="rotateThumb",this.svgRenderer.drawPath(e,u,this.diagramId,!0,void 0,{"aria-label":"Thumb to rotate the selected object"})},t.prototype.renderPathElement=function(t,e,i,n){var o=this.getBaseAttributes(t,i);o.data=t.absolutePath,o.data=t.absolutePath;var r=t.description?t.description:t.id;this.renderer.drawPath(e,o,this.diagramId,void 0,n,r)},t.prototype.renderSvgGridlines=function(t,e,i,n,o,r){var s=document.createElementNS("http://www.w3.org/2000/svg","pattern"),a=document.createElementNS("http://www.w3.org/2000/svg","defs");a.setAttribute("id",this.diagramId+"_grid_pattern_defn"),(t.constraints&ph.ShowHorizontalLines||t.constraints&ph.ShowVerticalLines)&&s.setAttribute("id",this.diagramId+"_pattern");var l=0,h=0,c=0,d=0,p=1,u=!1;if(n.showRulers&&n.dynamicGrid&&o&&r)c=r.updateSegmentWidth(i.scale),d=o.updateSegmentWidth(i.scale),t.horizontalGridlines.scaledIntervals=[c/o.interval],t.verticalGridlines.scaledIntervals=[d/r.interval],u=!0;else{for(var g=0,m=t.verticalGridlines.lineIntervals;g<m.length;g++)l+=y=m[g];for(var f=0,v=t.horizontalGridlines.lineIntervals;f<v.length;f++){var y=v[f];h+=y}p=this.scaleSnapInterval(t,i.scale)}l=u?d:l*p,h=u?c:h*p,ei(s,{id:this.diagramId+"_pattern",x:0,y:0,width:l,height:h,patternUnits:"userSpaceOnUse"}),this.horizontalSvgGridlines(s,l,h,p,t,n,r,u),this.verticalSvgGridlines(s,l,h,p,t,n,o,u),a.appendChild(s),e.appendChild(a)},t.prototype.horizontalSvgGridlines=function(t,e,i,n,o,r,s,a){var l,h=0,c=[];if(o.constraints&ph.ShowHorizontalLines){var d=o.horizontalGridlines.lineIntervals;o.horizontalGridlines.lineColor;o.horizontalGridlines.lineDashArray&&(c=this.renderer.parseDashArray(o.horizontalGridlines.lineDashArray)),r.showRulers&&r.dynamicGrid&&s&&(d=this.updateLineIntervals(d,r,s,i));for(var p=0;p<d.length;p+=2){l=document.createElementNS("http://www.w3.org/2000/svg","path");var u=h+d[p]/2;u=a?u:u*n,ei(l,{"stroke-width":d[p],stroke:o.horizontalGridlines.lineColor,d:"M0,"+u+" L"+e+","+u+" Z",dashArray:c.toString(),class:1.25===d[p]?"e-diagram-thick-grid":"e-diagram-thin-grid"}),t.appendChild(l),h+=d[p+1]+d[p]}}},t.prototype.verticalSvgGridlines=function(t,e,i,n,o,r,s,a){var l,h=0,c=[];if(o.constraints&ph.ShowVerticalLines){var d=o.verticalGridlines.lineIntervals;o.verticalGridlines.lineColor;o.verticalGridlines.lineDashArray&&(c=this.renderer.parseDashArray(o.verticalGridlines.lineDashArray)),r.showRulers&&r.dynamicGrid&&s&&(d=this.updateLineIntervals(d,r,s,e));for(var p=0;p<d.length;p+=2){l=document.createElementNS("http://www.w3.org/2000/svg","path");var u=h+d[p]/2;u=a?u:u*n,ei(l,{"stroke-width":d[p],stroke:o.verticalGridlines.lineColor,d:"M"+u+",0 L"+u+","+i+" Z",dashArray:c.toString(),class:1.25===d[p]?"e-diagram-thick-grid":"e-diagram-thin-grid"}),t.appendChild(l),h+=d[p+1]+d[p]}}},t.prototype.updateGrid=function(t,e,i,n,o,r){var s,a=e.getElementById(this.diagramId+"_grid_rect"),l=!1;if(a){var h=e.getElementById(this.diagramId+"_pattern");h&&h.parentNode.removeChild(h);var c=0,d=0,p=1;n.showRulers&&n.dynamicGrid&&r&&o?(c=r.updateSegmentWidth(i.scale),d=o.updateSegmentWidth(i.scale),l=!0,t.horizontalGridlines.scaledIntervals=[c/o.interval],t.verticalGridlines.scaledIntervals=[d/r.interval]):p=this.scaleSnapInterval(t,i.scale);var u=0;for(s=0;s<t.horizontalGridlines.lineIntervals.length;s++)u+=t.horizontalGridlines.lineIntervals[s];var g=0;for(s=0;s<t.verticalGridlines.lineIntervals.length;s++)g+=t.verticalGridlines.lineIntervals[s];var m={x:-i.tx*i.scale,y:-i.ty*i.scale};ei(a,m),g=l?d:g*p,u=l?c:u*p,m={id:this.diagramId+"_pattern",x:0,y:0,width:g,height:u,patternUnits:"userSpaceOnUse"},ei(h=document.createElementNS("http://www.w3.org/2000/svg","pattern"),m),this.horizontalSvgGridlines(h,g,u,p,t,n,r,l),this.verticalSvgGridlines(h,g,u,p,t,n,o,l),e.getElementById(this.diagramId+"_grid_pattern_defn").appendChild(h)}},t.prototype.updateLineIntervals=function(t,e,i,n){for(var o=[],r=n/i.interval,s=0;s<2*i.interval;s++)o[s]=s%2==0?0===s?1.25:.25:r-o[s-1];return o},t.prototype.scaleSnapInterval=function(t,e){if(e>=2)for(;e>=2;)e/=2;else if(e<=.5)for(;e<=.5;)e*=2;var i;if(t.horizontalGridlines.scaledIntervals=t.horizontalGridlines.snapIntervals,t.verticalGridlines.scaledIntervals=t.verticalGridlines.snapIntervals,1!==e){var n=t.horizontalGridlines;for(n.scaledIntervals=[],i=0;i<n.snapIntervals.length;i++)n.scaledIntervals[i]=n.snapIntervals[i]*e;for((n=t.verticalGridlines).scaledIntervals=[],i=0;i<n.snapIntervals.length;i++)n.scaledIntervals[i]=n.snapIntervals[i]*e}return e},t.prototype.renderTextElement=function(t,e,i,n){var o=this.getBaseAttributes(t,i);o.cornerRadius=0,this.renderer.drawRectangle(e,o,this.diagramId,void 0,void 0,n),o.whiteSpace=pe(t.style.whiteSpace,t.style.textWrapping),o.content=t.content,o.breakWord=le(t.style.textWrapping),o.textAlign=ae(t.style.textAlign),o.color=t.style.color,o.italic=t.style.italic,o.bold=t.style.bold,o.fontSize=t.style.fontSize,o.fontFamily=t.style.fontFamily,o.textOverflow=t.style.textOverflow,o.textDecoration=t.style.textDecoration,o.doWrap=t.doWrap,o.wrapBounds=t.wrapBounds,o.childNodes=t.childNodes,o.dashArray="",o.strokeWidth=0,o.fill="";var r=t.description?t.description:t.content?t.content:t.id;this.renderer.drawText(e,o,n,r,this.diagramId),this.isSvgMode&&(t.doWrap=!1)},t.prototype.renderNativeElement=function(t,e,i,n){var o,r,s=this.getParentSvg(t,void 0,e)||n,a=this.getParentElement(t,e,s).g||e,l=this.getBaseAttributes(t,i);switch(l.fill="transparent",l.cornerRadius=t.cornerRadius,l.stroke="transparent",this.renderer.drawRectangle(e,l,this.diagramId,void 0,void 0,n),t.scale){case"None":o=t.contentSize.width,r=t.contentSize.height;break;case"Stretch":o=t.actualSize.width,r=t.actualSize.height;break;case"Meet":o=r=t.actualSize.width<=t.actualSize.height?t.actualSize.width:t.actualSize.height;break;case"Slice":o=r=t.actualSize.width>=t.actualSize.height?t.actualSize.width:t.actualSize.height}this.svgRenderer&&this.svgRenderer.drawNativeContent(t,a,r,o,s)},t.prototype.renderHTMLElement=function(t,e,i,n,o){var r=this.getBaseAttributes(t,n);r.fill="transparent",r.cornerRadius=t.cornerRadius,r.stroke="transparent",this.renderer.drawRectangle(e,r,this.diagramId,void 0,void 0,o),this.svgRenderer&&this.svgRenderer.drawHTMLContent(t,i.children[0],n)},t.prototype.renderImageElement=function(t,e,i,n){var o=this.getBaseAttributes(t,i);o.cornerRadius=0,this.renderer.drawRectangle(e,o,this.diagramId,void 0,void 0,n);var r,s,a,l;if("Stretch"===t.stretch)r=t.actualSize.width,s=t.actualSize.height;else{var h=t.contentSize.width,c=t.contentSize.height,d=o.width/h,p=o.height/c,u=void 0;switch(t.stretch){case"Meet":r=h*(u=Math.min(d,p)),s=c*u,o.x+=Math.abs(o.width-r)/2,o.y+=Math.abs(o.height-s)/2;break;case"Slice":d=o.width/h,p=o.height/c,r=h*(u=Math.max(d,p)),s=c*u,a=o.width/r*h,l=o.height/s*c;break;case"None":r=h,s=c}}o.width=r,o.height=s,o.sourceWidth=a,o.sourceHeight=l,o.source=t.source,o.alignment=t.imageAlign,o.scale=t.imageScale,o.description=t.description?t.description:t.id,this.renderer.drawImage(e,o,n)},t.prototype.renderContainer=function(t,e,i,n,o,r){var s={svg:o,g:e};if(this.diagramId&&(o=this.getParentSvg(t)||o,this.isSvgMode)){var a=void 0;a=this.getParentElement(t,e,o).g||e,o=this.getParentSvg(this.hasNativeParent(t.children))||o;var l=this.getParentElement(this.hasNativeParent(t.children),a,o);s.svg=l.svg||o,s.g=l.g||a,r?(o&&(o.getElementById(s.g.id)||e.appendChild(s.g)),e=s.g):e=s.g}if(this.renderRect(t,e,n,o),t.hasChildren())for(var h,c=void 0,d=0,p=t.children;d<p.length;d++){var u=p[d];o=this.getParentSvg(this.hasNativeParent(t.children)||u)||o,this.isSvgMode&&(c=(h=this.getParentElement(this.hasNativeParent(t.children)||u,e,o)).g||e,h.svg&&(o=h.svg)),this.renderElement(u,c||e,i,n,o,!0)}},t.prototype.hasNativeParent=function(t,e){if(t&&t.length>0){var i=t[0];if(i instanceof oc)return i;i.children&&i.children.length&&this.hasNativeParent(i.children,e++||0)}},t.prototype.renderRect=function(t,e,i,n){var o=this.getBaseAttributes(t,i);o.cornerRadius=t.cornerRadius||0;var r=t.description?t.description:t.id;this.renderer.drawRectangle(e,o,this.diagramId,void 0,void 0,n,r)},t.prototype.drawRect=function(t,e){e.cornerRadius=0,this.svgRenderer.drawRectangle(t,e,this.diagramId)},t.prototype.getBaseAttributes=function(t,e){var i={width:t.actualSize.width,height:t.actualSize.height,x:t.offsetX-t.actualSize.width*t.pivot.x+.5,y:t.offsetY-t.actualSize.height*t.pivot.y+.5,fill:t.style.fill,stroke:t.style.strokeColor,angle:t.rotateAngle+t.parentTransform,pivotX:t.pivot.x,pivotY:t.pivot.y,strokeWidth:t.style.strokeWidth,dashArray:t.style.strokeDashArray||"",opacity:t.style.opacity,shadow:t.shadow,gradient:t.style.gradient,visible:t.visible,id:t.id,description:t.description};return e&&(i.x+=e.tx,i.y+=e.ty),i},t.renderSvgBackGroundImage=function(t,e,i,n,o,r){document.getElementById(e.id);var s=je(e.id).getElementById(e.id+"_image");if(!s&&t.source){var a=Ve(e.id);(s=document.createElementNS("http://www.w3.org/2000/svg","image")).setAttribute("id",e.id+"_image"),a.appendChild(s),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t.source)}if(s){var l="None"!==t.scale?t.scale:"",h=t.align,c=h.charAt(0).toLowerCase()+h.slice(1)+" "+l.charAt(0).toLowerCase()+l.slice(1);document.getElementById(e.id);ei(s,{id:e.id+"_image",x:i,y:n,width:o,height:r,preserveAspectRatio:c})}},t.prototype.transformLayers=function(t,e){e&&Be(this.diagramId).setAttribute("transform","translate("+t.tx*t.scale+","+t.ty*t.scale+"),scale("+t.scale+")"),_e(this.diagramId).setAttribute("transform","translate("+t.tx*t.scale+","+t.ty*t.scale+")"),Ue(this.diagramId).setAttribute("transform","translate("+t.tx*t.scale+","+t.ty*t.scale+"),scale("+t.scale+")"),We(this.diagramId).setAttribute("transform","translate("+t.tx*t.scale+","+t.ty*t.scale+"),scale("+t.scale+")"),qe(this.diagramId).setAttribute("transform","translate("+t.tx*t.scale+","+t.ty*t.scale+"),scale("+t.scale+")"),Xe(this.diagramId).children[0].style.transform="translate("+t.tx*t.scale+"px,"+t.ty*t.scale+"px)scale("+t.scale+")"},t.prototype.updateNode=function(t,e,i,n){this.renderElement(t,e,i,n,this.getParentSvg(t))},t}(),wp=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),xp=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Sp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return wp(e,t),xp([et("")],e.prototype,"source",void 0),xp([et("transparent")],e.prototype,"color",void 0),xp([et("None")],e.prototype,"scale",void 0),xp([et("None")],e.prototype,"align",void 0),e}(qa),Cp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return wp(e,t),xp([et(null)],e.prototype,"width",void 0),xp([et(null)],e.prototype,"height",void 0),xp([it({},Xh)],e.prototype,"margin",void 0),xp([et("Landscape")],e.prototype,"orientation",void 0),xp([et("Infinity")],e.prototype,"boundaryConstraints",void 0),xp([it({},Sp)],e.prototype,"background",void 0),xp([et(!1)],e.prototype,"multiplePage",void 0),xp([et(!1)],e.prototype,"showPageBreaks",void 0),e}(qa),Lp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return wp(e,t),xp([et(0)],e.prototype,"horizontalOffset",void 0),xp([et(0)],e.prototype,"verticalOffset",void 0),xp([et(1)],e.prototype,"currentZoom",void 0),xp([et(0)],e.prototype,"viewPortWidth",void 0),xp([et(0)],e.prototype,"viewPortHeight",void 0),xp([et(.2)],e.prototype,"minZoom",void 0),xp([et(30)],e.prototype,"maxZoom",void 0),xp([et("Diagram")],e.prototype,"scrollLimit",void 0),xp([et()],e.prototype,"scrollableArea",void 0),xp([et(!1)],e.prototype,"canAutoScroll",void 0),xp([it({left:15,right:15,top:15,bottom:15},Xh)],e.prototype,"autoScrollBorder",void 0),e}(qa),Ep=function(){function t(){this.services={}}return t.prototype.register=function(t,e){this.services[t]=e},t.prototype.getService=function(t){return this.services[t]},t}(),Pp=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),kp=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Tp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pp(e,t),kp([et("lightgray")],e.prototype,"lineColor",void 0),kp([et("")],e.prototype,"lineDashArray",void 0),kp([et([1.25,18.75,.25,19.75,.25,19.75,.25,19.75,.25,19.75])],e.prototype,"lineIntervals",void 0),kp([et([20])],e.prototype,"snapIntervals",void 0),e}(qa),Op=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pp(e,t),kp([it({},Tp)],e.prototype,"horizontalGridlines",void 0),kp([it({},Tp)],e.prototype,"verticalGridlines",void 0),kp([et(ph.All)],e.prototype,"constraints",void 0),kp([et(5)],e.prototype,"snapAngle",void 0),kp([et(5)],e.prototype,"snapObjectDistance",void 0),e}(qa),Ip=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ap=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Mp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ip(e,t),Ap([et(5)],e.prototype,"interval",void 0),Ap([et(100)],e.prototype,"segmentWidth",void 0),Ap([et("Horizontal")],e.prototype,"orientation",void 0),Ap([et("RightOrBottom")],e.prototype,"tickAlignment",void 0),Ap([et("red")],e.prototype,"markerColor",void 0),Ap([et(25)],e.prototype,"thickness",void 0),Ap([et(null)],e.prototype,"arrangeTick",void 0),e}(qa),Rp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ip(e,t),Ap([et(!1)],e.prototype,"showRulers",void 0),Ap([et(!0)],e.prototype,"dynamicGrid",void 0),Ap([it({orientation:"Horizontal"},Mp)],e.prototype,"horizontalRuler",void 0),Ap([it({orientation:"Vertical"},Mp)],e.prototype,"verticalRuler",void 0),e}(qa),Dp=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Bp=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Np=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Dp(e,t),Bp([et("")],e.prototype,"id",void 0),Bp([et(null)],e.prototype,"dataManager",void 0),Bp([et("")],e.prototype,"root",void 0),Bp([et("")],e.prototype,"parentId",void 0),Bp([et()],e.prototype,"data",void 0),Bp([et()],e.prototype,"doBinding",void 0),e}(qa),Hp=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),zp=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},jp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Hp(e,t),zp([et("")],e.prototype,"fixedNode",void 0),zp([et(30)],e.prototype,"horizontalSpacing",void 0),zp([et(30)],e.prototype,"verticalSpacing",void 0),zp([et(30)],e.prototype,"maxIteration",void 0),zp([et(40)],e.prototype,"springFactor",void 0),zp([et(50)],e.prototype,"springLength",void 0),zp([it({left:50,top:50,right:0,bottom:0},Xh)],e.prototype,"margin",void 0),zp([et("Auto")],e.prototype,"horizontalAlignment",void 0),zp([et("Auto")],e.prototype,"verticalAlignment",void 0),zp([et("TopToBottom")],e.prototype,"orientation",void 0),zp([et("Auto")],e.prototype,"connectionDirection",void 0),zp([et("Default")],e.prototype,"connectorSegments",void 0),zp([et("None")],e.prototype,"type",void 0),zp([et()],e.prototype,"getLayoutInfo",void 0),zp([et()],e.prototype,"getBranch",void 0),zp([et()],e.prototype,"bounds",void 0),zp([et(!0)],e.prototype,"enableAnimation",void 0),zp([et("")],e.prototype,"root",void 0),e}(qa),Vp={None:"default",Rotate:"crosshair",Select:"default",Drag:"move",ResizeWest:"w-resize",ResizeEast:"e-resize",ResizeSouth:"s-resize",ResizeNorth:"n-resize",Draw:"crosshair",PortDraw:"crosshair",ResizeNorthEast:"ne-resize",ResizeNorthWest:"nw-resize",ResizeSouthEast:"se-resize",ResizeSouthWest:"sw-resize",ConnectorSourceEnd:"move",ConnectorTargetEnd:"move",BezierSourceThumb:"move",BezierTargetThumb:"move",OrthoThumb:"move",SegmentEnd:"move",Pan:"pointer",Hyperlink:"pointer",PortDrag:"pointer"},Fp=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),_p=function(){function t(t,e){void 0===e&&(e=!1),this.commandHandler=null,this.inAction=!1,this.isProtectChange=!1,this.currentElement=null,this.blocked=!1,this.isTooltipVisible=!1,this.childTable={},this.undoElement={nodes:[],connectors:[]},this.undoParentElement={nodes:[],connectors:[]},this.commandHandler=t,this.isProtectChange=e}return t.prototype.startAction=function(t){this.currentElement=t,this.inAction=!0},t.prototype.mouseDown=function(t){this.currentElement=t.source,this.startPosition=this.currentPosition=this.prevPosition=t.position,this.isTooltipVisible=!0,this.startAction(t.source),this.commandHandler.startTransaction(this.isProtectChange)},t.prototype.mouseMove=function(t){return this.currentPosition=t.position,!this.blocked},t.prototype.mouseUp=function(t){this.currentPosition=t.position,this.isTooltipVisible=!1,this.commandHandler.endTransaction(this.isProtectChange),this.endAction()},t.prototype.endAction=function(){this.isTooltipVisible||this.commandHandler.closeTooltip(),this.commandHandler=null,this.currentElement=null,this.currentPosition=null,this.inAction=!1,this.blocked=!1},t.prototype.mouseWheel=function(t){this.currentPosition=t.position},t.prototype.mouseLeave=function(t){this.mouseUp(t)},t}(),Wp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fp(e,t),e.prototype.mouseDown=function(e){this.inAction=!0,t.prototype.mouseDown.call(this,e)},e.prototype.mouseMove=function(e){if(t.prototype.mouseMove.call(this,e),this.inAction&&!1===sh.equals(this.currentPosition,this.prevPosition)){var i=ah.toBounds([this.prevPosition,this.currentPosition]);this.commandHandler.drawSelectionRectangle(i.x,i.y,i.width,i.height)}return!this.blocked},e.prototype.mouseUp=function(e){if(!1===sh.equals(this.currentPosition,this.prevPosition)&&this.inAction){var i=ah.toBounds([this.prevPosition,this.currentPosition]);this.commandHandler.doRubberBandSelection(i)}else{var n=this.commandHandler.getSelectedObject();this.commandHandler.hasSelection()&&e.info&&e.info.ctrlKey?e&&e.source&&(this.commandHandler.isSelected(e.source)?1===e.clickCount&&this.commandHandler.unSelect(e.source):this.commandHandler.selectObjects([e.source],!0)):(this.commandHandler.clearSelection(null===e.source),e.source&&this.commandHandler.selectObjects([e.source],!1,n))}this.inAction=!1,t.prototype.mouseUp.call(this,e)},e.prototype.mouseLeave=function(t){this.inAction&&this.mouseUp(t)},e}(_p),Up=function(t){function e(e,i){var n=t.call(this,e,!0)||this;return n.endPoint=i,n}return Fp(e,t),e.prototype.mouseDown=function(e){this.inAction=!0,this.undoElement=void 0,this instanceof Zp||(this.undoElement=ie(e.source)),t.prototype.mouseDown.call(this,e);var i;if(e.source&&e.source.connectors&&({x:this.prevPosition.x,y:this.prevPosition.y},i=e.source.connectors[0]),"BezierSourceThumb"===this.endPoint||"BezierTargetThumb"===this.endPoint)for(var n=0;n<i.segments.length;n++){var o=i.segments[n],r=sh.isEmptyPoint(o.point1)?o.bezierPoint1:o.point1,s=sh.isEmptyPoint(o.point2)?o.bezierPoint2:o.point2;(Is(this.currentPosition,r,i.hitPadding)||Is(this.currentPosition,s,i.hitPadding))&&(this.selectedSegment=o)}this.currentPosition=e.position},e.prototype.mouseUp=function(e){if(this.commandHandler.updateSelector(),this.commandHandler.removeSnap(),this instanceof Zp||("ConnectorSourceEnd"!==this.endPoint||sh.equals(e.source.connectors[0].sourcePoint,this.undoElement.connectors[0].sourcePoint)&&e.source.connectors[0].sourceID===this.undoElement.connectors[0].sourceID)&&("ConnectorTargetEnd"!==this.endPoint||sh.equals(e.source.connectors[0].targetPoint,this.undoElement.connectors[0].targetPoint)&&e.source.connectors[0].targetID===this.undoElement.connectors[0].targetID)){if(!(this instanceof Zp||"BezierTargetThumb"!==this.endPoint&&"BezierSourceThumb"!==this.endPoint)&&this.undoElement&&e.source){var i=void 0,n={type:"SegmentChanged",redoObject:i=ie(e.source),undoObject:this.undoElement,category:"Internal"};this.commandHandler.addHistoryEntry(n)}}else{var o=void 0,r=void 0;e.source&&e.source.connectors&&(o={x:this.prevPosition.x,y:this.prevPosition.y},r=e.source.connectors[0]);var s=void 0,a=void 0;if(e.target){var l=this.commandHandler.findTarget(e.targetWrapper,e.target,"ConnectorSourceEnd"===this.endPoint);l instanceof dc?s=l.id:a=l.id}var h={connector:r,state:"Completed",targetNode:a,oldValue:o,newValue:o,cancel:!1,targetPort:s},c="ConnectorSourceEnd"===this.endPoint?Ph.sourcePointChange:Ph.targetPointChange;if(this.commandHandler.triggerEvent(c,h),this.commandHandler.removeTerminalSegment(r,!0),this.undoElement&&e.source){var i=void 0,n={type:"ConnectionChanged",redoObject:ie(i=ie(e.source)),undoObject:ie(this.undoElement),category:"Internal"};this.commandHandler.addHistoryEntry(n)}}t.prototype.mouseUp.call(this,e)},e.prototype.mouseMove=function(e){if(t.prototype.mouseMove.call(this,e),!(this instanceof Zp)&&("ConnectorSourceEnd"===this.endPoint&&sh.equals(e.source.connectors[0].sourcePoint,this.undoElement.connectors[0].sourcePoint)||"ConnectorTargetEnd"===this.endPoint&&sh.equals(e.source.connectors[0].targetPoint,this.undoElement.connectors[0].targetPoint))){var i=void 0,n=void 0;e.source&&e.source.connectors&&(i={x:this.prevPosition.x,y:this.prevPosition.y},n=e.source.connectors[0]);var o=void 0,r=void 0;e.target&&(r=e.target.id,(g=this.commandHandler.findTarget(e.targetWrapper,e.target,"ConnectorSourceEnd"===this.endPoint))instanceof dc||g instanceof lp?o=g.id:r=g.id);var s={connector:n,state:"Start",targetNode:r,oldValue:i,newValue:i,cancel:!1,targetPort:o},a="ConnectorSourceEnd"===this.endPoint?Ph.sourcePointChange:Ph.targetPointChange;this.commandHandler.triggerEvent(a,s)}if(this.currentPosition=e.position,this.currentPosition&&this.prevPosition){var l=this.currentPosition.x-this.prevPosition.x,h=this.currentPosition.y-this.prevPosition.y,c=void 0,i=void 0;this.currentPosition=this.commandHandler.snapConnectorEnd(this.currentPosition);var d=void 0;e.source&&e.source.connectors&&(c={x:this.currentPosition.x,y:this.currentPosition.y},i={x:this.prevPosition.x,y:this.prevPosition.y},d=e.source.connectors[0]);var p=void 0,u=void 0;if(e.target){var g=this.commandHandler.findTarget(e.targetWrapper,e.target,"ConnectorSourceEnd"===this.endPoint);g instanceof dc?p=g.id:u=g.id}s={connector:d,state:"Progress",targetNode:u,oldValue:i,newValue:c,cancel:!1,targetPort:p};if(!(this instanceof Zp)){a="ConnectorSourceEnd"===this.endPoint?Ph.sourcePointChange:Ph.targetPointChange;this.commandHandler.triggerEvent(a,s)}if((!s.cancel&&this.inAction&&void 0!==this.endPoint&&0!==l||0!==h)&&(this.blocked=!this.commandHandler.dragConnectorEnds(this.endPoint,e.source,this.currentPosition,this.selectedSegment,e.target,p),this.commandHandler.updateSelector(),e.target&&("ConnectorSourceEnd"===this.endPoint&&gr(e.target)||"ConnectorTargetEnd"===this.endPoint&&ur(e.target))?(this.commandHandler.canDisconnect(this.endPoint,e,p,u)&&this.commandHandler.disConnect(e.source,this.endPoint),this.commandHandler.connect(this.endPoint,e)):-1===this.endPoint.indexOf("Bezier")&&(this.commandHandler.disConnect(e.source,this.endPoint),this.commandHandler.updateSelector())),this.commandHandler.canEnableDefaultTooltip()){var m=this.getTooltipContent(e.position);this.commandHandler.showTooltip(e.source,e.position,m,"ConnectTool",this.isTooltipVisible),this.isTooltipVisible=!1}}return this.prevPosition=this.currentPosition,!this.blocked},e.prototype.mouseLeave=function(t){this.mouseUp(t)},e.prototype.getTooltipContent=function(t){return"X:"+Math.round(t.x)+" Y:"+Math.round(t.y)},e.prototype.endAction=function(){t.prototype.endAction.call(this),this.prevPosition=null,this.endPoint=null},e}(_p),qp=function(t){function e(e,i){var n=t.call(this,e,!0)||this;return n.currentTarget=null,n.objectType=i,n}return Fp(e,t),e.prototype.mouseDown=function(e){if(e.source instanceof gp||e.source instanceof Vd){this.commandHandler.selectObjects([e.source],e.info&&e.info.ctrlKey);var i={nodes:[],connectors:[]};e.source instanceof gp?i.nodes.push(ie(e.source)):i.connectors.push(ie(e.source)),this.undoElement=ie(i)}else this.undoElement=ie(e.source);this.undoParentElement=this.commandHandler.getSubProcess(e.source),t.prototype.mouseDown.call(this,e),this.initialOffset={x:0,y:0}},e.prototype.mouseUp=function(e){var i,n=!1;if("Port"!==this.objectType){if(e.source instanceof gp||e.source instanceof Vd){var o={nodes:[],connectors:[]};e.source instanceof gp?o.nodes.push(ie(e.source)):o.connectors.push(ie(e.source)),i=ie(o);var r=e.source.wrapper;i.offsetX=r.offsetX,i.offsetY=r.offsetY}else i=ie(e.source);if(i.offsetX!==this.undoElement.offsetX||i.offsetY!==this.undoElement.offsetY){var s=void 0,a=void 0;e.source&&(a={offsetX:e.source.wrapper.offsetX,offsetY:e.source.wrapper.offsetY},s={offsetX:e.source.wrapper.offsetX,offsetY:e.source.wrapper.offsetY});c={source:e.source,state:"Completed",oldValue:s,newValue:a,target:this.currentTarget,targetPosition:this.currentPosition,allowDrop:!0,cancel:!1};this.commandHandler.triggerEvent(Ph.positionChange,c),this.commandHandler.startGroupAction(),n=!0;var l={type:"PositionChanged",redoObject:ie(i),undoObject:ie(this.undoElement),category:"Internal"};if(i.nodes[0]&&i.nodes[0].processId){var h={type:"SizeChanged",category:"Internal",undoObject:this.undoParentElement,redoObject:this.commandHandler.getSubProcess(e.source)};this.commandHandler.addHistoryEntry(h)}this.commandHandler.addHistoryEntry(l)}this.commandHandler.snapPoint(this.prevPosition,this.currentPosition,0,0);if(this.commandHandler.removeSnap(),this.commandHandler.removeHighlighter(),e.source&&this.currentTarget&&fr(this.currentTarget)&&this.commandHandler.isDroppable(e.source,this.currentTarget)){this.commandHandler.drop(this.currentElement,this.currentTarget,this.currentPosition);var c={element:e.source,target:this.currentTarget,position:this.currentPosition,cancel:!1};this.commandHandler.triggerEvent(Ph.drop,c)}this.commandHandler.updateSelector(),n&&this.commandHandler.endGroupAction()}t.prototype.mouseUp.call(this,e)},e.prototype.mouseMove=function(e){t.prototype.mouseMove.call(this,e);var i=!1;e.source instanceof gp||e.source instanceof Vd?e.source instanceof gp?e.source.offsetX===this.undoElement.nodes[0].offsetX&&e.source.offsetY===this.undoElement.nodes[0].offsetY&&(i=!0):sh.equals(e.source.sourcePoint,this.undoElement.connectors[0].sourcePoint)&&sh.equals(e.source.targetPoint,this.undoElement.connectors[0].targetPoint)&&(i=!0):e.source.wrapper.offsetX===this.undoElement.wrapper.offsetX&&e.source.wrapper.offsetY===this.undoElement.wrapper.offsetY&&(i=!0);var n;e.source&&(n={offsetX:e.source.wrapper.offsetX,offsetY:e.source.wrapper.offsetY});var o={source:e.source,state:"Start",oldValue:n,newValue:n,target:e.target,targetPosition:e.position,allowDrop:!0,cancel:!1};if(i&&this.commandHandler.triggerEvent(Ph.positionChange,o),this.currentPosition=e.position,"Port"!==this.objectType){this.currentPosition.x,this.prevPosition.x,this.currentPosition.y,this.prevPosition.y;var r=this.initialOffset.x+(this.currentPosition.x-this.prevPosition.x),s=this.initialOffset.y+(this.currentPosition.y-this.prevPosition.y);this.commandHandler.dragOverElement(e,this.currentPosition),this.commandHandler.disConnect(e.source),this.commandHandler.removeSnap();var a,l=void 0,h=this.commandHandler.snapPoint(this.prevPosition,this.currentPosition,r,s);this.initialOffset.x=r-h.x,this.initialOffset.y=s-h.y,e.source&&(a={offsetX:e.source.wrapper.offsetX,offsetY:e.source.wrapper.offsetY},l={offsetX:e.source.wrapper.offsetX+h.x,offsetY:e.source.wrapper.offsetY+h.y}),this.currentTarget&&e.target!==this.currentTarget&&this.commandHandler.removeChildFromBPmn(e.source,e.target,this.currentTarget),this.currentTarget=e.target;var c={source:e.source,state:"Progress",oldValue:a,newValue:l,target:e.target,targetPosition:e.position,allowDrop:!0,cancel:!1};if(this.commandHandler.triggerEvent(Ph.positionChange,c),!c.cancel){this.blocked=!this.commandHandler.dragSelectedObjects(h.x,h.y);var d=!this.commandHandler.mouseOver(this.currentElement,this.currentTarget,this.currentPosition);this.blocked=this.blocked||d}if(this.currentTarget&&e.source!==this.currentTarget&&this.commandHandler.isDroppable(e.source,this.currentTarget)?this.commandHandler.drawHighlighter(this.currentTarget):this.commandHandler.removeHighlighter(),this.commandHandler.canEnableDefaultTooltip()){var p=this.getTooltipContent(e.source);this.commandHandler.showTooltip(e.source,e.position,p,"MoveTool",this.isTooltipVisible),this.isTooltipVisible=!1}}else this.commandHandler.portDrag(e.source,e.sourceWrapper,e.position.x-this.prevPosition.x,e.position.y-this.prevPosition.y);return this.prevPosition=this.currentPosition,!this.blocked},e.prototype.getTooltipContent=function(t){return"X:"+Math.round(t.wrapper.bounds.x)+" Y:"+Math.round(t.wrapper.bounds.y)},e.prototype.mouseLeave=function(t){this.mouseUp(t)},e.prototype.endAction=function(){t.prototype.endAction.call(this),this.currentTarget=null,this.prevPosition=null},e}(_p),Xp=function(t){function e(e){return t.call(this,e,!0)||this}return Fp(e,t),e.prototype.mouseDown=function(e){if(this.undoElement=ie(e.source),this.undoElement.nodes[0]&&this.undoElement.nodes[0].children)for(var i=[],n=this.commandHandler.getAllDescendants(this.undoElement.nodes[0],i),o=0;o<n.length;o++){var r=this.commandHandler.cloneChild(n[o].id);this.childTable[n[o].id]=ie(r)}t.prototype.mouseDown.call(this,e)},e.prototype.mouseUp=function(e){if(this.undoElement.rotateAngle!==e.source.wrapper.rotateAngle){var i={rotateAngle:e.source.wrapper.rotateAngle},n={source:e.source,state:"Completed",oldValue:i,newValue:i,cancel:!1};this.commandHandler.triggerEvent(Ph.rotateChange,n);var o=void 0,r={type:"RotationChanged",redoObject:ie(o=ie(e.source)),undoObject:ie(this.undoElement),category:"Internal",childTable:this.childTable};this.commandHandler.addHistoryEntry(r),this.commandHandler.updateSelector()}t.prototype.mouseUp.call(this,e)},e.prototype.mouseMove=function(e){if(t.prototype.mouseMove.call(this,e),this.undoElement.rotateAngle===e.source.wrapper.rotateAngle){var i={rotateAngle:e.source.wrapper.rotateAngle},n={source:e.source,state:"Start",oldValue:i,newValue:i,cancel:!1};this.commandHandler.triggerEvent(Ph.rotateChange,n)}this.currentPosition=e.position;var o={x:this.currentElement.wrapper.offsetX,y:this.currentElement.wrapper.offsetY},r=sh.findAngle(o,this.currentPosition)+90,s=this.commandHandler.snapAngle(r);r=((r=0!==s?s:r)+360)%360;var a={rotateAngle:e.source.wrapper.rotateAngle},l={rotateAngle:r},h={source:e.source,state:"Progress",oldValue:a,newValue:l,cancel:!1};if(this.commandHandler.triggerEvent(Ph.rotateChange,h),h.cancel||(this.blocked=!this.commandHandler.rotateSelectedItems(r-this.currentElement.wrapper.rotateAngle)),this.commandHandler.canEnableDefaultTooltip()){var c=this.getTooltipContent(e.source);this.commandHandler.showTooltip(e.source,e.position,c,"RotateTool",this.isTooltipVisible),this.isTooltipVisible=!1}return!this.blocked},e.prototype.getTooltipContent=function(t){return Math.round(t.rotateAngle%360).toString()+""},e.prototype.mouseLeave=function(t){this.mouseUp(t)},e.prototype.endAction=function(){t.prototype.endAction.call(this)},e}(_p),Yp=function(t){function e(e,i){var n=t.call(this,e,!0)||this;return n.initialBounds=new ah,n.corner=i,n}return Fp(e,t),e.prototype.mouseDown=function(e){if(this.undoElement=ie(e.source),this.undoParentElement=this.commandHandler.getSubProcess(e.source),t.prototype.mouseDown.call(this,e),this.undoElement.nodes[0]&&this.undoElement.nodes[0].children)for(var i=[],n=this.commandHandler.getAllDescendants(this.undoElement.nodes[0],i),o=0;o<n.length;o++){var r=this.commandHandler.cloneChild(n[o].id);this.childTable[n[o].id]=ie(r)}t.prototype.mouseDown.call(this,e),this.initialBounds.x=e.source.wrapper.offsetX,this.initialBounds.y=e.source.wrapper.offsetY,this.initialBounds.height=e.source.wrapper.actualSize.height,this.initialBounds.width=e.source.wrapper.actualSize.width},e.prototype.mouseUp=function(e){if(this.commandHandler.removeSnap(),this.undoElement.offsetX!==e.source.wrapper.offsetX||this.undoElement.offsetY!==e.source.wrapper.offsetY){this.blocked=this.updateSize(e.source,this.currentPosition,this.prevPosition,this.corner);var i={offsetX:e.source.wrapper.offsetX,offsetY:e.source.wrapper.offsetY,width:e.source.wrapper.actualSize.width,height:e.source.wrapper.actualSize.height},n={source:e.source,state:"Completed",oldValue:i,newValue:i,cancel:!1};this.commandHandler.triggerEvent(Ph.sizeChange,n);var o=ie(e.source),r={type:"SizeChanged",redoObject:ie(o),undoObject:ie(this.undoElement),category:"Internal",childTable:this.childTable};if(this.commandHandler.startGroupAction(),this.commandHandler.addHistoryEntry(r),o.nodes[0]&&o.nodes[0].processId){var s={type:"SizeChanged",redoObject:this.commandHandler.getSubProcess(e.source),undoObject:this.undoParentElement,category:"Internal"};this.commandHandler.addHistoryEntry(s)}this.commandHandler.endGroupAction()}return t.prototype.mouseUp.call(this,e),!this.blocked},e.prototype.mouseMove=function(e){if(t.prototype.mouseMove.call(this,e),this.undoElement.offsetX===e.source.wrapper.offsetX&&this.undoElement.offsetY===e.source.wrapper.offsetY){var i={offsetX:e.source.wrapper.offsetX,offsetY:e.source.wrapper.offsetY,width:e.source.wrapper.actualSize.width,height:e.source.wrapper.actualSize.height},n={source:e.source,state:"Start",oldValue:i,newValue:this.currentElement,cancel:!1};this.commandHandler.triggerEvent(Ph.sizeChange,n)}this.currentPosition=e.position;var o={x:this.currentPosition.x-this.startPosition.x,y:this.currentPosition.y-this.startPosition.y};o=ge(-this.currentElement.wrapper.rotateAngle,void 0,void 0,o);this.currentElement.wrapper.actualSize.width,o.x,this.currentElement.wrapper.actualSize.width,this.currentElement.wrapper.actualSize.height,o.y,this.currentElement.wrapper.actualSize.height;if(o=this.getChanges(o),this.commandHandler.removeSnap(),this.blocked=!this.updateSize(e.source,this.startPosition,this.currentPosition,this.corner),this.commandHandler.canEnableDefaultTooltip()){var r=this.getTooltipContent(e.source);this.commandHandler.showTooltip(e.source,e.position,r,"ResizeTool",this.isTooltipVisible),this.isTooltipVisible=!1}return this.prevPosition=this.currentPosition,!this.blocked},e.prototype.mouseLeave=function(t){this.mouseUp(t)},e.prototype.getTooltipContent=function(t){return"W:"+Math.round(t.wrapper.bounds.width)+" H:"+Math.round(t.wrapper.bounds.height)},e.prototype.getPivot=function(){switch(this.corner){case"ResizeWest":return{x:1,y:.5};case"ResizeEast":return{x:0,y:.5};case"ResizeNorth":return{x:.5,y:1};case"ResizeSouth":return{x:.5,y:0};case"ResizeNorthEast":return{x:0,y:1};case"ResizeNorthWest":return{x:1,y:1};case"ResizeSouthEast":return{x:0,y:0};case"ResizeSouthWest":return{x:1,y:0}}return{x:.5,y:.5}},e.prototype.getChanges=function(t){switch(this.corner){case"ResizeEast":return{x:t.x,y:0};case"ResizeSouthEast":return t;case"ResizeSouth":return{x:0,y:t.y};case"ResizeNorth":return{x:0,y:-t.y};case"ResizeNorthEast":return{x:t.x,y:-t.y};case"ResizeNorthWest":return{x:-t.x,y:-t.y};case"ResizeWest":return{x:-t.x,y:0};case"ResizeSouthWest":return{x:-t.x,y:t.y}}return t},e.prototype.updateSize=function(t,e,i,n){var o,r={snapped:!1,offset:0,left:!1,right:!1},s={snapped:!1,offset:0,top:!1,bottom:!1},a=this.currentPosition.x-this.startPosition.x,l=this.currentPosition.y-this.startPosition.y,h=this.commandHandler.snappingModule&&this.commandHandler.snappingModule.canSnap(),c=h?this.commandHandler.snappingModule.getLayer():null;qt(o=_t(),-t.rotateAngle,0,0);var d=t.offsetX,p=t.offsetY,u=t.width,g=t.height;d-=u*t.pivot.x,p-=g*t.pivot.y;var m,f=0,v=0,y=this.initialBounds;switch(n){case"ResizeWest":a=(m=Wt(o,{x:a,y:l})).x,l=m.y,v=1,a=h?this.commandHandler.snappingModule.snapLeft(r,s,c,a,l,t,i===e,this.initialBounds):a,l=0,f=(y.width-a)/t.width;break;case"ResizeEast":a=(m=Wt(o,{x:a,y:l})).x,l=m.y,a=h?this.commandHandler.snappingModule.snapRight(r,s,c,a,l,t,i===e,this.initialBounds):a,l=0,f=(y.width+a)/t.width,v=1;break;case"ResizeNorth":f=1,a=(m=Wt(o,{x:a,y:l})).x,l=m.y,l=h?this.commandHandler.snappingModule.snapTop(r,s,c,a,l,t,i===e,this.initialBounds):l,v=(y.height-l)/t.height;break;case"ResizeSouth":f=1,a=(m=Wt(o,{x:a,y:l})).x,l=m.y,l=h?this.commandHandler.snappingModule.snapBottom(r,s,c,m.x,m.y,t,i===e,this.initialBounds):l,v=(y.height+l)/t.height;break;case"ResizeNorthEast":a=(m=Wt(o,{x:a,y:l})).x,l=m.y,a=h?this.commandHandler.snappingModule.snapRight(r,s,c,a,l,t,i===e,this.initialBounds):a,l=h?this.commandHandler.snappingModule.snapTop(r,s,c,a,l,t,i===e,this.initialBounds):l,f=(y.width+a)/t.width,v=(y.height-l)/t.height;break;case"ResizeNorthWest":a=(m=Wt(o,{x:a,y:l})).x,l=m.y,l=h?this.commandHandler.snappingModule.snapTop(r,s,c,a,l,t,i===e,this.initialBounds):l,a=h?this.commandHandler.snappingModule.snapLeft(r,s,c,a,l,t,i===e,this.initialBounds):a,f=(y.width-a)/t.width,v=(y.height-l)/t.height;break;case"ResizeSouthEast":a=(m=Wt(o,{x:a,y:l})).x,l=m.y,l=h?this.commandHandler.snappingModule.snapBottom(r,s,c,a,l,t,i===e,this.initialBounds):l,a=h?this.commandHandler.snappingModule.snapRight(r,s,c,a,l,t,i===e,this.initialBounds):a,v=(y.height+l)/t.height,f=(y.width+a)/t.width;break;case"ResizeSouthWest":a=(m=Wt(o,{x:a,y:l})).x,l=m.y,l=h?this.commandHandler.snappingModule.snapBottom(r,s,c,a,l,t,i===e,y):l,a=h?this.commandHandler.snappingModule.snapLeft(r,s,c,a,l,t,i===e,y):a,f=(y.width-a)/t.width,v=(y.height+l)/t.height}return this.scaleObjects(o,f,v,n,e,i,t)},e.prototype.scaleObjects=function(t,e,i,n,o,r,s){1===s.nodes.length&&s.nodes[0].constraints&fh.AspectRatio&&("ResizeWest"===n||"ResizeEast"===n||"ResizeNorth"===n||"ResizeSouth"===n?1===i&&1===e||(i=e=Math.max(1===i?0:i,1===e?0:e)):i=e=o!==r?Math.max(i,e):0);var a={offsetX:s.offsetX,offsetY:s.offsetY,width:s.width,height:s.height};this.blocked=this.commandHandler.scaleSelectedItems(e,i,this.getPivot());var l={source:s,state:"Progress",oldValue:a,newValue:{offsetX:s.offsetX,offsetY:s.offsetY,width:s.width,height:s.height},cancel:!1};return this.commandHandler.triggerEvent(Ph.sizeChange,l),l.cancel&&this.commandHandler.scaleSelectedItems(1/e,1/i,this.getPivot()),this.blocked},e}(_p),Gp=function(t){function e(e,i){var n=t.call(this,e,!0)||this;return n.sourceObject=i,n}return Fp(e,t),e.prototype.mouseDown=function(e){t.prototype.mouseDown.call(this,e),this.inAction=!0},e.prototype.mouseMove=function(e){t.prototype.mouseMove.call(this,e);var i,n={offsetX:this.currentPosition.x,width:3,height:3,offsetY:this.currentPosition.y};if(this.drawingObject||(this.drawingObject=this.commandHandler.drawObject(n)),this.inAction&&!1===sh.equals(this.currentPosition,this.prevPosition)){var o=ah.toBounds([this.prevPosition,this.currentPosition]);(i=this.commandHandler.checkBoundaryConstraints(void 0,void 0,o))&&this.commandHandler.updateNodeDimension(this.drawingObject,o)}return i},e.prototype.mouseUp=function(e){var i=ah.toBounds([this.prevPosition,this.currentPosition]);this.commandHandler.checkBoundaryConstraints(void 0,void 0,i),this.drawingObject&&this.drawingObject instanceof gp&&(this.commandHandler.addObjectToDiagram(this.drawingObject),this.drawingObject=null),t.prototype.mouseUp.call(this,e),this.inAction=!1},e.prototype.endAction=function(){t.prototype.endAction.call(this)},e.prototype.mouseLeave=function(t){this.inAction&&this.mouseUp(t)},e}(_p),Zp=function(t){function e(e,i,n){var o=t.call(this,e,i)||this;return o.sourceObject=n,o}return Fp(e,t),e.prototype.mouseDown=function(e){t.prototype.mouseDown.call(this,e),this.inAction=!0},e.prototype.mouseMove=function(e){if(this.inAction){var i={sourcePoint:this.currentPosition,targetPoint:this.currentPosition};this.drawingObject||(this.drawingObject=this.commandHandler.drawObject(i)),e.source=this.drawingObject,e.target&&this.commandHandler.connect(this.endPoint,e),this.endPoint="ConnectorTargetEnd"}return this.inAction||(this.commandHandler.updateSelector(),e.source&&e.sourceWrapper&&this.commandHandler.renderHighlighter(e,!0)),t.prototype.mouseMove.call(this,e),!this.blocked},e.prototype.mouseUp=function(e){this.drawingObject&&this.drawingObject instanceof Vd&&(this.commandHandler.addObjectToDiagram(this.drawingObject),this.drawingObject=null),this.inAction=!1,t.prototype.mouseUp.call(this,e)},e.prototype.endAction=function(){t.prototype.endAction.call(this)},e.prototype.mouseLeave=function(t){this.inAction&&this.mouseUp(t)},e}(Up),Kp=function(t){function e(e){return t.call(this,e,!0)||this}return Fp(e,t),e.prototype.mouseDown=function(e){t.prototype.mouseDown.call(this,e),this.commandHandler.clearSelection();var i={shape:{type:"Text"},offsetX:this.currentPosition.x,width:50,height:20,offsetY:this.currentPosition.y};e.source||(this.drawingNode=this.commandHandler.drawObject(i))},e.prototype.mouseMove=function(e){if(t.prototype.mouseMove.call(this,e),this.drawingNode)this.drawingNode.style.strokeColor="black",this.drawingNode.style.strokeDashArray="2 2",this.drawingNode.style.fill="transparent";else{var i={shape:{type:"Text"},offsetX:this.currentPosition.x,width:30,height:30,style:{strokeDashArray:"2 2",fill:"transparent"},offsetY:this.currentPosition.y};this.drawingNode=this.commandHandler.drawObject(i)}if(this.inAction&&!1===sh.equals(this.currentPosition,this.prevPosition)){var n=ah.toBounds([this.prevPosition,this.currentPosition]);this.commandHandler.updateNodeDimension(this.drawingNode,n)}return!this.blocked},e.prototype.mouseUp=function(e){this.drawingNode?(this.drawingNode.style.strokeColor="none",this.drawingNode.style.fill="none"):this.drawingNode=e.source,this.drawingNode&&(this.drawingNode instanceof gp||this.drawingNode instanceof Vd)&&this.commandHandler.addText(this.drawingNode,this.currentPosition),t.prototype.mouseUp.call(this,e),this.inAction=!1},e.prototype.endAction=function(){t.prototype.endAction.call(this)},e}(_p),Qp=function(t){function e(e,i){var n=t.call(this,e)||this;return n.zooming=i,n}return Fp(e,t),e.prototype.mouseDown=function(e){t.prototype.mouseDown.call(this,e),this.inAction=!0},e.prototype.mouseMove=function(e){if(t.prototype.mouseMove.call(this,e),this.inAction)if(this.zooming||!1!==sh.equals(this.currentPosition,this.prevPosition)){if(e.moveTouches.length>=2){var i=e.startTouches[0],n=e.startTouches[1],o=e.moveTouches[0],r=e.moveTouches[1],s=this.getDistance(o,r)/this.getDistance(i,n),a=e.position;this.commandHandler.zoom(s,0,0,a),this.updateTouch(i,o),this.updateTouch(n,r)}}else{var l=this.currentPosition.x-this.prevPosition.x,h=this.currentPosition.y-this.prevPosition.y;this.commandHandler.scroll(l,h,this.currentPosition)}return!this.blocked},e.prototype.mouseUp=function(e){t.prototype.mouseUp.call(this,e),this.inAction=!1},e.prototype.endAction=function(){t.prototype.endAction.call(this)},e.prototype.getDistance=function(t,e){var i=e.pageX-t.pageX,n=e.pageY-t.pageY;return Math.sqrt(i*i+n*n)},e.prototype.updateTouch=function(t,e){t.pageX=e.pageX,t.pageY=e.pageY},e}(_p),Jp=function(t){function e(e){return t.call(this,e,!0)||this}return Fp(e,t),e.prototype.mouseUp=function(e){this.commandHandler.initExpand(e),t.prototype.mouseUp.call(this,e)},e}(_p),$p=function(t){function e(e){return t.call(this,e,!0)||this}return Fp(e,t),e.prototype.mouseUp=function(e){window.open(e.sourceWrapper.hyperlink.link,"_blank").focus(),t.prototype.mouseUp.call(this,e)},e}(_p),tu=function(t){function e(e){return t.call(this,e,!0)||this}return Fp(e,t),e.prototype.mouseDown=function(e){if(t.prototype.mouseDown.call(this,e),this.inAction=!0,this.drawingObject){var i=void 0,n=this.drawingObject.shape;i={x:(i=n.points[n.points.length-1]).x,y:i.y},this.drawingObject.shape.points.push(i)}else{this.startPoint={x:this.startPosition.x,y:this.startPosition.y};var o={offsetX:this.currentPosition.x,offsetY:this.currentPosition.y,width:5,height:5,style:{strokeColor:"black",strokeWidth:1},shape:{type:"Basic",shape:"Polygon",points:[{x:this.startPoint.x,y:this.startPoint.y},{x:this.currentPosition.x,y:this.currentPosition.y}]}};this.drawingObject=this.commandHandler.drawObject(o)}},e.prototype.mouseMove=function(e){if(t.prototype.mouseMove.call(this,e),this.inAction){var i=this.drawingObject.shape;if(this.drawingObject&&this.currentPosition&&(i.points[i.points.length-1].x=this.currentPosition.x,i.points[i.points.length-1].y=this.currentPosition.y,this.drawingObject.wrapper.children[0].data=Dt(this.drawingObject.shape.points),this.inAction&&!1===sh.equals(this.currentPosition,this.prevPosition))){var n=ah.toBounds(this.drawingObject.shape.points);this.commandHandler.updateNodeDimension(this.drawingObject,n)}}return!0},e.prototype.mouseUp=function(e,i){t.prototype.mouseMove.call(this,e),this.inAction&&(this.inAction=!1,this.drawingObject&&this.commandHandler.addObjectToDiagram(this.drawingObject)),this.endAction()},e.prototype.mouseWheel=function(e){t.prototype.mouseWheel.call(this,e),this.mouseMove(e)},e.prototype.endAction=function(){this.inAction=!1,this.drawingObject=null},e}(_p),eu=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),iu=function(t){function e(e,i){var n=t.call(this,e,!0)||this;return n.endPoint=i,n}return eu(e,t),e.prototype.mouseDown=function(e){this.inAction=!0,this.undoElement=ie(e.source),t.prototype.mouseDown.call(this,e);var i;e.source&&e.source.connectors&&(i=e.source.connectors[0]);for(var n=0;n<i.segments.length;n++){var o=i.segments[n];if("OrthoThumb"===this.endPoint)for(var r=0;r<o.points.length-1;r++){var s={x:0,y:0};s.x=(o.points[r].x+o.points[r+1].x)/2,s.y=(o.points[r].y+o.points[r+1].y)/2,Is(this.currentPosition,s,30)&&(this.selectedSegment=o,this.segmentIndex=r)}else Is(this.currentPosition,o.point,10)&&(this.selectedSegment=o)}},e.prototype.mouseMove=function(e){if(t.prototype.mouseMove.call(this,e),this.currentPosition=e.position,this.currentPosition&&this.prevPosition){var i=this.currentPosition.y-this.prevPosition.y,n=this.currentPosition.x-this.prevPosition.x;this.currentPosition=this.commandHandler.snapConnectorEnd(this.currentPosition);var o=void 0;if(e.source&&e.source.connectors&&(o=e.source.connectors[0]),this.inAction&&void 0!==this.endPoint&&0!==n||0!==i){if("OrthoThumb"===this.endPoint)this.blocked=!this.dragOrthogonalSegment(o,this.selectedSegment,this.currentPosition,this.segmentIndex);else{var r=this.currentPosition.x-this.selectedSegment.point.x,s=this.currentPosition.y-this.selectedSegment.point.y,a=o.segments.indexOf(this.selectedSegment);this.blocked=!this.commandHandler.dragControlPoint(o,r,s,!1,a)}this.commandHandler.updateSelector()}}return this.prevPosition=this.currentPosition,!this.blocked},e.prototype.mouseUp=function(e){var i;if(e.source&&e.source.connectors&&(i=e.source.connectors[0]),e&&e.source&&e.info&&e.info.ctrlKey&&e.info.shiftKey&&"Straight"===i.type)this.addOrRemoveSegment(i,this.currentPosition);else if("OrthoThumb"===this.endPoint&&this.selectedSegment){var n=i.segments.indexOf(this.selectedSegment),o=i.segments[n-1],r=i.segments[n+1];if(n===i.segments.length-2&&this.updateLastSegment(i,this.selectedSegment))i.segments.splice(i.segments.length-2,1);else if(o&&Math.abs(o.length)<5)1!==n&&this.removePrevSegment(i,n);else if(r){var s=sh.distancePoints(r.points[0],r.points[1]),a=r.length||0===r.length?r.length:s;Math.abs(a)<=5&&this.removeNextSegment(i,n)}this.commandHandler.updateEndPoint(i)}if(this.undoElement){var l=void 0,h={type:"SegmentChanged",redoObject:l=ie(e.source),undoObject:this.undoElement,category:"Internal"};this.commandHandler.addHistoryEntry(h)}t.prototype.mouseUp.call(this,e)},e.prototype.removePrevSegment=function(t,e){var i=t.segments[e-2],n=t.segments[e+1];if(!((n.length||0===n.length?n.length:sh.distancePoints(n.points[0],n.points[1]))<=5)){var o=t.segments[e+1];t.segments.splice(e-1,2);var r=this.selectedSegment;"Left"===r.direction||"Right"===r.direction?(i.points[i.points.length-1].x=o.points[0].x,o.points[0].y=i.points[i.points.length-1].y):(i.points[i.points.length-1].y=o.points[0].y,o.points[0].x=i.points[i.points.length-1].x),(r.length||0===r.length)&&this.findSegmentDirection(i),this.findSegmentDirection(o)}},e.prototype.findSegmentDirection=function(t){t.direction&&(t.length||0===t.length)&&(t.length=sh.distancePoints(t.points[0],t.points[t.points.length-1]),t.direction=sh.direction(t.points[0],t.points[t.points.length-1]))},e.prototype.removeNextSegment=function(t,e){var i=this.selectedSegment,n=t.segments[e-1],o=t.segments[e+2],r=t.segments[e+1];if(r.length||0===r.length?(t.segments.splice(e,2),"Top"===i.direction||"Bottom"===i.direction?(o.points[0].y=i.points[0].y,n.points[n.points.length-1].x=o.points[0].x):(o.points[0].x=i.points[0].x,n.points[n.points.length-1].y=o.points[0].y)):(t.segments.splice(e+1,1),"Top"===i.direction||"Bottom"===i.direction?n.points[n.points.length-1].x=r.points[r.points.length-1].x:n.points[n.points.length-1].y=r.points[r.points.length-1].y,this.findSegmentDirection(n),i.length=i.direction=null),n&&o&&(n.length=sh.distancePoints(n.points[0],o.points[0]),n.direction=sh.direction(n.points[0],o.points[0]),o.length||0===o.length)){o.length=sh.distancePoints(n.points[n.points.length-1],o.points[o.points.length-1]);var s=n.points,a=o.points;o.direction=sh.direction(s[s.length-1],a[a.length-1])}},e.prototype.addOrRemoveSegment=function(t,e){for(var i,n,o=0;o<t.segments.length;o++)Is(e,(r=t.segments[o]).point,t.hitPadding)&&(n=o,i=!0);if(i&&void 0!==n){if(t.segments&&t.segments[n]&&"Straight"===t.segments[n].type){var r=t.segments[n],s=t.segments[n+1];s&&(t.segments.splice(n,1),s.points[0]=r.points[0])}}else{var a=this.findIndex(t,e);if(t.segments&&t.segments[a]&&"Straight"===t.segments[a].type){var r=t.segments[a],l=new Hd(t,"segments",{type:"Straight",point:e},!0);l.points[0]=r.points[0],l.points[1]=e,r.points[0]=e,t.segments.splice(a,0,l),i=!0}}i&&this.commandHandler.updateEndPoint(t)},e.prototype.findIndex=function(t,e){for(var i=[],n=0;n<t.segments.length;n++){var o=t.segments[n],r=ah.toBounds([o.points[0],o.points[1]]);r.Inflate(t.hitPadding),r.containsPoint(e)&&i.push(o)}if(1===i.length)return t.segments.indexOf(i[0]);for(var s=void 0,a=void 0,l=void 0,h=void 0,c=void 0,d=void 0,n=0;n<i.length;n++)h=i[n],c=(e.y-h.points[0].y)/(h.points[1].y-e.y),d=(e.x-h.points[0].x)/(h.points[1].x-e.x),s=Math.abs(c-d),0===n&&(a=s,l=0),s<a&&(a=s,l=n);return t.segments.indexOf(i[l])},e.prototype.dragOrthogonalSegment=function(t,e,i,n){var o={x:0,y:0};o.x=(e.points[n].x+e.points[n+1].x)/2,o.y=(e.points[n].y+e.points[n+1].y)/2;var r=i.y-o.y,s=i.x-o.x,a=t.segments.indexOf(e),l=!1;e.points[0].y.toFixed(2),e.points[1].y.toFixed(2);return-1!==a&&(0===a&&1===t.segments.length&&2===e.points.length?(a=this.addSegments(t,e,s,r,a),l=!0):a!==t.segments.length-1||null!==e.direction&&null!==e.length?0===a&&(a=this.insertFirstSegment(t,e,s,r,a),l=!0):(a=this.addTerminalSegment(t,e,s,r,n),l=!0),l&&(this.selectedSegment=e=t.segments[a],this.segmentIndex=0),this.updateAdjacentSegments(t,a,s,r),this.commandHandler.updateEndPoint(t)),!0},e.prototype.addSegments=function(t,e,i,n,o){var r,s,a=[],l=sh.distancePoints(e.points[0],e.points[1]),h=sh.direction(e.points[0],e.points[1]);return a.push(new jd(t,"segments",{type:"Orthogonal",direction:h,length:l/4},!0)),r=e.points[0].y===e.points[1].y?n>0?"Bottom":"Top":i>0?"Right":"Left",s=e.points[0].x===e.points[1].x?n:i,a.push(new jd(t,"segments",{type:"Orthogonal",direction:r,length:s},!0)),a.push(new jd(t,"segments",{type:"Orthogonal",direction:h,length:l/2},!0)),t.segments=a.concat(t.segments),o+2},e.prototype.insertFirstSegment=function(t,e,i,n,o){var r,s,a,l,h,c=[];if(t.sourcePortID&&e.length&&t.segments[0].points.length>2){t.segments.splice(0,1);for(var d=void 0,p=0;p<e.points.length-1;p++){var u=sh.distancePoints(e.points[p],e.points[p+1]),g=sh.direction(e.points[p],e.points[p+1]);0===(h=new jd(t,"segments",{type:"Orthogonal",direction:g,length:u},!0)).length&&(!d||"Top"!==d.direction&&"Bottom"!==d.direction?h.direction=n>0?"Bottom":"Top":h.direction=i>0?"Right":"Left"),d=h,c.push(h)}t.segments=c.concat(t.segments),l=1}else{a={type:"Orthogonal",direction:e.direction,length:e.length/3},c.push(new jd(t,"segments",a,!0)),"Bottom"===e.direction||"Top"===e.direction?(s=Math.abs(i),r=i>0?"Right":"Left"):(s=Math.abs(n),r=n>0?"Bottom":"Top"),h=new jd(t,"segments",{type:"Orthogonal",direction:r,length:s},!0),c.push(h);var m=t.segments[1];m&&m.length&&(m.length=r!==m.direction?m.length+s:m.length-s),l=2,e.length=2*e.length/3,t.segments=c.concat(t.segments)}return l},e.prototype.updateAdjacentSegments=function(t,e,i,n){var o=t.segments[e],r=o.points[o.points.length-1],s=o.points[0],a=!0;if("Orthogonal"===o.type&&(o.points[0]=s,o.points[o.points.length-1]=r,t.segments[e-1]&&(a=this.updatePreviousSegment(i,n,t,e)),t.segments.length-1>e&&a)){var l=t.segments[e+1];this.updateNextSegment(t,o,l,i,n)}},e.prototype.addTerminalSegment=function(t,e,i,n,o){var r,s,a,l,h=t.segments.indexOf(e);t.segments.pop();var c=t.segments[t.segments.length-1];r=c&&"Orthogonal"===c.type?c:null;for(var d=0;d<e.points.length-2;d++)a=sh.distancePoints(e.points[d],e.points[d+1]),l=sh.direction(e.points[d],e.points[d+1]),s=new jd(t,"segments",{type:"Orthogonal",length:a,direction:l},!0),t.segments.push(s),r=s;var p=o;if((2===e.points.length||p===e.points.length-2)&&(r&&(r.length+=5),void 0!==p)){var u=void 0;a=2*sh.distancePoints(e.points[e.points.length-2],e.points[e.points.length-1])/3,l=sh.direction(e.points[e.points.length-2],e.points[e.points.length-1]),u=new jd(t,"segments",{type:"Orthogonal",length:a,direction:l}),t.segments.push(u)}var g=new jd(t,"segments",{type:"Orthogonal"},!0);return t.segments.push(g),this.commandHandler.updateEndPoint(t),h+=o},e.prototype.updatePortSegment=function(t,e,i,n,o){if(1===i&&2===t.points.length&&t.length<0){var r=e.sourceWrapper.corners,s=e.segments[i],a=e.segments[i+1],l=void 0,h=[];l=new jd(e,"segments",{type:"Orthogonal",length:13,direction:t.direction}),h.push(l);var c=void 0;c="Left"===s.direction?s.points[0].x-(r.middleLeft.x-20):"Right"===s.direction?r.middleRight.x+20-s.points[0].x:"Bottom"===s.direction?r.bottomCenter.y+20-s.points[0].y:s.points[0].y-(r.topCenter.y-20);s.direction;l=new jd(e,"segments",{type:"Orthogonal",length:c,direction:s.direction}),h.push(l),s.length=s.length-c,a&&a.length&&a.direction&&(a.direction===t.direction?a.length-=13:a.direction===Qo(t.direction)&&(a.length+=13)),e.segments=h.concat(e.segments),this.selectedSegment=e.segments[3]}},e.prototype.updatePreviousSegment=function(t,e,i,n){var o=i.segments[n],r=i.segments[n-1];r.points[r.points.length-1]=o.points[0];var s=!i.sourceID||""!==i.sourcePortID,a=!0;return"Orthogonal"===r.type&&("Bottom"===r.direction?r.length+=e:"Top"===r.direction?r.length-=e:"Right"===r.direction?r.length+=t:r.length-=t,""!==i.sourcePortID&&r.length<0?this.updatePortSegment(r,i,n,t,e):i.sourceID&&""===i.sourcePortID&&r.length<0&&1===n&&(a=!1,this.updateFirstSegment(i,o)),s&&this.changeSegmentDirection(r)),a},e.prototype.changeSegmentDirection=function(t){t.length<0&&(t.direction=Qo(t.direction),t.length*=-1)},e.prototype.updateNextSegment=function(t,e,i,n,o){e.points[e.points.length-1];i.points[0]=e.points[e.points.length-1],i&&"Orthogonal"===i.type&&(i.length||0===i.length)&&("Left"===i.direction||"Right"===i.direction?0!==n&&(i.length="Right"===i.direction?i.length-n:i.length+n,(i.length||0===i.length)&&this.changeSegmentDirection(i)):0!==o&&(i.length="Bottom"===i.direction?i.length-o:i.length+o,(i.length||0===i.length)&&this.changeSegmentDirection(i)))},e.prototype.updateFirstSegment=function(t,e){var i,n=t.segments.indexOf(e),o=!1,r=t.segments[n],s=t.segments[n-1];if(s.length<0&&t.sourceID){var a=t.sourceWrapper.corners,l=[],h=void 0,c=!1;this.changeSegmentDirection(r);var d=t.segments[n+1],p=t.segments[n+2];switch(d&&this.changeSegmentDirection(d),p&&this.changeSegmentDirection(p),s.direction){case"Top":case"Bottom":i=r.length>0&&"Left"===r.direction?a.middleLeft:a.middleRight,r.length>a.width/2?Math.abs(s.length)<a.height/2&&(s.length=sh.distancePoints(a.center,s.points[s.points.length-1]),r.points[0].x=i.x,r.length=sh.distancePoints(r.points[0],r.points[r.points.length-1]),r.length-=20,o=!0):(d&&d.direction&&d.length&&(d.points[0].y=i.y,d.points[0].x=d.points[d.points.length-1].x="Right"===r.direction?i.x+20:i.x-20),o=!0,c=!0);break;case"Left":case"Right":i=r.length>0&&"Top"===r.direction?a.topCenter:a.bottomCenter,r.length>a.height/2?Math.abs(s.length)<a.width/2&&(s.length=sh.distancePoints(a.center,s.points[s.points.length-1]),r.points[0].y=i.y,r.length=sh.distancePoints(r.points[0],r.points[r.points.length-1]),r.length-=20,o=!0):(d&&d.direction&&d.length&&(d.points[0].x=i.x,d.points[0].y=d.points[d.points.length-1].y="Bottom"===r.direction?i.y+20:i.y-20),o=!0,c=!0)}this.changeSegmentDirection(s),this.changeSegmentDirection(r),o&&(h={type:"Orthogonal",direction:r.direction,length:20},l.push(new jd(t,"segments",h,!0)),c&&(d&&d.direction&&d.length&&(d.length=sh.distancePoints(d.points[0],d.points[d.points.length-1])),p&&p.direction&&p.length&&(p.length=sh.distancePoints(d.points[d.points.length-1],p.points[p.points.length-1])),t.segments.splice(n-1,2)),t.segments=l.concat(t.segments)),this.selectedSegment=c?t.segments[n-1]:t.segments[n+1],this.commandHandler.updateEndPoint(t)}},e.prototype.updateLastSegment=function(t,e){if(t.targetID&&""===t.targetPortID){var i=void 0,n=void 0,o=void 0,r=void 0,s=t.targetWrapper.corners,a=e.points[0],l=e.points[e.points.length-1];return"Right"===e.direction||"Left"===e.direction?(i={x:a.x,y:a.y},n={x:"Left"===e.direction?l.x-s.width/2:l.x+s.width/2,y:l.y},o={x:s.center.x,y:s.center.y-s.height},r={x:s.center.x,y:s.center.y+s.height}):(i={x:a.x,y:a.y},n={x:l.x,y:"Bottom"===e.direction?l.y+s.height/2:l.y-s.height/2},o={x:s.center.x-s.width,y:s.center.y},r={x:s.center.x+s.width,y:s.center.y}),Kr({X1:i.x,Y1:i.y,X2:n.x,Y2:n.y},{X1:o.x,Y1:o.y,X2:r.x,Y2:r.y}).enabled}return!1},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"ConnectorEditingTool"},e}(_p),nu=function(){function t(t,e){this.currentAction="None",this.focus=!1,this.isBlocked=!1,this.isMouseDown=!1,this.inAction=!1,this.doingAutoScroll=!1,this.diagram=null,this.objectFinder=null,this.tool=null,this.eventArgs=null,this.diagram=t,this.objectFinder=new ou,this.commandHandler=e}return Object.defineProperty(t.prototype,"action",{get:function(){return this.currentAction},set:function(t){t!==this.currentAction&&("PortDraw"===this.currentAction&&(this.diagram.tool&=~bh.DrawOnce,this.tool&&this.tool.mouseUp({position:this.currentPosition}),this.tool=null),"Rotate"===t?this.diagram.diagramCanvas.classList.add("e-diagram-rotate"):"Rotate"===this.currentAction&&this.diagram.diagramCanvas.classList.remove("e-diagram-rotate"),this.currentAction=t,"None"===this.currentAction||"Select"===this.currentAction||this.diagram.diagramActions&Lh.TextEdit?this.diagram.diagramActions=this.diagram.diagramActions&~Lh.ToolAction:this.diagram.diagramActions=this.diagram.diagramActions|Lh.ToolAction,this.diagram.setCursor(this.diagram.getCursor(t,this.inAction)))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"blocked",{get:function(){return this.isBlocked},set:function(t){this.isBlocked=t,this.blocked?this.diagram.setCursor("not-allowed"):this.diagram.setCursor(this.diagram.getCursor(this.action,this.inAction))},enumerable:!0,configurable:!0}),t.prototype.getMousePosition=function(t){var e,i,n;-1!==t.type.indexOf("touch")?(i=(e=t).changedTouches[0].clientX,n=e.changedTouches[0].clientY):(i=t.clientX,n=t.clientY);var o=new nh;o=zr(this.diagram);var r=this.diagram.element.getBoundingClientRect();return i=i+this.diagram.diagramCanvas.scrollLeft-r.left-o.width,n=n+this.diagram.diagramCanvas.scrollTop-r.top-o.height,i/=this.diagram.scroller.transform.scale,n/=this.diagram.scroller.transform.scale,i-=this.diagram.scroller.transform.tx,n-=this.diagram.scroller.transform.ty,{x:i,y:n}},t.prototype.windowResize=function(t){var e=this;return this.resizeTo&&clearTimeout(this.resizeTo),this.resizeTo=setTimeout(function(){e.updateViewPortSize(e.diagram.element)},300),!1},t.prototype.updateViewPortSize=function(t){var e=document.getElementById(t.id);if(e){var i=e.getBoundingClientRect();this.diagram.scroller.setViewPortSize(i.width,i.height);var n=new nh;n=zr(this.diagram);var o=this.diagram.getSizeValue(this.diagram.width,n.width),r=this.diagram.getSizeValue(this.diagram.height,n.height);this.diagram.diagramCanvas.style.width=o,this.diagram.diagramCanvas.style.height=r,this.diagram.scroller.setSize(),this.diagram.rulerSettings.showRulers&&Nr(this.diagram)}},t.prototype.canHideResizers=function(){return(this.tool instanceof qp||this.tool instanceof Xp)&&this.isMouseDown},t.prototype.updateCursor=function(){if(1===this.diagram.selectedItems.nodes.length||1===this.diagram.selectedItems.connectors.length){var t=[];t=t.concat(this.diagram.selectedItems.nodes,this.diagram.selectedItems.connectors),this.blocked=this.isMouseDown&&1===t.length&&this.tool instanceof Wp&&!or(t[0])}},t.prototype.isForeignObject=function(t,e){var i=t;if(i)for(;null!=i.parentNode;){if("string"==typeof i.className&&(!e&&-1!==i.className.indexOf("foreign-object")||e&&-1!==i.className.indexOf("e-diagram-text-edit")))return i;i=i.parentNode}return null},t.prototype.isMetaKey=function(t){return navigator.platform.match("Mac")?t.metaKey:t.ctrlKey},t.prototype.isDeleteKey=function(t,e){return navigator.platform.match("Mac")&&"Backspace"===t&&"delete"===e},t.prototype.mouseDown=function(t){this.focus=!0;var e;if(e=t.touches,!this.checkEditBoxAsTarget(t)&&Pr(this.diagram)||wr(this.diagram)&&!Cr(this.diagram))if("Select"!==this.action&&"Drag"!==this.action||this.diagram.updatePortVisibility(this.hoverElement,lh.Hover,!0),this.tool instanceof tu&&(2===t.button||2===t.buttons)){var i={element:this.diagram,position:this.currentPosition,count:t.buttons};this.inAction=!1,this.tool.mouseUp(this.eventArgs,i)}else if(!0===this.inAction&&!0===this.isMouseDown&&this.tool instanceof tu)this.isMouseDown=!0,this.eventArgs={},this.getMouseEventArgs(this.currentPosition,this.eventArgs),this.eventArgs.position=this.currentPosition,this.tool.mouseDown(this.eventArgs);else{this.isMouseDown=!0,this.currentPosition=this.prevPosition=this.getMousePosition(t),this.eventArgs={},this.diagram.endEdit();var n=void 0,o=this.objectFinder.findObjectsUnderMouse(this.currentPosition,this.diagram,null,this.action),r=this.objectFinder.findObjectUnderMouse(this.diagram,o,this.action,this.inAction,t),s=null;null!==r&&(s=this.diagram.findElementUnderMouse(r,this.currentPosition))&&(n=this.commandHandler.findTarget(s,r)),this.action=this.diagram.findActionToBeDone(r,s,this.currentPosition,n);var a=this.isMetaKey(t);if(a&&t.shiftKey&&this.diagram.connectorEditingToolModule?this.action="SegmentEnd":!a&&!t.shiftKey||wr(this.diagram)||(this.action="Select"),this.tool=this.diagram.getTool(this.action),this.tool||(this.action="Select",this.tool=this.diagram.getTool(this.action)),this.getMouseEventArgs(this.currentPosition,this.eventArgs),a||t.shiftKey){var l=a&&t.shiftKey?{ctrlKey:a,shiftKey:t.shiftKey}:{ctrlKey:!0};this.eventArgs.info=l}this.eventArgs.position=this.currentPosition,this.tool.mouseDown(this.eventArgs),this.initialEventArgs={source:this.eventArgs.source,sourceWrapper:this.eventArgs.sourceWrapper},this.initialEventArgs.position=this.currentPosition,this.initialEventArgs.info=this.eventArgs.info,this.inAction=!1,"touchstart"===t.type&&(e&&e.length>=2&&(this.touchStartList=Je(this.touchStartList,t,e)),e||t.preventDefault())}this.isForeignObject(t.target)||this.isForeignObject(t.target,!0)||e||t.preventDefault()},t.prototype.mouseMoveExtend=function(t,e){this.tool instanceof tu&&this.tool.mouseMove(this.eventArgs),this.diagram.scrollSettings.canAutoScroll?this.checkAutoScroll(t):this.blocked||this.tool.mouseMove(this.eventArgs),this.eventArgs.target&&(this.hoverElement=this.eventArgs.target);var i=!(this.eventArgs.target instanceof gp&&e instanceof gp);this.tool instanceof Up&&this.diagram.updatePortVisibility(this.hoverElement instanceof gp?this.hoverElement:this.hoverNode,lh.Connect|lh.Hover,i),this.hoverElement instanceof gp&&this.hoverNode instanceof gp&&this.hoverNode&&this.hoverNode.id!==this.hoverElement.id&&this.diagram.updatePortVisibility(this.hoverNode,lh.Connect|lh.Hover,!0),this.hoverElement=i?null:e,this.hoverNode=i?null:e},t.prototype.mouseMove=function(t,e){if(this.focus=!0,Pr(this.diagram)||wr(this.diagram)&&!Cr(this.diagram)){this.currentPosition=this.getMousePosition(t);var i=this.diagram.findObjectsUnderMouse(this.currentPosition),n=this.diagram.findObjectUnderMouse(i,this.action,this.inAction);Fr(this.diagram,this.currentPosition);var o=!1,r=void 0;if("touchmove"===t.type&&(e=t.touches)&&e.length>1&&(this.touchMoveList=Je(this.touchMoveList,t,e),"PinchZoom"!==this.action&&(o=!0)),!1===sh.equals(this.currentPosition,this.prevPosition)||this.inAction){if(!1===this.isMouseDown||o){this.eventArgs={};var s=null;null!==n&&(s=this.diagram.findElementUnderMouse(n,this.currentPosition),n!==this.hoverElement?(this.hoverElement&&(this.elementLeave(),this.diagram.updatePortVisibility(this.hoverElement,lh.Hover,!0)),n instanceof gp&&(this.hoverNode=n),this.hoverElement=n,this.elementEnter(this.currentPosition,!1)):this.hoverElement||this.hoverElement!==n||this.elementEnter(this.currentPosition,!0),s&&(r=this.commandHandler.findTarget(s,n))),this.action=this.diagram.findActionToBeDone(n,s,this.currentPosition,r),this.getMouseEventArgs(this.currentPosition,this.eventArgs),this.tool=this.getTool(this.action),this.tool instanceof Zp?this.tool.mouseMove(this.eventArgs):this.tool instanceof tu?this.tool.mouseMove(this.eventArgs):e&&this.tool instanceof Qp&&this.tool.mouseDown(this.eventArgs),this.updateCursor();var a=!1;(!this.hoverElement||this.tool instanceof Qp||!(n instanceof gp)||0!==this.diagram.selectedItems.nodes.length&&Rs(this.diagram,this.hoverElement))&&(a=!0),this.diagram.updatePortVisibility(this.hoverElement,lh.Hover,a),null===n&&this.hoverElement&&(this.hoverElement=null,this.elementLeave()),o=!1}else{if(this.eventArgs.position=this.currentPosition,"Drag"===this.action&&!Rs(this.diagram,this.eventArgs.source,!1)&&this.eventArgs.source instanceof Ud&&this.getMouseEventArgs(this.currentPosition,this.eventArgs),t.ctrlKey||t.shiftKey){var l=t.ctrlKey&&t.shiftKey?{ctrlKey:t.ctrlKey,shiftKey:t.shiftKey}:{ctrlKey:!0};this.eventArgs.info=l}or(n)&&nr(n)&&this.initialEventArgs&&this.initialEventArgs.source&&"Select"===this.action&&(!Rs(this.diagram,this.eventArgs.source,!1)&&this.eventArgs.source instanceof Ud&&this.getMouseEventArgs(this.currentPosition,this.eventArgs),n instanceof Vd&&(!(n instanceof Vd)||Is(this.currentPosition,n.sourcePoint,n.hitPadding)||Is(this.currentPosition,n.targetPoint,n.hitPadding))||(this.action="Drag"),this.tool=this.getTool(this.action),this.tool.mouseDown(this.initialEventArgs)),this.getMouseEventArgs(this.currentPosition,this.eventArgs,this.eventArgs.source),this.updateCursor(),this.inAction=!0,this.initialEventArgs=null,this.mouseMoveExtend(t,n)}this.prevPosition=this.currentPosition,this.isForeignObject(t.target,!0)||t.preventDefault()}}},t.prototype.checkAutoScroll=function(t){var e=this.startAutoScroll(t);if(!e&&this.doingAutoScroll)this.doingAutoScroll=!1,clearInterval(this.timeOutValue);else if(e){if((this.tool instanceof qp||this.tool instanceof Yp||this.tool instanceof Wp)&&this.inAction){var i=this;this.diagram.scrollSettings.canAutoScroll&&e&&!this.doingAutoScroll&&(this.doingAutoScroll=!0,this.timeOutValue=setInterval(function(n){i.doAutoScroll(e,t,100)},100))}}else this.blocked=!this.tool.mouseMove(this.eventArgs)},t.prototype.mouseUp=function(t){var e;if(e=t.touches,!this.checkEditBoxAsTarget(t)&&Pr(this.diagram)||wr(this.diagram)&&!Cr(this.diagram)){if(this.tool&&(!(this.tool instanceof tu)||this.tool instanceof tu&&2===t.detail)){if(this.diagram.endEdit(),document.getElementById(this.diagram.element.id+"content").focus(),!this.inAction&&3!==t.which&&"Drag"===this.action){this.action="Select";var i=this.diagram.findObjectsUnderMouse(this.currentPosition),n=this.diagram.findObjectUnderMouse(i,this.action,this.inAction),o=!0;!t.ctrlKey&&this.isMouseDown&&this.diagram.selectedItems.nodes.length+this.diagram.selectedItems.connectors.length>1&&1===t.which&&(o=!1,this.commandHandler.clearSelection()),Rs(this.diagram,n)&&o||this.commandHandler.selectObjects([n])}if(this.inAction=!1,this.isMouseDown=!1,this.currentPosition=this.getMousePosition(t),this.tool&&(this.tool.prevPosition||this.tool instanceof $p)){this.eventArgs.position=this.currentPosition,this.getMouseEventArgs(this.currentPosition,this.eventArgs,this.eventArgs.source);var r=this.isMetaKey(t);if(r||t.shiftKey){var s=r&&t.shiftKey?{ctrlKey:r,shiftKey:t.shiftKey}:{ctrlKey:!0};this.eventArgs.info=s}this.eventArgs.clickCount=t.detail,this.tool.mouseUp(this.eventArgs)}if(this.blocked=!1,this.hoverElement){var a=lh.Connect;Rs(this.diagram,this.hoverElement)&&(a|=lh.Hover),this.diagram.updatePortVisibility(this.hoverElement,a,!0),this.hoverElement=null}this.touchStartList=null,this.touchMoveList=null,this.tool instanceof Kp||(this.tool=null)}this.eventArgs={},e||t.preventDefault(),this.diagram.currentDrawingObject=void 0;var l=this.diagram.selectedItems;if(!this.inAction&&l.wrapper&&l.userHandles.length>0&&this.diagram.renderSelector(!0),!this.inAction&&!this.diagram.currentSymbol){var h={element:this.eventArgs.source||this.diagram,position:this.eventArgs.position,count:t.detail};this.diagram.triggerEvent(Ph.click,h)}}},t.prototype.mouseLeave=function(t){this.tool&&this.inAction&&this.tool.mouseLeave(this.eventArgs),this.eventArgs&&this.eventArgs.source&&(this.diagram.updatePortVisibility(this.eventArgs.source,lh.Hover,!0),this.hoverElement=null),this.tool instanceof Up&&this.eventArgs&&this.eventArgs.target&&this.eventArgs.target instanceof gp&&(this.diagram.updatePortVisibility(this.eventArgs.target,lh.Hover|lh.Connect,!0),this.hoverElement=null);var e=this.diagram.selectedItems;e&&e.wrapper&&this.diagram.renderSelector(!0),this.isMouseDown=!1,this.focus=!1,this.touchStartList=null,this.touchMoveList=null,this.commandHandler.removeSnap(),this.inAction=!1,this.eventArgs={},this.tool=null,Vr(),"Rotate"===this.action&&this.diagram.diagramCanvas.classList.remove("e-diagram-rotate"),t.preventDefault()},t.prototype.mouseWheel=function(t){var e=t.wheelDelta>0||-40*t.detail>0,i=this.getMousePosition(t);if(this.diagram.endEdit(),this.diagram.tooltipObject.close(),this.isMetaKey(t))this.diagram.zoom(e?1.2:1/1.2,i),t.preventDefault();else{var n=this.diagram.scroller.horizontalOffset,o=this.diagram.scroller.verticalOffset,r=e?20:-20;this.tool&&this.tool instanceof tu&&(this.eventArgs={},this.getMouseEventArgs(i,this.eventArgs),this.eventArgs.position=i,this.tool.mouseWheel(this.eventArgs)),t.shiftKey?this.diagram.scroller.zoom(1,r,0,i):this.diagram.scroller.zoom(1,0,r,i),n===this.diagram.scroller.horizontalOffset&&o===this.diagram.scroller.verticalOffset||t.preventDefault()}},t.prototype.keyDown=function(t){if(!(this.diagram.diagramActions&Lh.TextEdit)&&!this.checkEditBoxAsTarget(t)||"Escape"===t.key||27===t.keyCode){var e=void 0,i=t.keyCode?t.keyCode:t.which,n=t.key,o=this.isMetaKey(t);if(this.diagram.commandManager&&this.diagram.commands)for(var r=this.diagram.commands,s=0,a=Object.keys(r);s<a.length;s++){var l=a[s];if((e=this.diagram.commands[l])&&(e.gesture.keyModifiers||e.gesture.key)&&(i===e.gesture.key||n===Ch[e.gesture.key]||this.isDeleteKey(n,l))&&(!e.gesture.keyModifiers&&!t.altKey&&!t.shiftKey&&!o||e.gesture.keyModifiers&&(o||t.altKey||t.shiftKey)&&this.altKeyPressed(e.gesture.keyModifiers)&&t.altKey||this.shiftKeyPressed(e.gesture.keyModifiers)&&t.shiftKey||this.ctrlKeyPressed(e.gesture.keyModifiers)&&o)){var h=fe(e.canExecute);if(h&&h({keyDownEventArgs:KeyboardEvent,parameter:e.parameter})){t.preventDefault(),"Escape"===t.key&&this.checkEditBoxAsTarget(t)&&document.getElementById(this.diagram.diagramCanvas.id).focus(),e.execute&&fe(e.execute)({keyDownEventArgs:KeyboardEvent,parameter:e.parameter});break}}}}},t.prototype.startAutoScroll=function(t){var e=this.getMousePosition(t);e.x*=this.diagram.scroller.currentZoom,e.y*=this.diagram.scroller.currentZoom;var i,n=this.diagram.scrollSettings.autoScrollBorder;return this.diagram.scrollSettings.canAutoScroll&&(e.x+this.diagram.scroller.horizontalOffset+n.right>this.diagram.scroller.viewPortWidth-18?i="right":e.x+this.diagram.scroller.horizontalOffset<n.left?i="left":e.y+this.diagram.scroller.verticalOffset+n.bottom>this.diagram.scroller.viewPortHeight-18?i="bottom":e.y+this.diagram.scroller.verticalOffset<n.top&&(i="top")),i},t.prototype.doAutoScroll=function(t,e,i,n){var o=t;if((this.tool instanceof qp||this.tool instanceof Yp||this.tool instanceof Wp)&&this.inAction){this.eventArgs.position={x:this.tool.prevPosition.x,y:this.tool.prevPosition.y};var r=this.getMousePosition(e),s=(this.diagram.scrollSettings.autoScrollBorder,0),a=0;switch(o){case"right":this.eventArgs.position.x+=10,s=10;break;case"left":this.eventArgs.position.x-=10,s=-10;break;case"bottom":this.eventArgs.position.y+=10,a=10;break;case"top":this.eventArgs.position.y-=10,a=-10}this.tool.mouseMove(this.eventArgs),this.diagram.scroller.zoom(1,-s,-a,r)}},t.prototype.elementEnter=function(t,e){if(!e){var i=this.hoverElement instanceof gp&&this.hoverElement.constraints&fh.Tooltip||this.hoverElement instanceof Vd&&this.hoverElement.constraints&gh.Tooltip;Vn(this.diagram,i?this.hoverElement:void 0);var n=Jr(this.diagram,t,this.hoverElement);this.diagram.tooltipObject.close(),this.diagram.tooltipObject.offsetX=n.x,this.diagram.tooltipObject.offsetY=n.y,this.diagram.tooltipObject.dataBind(),vr(this.hoverElement,this.diagram)&&this.diagram.tooltipObject.open(this.diagram.element)}},t.prototype.elementLeave=function(){this.diagram.tooltipObject.close()},t.prototype.altKeyPressed=function(t){return!!(t&Sh.Alt)},t.prototype.ctrlKeyPressed=function(t){return!!(t&Sh.Control)},t.prototype.shiftKeyPressed=function(t){return!!(t&Sh.Shift)},t.prototype.scrolled=function(t){this.diagram.updateScrollOffset()},t.prototype.doubleClick=function(t){if(Pr(this.diagram)){var e=void 0,i=this.diagram.findObjectsUnderMouse(this.currentPosition),n=this.diagram.findObjectUnderMouse(i,this.action,this.inAction);if(null!==n&&Pr(this.diagram))if(e=this.diagram.findElementUnderMouse(n,this.currentPosition),this.tool&&this.tool instanceof tu){var o={source:n||this.diagram,position:this.currentPosition,count:t.detail};this.tool.mouseUp(this.eventArgs,o),this.isMouseDown=!1,this.eventArgs={},this.tool=null,t.preventDefault()}else{var r=this.diagram.commandHandler.getObjectLayer(n.id);if(r&&!r.lock&&r.visible&&!(this.diagram.diagramActions&Lh.TextEdit)){var s="";"TextAnnotation"===n.shape.shape&&(s=n.id.split("_textannotation_")[1]),this.diagram.startTextEdit(n,s||(e instanceof Fh?e.id.split(n.id+"_")[1]:void 0))}}var a={source:n||this.diagram,position:this.currentPosition,count:t.detail};this.diagram.triggerEvent(Ph.doubleClick,a)}},t.prototype.inputChange=function(t){var e,i,n,o,r,s,a,l,h=document.getElementById(this.diagram.element.id+"_editBox"),c=document.getElementById(this.diagram.element.id+"_editTextBoxDiv"),d=h.value,p=d.split("\n");!(o=this.diagram.selectedItems.nodes[0]?this.diagram.selectedItems.nodes[0]:this.diagram.selectedItems.connectors[0])&&this.tool instanceof Kp&&(o=this.diagram.nameTable[this.diagram.activeLabel.parentId]),o&&("Text"!==o.shape.type&&o.annotations.length>0||"Text"===o.shape.type)&&(n=this.diagram.getWrapper(o.wrapper,this.diagram.activeLabel.id),e=(e=o.wrapper.bounds.width>n.bounds.width?o.wrapper.bounds.width:n.bounds.width)>90?e:90,a=Le(n.style,d,void 0,void 0,e),i=Number(h.style.fontSize.split("px")[0]),p.length>1&&""===p[p.length-1]&&(a.height=a.height+i),s=90>(s=a.width)?90:s,r=12>a.height?12:a.height,l=this.diagram.scroller.transform,c.style.left=(n.bounds.center.x+l.tx)*l.scale-s/2-2.5+"px",c.style.top=(n.bounds.center.y+l.ty)*l.scale-r/2-3+"px",c.style.width=s+"px",c.style.height=r+"px",h.style.minHeight="12px",h.style.minWidth="90px",h.style.width=s+"px",h.style.height=r+"px")},t.prototype.isAddTextNode=function(t,e){return!!(this.tool instanceof Kp||e)&&(this.tool=null,t&&!xr(this.diagram)&&(this.diagram.drawingObject=void 0,this.diagram.currentDrawingObject=void 0),!Cs(this.diagram.nodes,t.id)&&!Cs(this.diagram.connectors,t.id))},t.prototype.checkEditBoxAsTarget=function(t){return!(!t.target||t.target.id!==this.diagram.element.id+"_editBox")},t.prototype.getMouseEventArgs=function(t,e,i){e.position=t;var n,o;i?(o=this.diagram.findObjectsUnderMouse(this.currentPosition,i),n=this.diagram.findTargetObjectUnderMouse(o,this.action,this.inAction,e.position,i)):"Drag"===this.action||"ConnectorSourceEnd"===this.action||"SegmentEnd"===this.action||"OrthoThumb"===this.action||"BezierSourceThumb"===this.action||"BezierTargetThumb"===this.action||"ConnectorTargetEnd"===this.action||"Rotate"===this.action||-1!==this.action.indexOf("Resize")?n=this.diagram.selectedItems:(o=this.diagram.findObjectsUnderMouse(this.currentPosition),n=this.diagram.findObjectUnderMouse(o,this.action,this.inAction));var r;return n&&(r=this.diagram.findElementUnderMouse(n,this.currentPosition)),i?(e.target=n,e.targetWrapper=r):(e.source=n,e.sourceWrapper=r),e.startTouches=this.touchStartList,e.moveTouches=this.touchMoveList,e},t.prototype.resetTool=function(){this.action="Select",this.hoverElement=null,this.hoverNode=null,this.tool=this.diagram.getTool(this.action),this.updateCursor()},t.prototype.getTool=function(t){switch(t){case"Select":return new Wp(this.commandHandler,!0);case"Drag":return new qp(this.commandHandler);case"Rotate":return new Xp(this.commandHandler);case"LayoutAnimation":return new Jp(this.commandHandler);case"Hyperlink":return new $p(this.commandHandler);case"ResizeSouthEast":case"ResizeSouthWest":case"ResizeNorthEast":case"ResizeNorthWest":case"ResizeSouth":case"ResizeNorth":case"ResizeWest":case"ResizeEast":return new Yp(this.commandHandler,t);case"ConnectorSourceEnd":case"ConnectorTargetEnd":case"BezierSourceThumb":case"BezierTargetThumb":return new Up(this.commandHandler,t);case"SegmentEnd":case"OrthoThumb":return new iu(this.commandHandler,t);case"Draw":var e=Xr(this.diagram.drawingObject);if("Node"===e&&"Text"===this.diagram.drawingObject.shape.type)return new Kp(this.commandHandler);if("Node"===e&&"Polygon"===this.diagram.drawingObject.shape.shape&&!this.diagram.drawingObject.shape.points)return new tu(this.commandHandler);if("Node"===e||"Node"===e&&"Polygon"===this.diagram.drawingObject.shape.shape&&this.diagram.drawingObject.shape.points)return new Gp(this.commandHandler,this.diagram.drawingObject);if("Connector"===e)return new Zp(this.commandHandler,"ConnectorSourceEnd",this.diagram.drawingObject);break;case"Pan":return new Qp(this.commandHandler,!1);case"PinchZoom":return new Qp(this.commandHandler,!0);case"PortDrag":return new qp(this.commandHandler,"Port");case"PortDraw":return new Zp(this.commandHandler,"ConnectorSourceEnd",this.diagram.drawingObject)}return null},t.prototype.getCursor=function(t){return Ds(t,this.diagram.selectedItems.rotateAngle)},t.prototype.findElementUnderMouse=function(t,e){return this.objectFinder.findElementUnderSelectedItem(t,e)},t.prototype.findObjectsUnderMouse=function(t,e){return this.objectFinder.findObjectsUnderMouse(t,this.diagram,e)},t.prototype.findObjectUnderMouse=function(t,e,i){return this.objectFinder.findObjectUnderMouse(this.diagram,t,e,i,this.currentPosition)},t.prototype.findTargetUnderMouse=function(t,e,i,n,o){return this.objectFinder.findObjectUnderMouse(this.diagram,t,e,i,n,o)},t.prototype.findActionToBeDone=function(t,e,i,n){return Ps(t,e,this.currentPosition,this.diagram,this.touchStartList,this.touchMoveList,n)},t}(),ou=function(){function t(){}return t.prototype.findObjectsUnderMouse=function(t,e,i,n){var o=[];i&&i instanceof Ud&&i.nodes.length+i.connectors.length===1&&(i=i.nodes[0]||i.connectors[0]);for(var r,s,a,l,h,c={},d=0,p=e.spatialSearch.findObjects(new ah(t.x-50,t.y-50,100,100));d<p.length;d++){var u=t;if(s=(S=p[d]).wrapper.outerBounds,((S!==i||e.currentDrawingObject instanceof Vd)&&S instanceof Vd?S!==e.currentDrawingObject:S.wrapper.visible)&&(b=e.commandHandler.getObjectLayer(S.id))&&!b.lock&&b.visible){if(h=c[b.zIndex]=c[b.zIndex]||[],S.rotateAngle){r=S.wrapper,qt(l=_t(),-(r.rotateAngle+r.parentTransform),S.offsetX,S.offsetY),u=Wt(l,t),s=r.corners;for(var g=0,m=r.children;g<m.length;g++)a=m[g],s.uniteRect(a.corners)}if((!i||!1===Rs(e,S))&&rr(S,e)&&(S instanceof Vd?Zr(S,t):s.containsPoint(u))){var f=S instanceof Vd?S.hitPadding||0:0;this.findElementUnderMouse(S,t,f)&&(S instanceof Vd&&e.bpmnModule&&(S=e.bpmnModule.findInteractableObject(S,e)),Es(S,"zIndex",h))}}}for(var v=0,y=e.layers;v<y.length;v++)for(var b=y[v],w=0,x=o=o.concat(c[b.zIndex]||[]);w<x.length;w++){var S=x[w];"Bpmn"!==S.shape.type||!S.processId||e.eventHandler.tool instanceof qp&&!(e.eventHandler.tool instanceof qp&&fr(S))||(T=o.indexOf(e.nameTable[S.processId]))>-1&&o.splice(T,1)}for(var C=0;C<o.length;C++){var L=e.nameTable[o[C].parentId];if(L)for(var E=this.findElementUnderMouse(L,t),P=0;P<L.ports.length;P++)if(E.id.match("_"+L.ports[P].id+"$")){var k=L.ports[P];if(Rr(k,e)||Mr(k,e))return o}for(;L;){var T=o.indexOf(L);if(-1===T)break;o.splice(T,1),L=e.nameTable[L.parentId]}}return o},t.prototype.isTarget=function(t,e,i){var n,o=e.selectedItems.connectors[0];return!(n="ConnectorSourceEnd"===i?e.nameTable[o.targetID]:n=e.nameTable[o.sourceID])||(n.processId||t.processId)&&n.processId===t.processId||n.processId!==t.processId&&(t=null),t},t.prototype.findObjectUnderMouse=function(t,e,i,n,o,r){var s=null;if(0!==e.length)if(r&&r instanceof Ud&&r.nodes.length+r.connectors.length===1&&(r=r.nodes[0]||r.connectors[0]),"ConnectorSourceEnd"===i&&r||"PortDraw"===i||(Sr(t)||xr(t))&&yp(t.drawingObject)===Vd){for(var a=t.selectedItems.connectors[0],l=e.length-1;l>=0;l--)if(e[l]instanceof gp&&gr(e[l]))return s=e[l],a&&(s=this.isTarget(s,t,i)),s}else if("ConnectorTargetEnd"===i&&r){for(l=e.length-1;l>=0;l--)if(e[l]instanceof gp&&ur(e[l]))return s=e[l],s=this.isTarget(s,t,i)}else{if(r&&("Drag"===i||t.eventHandler.tool instanceof qp)){for(var h=0,l=0;l<e.length;l++){var c=e[l];r!==c&&(c instanceof Vd||!o||c.wrapper.bounds.containsPoint(o))&&fr(c)&&(s?(s=h>=c.zIndex?s:c,h=Math.max(h,c.zIndex)):h=(s=c).zIndex)}return s&&"Bpmn"===s.shape.type&&(s=t.selectedItems.nodes.length>0&&"Bpmn"===t.selectedItems.nodes[0].shape.type?s:null),s}if("Select"===i&&t.eventHandler.tool){for(l=e.length-1;l>=0;l--)if(e[l]instanceof Vd&&e[l-1]instanceof gp&&e[l-1].ports){if((g=this.findTargetElement(e[l-1].wrapper,o,void 0))&&(g.id.match("_icon_content_shape$")||g.id.match("_icon_content_rect$")))return e[l-1];for(var d=0;d<e[l-1].ports.length;d++)if(g&&g.id.match("_"+e[l-1].ports[d].id+"$")&&Mr(e[l-1].ports[d],t))return e[l-1]}if((s=e[e.length-1]).parentId)for(var p=s,u=Rs(t,p);p&&(!Rs(t,p)||u);)s=p,p=t.nameTable[p.parentId]}else if("Pan"===i||"LayoutAnimation"===i){for(l=e.length-1;l>=0;l--)if(e[l]instanceof gp){var g=this.findTargetElement(e[l].wrapper,o,void 0);if("LayoutAnimation"===i||"Pan"===i||g&&(g.id.match("_icon_content_shape$")||g.id.match("_icon_content_rect$")))return e[l]}}else s=e[e.length-1]}return s},t.prototype.findElementUnderSelectedItem=function(t,e){return t instanceof Ud?1!==t.nodes.length||t.connectors&&t.connectors.length?t.nodes&&!t.nodes.length||1!==t.connectors.length?null:this.findElementUnderMouse(t.connectors[0],e):this.findElementUnderMouse(t.nodes[0],e):this.findElementUnderMouse(t,e)},t.prototype.findElementUnderMouse=function(t,e,i){return this.findTargetElement(t.wrapper,e,i)},t.prototype.findTargetElement=function(t,e,i){for(var n=t.children.length-1;n>=0;n--){var o=t.children[n];if(o&&o.outerBounds.containsPoint(e)){if(o instanceof ic){var r=this.findTargetElement(o,e);if(r)return r}if(o.bounds.containsPoint(e))return o}}return t.bounds.containsPoint(e,i)&&"none"!==t.style.fill?t:null},t}(),ru=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),su=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},au=function(t){function e(e,i,n,o){var r=t.call(this,e,i,n,o)||this;return r.objectZIndex=-1,r.zIndexTable={},r.objects=[],r}return ru(e,t),su([et("")],e.prototype,"id",void 0),su([et(!0)],e.prototype,"visible",void 0),su([et(!1)],e.prototype,"lock",void 0),su([et()],e.prototype,"objects",void 0),su([et()],e.prototype,"addInfo",void 0),su([et(-1)],e.prototype,"zIndex",void 0),e}(qa),lu=function(){function t(t){this.clipboardData={},this.connectorsTable=[],this.processTable={},this.childTable={},this.parentTable={},this.diagram=t}return Object.defineProperty(t.prototype,"snappingModule",{get:function(){return this.diagram.snappingModule},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layoutAnimateModule",{get:function(){return this.diagram.layoutAnimateModule},enumerable:!0,configurable:!0}),t.prototype.startTransaction=function(t){this.state={element:this.diagram.selectedItems,backup:null},t&&this.diagram.protectPropertyChange(!0),De(this.diagram.element.id).style.pointerEvents="none"},t.prototype.endTransaction=function(t){this.state=null,t&&this.diagram.protectPropertyChange(!1),De(this.diagram.element.id).style.pointerEvents="all"},t.prototype.showTooltip=function(t,e,i,n,o){var r=this;o&&(this.diagram.tooltipObject.position="BottomCenter",this.diagram.tooltipObject.animation={open:{delay:0,duration:0}},this.diagram.tooltip.relativeMode="ConnectTool"===n?"Mouse":"Object",this.diagram.tooltipObject.openDelay=0,this.diagram.tooltipObject.closeDelay=0),this.diagram.tooltipObject.content=i;var s=Jr(this.diagram,{x:e.x,y:e.y},t);this.diagram.tooltipObject.offsetX=s.x+("ConnectTool"===n?10:0),this.diagram.tooltipObject.offsetY=s.y+10,this.diagram.tooltipObject.dataBind(),o&&setTimeout(function(){r.diagram.tooltipObject.open(r.diagram.element)},1)},t.prototype.closeTooltip=function(){this.diagram.tooltipObject.close()},t.prototype.canEnableDefaultTooltip=function(){return!!(this.diagram.selectedItems.constraints&uh.ToolTip)},t.prototype.updateSelector=function(){this.diagram.updateSelector()},t.prototype.triggerEvent=function(t,e){if(t===Ph.drop||t===Ph.positionChange||t===Ph.connectionChange){if(this.diagram.currentSymbol)return;if(t===Ph.drop&&(e.source=this.diagram),this.diagram.currentDrawingObject)return}this.diagram.triggerEvent(t,e)},t.prototype.dragOverElement=function(t,e){if(this.diagram.currentSymbol){var i={element:t.source,target:t.target,mousePosition:e,diagram:this.diagram};this.triggerEvent(Ph.dragOver,i)}},t.prototype.disConnect=function(t,e){var i,n={},o={};if(t instanceof Ud?i=t.connectors[0]:t instanceof Vd&&this.diagram.currentDrawingObject&&(i=this.diagram.currentDrawingObject),t&&i&&(Ms(this.diagram)||this.diagram.currentDrawingObject))if(!e||"ConnectorSourceEnd"!==e&&"ConnectorTargetEnd"!==e){if("OrthoThumb"!==e&&"SegmentEnd"!==e&&(i.sourceID||i.targetID)){n={sourceID:i.sourceID,sourcePortID:i.sourcePortID,targetID:i.targetID,targetPortID:i.targetPortID},i.sourceID="",i.sourcePortID="",i.targetID="",i.targetPortID="";var r={connector:i,oldValue:n,newValue:o={sourceID:i.sourceID,sourcePortID:i.sourcePortID,targetID:i.targetID,targetPortID:i.targetPortID},cancel:!1,state:"Changing",connectorEnd:e};this.triggerEvent(Ph.connectionChange,r),r.cancel?(i.sourceID=n.sourceID,i.sourcePortID=n.sourcePortID,i.targetID=n.targetID,i.targetPortID=n.targetPortID):(this.diagram.connectorPropertyChange(i,n,o),this.diagram.updateDiagramObject(i),r={connector:i,oldValue:n,newValue:o,cancel:!1,state:"Changed",connectorEnd:e},this.triggerEvent(Ph.connectionChange,r))}}else{var s="ConnectorSourceEnd"===e?"sourceID":"targetID",a="ConnectorSourceEnd"===e?"sourcePortID":"targetPortID";i[s]&&(n[s]=i[s],i[s]="",o[s]=i[s],(i.sourcePortID||i.targetPortID)&&(n[a]=i[a],i[a]="",o[a]=i[a]),this.connectionEventChange(i,n,o,e))}},t.prototype.connectionEventChange=function(t,e,i,n){var o="ConnectorSourceEnd"===n?"sourceID":"targetID",r="ConnectorSourceEnd"===n?"sourcePortID":"targetPortID",s={connector:t,oldValue:{nodeId:e[o],portId:e[r]},newValue:{nodeId:i[o],portId:i[r]},cancel:!1,state:"Changing",connectorEnd:n};this.triggerEvent(Ph.connectionChange,s),s.cancel?(t[o]=e[o],t[r]=e[r],i=e):(this.diagram.connectorPropertyChange(t,e,i),this.diagram.updateDiagramObject(t),s={connector:t,oldValue:{nodeId:e[o],portId:e[r]},newValue:{nodeId:i[o],portId:i[r]},cancel:!1,state:"Changed",connectorEnd:n},this.triggerEvent(Ph.connectionChange,s))},t.prototype.findTarget=function(t,e,i){if(e instanceof gp){if(t&&t.id===e.id+"_content")return e;if(i&&"Bpmn"===e.shape.type&&"Activity"===e.shape.shape&&"Transaction"===e.shape.activity.subProcess.type){var n=e.shape.activity.subProcess.transaction;if(n.success.visible&&0===t.id.indexOf(e.id+"_success"))return n.success;if(n.cancel.visible&&0===t.id.indexOf(e.id+"_cancel"))return n.cancel;if(n.failure.visible&&0===t.id.indexOf(e.id+"_failure"))return n.failure}if(t instanceof Hh)for(var o=0;o<e.ports.length;o++){var r=e.ports[o];if(t.id===e.id+"_"+r.id)return r}}return e},t.prototype.canDisconnect=function(t,e,i,n){var o;e.source instanceof Ud?o=e.source.connectors[0]:e.source instanceof Vd&&this.diagram.currentDrawingObject&&(o=this.diagram.currentDrawingObject);this.findTarget(e.targetWrapper,e.target,"ConnectorSourceEnd"===t);var r="ConnectorSourceEnd"===t?"sourceID":"targetID",s="ConnectorSourceEnd"===t?"sourcePortID":"targetPortID";return o[r]!==n||o[s]!==i},t.prototype.connect=function(t,e){var i,n,o,r={},s={};e.source instanceof Ud?o=e.source.connectors[0]:e.source instanceof Vd&&this.diagram.currentDrawingObject&&(o=this.diagram.currentDrawingObject);var a=this.findTarget(e.targetWrapper,e.target,"ConnectorSourceEnd"===t),l="ConnectorSourceEnd"===t?"sourceID":"targetID",h="ConnectorSourceEnd"===t?"sourcePortID":"targetPortID";if(a instanceof gp)s[l]=o[l],o[l]=a.id,r[l]=o[l],s[h]=o[h],this.connectionEventChange(o,s,r,t);else{i=o[l],n=o[h],o[h]=a.id,o[l]=e.target.id,r[l]=o[l],r[h]=o[h];var c={connector:o,oldValue:{nodeId:i,portId:n},newValue:{nodeId:r[l],portId:r[h]},cancel:!1,state:"Changing",connectorEnd:t};this.triggerEvent(Ph.connectionChange,c),c.cancel?(o[l]=i,o[h]=n,r[l]=i,r[h]=n):(this.diagram.connectorPropertyChange(o,{},r),this.diagram.updateDiagramObject(o),c={connector:o,oldValue:{nodeId:i,portId:n},newValue:{nodeId:r[l],portId:r[h]},cancel:!1,state:"Changed",connectorEnd:t},this.triggerEvent(Ph.connectionChange,c))}this.renderHighlighter(e,void 0,"ConnectorSourceEnd"===t)},t.prototype.cut=function(){this.clipboardData.pasteIndex=0,this.diagram.undoRedoModule&&this.diagram.historyList.startGroupAction(),this.clipboardData.clipObject=this.copyObjects(),this.diagram.undoRedoModule&&this.diagram.historyList.endGroupAction(),"SVG"!==this.diagram.mode&&this.diagram.refreshDiagramLayer()},t.prototype.addLayer=function(t,e){t.id=t.id||te(),t.zIndex=this.diagram.layers.length,(t=new au(this.diagram,"layers",t,!0)).objectZIndex=-1,t.zIndexTable={},this.diagram.layers.push(t),this.diagram.layerZIndexTable[t.zIndex]=t.id,this.diagram.activeLayer=t;t.objects;if(e)for(var i=0;i<e.length;i++)this.diagram.add(e[i])},t.prototype.getObjectLayer=function(t){for(var e=this.diagram.layers,i=0;i<e.length;i++)if(e[i].objects.indexOf(t)>-1)return e[i];return this.diagram.activeLayer},t.prototype.getLayer=function(t){for(var e=this.diagram.layers,i=0;i<e.length;i++)if(e[i].id===t)return e[i]},t.prototype.removeLayer=function(t){var e=this.getLayer(t);if(e){for(var i=this.diagram.layers.indexOf(e),n=e.objects,o=n.length-1;o>=0;o--)this.diagram.unSelect(this.diagram.nameTable[n[o]]),this.diagram.remove(this.diagram.nameTable[n[o]]),"default_layer"!==e.id&&this.diagram.activeLayer.id===t&&(this.diagram.activeLayer=this.diagram.layers[this.diagram.layers.length-1]);delete this.diagram.layerZIndexTable[e.zIndex],this.diagram.layers.splice(i,1),"SVG"!==this.diagram.mode&&this.diagram.refreshDiagramLayer()}},t.prototype.moveObjects=function(t,e){var i=this.getLayer(e)||this.diagram.activeLayer;this.diagram.setActiveLayer(i.id);for(var n,o=0,r=t;o<r.length;o++){var s=r[o];this.getObjectLayer(s).objects.indexOf(s)>-1&&(n=this.diagram.nameTable[s],this.diagram.unSelect(n),this.diagram.remove(this.diagram.nameTable[s]),this.diagram.add(n))}},t.prototype.cloneLayer=function(t){this.diagram.layers;var e=this.getLayer(t);if(e){var i=[],n={id:t+"_"+te(),objects:[],visible:!0,lock:!1};this.addLayer(n),n.zIndex=this.diagram.layers.length-1;for(var o=0,r=e.objects;o<r.length;o++){var s=r[o];i.push(this.diagram.nameTable[s])}this.paste(i)}},t.prototype.copy=function(){return this.clipboardData.pasteIndex=1,this.clipboardData.clipObject=this.copyObjects(),this.clipboardData.clipObject},t.prototype.copyObjects=function(){var t=[],e=[];if(this.clipboardData.childTable={},this.diagram.selectedItems.connectors.length>0){t=this.diagram.selectedItems.connectors;for(n=0;n<t.length;n++){var i=ie(t[n]);e.push(i)}}if(this.diagram.selectedItems.nodes.length>0){t=t.concat(this.diagram.selectedItems.nodes);for(var n=0;n<this.diagram.selectedItems.nodes.length;n++){var o=ie(this.diagram.selectedItems.nodes[n]);this.copyProcesses(o),e.push(ie(o));var r=_t();if(qt(r,-o.rotateAngle,o.offsetX,o.offsetY),o.children){for(var s=this.clipboardData.childTable,a=void 0,l=[],h=this.getAllDescendants(o,l,!0),c=0;c<h.length;c++){var d=s[(a=this.diagram.nameTable[h[c].id]).id]=ie(a),p=Wt(r,{x:d.wrapper.offsetX,y:d.wrapper.offsetY});a instanceof gp&&(d.offsetX=p.x,d.offsetY=p.y,d.rotateAngle-=o.rotateAngle)}this.clipboardData.childTable=s}}}if(0===this.clipboardData.pasteIndex){this.startGroupAction();for(var u=0,g=t;u<g.length;u++){var m=g[u];this.diagram.nameTable[m.id]&&this.diagram.remove(m)}this.endGroupAction()}return this.sortByZIndex(e,"zIndex"),e},t.prototype.copyProcesses=function(t){if("Bpmn"===t.shape.type&&t.shape.activity&&t.shape.activity.subProcess.processes&&t.shape.activity.subProcess.processes.length>0){for(var e=0,i=t.shape.activity.subProcess.processes;e<i.length;e++){var n=i[e];this.processTable[n]=ie(this.diagram.nameTable[n]),this.processTable[n].shape.activity.subProcess.processes&&this.processTable[n].shape.activity.subProcess.processes.length>0&&this.copyProcesses(this.processTable[n])}this.clipboardData.processTable=this.processTable}},t.prototype.group=function(){var t=this.diagram.isProtectedOnChange;this.diagram.protectPropertyChange(!0),this.diagram.diagramActions=this.diagram.diagramActions|Lh.Group;var e=[],i={};i.id="group"+te(),(i=new gp(this.diagram,"nodes",i,!0)).children=[],e=(e=this.diagram.selectedItems.nodes).concat(this.diagram.selectedItems.connectors);for(var n=0;n<e.length;n++)e[n].parentId||i.children.push(e[n].id);this.diagram.add(i);var o={type:"Group",undoObject:i,redoObject:i,category:"Internal"};this.addHistoryEntry(o),this.diagram.diagramActions=this.diagram.diagramActions&~Lh.Group,this.diagram.protectPropertyChange(t)},t.prototype.unGroup=function(t){var e=this.diagram.isProtectedOnChange;this.diagram.protectPropertyChange(!0),this.diagram.diagramActions=this.diagram.diagramActions|Lh.Group;var i=[];t?i.push(t):i=this.diagram.selectedItems.nodes;for(var n=0;n<i.length;n++){var o=i[n],r={type:"UnGroup",undoObject:ie(o),redoObject:ie(o),category:"Internal"};if(this.diagram.diagramActions&Lh.UndoRedo||this.addHistoryEntry(r),o.children){for(var s=this.diagram.nameTable[o.parentId],a=o.children.length-1;a>=0;a--)this.diagram.nameTable[o.children[0]].parentId="",this.diagram.deleteChild(this.diagram.nameTable[o.children[0]],o),o.parentId&&o.children[0]&&this.diagram.addChild(s,o.children[0]);o.parentId&&this.diagram.deleteChild(o,s)}this.diagram.removeNode(o),this.clearSelection()}this.diagram.diagramActions=this.diagram.diagramActions&~Lh.Group,this.diagram.protectPropertyChange(e)},t.prototype.paste=function(t){if(t||this.clipboardData.clipObject){this.diagram.protectPropertyChange(!0);var e=t?this.getNewObject(t):this.clipboardData.clipObject;if(e){var i=1!==e.length,n=!1,o={},r={};0!==this.clipboardData.pasteIndex&&this.clearSelection(),this.diagram.undoRedoModule&&(n=!0,this.diagram.historyList.startGroupAction());for(var s=0,a=e;s<a.length;s++)o[(h=a[s]).id]=h;for(var l=0;l<e.length;l++){var h=e[l];if(yp(h)===Vd){var c=ie(h),d=c.sourceID;c.sourceID="",o[d]&&r[d]&&(c.sourceID=r[d]),d=c.targetID,c.targetID="",o[d]&&r[d]&&(c.targetID=r[d]);var p=this.cloneConnector(c,i);r[h.id]=p.id}else{var u=this.cloneNode(h,i);if(u){r[h.id]=u.id;var g=h.inEdges;if(g)for(var m=0,f=g;m<f.length;m++)o[b=f[m]]&&r[b]&&((w=this.diagram.nameTable[r[b]]).targetID=r[h.id],this.diagram.connectorPropertyChange(w,{targetID:""},{targetID:w.targetID}));if(g=h.outEdges)for(var v=0,y=g;v<y.length;v++){var b=y[v];if(o[b]&&r[b]){var w=this.diagram.nameTable[r[b]];w.sourceID=r[h.id],this.diagram.connectorPropertyChange(w,{sourceID:""},{sourceID:w.sourceID})}}}}}!0===n&&(this.diagram.historyList.endGroupAction(),n=!1),"SVG"!==this.diagram.mode&&this.diagram.refreshDiagramLayer(),this.clipboardData.pasteIndex++,this.diagram.protectPropertyChange(!1)}}},t.prototype.getNewObject=function(t){var e,i=[];this.clipboardData.pasteIndex=1;for(var n=0;n<t.length;n++)e=ie(t[n]),i.push(e);return i},t.prototype.cloneConnector=function(t,e){var i,n=ie(t);return this.translateObject(n),n.zIndex=-1,i=this.diagram.add(n),this.selectObjects([i],e),i},t.prototype.cloneNode=function(t,e,i){var n,o,r={},s=ie(t);t.shape&&"Bpmn"===t.shape.type&&t.shape.activity&&t.shape.activity.subProcess.processes&&t.shape.activity.subProcess.processes.length&&(o=s.shape.activity.subProcess.processes,s.zIndex=-1,s.shape.activity.subProcess.processes=[]),!t.children||!t.children.length||i&&i.length?(this.translateObject(s),s.zIndex=-1,i&&(s.children=i),n=this.diagram.add(s)):n=this.cloneGroup(t,e);for(var a=0,l=Object.keys(r);a<l.length;a++){var h=l[a];this.diagram.add(r[h])}return o&&o.length&&(n.shape.activity.subProcess.processes=o,this.cloneSubProcesses(n)),n&&this.selectObjects([n],e),n},t.prototype.cloneSubProcesses=function(t){var e=[],i={};if("Bpmn"===t.shape.type&&t.shape.activity&&t.shape.activity.subProcess.processes&&t.shape.activity.subProcess.processes.length)for(var n=t.shape.activity.subProcess.processes,o=0;o<n.length;o++){for(var r=this.diagram.nameTable[n[o]]||this.clipboardData.processTable[n[o]],s=0,a=r.outEdges;s<a.length;s++){c=a[s];e.indexOf(c)<0&&e.push(c)}for(var l=0,h=r.inEdges;l<h.length;l++){var c=h[l];e.indexOf(c)<0&&e.push(c)}var d=ie(this.clipboardData.processTable[n[o]]);d.processId=t.id;var p=this.cloneNode(d,!1);i[n[o]]=p.id,n[o]=p.id,this.diagram.addProcess(p,t.id);for(var u=0,g=e;u<g.length;u++){var m=g[u],f=ie(this.diagram.nameTable[m]||this.diagram.connectorTable[m]);i[f.sourceID]&&i[f.targetID]&&(f.zIndex=-1,f.id+=te(),f.sourceID=i[f.sourceID],f.targetID=i[f.targetID],e.splice(e.indexOf(m),1),this.diagram.add(f))}}},t.prototype.cloneGroup=function(t,e){var i=[],n=[];if(n=n.concat(t.children),this.clipboardData.childTable)for(var o=0;o<n.length;o++){var r=this.clipboardData.childTable[n[o]];if(r){var s=void 0;s=yp(r)===Vd?this.cloneConnector(r,e):this.cloneNode(r,e),i.push(s.id)}}return this.cloneNode(t,e,i)},t.prototype.translateObject=function(t){t.id+=te();var e=10*this.clipboardData.pasteIndex;if(yp(t)===Vd){if(t.sourcePoint={x:t.sourcePoint.x+e,y:t.sourcePoint.y+e},t.targetPoint={x:t.targetPoint.x+e,y:t.targetPoint.y+e},"Bezier"===t.type)for(var i=t.segments,n=0;n<i.length;n++)sh.isEmptyPoint(i[n].point1)||(i[n].point1={x:i[n].point1.x+e,y:i[n].point1.y+e}),sh.isEmptyPoint(i[n].point2)||(i[n].point2={x:i[n].point2.x+e,y:i[n].point2.y+e});if(("Straight"===t.type||"Bezier"===t.type)&&t.segments&&t.segments.length>0)for(var i=t.segments,n=0;n<i.length-1;n++)i[n].point.x+=e,i[n].point.y+=e}else t.offsetX+=e,t.offsetY+=e},t.prototype.drawObject=function(t){var e,i;i=ie(this.diagram.drawingObject);for(var n=0,o=Object.keys(t);n<o.length;n++){var r=o[n];i[r]=t[r]}return yp(this.diagram.drawingObject)===gp?((e=new gp(this.diagram,"nodes",i,!0)).id=(this.diagram.drawingObject.id||"node")+te(),this.diagram.initObject(e)):((e=new Vd(this.diagram,"connectors",i,!0)).id=(this.diagram.drawingObject.id||"connector")+te(),this.diagram.initObject(e)),this.diagram.updateDiagramObject(e),this.diagram.currentDrawingObject=e,e},t.prototype.addObjectToDiagram=function(t){var e;this.diagram.removeFromAQuad(t),this.diagram.removeObjectsFromLayer(this.diagram.nameTable[t.id]),delete this.diagram.nameTable[t.id],e=this.diagram.add(t),"SVG"!==this.diagram.mode&&this.diagram.refreshDiagramLayer(),this.selectObjects([e]),t&&!xr(this.diagram)&&(this.diagram.tool&=~bh.DrawOnce,this.diagram.currentDrawingObject=void 0)},t.prototype.addText=function(t,e){var i=this.diagram.findElementUnderMouse(t,e);this.diagram.startTextEdit(t,i instanceof Fh?i.id.split("_")[1]:void 0)},t.prototype.selectObjects=function(t,e,i){var n={oldValue:i||[],newValue:t,cause:this.diagram.diagramActions,state:"Changing",type:"Addition",cancel:!1};this.diagram.triggerEvent(Ph.selectionChange,n);var o=br(this.diagram),r=yr(this.diagram);if(r||o){if(!o&&(t.length>1||e&&1===t.length)){if(1!==t.length)return;this.clearSelection()}if(!(r||1!==t.length||e&&As(this.diagram)))return void this.clearSelection()}if(!n.cancel){for(var s=0;s<t.length;s++){var a=t[s];if(!0,As(this.diagram)){if((s>0||e)&&a.children&&!a.parentId)for(var l=0;l<this.diagram.selectedItems.nodes.length;l++){var h=this.diagram.nameTable[this.diagram.selectedItems.nodes[l].parentId];h&&(h=this.findParent(h))&&a.id===h.id&&this.selectGroup(a)}this.selectProcesses(a),this.selectBpmnSubProcesses(a)&&this.select(a,s>0||e,!0)}else this.select(a,s>0||e,!0)}n={oldValue:i||[],newValue:t,cause:this.diagram.diagramActions,state:"Changed",type:"Addition",cancel:!1},this.diagram.triggerEvent(Ph.selectionChange,n),this.diagram.renderSelector(e||t&&t.length>1)}},t.prototype.findParent=function(t){return t.parentId&&(t=this.diagram.nameTable[t.parentId],this.findParent(t)),t},t.prototype.selectProcesses=function(t){if(this.hasProcesses(t))for(var e=t.shape.activity.subProcess.processes,i=0;i<e.length;i++){var n=this.diagram.nameTable[e[i]];this.hasProcesses(n)&&this.selectObjects([n],!0),this.unSelect(n)}},t.prototype.selectGroup=function(t){for(var e=0;e<t.children.length;e++){var i=this.diagram.nameTable[t.children[e]];i.children&&this.selectGroup(i),this.unSelect(this.diagram.nameTable[t.children[e]])}},t.prototype.selectBpmnSubProcesses=function(t){var e,i=!0;if(t.processId)i=!Rs(this.diagram,this.diagram.nameTable[t.processId])&&this.selectBpmnSubProcesses(this.diagram.nameTable[t.processId]);else if(t instanceof Vd&&(t.sourceID&&this.diagram.nameTable[t.sourceID]&&this.diagram.nameTable[t.sourceID].processId&&(e=this.diagram.nameTable[t.sourceID].processId),t.targetID&&this.diagram.nameTable[t.targetID]&&this.diagram.nameTable[t.targetID].processId&&(e=this.diagram.nameTable[t.targetID].processId),e)){if(Rs(this.diagram,this.diagram.nameTable[e]))return!1;i=this.selectBpmnSubProcesses(this.diagram.nameTable[e])}return i},t.prototype.hasProcesses=function(t){return!!(t&&"Bpmn"===t.shape.type&&t.shape.activity&&t.shape.activity.subProcess.processes&&t.shape.activity.subProcess.processes.length>0)},t.prototype.select=function(t,e,i){var n=this.getObjectLayer(t.id);if(nr(t)&&!(t instanceof Ud)&&!Rs(this.diagram,t)&&n&&!n.lock&&n.visible&&t.wrapper.visible){(e=!!As(this.diagram)&&e)||this.clearSelection();var o=this.diagram.selectedItems;t instanceof gp?o.nodes.push(t):o.connectors.push(t),e?(o.wrapper.rotateAngle=o.rotateAngle=0,o.wrapper.children.push(t.wrapper)):(o.init(this.diagram),1===o.nodes.length&&0===o.connectors.length&&(o.rotateAngle=o.nodes[0].rotateAngle,o.wrapper.rotateAngle=o.nodes[0].rotateAngle,o.wrapper.pivot=o.nodes[0].pivot)),i||this.diagram.renderSelector(e)}},t.prototype.unSelect=function(t){var e=[];e.push(t);var i={oldValue:e,newValue:[],cause:this.diagram.diagramActions,state:"Changing",type:"Removal",cancel:!1};if(this.diagram.currentSymbol||this.diagram.triggerEvent(Ph.selectionChange,i),Rs(this.diagram,t)){var n=this.diagram.selectedItems,o=void 0;t instanceof gp?(o=n.nodes.indexOf(t,0),n.nodes.splice(o,1)):(o=n.connectors.indexOf(t,0),n.connectors.splice(o,1)),(i={oldValue:e,newValue:[],cause:this.diagram.diagramActions,state:"Changed",type:"Removal",cancel:!1}).cancel||(o=n.wrapper.children.indexOf(t.wrapper,0),n.wrapper.children.splice(o,1),this.diagram.updateSelector(),this.diagram.currentSymbol||this.diagram.triggerEvent(Ph.selectionChange,i))}},t.prototype.getChildElements=function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i];n.children&&n.children.length>0?e.concat(this.getChildElements(n.children)):(e.push(n.id),n instanceof Fh&&e.push(n.id+"_text"))}return e},t.prototype.moveSvgNode=function(t,e){var i=Ae(e+"_groupElement"),n=Ae(t+"_groupElement");i.parentNode.insertBefore(n,i)},t.prototype.sendLayerBackward=function(t){var e=this.getLayer(t);if(e&&0!==e.zIndex){var i=e.zIndex;if("SVG"===this.diagram.mode){var n=e.objects,o=this.getLayer(this.diagram.layerZIndexTable[i-1]).objects[0];if(o)for(var r=0,s=n;r<s.length;r++){var a=s[r];this.moveSvgNode(a,o)}}var l=this.getLayer(this.diagram.layerZIndexTable[i-1]);l.zIndex=l.zIndex+1,e.zIndex=e.zIndex-1;var h=this.diagram.layerZIndexTable[i];this.diagram.layerZIndexTable[i]=this.diagram.layerZIndexTable[i-1],this.diagram.layerZIndexTable[i-1]=h,"Canvas"===this.diagram.mode&&this.diagram.refreshDiagramLayer()}},t.prototype.bringLayerForward=function(t){var e=this.getLayer(t);if(e&&e.zIndex<this.diagram.layers.length-1){var i=e.zIndex;if("SVG"===this.diagram.mode)for(var n=this.getLayer(this.diagram.layerZIndexTable[i+1]).objects[0],o=0,r=e.objects;o<r.length;o++){var s=r[o];n&&this.moveSvgNode(n,s)}var a=this.getLayer(this.diagram.layerZIndexTable[i+1]);a.zIndex=a.zIndex-1,e.zIndex=e.zIndex+1;var l=this.diagram.layerZIndexTable[i];this.diagram.layerZIndexTable[i]=this.diagram.layerZIndexTable[i+1],this.diagram.layerZIndexTable[i+1]=l,"Canvas"===this.diagram.mode&&this.diagram.refreshDiagramLayer()}},t.prototype.sendToBack=function(){if(As(this.diagram)){for(var t=this.diagram.selectedItems.nodes.length?this.diagram.selectedItems.nodes[0].id:this.diagram.selectedItems.connectors[0].id,e=this.diagram.nameTable[t].zIndex,i=this.diagram.layers.indexOf(this.getObjectLayer(t)),n=this.diagram.layers[i].zIndexTable,o=e;o>0;o--)n[o]&&(n[o-1]?(n[o]=n[o-1],this.diagram.nameTable[n[o]].zIndex=o):(n[o-1]=n[o],this.diagram.nameTable[n[o-1]].zIndex=o,delete n[o]));if(n[0]=this.diagram.nameTable[t].id,this.diagram.nameTable[t].zIndex=0,"SVG"===this.diagram.mode){for(var r=n[o=1];!r&&o<e;)r=n[++o];this.moveSvgNode(t,r)}else this.diagram.refreshCanvasLayers()}},t.prototype.bringToFront=function(){if(As(this.diagram)){for(var t=this.diagram.selectedItems.nodes.length?this.diagram.selectedItems.nodes[0].id:this.diagram.selectedItems.connectors[0].id,e=this.diagram.layers.indexOf(this.getObjectLayer(t)),i=this.diagram.layers[e].zIndexTable,n=Number(Object.keys(i).sort(function(t,e){return Number(t)-Number(e)}).reverse()[0]),o=this.diagram.nameTable[t].zIndex;o<n;o++)i[o]&&(i[o+1]?(i[o]=i[o+1],this.diagram.nameTable[i[o]].zIndex=o):(i[o+1]=i[o],this.diagram.nameTable[i[o+1]].zIndex=o,delete i[o]));if(i[n]=this.diagram.nameTable[t].id,this.diagram.nameTable[t].zIndex=n,"SVG"===this.diagram.mode){var r=this.diagram.diagramLayer,s=(this.getChildElements(this.diagram.nameTable[t].wrapper.children),Ae(t+"_groupElement"));s.parentNode.removeChild(s);var a=Xe(this.diagram.element.id);this.diagram.diagramRenderer.renderElement(this.diagram.nameTable[t].wrapper,r,a)}else this.diagram.refreshCanvasLayers()}},t.prototype.sortByZIndex=function(t,e){var i=e||"zIndex";return t=t.sort(function(t,e){return t[i]-e[i]})},t.prototype.sendForward=function(){if(As(this.diagram)){var t=this.diagram.selectedItems.nodes.length?this.diagram.selectedItems.nodes[0].id:this.diagram.selectedItems.connectors[0].id,e=this.diagram.layers.indexOf(this.getObjectLayer(t)),i=this.diagram.layers[e].zIndexTable,n=(Object.keys(i).length,this.diagram.nameTable[t]),o=[],r=this.diagram.spatialSearch.findObjects(n.wrapper.bounds);r.length>2&&(r=this.sortByZIndex(r));for(var s=0,a=r;s<a.length;s++){var l=a[s];if(n.id!==l.id&&e===this.getObjectLayer(l.id).zIndex&&Number(this.diagram.nameTable[t].zIndex)<Number(l.zIndex)&&n.wrapper.bounds.intersects(l.wrapper.bounds)){o.push(l);break}}if(o.length>0){var h=o[0].zIndex,c=n.zIndex;i[h];this.diagram.layers[0].zIndexTable[h]=n.id,this.diagram.nameTable[i[h]].zIndex=h,this.diagram.layers[0].zIndexTable[c]=o[0].id,this.diagram.nameTable[i[c]].zIndex=c,"SVG"===this.diagram.mode?this.moveSvgNode(i[Number(o[0].zIndex)],t):this.diagram.refreshCanvasLayers()}}},t.prototype.sendBackward=function(){if(As(this.diagram)){var t=this.diagram.selectedItems.nodes.length?this.diagram.selectedItems.nodes[0].id:this.diagram.selectedItems.connectors[0].id,e=this.diagram.layers.indexOf(this.getObjectLayer(t)),i=this.diagram.layers[e].zIndexTable,n=(Object.keys(i).length,this.diagram.nameTable[t]),o=[],r=this.diagram.spatialSearch.findObjects(n.wrapper.bounds);r.length>2&&(r=this.sortByZIndex(r));for(var s=0,a=r;s<a.length;s++){var l=a[s];n.id!==l.id&&e===this.getObjectLayer(l.id).zIndex&&Number(this.diagram.nameTable[t].zIndex)>Number(l.zIndex)&&n.wrapper.bounds.intersects(l.wrapper.bounds)&&o.push(l)}if(o.length>0){var h=o[o.length-1].zIndex,c=n.zIndex;i[h];i[h]=n.id,this.diagram.nameTable[i[h]].zIndex=h,i[c]=o[o.length-1].id,this.diagram.nameTable[i[c]].zIndex=c,"SVG"===this.diagram.mode?this.moveSvgNode(t,i[o[o.length-1].zIndex]):this.diagram.refreshCanvasLayers()}}},t.prototype.initSelectorWrapper=function(){var t=this.diagram.selectedItems;t.init(this.diagram),1===t.nodes.length&&0===t.connectors.length&&(t.rotateAngle=t.nodes[0].rotateAngle,t.wrapper.rotateAngle=t.nodes[0].rotateAngle,t.wrapper.pivot=t.nodes[0].pivot)},t.prototype.doRubberBandSelection=function(t){this.clearSelectionRectangle(),this.clearSelection();var e=[],i=[];e=this.diagram.getNodesConnectors(e),(i="CompleteIntersect"===this.diagram.selectedItems.rubberBandSelectionMode?qr(t,e):this.diagram.spatialSearch.findObjects(t)).length&&this.selectObjects(i,!0)},t.prototype.clearSelectionRectangle=function(){var t=Me(this.diagram.element.id).getElementById(this.diagram.element.id+"_diagramAdorner_selected_region");t&&M(t)},t.prototype.dragConnectorEnds=function(t,e,i,n,o,r){var s,a,l,h=!1;return e instanceof Ud?s=e.connectors[0]:e instanceof Vd&&this.diagram.currentDrawingObject&&(this.clearSelection(),s=this.diagram.currentDrawingObject),"BezierSourceThumb"!==t&&"BezierTargetThumb"!==t||(h=!0),"ConnectorSourceEnd"===t||"BezierSourceThumb"===t?(a=i.x-(h?n.bezierPoint1.x:s.sourcePoint.x),l=i.y-(h?n.bezierPoint1.y:s.sourcePoint.y),this.dragSourceEnd(s,a,l,null,i,t,void 0,o,r,void 0,n)):(a=i.x-(h?n.bezierPoint2.x:s.targetPoint.x),l=i.y-(h?n.bezierPoint2.y:s.targetPoint.y),this.dragTargetEnd(s,a,l,null,i,t,void 0,n))},t.prototype.getSelectedObject=function(){var t=this.diagram.selectedItems;return t.nodes.concat(t.connectors)},t.prototype.clearSelection=function(t){if(As(this.diagram)){var e=this.diagram.selectedItems,i=this.getSelectedObject(),n={oldValue:i,newValue:[],cause:this.diagram.diagramActions,state:"Changing",type:"Removal",cancel:!1};t&&this.diagram.triggerEvent(Ph.selectionChange,n),n.cancel||(e.offsetX=0,e.offsetY=0,e.width=0,e.height=0,e.rotateAngle=0,e.nodes=[],e.connectors=[],e.wrapper=null,this.diagram.clearSelectorLayer(),t&&(n={oldValue:i,newValue:[],cause:this.diagram.diagramActions,state:"Changed",type:"Removal",cancel:!1},this.diagram.triggerEvent(Ph.selectionChange,n)))}},t.prototype.drag=function(t,e,i){var n,o=[];if(or(t)&&this.checkBoundaryConstraints(e,i,t.wrapper.bounds)&&Ir(this.diagram))if(t instanceof gp){var r={offsetX:t.offsetX,offsetY:t.offsetY};if(t.offsetX+=e,t.offsetY+=i,t.children)for(var s=this.getAllDescendants(t,o),a=0;a<s.length;a++)n=this.diagram.nameTable[s[a].id],this.drag(n,e,i);this.diagram.nodePropertyChange(t,r,{offsetX:t.offsetX,offsetY:t.offsetY})}else{var l=t,h="Bezier"===l.type,c=!1;if(l.sourceWrapper?c=!0:this.dragSourceEnd(l,e,i,!0,null,"",h),l.targetWrapper?c=!0:this.dragTargetEnd(l,e,i,!0,null,"",h),!c){this.dragControlPoint(l,e,i,!0);var d={sourcePoint:l.sourcePoint,targetPoint:l.targetPoint};this.diagram.connectorPropertyChange(l,{},d)}}},t.prototype.updateEndPoint=function(t){var e={sourcePoint:t.sourcePoint,targetPoint:t.targetPoint,sourceID:t.sourceID?t.sourceID:void 0,targetID:t.targetID?t.targetID:void 0,sourcePortID:t.sourcePortID?t.sourcePortID:void 0,targetPortID:t.targetPortID?t.targetPortID:void 0,segments:t.segments?t.segments:void 0};this.diagram.connectorPropertyChange(t,{},e),this.diagram.updateSelector()},t.prototype.dragSourceEnd=function(t,e,i,n,o,r,s,a,l,h,c){var d=this.diagram.nameTable[t.id],p=this.checkBoundaryConstraints(e,i,d.wrapper.bounds);if(lr(d)&&p&&"BezierSourceThumb"!==r&&Ir(this.diagram)&&(d.sourcePoint.x+=e,d.sourcePoint.y+=i,"ConnectorSourceEnd"===r&&"Orthogonal"===d.type&&this.changeSegmentLength(d,a,l,h)),"Bezier"===d.type)if(c)this.translateBezierPoints(t,""===r?"ConnectorSourceEnd":r,e,i,c,o,!s);else for(var u=0;u<t.segments.length;u++)this.translateBezierPoints(t,""===r?"ConnectorSourceEnd":r,e,i,t.segments[u],o,!s);return n||this.updateEndPoint(d),p},t.prototype.changeSegmentLength=function(t,e,i,n){if(t.segments&&null!==t.segments[0].direction&&(!e&&""===t.sourceID||n)){var o=t.segments[0],r=t.segments[1],s=this.diagram.nameTable[t.sourceID],a=void 0;if(o.points[0]=t.sourcePoint,"Top"===o.direction||"Bottom"===o.direction?(o.points[o.points.length-1].x=t.sourcePoint.x,r.points[0].y=o.points[o.points.length-1].y):(o.points[o.points.length-1].y=t.sourcePoint.y,r.points[0].x=o.points[o.points.length-1].x),o.direction&&(o.length||0===o.length)&&(o.length=sh.distancePoints(o.points[0],o.points[o.points.length-1])),r.direction&&(r.length||0===r.length)&&(r.length=sh.distancePoints(o.points[o.points.length-1],r.points[r.points.length-1]),r.direction=sh.direction(o.points[o.points.length-1],r.points[r.points.length-1])),""!==t.sourcePortID&&o.length<10)if(t.segments.length>2){var l=t.segments[2],h=sh.direction(l.points[0],l.points[1]);o.direction===Qo(h)?("Right"===o.direction?l.points[0].x=o.points[o.points.length-1].x=s.wrapper.corners.middleRight.x+20:"Left"===o.direction?l.points[0].x=o.points[o.points.length-1].x=s.wrapper.corners.middleLeft.x-20:"Top"===o.direction?l.points[0].y=o.points[o.points.length-1].y=s.wrapper.corners.topCenter.y-20:l.points[0].y=o.points[o.points.length-1].y=s.wrapper.corners.bottomCenter.y+20,l.direction&&l.length&&(l.length=sh.distancePoints(l.points[0],l.points[l.points.length-1])),o.length=sh.distancePoints(o.points[0],o.points[o.points.length-1])):o.direction===h&&l.direction&&l.length?("Top"===o.direction||"Bottom"===o.direction?(l.points[0]=o.points[0],l.points[l.points.length-1].x=l.points[0].x):(l.points[0]=o.points[0],l.points[l.points.length-1].y=l.points[0].y),l.length=sh.distancePoints(l.points[0],l.points[l.points.length-1]),t.segments.splice(0,2)):o.length=20}else o.length=20;else o.length<1&&(""!==t.sourceID?("Right"===r.direction?(a=s.wrapper.corners.middleRight,r.points[r.points.length-1].y=a.y):"Left"===r.direction?(a=s.wrapper.corners.middleLeft,r.points[r.points.length-1].y=a.y):"Top"===r.direction?(a=s.wrapper.corners.topCenter,r.points[r.points.length-1].x=a.x):(a=s.wrapper.corners.bottomCenter,r.points[r.points.length-1].x=a.x),r.length=sh.distancePoints(a,r.points[r.points.length-1]),t.segments.length>2&&(l=t.segments[2]).direction&&l.length&&(l.length=sh.distancePoints(r.points[r.points.length-1],l.points[l.points.length-1])),t.segments.splice(0,1)):t.segments.splice(0,1))}else e&&i&&t.sourcePortID!==i&&t.segments&&null!==t.segments[0].direction&&e&&e instanceof gp?this.changeSourceEndToPort(t,e,i):e&&(t.sourceID!==e.id||""===t.sourcePortID)&&t.segments&&null!==t.segments[0].direction&&e&&e instanceof gp&&this.changeSourceEndToNode(t,e)},t.prototype.changeSourceEndToPort=function(t,e,i){var n=this.diagram.getWrapper(e.wrapper,i),o={x:n.offsetX,y:n.offsetY},r=Zo(o,e.wrapper.corners,e.wrapper.bounds,!1),s=t.segments[0],a=t.segments[1];if(s.direction!==r){var l=[],h={};if(s.direction===Qo(r)){h={};var c=void 0;"Top"===r||"Bottom"===r?(c="Top"===r?{type:"Orthogonal",isTerminal:!0,direction:r,length:Math.abs(s.points[0].y-o.y)}:{type:"Orthogonal",isTerminal:!0,direction:r,length:Math.abs(o.y-s.points[0].y)},h=s.points[0].x>o.x?{type:"Orthogonal",isTerminal:!0,direction:"Right",length:s.points[0].x-o.x}:{type:"Orthogonal",isTerminal:!0,direction:"Left",length:o.x-s.points[0].x}):(c="Right"===r?{type:"Orthogonal",isTerminal:!0,direction:r,length:Math.abs(s.points[0].x-o.x)}:{type:"Orthogonal",isTerminal:!0,direction:r,length:Math.abs(o.x-s.points[0].x)},h=s.points[0].y>o.y?{type:"Orthogonal",direction:"Top",isTerminal:!0,length:s.points[0].y-o.y}:{type:"Orthogonal",direction:"Bottom",isTerminal:!0,length:o.y-s.points[0].y}),l.push(new jd(t,"segments",c,!0)),l.push(new jd(t,"segments",h,!0))}else h={type:"Orthogonal",direction:r,length:20,isTerminal:!0},l.push(new jd(t,"segments",h,!0));s.direction!==Qo(r)&&("Top"===r||"Bottom"===r?(s.points[0].x=o.x,s.points[0].y=s.points[s.points.length-1].y="Top"===r?o.y-20:o.y+20):(s.points[0].y=o.y,s.points[0].x=s.points[s.points.length-1].x="Right"===r?o.x+20:o.x-20),s.length=sh.distancePoints(s.points[0],s.points[s.points.length-1]),a.length=sh.distancePoints(s.points[s.points.length-1],a.points[a.points.length-1])),t.segments=l.concat(t.segments)}else s.points[0]=o,"Top"===r||"Bottom"===r?s.points[s.points.length-1].x=o.x:s.points[s.points.length-1].y=o.y,s.length=sh.distancePoints(s.points[0],s.points[s.points.length-1]),a.length=sh.distancePoints(s.points[s.points.length-1],a.points[a.points.length-1])},t.prototype.removeTerminalSegment=function(t,e){for(var i=0;i<t.segments.length-2;i++){var n=t.segments[0];n.isTerminal&&(e?n.isTerminal=!1:(t.segments.splice(i,1),i--))}},t.prototype.changeSourceEndToNode=function(t,e){this.removeTerminalSegment(t);var i,n,o=e.wrapper.children[0].corners,r=t.segments[0],s=t.segments[1],a=[];if("Right"===r.direction||"Left"===r.direction)if(i="Left"===r.direction?o.middleLeft:o.middleRight,r.length>o.width||"Left"===r.direction&&i.x>=r.points[0].x||"Right"===r.direction&&i.x<=r.points[0].x)r.points[0].y=r.points[r.points.length-1].y=i.y,r.points[0].x=i.x,r.length=sh.distancePoints(r.points[0],r.points[r.points.length-1]),s.length=sh.distancePoints(r.points[r.points.length-1],s.points[s.points.length-1]);else{l=void 0;n="Bottom"===(l=s.direction?s.direction:sh.direction(s.points[0],s.points[s.points.length-1]))?o.bottomCenter:o.topCenter,s.length&&s.direction&&(s.length="Top"===l?r.points[r.points.length-1].y-(n.y+20):n.y+20-r.points[r.points.length-1].y),r.length=r.points[r.points.length-1].x-n.x,r.direction=r.length>0?"Right":"Left";h={type:"Orthogonal",direction:l,length:20};a.push(new jd(t,"segments",h,!0)),t.segments=a.concat(t.segments)}else if(i="Bottom"===r.direction?o.bottomCenter:o.topCenter,r.length>o.height||"Top"===r.direction&&i.y>=r.points[0].y||"Bottom"===r.direction&&i.y<=r.points[0].y)r.points[0].x=r.points[r.points.length-1].x=i.x,r.points[0].y=i.y,r.length=sh.distancePoints(r.points[0],r.points[r.points.length-1]),s.length=sh.distancePoints(r.points[r.points.length-1],s.points[s.points.length-1]);else{n="Left"===s.direction?o.middleLeft:o.middleRight;var l=void 0;l=s.direction?s.direction:sh.direction(s.points[0],s.points[s.points.length-1]),s.length&&s.direction&&(s.length="Left"===l?r.points[r.points.length-1].x-(n.x+20):n.x+20-r.points[r.points.length-1].x),r.length=r.points[r.points.length-1].y-n.y,r.direction=r.length>0?"Bottom":"Top";var h={type:"Orthogonal",direction:l,length:20};a.push(new jd(t,"segments",h,!0)),t.segments=a.concat(t.segments)}},t.prototype.translateBezierPoints=function(t,e,i,n,o,r,s){var a=t.segments.indexOf(o),l=t.segments[a];l&&("BezierSourceThumb"===e&&(l.vector1.angle||l.vector1.distance)?l.vector1={distance:t.distance(t.sourcePoint,r),angle:sh.findAngle(t.sourcePoint,r)}:"BezierTargetThumb"===e&&(l.vector2.angle||l.vector2.distance)?l.vector2={distance:t.distance(t.targetPoint,r),angle:sh.findAngle(t.targetPoint,r)}:("ConnectorSourceEnd"===e&&!t.sourceID||"ConnectorTargetEnd"===e&&!t.targetID)&&s&&$o(l.vector1)&&$o(l.vector2)?(sh.isEmptyPoint(l.point1)&&(l.bezierPoint1=tr(t.sourcePoint,t.targetPoint)),sh.isEmptyPoint(l.point2)&&(l.bezierPoint2=tr(t.targetPoint,t.sourcePoint))):"BezierSourceThumb"===e||"ConnectorSourceEnd"===e&&!s&&$o(l.vector1)?(l.bezierPoint1.x+=i,l.bezierPoint1.y+=n,sh.isEmptyPoint(l.point1)&&!s||(l.point1={x:l.bezierPoint1.x,y:l.bezierPoint1.y})):("BezierTargetThumb"===e||"ConnectorTargetEnd"===e&&!s&&$o(l.vector2))&&(l.bezierPoint2.x+=i,l.bezierPoint2.y+=n,sh.isEmptyPoint(l.point2)&&!s||(l.point2={x:l.bezierPoint2.x,y:l.bezierPoint2.y})))},t.prototype.dragTargetEnd=function(t,e,i,n,o,r,s,a){var l=this.diagram.nameTable[t.id],h=this.checkBoundaryConstraints(e,i,l.wrapper.bounds);if(hr(l)&&"BezierTargetThumb"!==r&&h&&Ir(this.diagram)&&(l.targetPoint.x+=e,l.targetPoint.y+=i,"ConnectorTargetEnd"===r&&"Orthogonal"===l.type&&l.segments&&l.segments.length>0)){var c=l.segments[l.segments.length-2];c&&2===l.segments[l.segments.length-1].points.length&&("Left"===c.direction||"Right"===c.direction?c.points[c.points.length-1].x=l.targetPoint.x:c.points[c.points.length-1].y=l.targetPoint.y,c.length=sh.distancePoints(c.points[0],c.points[c.points.length-1]),c.direction=sh.direction(c.points[0],c.points[c.points.length-1]))}if("Bezier"===l.type)if(a)this.translateBezierPoints(t,""===r?"ConnectorTargetEnd":r,e,i,a,o,!s);else for(var d=0;d<t.segments.length;d++)this.translateBezierPoints(t,""===r?"ConnectorTargetEnd":r,e,i,t.segments[d],o,!s);return n||this.updateEndPoint(l),h},t.prototype.dragControlPoint=function(t,e,i,n,o){var r=this.diagram.nameTable[t.id];if(("Straight"===r.type||"Bezier"===r.type)&&r.segments.length>0){if(void 0!==o&&r.segments[o])r.segments[o].point.x+=e,r.segments[o].point.y+=i;else for(var s=0;s<r.segments.length-1;s++)r.segments[s].point.x+=e,r.segments[s].point.y+=i;n||this.updateEndPoint(r)}return!0},t.prototype.rotateObjects=function(t,e,i,n,o){n=n||{};var r=_t();qt(r,i,n.x,n.y);for(var s=0,a=e;s<a.length;s++){var l=a[s];if(l instanceof gp){if(dr(l)&&Ir(this.diagram)){if(!1!==o||t!==l){l.rotateAngle+=i,l.rotateAngle=(l.rotateAngle+360)%360;var h=Wt(r,{x:l.offsetX,y:l.offsetY});l.offsetX=h.x,l.offsetY=h.y,this.diagram.nodePropertyChange(l,{},{offsetX:l.offsetX,offsetY:l.offsetY,rotateAngle:l.rotateAngle})}if(l.processId){var c=this.diagram.nameTable[l.processId],d=this.diagram.bpmnModule.getChildrenBound(c,l.id,this.diagram);this.diagram.bpmnModule.updateSubProcessess(d,l,this.diagram)}l.children&&l.children.length&&this.getChildren(l,e)}}else this.rotatePoints(l,i,n||{x:l.wrapper.offsetX,y:l.wrapper.offsetY});this.diagram.updateDiagramObject(l)}this.diagram.updateSelector()},t.prototype.snapConnectorEnd=function(t){return this.diagram.snapSettings.constraints&ph.SnapToLines&&this.snappingModule&&this.diagram.snappingModule.snapConnectorEnd(t),t},t.prototype.snapAngle=function(t){return this.diagram.snapSettings.constraints&ph.SnapToLines&&this.snappingModule?this.snappingModule.snapAngle(this.diagram,t):0},t.prototype.rotatePoints=function(t,e,i){if(!t.sourceWrapper||!t.targetWrapper){var n=_t();qt(n,e,i.x,i.y),t.sourcePoint=Wt(n,t.sourcePoint),t.targetPoint=Wt(n,t.targetPoint);var o={sourcePoint:t.sourcePoint,targetPoint:t.targetPoint};this.diagram.connectorPropertyChange(t,{},o)}},t.prototype.scale=function(t,e,i,n,o){var r=this.diagram.nameTable[t.id],s=r,a=[],l=r.wrapper;if(void 0!==l.actualSize.width&&void 0!==l.actualSize.height&&Ir(this.diagram)){if(s.children){for(var h=0,c=this.getAllDescendants(s,a);h<c.length;h++){var d=c[h];this.scaleObject(e,i,n,d,l,o)}t.wrapper.measure(new nh),t.wrapper.arrange(t.wrapper.desiredSize),this.diagram.updateGroupOffset(r)}else this.scaleObject(e,i,n,r,l,o);var p=ee(t.wrapper);if(!this.checkBoundaryConstraints(void 0,void 0,p))return this.scale(t,1/e,1/i,n),!1;this.diagram.updateDiagramObject(t)}return!0},t.prototype.getAllDescendants=function(t,e,i){for(var n=t,o=0;o<n.children.length;o++)(t=this.diagram.nameTable[n.children[o]]).children?(i&&e.push(t),e=this.getAllDescendants(t,e)):e.push(t);return e},t.prototype.getChildren=function(t,e){var i=t;if(t.children)for(var n=0;n<i.children.length;n++)t=this.diagram.nameTable[i.children[n]],e.push(t);return e},t.prototype.cloneChild=function(t){return this.diagram.nameTable[t]},t.prototype.scaleObject=function(t,e,i,n,o,r){t=t<0?1:t,e=e<0?1:e;n.wrapper.offsetX,n.wrapper.offsetY,n.wrapper.actualSize.width,n.wrapper.actualSize.height;if(1!==t||1!==e){var s=void 0,a=void 0;if(n instanceof gp){var l=void 0,h=void 0;"Bpmn"===(f=n).shape.type&&f.shape.activity.subProcess.processes&&f.shape.activity.subProcess.processes.length>0&&(h=this.diagram.bpmnModule.getChildrenBound(f,f.id,this.diagram),l=f.wrapper.bounds.containsRect(h)),s=f.wrapper.actualSize.width*t,a=f.wrapper.actualSize.height*e,void 0!==f.maxWidth&&0!==f.maxWidth&&(s=Math.min(f.maxWidth,s)),void 0!==f.minWidth&&0!==f.minWidth&&(s=Math.max(f.minWidth,s)),void 0!==f.maxHeight&&0!==f.maxHeight&&(a=Math.min(f.maxHeight,a)),void 0!==f.minHeight&&0!==f.minHeight&&(a=Math.max(f.minHeight,a)),l&&(s=Math.max(s,h.right-f.wrapper.bounds.x),a=Math.max(a,h.bottom-f.wrapper.bounds.y)),t=s/f.actualSize.width,e=a/f.actualSize.height}var c=_t(),d=void 0;r||(r=n);var p=(d=r.wrapper).offsetX-d.actualSize.width*d.pivot.x,u=d.offsetY-d.actualSize.height*d.pivot.y,g={x:p+d.actualSize.width*i.x,y:u+d.actualSize.height*i.y};if(g=ge(d.rotateAngle,d.offsetX,d.offsetY,g),qt(c,-d.rotateAngle,g.x,g.y),Xt(c,t,e,g.x,g.y),qt(c,d.rotateAngle,g.x,g.y),n instanceof gp){var m,f=n,v=void 0,y=Wt(c,{x:f.wrapper.offsetX,y:f.wrapper.offsetY}),b=f.wrapper.offsetX-f.wrapper.actualSize.width*f.pivot.x,w=f.wrapper.offsetY-f.wrapper.actualSize.height*f.pivot.y;if(s>0)if(f.processId){var x=this.diagram.nameTable[f.processId];(!x.maxWidth||f.margin.left+s<x.maxWidth)&&(f.width=s,f.offsetX=y.x)}else f.width=s,f.offsetX=y.x;if(a>0)if(f.processId){var S=this.diagram.nameTable[f.processId];(!S.maxHeight||f.margin.top+a<S.maxHeight)&&(f.height=a,f.offsetY=y.y)}else f.height=a,f.offsetY=y.y;v=f.wrapper.offsetX-f.wrapper.actualSize.width*f.pivot.x,m=f.wrapper.offsetY-f.wrapper.actualSize.height*f.pivot.y,this.diagram.nameTable[f.processId]&&(f.margin.top+(m-w)<=0||f.margin.left+(v-b)<=0)?this.diagram.nodePropertyChange(n,{},{margin:{top:f.margin.top,left:f.margin.left}}):this.diagram.nodePropertyChange(n,{},{width:f.width,height:f.height,offsetX:f.offsetX,offsetY:f.offsetY,margin:{top:f.margin.top+(m-w),left:f.margin.left+(v-b)}})}else{var C=n;if(!C.sourceWrapper||!C.targetWrapper){C.sourcePoint=Wt(c,C.sourcePoint),C.targetPoint=Wt(c,C.targetPoint);var L={sourcePoint:C.sourcePoint,targetPoint:C.targetPoint};this.diagram.connectorPropertyChange(C,{},L)}}var E=this.diagram.nameTable[n.processId];if(E){E.wrapper.bounds,n.wrapper.bounds;h=this.diagram.bpmnModule.getChildrenBound(E,n.id,this.diagram);this.diagram.bpmnModule.updateSubProcessess(h,n,this.diagram)}}},t.prototype.portDrag=function(t,e,i,n){var o,r,s=this.findTarget(e,t),a=ee(t.wrapper),l=Ss(t,s.id),h={};h[l]={offset:{x:s.offset.x,y:s.offset.y}},s&&Rr(s,this.diagram)&&(o={ports:h},s.offset.x+=i/a.width,s.offset.y+=n/a.height,(h={})[l]={offset:{x:s.offset.x,y:s.offset.y}},r={ports:h},this.diagram.nodePropertyChange(t,o,r),this.diagram.updateDiagramObject(t))},t.prototype.getSubProcess=function(t){var e,i={nodes:[],connectors:[]};return t instanceof gp?e=t.processId:t&&t.nodes&&t.nodes.length&&t.nodes[0].processId&&(e=t.nodes[0].processId),e?(i.nodes.push(ie(this.diagram.nameTable[e])),i):i},t.prototype.checkBoundaryConstraints=function(t,e,i){var n=this.diagram.pageSettings,o=this.diagram.pageSettings.boundaryConstraints,r=this.diagram.scroller;if("Page"===o||"Diagram"===o){var s=i?void 0:this.diagram.selectedItems.wrapper.bounds,a="Page"===o?n.width:r.viewPortWidth,l="Page"===o?n.height:r.viewPortHeight,h=i,c=(i?h.right:s.right)+(t||0),d=(i?h.left:s.left)+(t||0),p=(i?h.top:s.top)+(e||0),u=(i?h.bottom:s.bottom)+(e||0);return c<=a&&d>=0&&u<=l&&p>=0}return!0},t.prototype.dragSelectedObjects=function(t,e){var i=this.diagram.selectedItems;return this.state&&!this.state.backup&&(this.state.backup={},this.state.backup.offsetX=i.offsetX,this.state.backup.offsetY=i.offsetY),!!this.checkBoundaryConstraints(t,e)&&(this.diagram.drag(i,t,e),!0)},t.prototype.scaleSelectedItems=function(t,e,i){var n=this.diagram.selectedItems;return this.state&&!this.state.backup&&(this.state.backup={},this.state.backup.offsetX=n.offsetX,this.state.backup.offsetY=n.offsetY,this.state.backup.width=n.width,this.state.backup.height=n.height,this.state.backup.pivot=i),this.diagram.scale(n,t,e,i)},t.prototype.rotateSelectedItems=function(t){var e=this.diagram.selectedItems;return this.state&&!this.state.backup&&(this.state.backup={},this.state.backup.angle=e.rotateAngle),this.diagram.rotate(e,t)},t.prototype.hasSelection=function(){return As(this.diagram)},t.prototype.isSelected=function(t){return Rs(this.diagram,t)},t.prototype.initExpand=function(t){var e=t.target||t.source;this.expandNode(e,!1,this.diagram)},t.prototype.expandNode=function(t,e,i){var n,o=e?t.isExpanded:!t.isExpanded;return this.expandCollapse(t,o,this.diagram),t.isExpanded=o,this.diagram.layout.fixedNode=t.id,e||this.diagram.updateIcon(t),this.diagram.layoutAnimateModule&&this.diagram.layout.enableAnimation&&(this.diagram.organizationalChartModule.isAnimation=!0),n=this.diagram.doLayout(),this.diagram.layoutAnimateModule&&this.diagram.layout.enableAnimation&&this.layoutAnimateModule.expand(this.diagram.organizationalChartModule.isAnimation,n,t,this.diagram),n},t.prototype.expandCollapse=function(t,e,i){for(var n=0;n<t.outEdges.length;n++){var o=i.nameTable[t.outEdges[n]],r=i.nameTable[o.targetID];o.visible=e,r.isExpanded&&this.expandCollapse(r,e,i);var s={visible:r.visible};r.visible=e;var a={visible:r.visible};i.nodePropertyChange(r,s,a),i.connectorPropertyChange(o,s,a)}},t.prototype.updateNodeDimension=function(t,e){t instanceof gp&&(t.offsetX=e.x+e.width/2,t.offsetY=e.y+e.height/2,t.width=e.width,t.height=e.height,this.diagram.nodePropertyChange(t,{},{width:e.width,height:e.height,offsetX:t.offsetX,offsetY:t.offsetY}),"SVG"!==this.diagram.mode&&this.diagram.refreshDiagramLayer())},t.prototype.drawSelectionRectangle=function(t,e,i,n){this.diagram.drawSelectionRectangle(t,e,i,n)},t.prototype.startGroupAction=function(){this.diagram.startGroupAction()},t.prototype.endGroupAction=function(){this.diagram.endGroupAction()},t.prototype.removeChildFromBPmn=function(t,e,i){var n=this.diagram.nameTable[t.id]||t.nodes[0];if(i&&n&&n.processId&&n.processId===i.wrapper.id){var o=ie(n);o.processId=n.processId,this.diagram.startGroupAction();for(var r=[],s=(r=r.concat(n.outEdges,n.inEdges)).length-1;s>=0;s--){var a=this.diagram.nameTable[r[s]];a&&this.diagram.remove(a)}var l=void 0;(l=this.diagram.nameTable[n.processId].shape.activity.subProcess.processes||[]).splice(l.indexOf(n.id),1),this.diagram.bpmnModule.removeChildFromBPMN(this.diagram.nameTable[n.processId].wrapper,n.id),this.diagram.nameTable[n.id].processId="",n.offsetX=n.wrapper.offsetX,n.offsetY=n.wrapper.offsetY;var h={type:"PositionChanged",redoObject:{nodes:[ie(n)]},undoObject:{nodes:[o]},category:"Internal"};this.addHistoryEntry(h),this.diagram.endGroupAction()}},t.prototype.isDroppable=function(t,e){var i=this.diagram.nameTable[t.id]||t.nodes[0];return!i||"Bpmn"!==i.shape.type||i.processId!==e.id&&i.id!==e.processId&&!e.shape.activity.subProcess.collapsed},t.prototype.renderHighlighter=function(t,e,i){new ah;if(t.target instanceof gp||e&&t.source instanceof gp){var n=e?t.source:t.target,o=e?t.sourceWrapper:t.targetWrapper,r=this.findTarget(o,n,i),s=void 0;if(r instanceof lp)for(var a=r.id,l=t.target,h=0,c=l.wrapper.children[0].children[0].children[2].children;h<c.length;h++){var d=c[h];if(d.id===l.id+"_"+a){s=d.children[0];break}}else s=r instanceof gp?r.wrapper:e?t.sourceWrapper:t.targetWrapper;this.diagram.renderHighlighter(s)}},t.prototype.mouseOver=function(t,e,i){return!0},t.prototype.snapPoint=function(t,e,i,n){var o,r=this.diagram.selectedItems,s=e.x<t.x,a=e.y<t.y,l=o={x:i,y:n};return this.snappingModule&&(l=this.diagram.snappingModule.snapPoint(this.diagram,r,s,a,o,t,e)),l},t.prototype.removeSnap=function(){this.diagram.snapSettings.constraints&ph.SnapToObject&&this.snappingModule&&this.snappingModule.removeGuidelines(this.diagram)},t.prototype.drop=function(t,e,i){this.diagram.bpmnModule&&(this.diagram.bpmnModule.dropBPMNchild(e,t instanceof gp?t:t.nodes[0],this.diagram),this.diagram.refreshDiagramLayer())},t.prototype.addHistoryEntry=function(t){this.diagram.addHistoryEntry(t)},t.prototype.align=function(t,e){if(t.length>0){var i=0,n=0,o=ee(t[0].wrapper),r={nodes:[],connectors:[]},s={nodes:[],connectors:[]};for(i=1;i<t.length;i++){var a=0,l=0;"Left"===e?a=t[i]instanceof gp?o.topLeft.x+t[i].width/2-t[i].offsetX:o.topLeft.x-t[i].sourcePoint.x:"Right"===e?a=t[i]instanceof gp?o.topRight.x-t[i].width/2-t[i].offsetX:o.topRight.x-t[i].wrapper.bounds.width-t[i].sourcePoint.x:"Top"===e?l=t[i]instanceof gp?o.top+t[i].height/2-t[i].offsetY:o.top-t[i].sourcePoint.y:"Bottom"===e?l=t[i]instanceof gp?o.bottom-t[i].height/2-t[i].offsetY:o.bottom-t[i].sourcePoint.y:"Center"===e?t[i]instanceof gp?a=o.center.x-t[i].offsetX:(n=Math.abs(o.width-t[i].wrapper.bounds.width),a=o.bottomLeft.x-n/2-t[i].sourcePoint.x):"Middle"===e&&(l=t[i]instanceof gp?o.center.y-t[i].offsetY:o.center.y-t[i].sourcePoint.y),r=this.storeObject(r,t[i]),this.drag(t[i],a,l),this.diagram.updateSelector(),s=this.storeObject(s,t[i])}r=ie(r),s=ie(s);var h={type:"Align",category:"Internal",undoObject:ie(r),redoObject:ie(s)};this.addHistoryEntry(h)}},t.prototype.distribute=function(t,e){if(t.length>0){var i=0,n=(new ah,0),o=0,r=0,s=0,a=0,l=0,h=0,c={nodes:[],connectors:[]},d={nodes:[],connectors:[]};for(t=es(t),i=1;i<t.length;i++)n=n+t[i].wrapper.bounds.topRight.x-t[i-1].wrapper.bounds.topRight.x,o=o+t[i].wrapper.bounds.topLeft.x-t[i-1].wrapper.bounds.topLeft.x,r=r+t[i].wrapper.bounds.topRight.y-t[i-1].wrapper.bounds.topRight.y,s=s+t[i].wrapper.bounds.bottomRight.y-t[i-1].wrapper.bounds.bottomRight.y,a=a+t[i].wrapper.bounds.center.x-t[i-1].wrapper.bounds.center.x,l=l+t[i].wrapper.bounds.center.y-t[i-1].wrapper.bounds.center.y,h=h+t[i].wrapper.bounds.topRight.y-t[i-1].wrapper.bounds.bottomRight.y;for(i=1;i<t.length-1;i++){var p=0,u=0,g=ee(t[i-1].wrapper),m=ee(t[i].wrapper);"RightToLeft"===e||"Center"===e?p=g.center.x-m.center.x+a/(t.length-1):"Right"===e?p=g.topRight.x-m.topRight.x+n/(t.length-1):"Left"===e?p=g.topLeft.x-m.topLeft.x+o/(t.length-1):"Middle"===e?u=g.center.y-m.center.y+l/(t.length-1):"Top"===e?u=g.topRight.y-m.topRight.y+r/(t.length-1):"Bottom"===e?u=g.bottomRight.y-m.bottomRight.y+s/(t.length-1):"BottomToTop"===e&&(u=g.bottomRight.y-m.topRight.y+h/(t.length-1)),c=this.storeObject(c,t[i]),this.drag(t[i],p,u),this.diagram.updateSelector(),d=this.storeObject(d,t[i])}c=ie(c),d=ie(d);var f={type:"Distribute",category:"Internal",undoObject:ie(c),redoObject:ie(d)};this.addHistoryEntry(f)}},t.prototype.sameSize=function(t,e){if(t.length>0){var i=0,n=void 0;n={x:.5,y:.5};var o=ee(t[0].wrapper),r={nodes:[],connectors:[]},s={nodes:[],connectors:[]};for(i=1;i<t.length;i++){var a=ee(t[i].wrapper),l=1,h=1;"Width"===e?l=o.width/a.width:"Height"===e?h=o.height/a.height:"Size"===e&&(l=o.width/a.width,h=o.height/a.height),r=this.storeObject(r,t[i]),this.scale(t[i],l,h,n),s=this.storeObject(s,t[i])}this.diagram.updateSelector(),r=ie(r),s=ie(s);var c={type:"Sizing",category:"Internal",undoObject:ie(r),redoObject:ie(s)};this.addHistoryEntry(c)}},t.prototype.storeObject=function(t,e){return e instanceof gp?t.nodes.push(ie(e)):t.connectors.push(ie(e)),t},t.prototype.scroll=function(t,e,i){var n=Tr(this.diagram),o=Or(this.diagram);this.diagram.pan((t=n?t:0)*this.diagram.scroller.currentZoom,(e=o?e:0)*this.diagram.scroller.currentZoom,i)},t.prototype.drawHighlighter=function(t){this.diagram.renderHighlighter(t.wrapper)},t.prototype.removeHighlighter=function(){this.diagram.clearHighlighter()},t.prototype.zoom=function(t,e,i,n){this.diagram.scroller.zoom(t,e*this.diagram.scroller.currentZoom,i*this.diagram.scroller.currentZoom,n)},t}(),hu=function(){function t(t){this.transform={tx:0,ty:0,scale:1},this.vPortWidth=0,this.vPortHeight=0,this.currentZoomFActor=1,this.hOffset=0,this.vOffset=0,this.scrolled=!1,this.hScrollSize=0,this.vScrollSize=0,this.diagram=t,this.objects=[]}return Object.defineProperty(t.prototype,"viewPortHeight",{get:function(){return this.vPortHeight},set:function(t){this.vPortHeight=t,this.diagram.scrollSettings.viewPortHeight=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentZoom",{get:function(){return this.currentZoomFActor},set:function(t){this.currentZoomFActor=t,this.diagram.scrollSettings.currentZoom=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"viewPortWidth",{get:function(){return this.vPortWidth},set:function(t){this.vPortWidth=t,this.diagram.scrollSettings.viewPortWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"horizontalOffset",{get:function(){return this.hOffset},set:function(t){this.hOffset=t,Math.abs(this.hOffset-this.diagram.scrollSettings.horizontalOffset)>1&&(this.scrolled=!0),this.diagram.scrollSettings.horizontalOffset=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"verticalOffset",{get:function(){return this.vOffset},set:function(t){this.vOffset=t,Math.abs(this.vOffset-this.diagram.scrollSettings.verticalOffset)>1&&(this.scrolled=!0),this.diagram.scrollSettings.verticalOffset=t},enumerable:!0,configurable:!0}),t.prototype.updateScrollOffsets=function(t,e){var i=0,n=0,o=this.getPageBounds();o.x*=this.currentZoom,o.y*=this.currentZoom,o.width*=this.currentZoom,o.height*=this.currentZoom,i=Math.max(0,t-o.left),n=Math.max(0,e-o.top),void 0!==t&&void 0!==e?(this.horizontalOffset=i,this.verticalOffset=n,this.diagram.setOffset(i,n)):this.diagram.setOffset(-this.horizontalOffset-o.x,-this.verticalOffset-o.y),this.transform={tx:Math.max(this.horizontalOffset,-o.left)/this.currentZoom,ty:Math.max(this.verticalOffset,-o.top)/this.currentZoom,scale:this.currentZoom}},t.prototype.setScrollOffset=function(t,e){this.scrolled=!1;var i=this.getPageBounds();i.x*=this.currentZoom,i.y*=this.currentZoom,i.width*=this.currentZoom,i.height*=this.currentZoom;var n=-i.left,o=-i.top,r=!1,s=this.viewPortWidth*this.currentZoom,a=this.viewPortHeight*this.currentZoom,l=n-t;if(l!==this.horizontalOffset){n<this.horizontalOffset&&(this.horizontalOffset>l?this.horizontalOffset-=t:this.horizontalOffset=l,r=!0);var h=Math.max(i.right+this.vScrollSize,s);if(!r&&h<-l+this.viewPortWidth){var c=-l+s-this.vScrollSize,d=-this.horizontalOffset+s-this.vScrollSize;c<d?this.horizontalOffset=l:c-i.right>c-d?this.horizontalOffset=l:this.horizontalOffset=-(i.right+this.vScrollSize-s),r=!0}r||(this.horizontalOffset=n-t)}r=!1;var p=o-e;if(p!==this.verticalOffset){o<this.verticalOffset&&(this.verticalOffset>p?this.verticalOffset-=e:this.verticalOffset=p,r=!0);var u=Math.max(i.bottom+this.hScrollSize,a);if(!r&&u<-p+a){var g=-p+a-this.hScrollSize,m=-this.verticalOffset+a-this.hScrollSize;g<m?this.verticalOffset=p:g-i.bottom>g-m?this.verticalOffset=p:this.verticalOffset=-(i.bottom+this.hScrollSize-a),r=!0}r||(this.verticalOffset=o-e)}this.transform={tx:Math.max(this.horizontalOffset,-i.left)/this.currentZoom,ty:Math.max(this.verticalOffset,-i.top)/this.currentZoom,scale:this.currentZoom},this.setSize(),this.scrolled&&this.diagram.endEdit()},t.prototype.setSize=function(){var t=this.getPageBounds();t.x*=this.currentZoom,t.y*=this.currentZoom,t.width*=this.currentZoom,t.height*=this.currentZoom;var e=Math.min(t.x,-this.horizontalOffset),i=Math.min(t.y,-this.verticalOffset),n=(this.horizontalOffset,this.viewPortWidth,t.right,this.verticalOffset,this.viewPortHeight,t.bottom,this.scrollerWidth),o=this.scrollerWidth;-this.verticalOffset<=t.y&&-this.verticalOffset+this.viewPortHeight>=t.bottom&&(o=0),-this.horizontalOffset<=t.x&&-this.horizontalOffset+this.viewPortWidth>=t.right&&(n=0),this.hScrollSize=n,this.vScrollSize=o,this.diagramWidth=Math.max(t.right,-this.horizontalOffset+this.viewPortWidth-o)-e,this.diagramHeight=Math.max(t.bottom,-this.verticalOffset+this.viewPortHeight-n)-i,this.diagram.setSize(this.diagramWidth,this.diagramHeight),this.diagram.element.style.overflow="hidden"},t.prototype.setViewPortSize=function(t,e){this.viewPortWidth=t,this.viewPortHeight=e},t.prototype.getPageBounds=function(t,e){var i=new ah;if("Content"!==e&&null!==this.diagram.pageSettings.width&&null!==this.diagram.pageSettings.height){var n=this.diagram.pageSettings.width,o=this.diagram.pageSettings.height,r=0,s=0;if(this.diagram.pageSettings.multiplePage){if((i=this.diagram.spatialSearch.getPageBounds(0,0)).right>n&&(n*=a=Math.ceil(i.right/n)),i.bottom>o&&(o*=a=Math.ceil(i.bottom/o)),i.left<0&&Math.abs(i.left)>r){a=Math.ceil(Math.abs(i.left)/this.diagram.pageSettings.width);r=this.diagram.pageSettings.width*a}if(i.top<0&&Math.abs(i.top)>s){var a=Math.ceil(Math.abs(i.top)/this.diagram.pageSettings.height);s=this.diagram.pageSettings.height*a}}return new ah(-r,-s,n+r,o+s)}var l=t?void 0:0;return this.diagram.spatialSearch.getPageBounds(l,l)},t.prototype.getPageBreak=function(t){for(var e=0,i=0,n=-1,o=[],r=0,s=0,a=0,l=0,h=this.diagram.pageSettings.margin.left,c=this.diagram.pageSettings.margin.right,d=this.diagram.pageSettings.margin.top,p=this.diagram.pageSettings.margin.bottom,u=1,g=1,m={x1:r,y1:a,x2:s,y2:l};t.width>e;)(e+=this.diagram.pageSettings.width?this.diagram.pageSettings.width:t.width)===this.diagram.pageSettings.width&&(m={x1:t.left+h,y1:t.top+d,x2:t.left+h,y2:t.bottom-p},o[++n]=m),e<t.width&&(m={x1:r=t.topLeft.x+this.diagram.pageSettings.width*u,y1:a=t.topLeft.y+d,x2:s=t.bottomLeft.x+this.diagram.pageSettings.width*u,y2:l=t.bottomLeft.y-p},o[++n]=m,u++),t.width===e&&(m={x1:t.right-c,y1:t.top+d,x2:t.right-c,y2:t.bottom-p},o[++n]=m);for(;t.height>i;)(i+=this.diagram.pageSettings.height?this.diagram.pageSettings.height:t.height)===this.diagram.pageSettings.height&&(m={x1:t.left+h,y1:t.top+d,x2:t.right-c,y2:t.top+d},o[++n]=m),i<t.height&&(m={x1:r=t.topLeft.x+h,y1:a=t.topLeft.y+this.diagram.pageSettings.height*g,x2:s=t.topRight.x-c,y2:l=t.topRight.y+this.diagram.pageSettings.height*g},o[++n]=m,g++),t.height===i&&(m={x1:t.left+h,y1:t.bottom-p,x2:t.right-c,y2:t.bottom-p},o[++n]=m);return o},t.prototype.zoom=function(t,e,i,n){if(Lr(this.diagram)&&1!==t||Er(this.diagram)&&1===t){var o=_t();if(Xt(o,this.currentZoom,this.currentZoom),Yt(o,this.horizontalOffset,this.verticalOffset),n=n||{x:this.viewPortWidth/2,y:this.viewPortHeight/2},n=Wt(o,n),this.currentZoom*t>=this.diagram.scrollSettings.minZoom&&this.currentZoom*t<=this.diagram.scrollSettings.maxZoom){this.currentZoom*=t;var r=this.getPageBounds();r.x*=this.currentZoom,r.y*=this.currentZoom;var s=_t();Xt(s,t,t,n.x,n.y),Yt(s,e||0,i||0),Qt(o,s);var a=Wt(o,{x:0,y:0});1===t&&(a=this.applyScrollLimit(a.x,a.y)),this.transform={tx:Math.max(a.x,-r.left)/this.currentZoom,ty:Math.max(a.y,-r.top)/this.currentZoom,scale:this.currentZoom},this.horizontalOffset=a.x,this.verticalOffset=a.y,this.setSize(),"SVG"!==this.diagram.mode&&this.diagram.refreshDiagramLayer(),this.diagram.setOffset(-this.horizontalOffset-r.x,-this.verticalOffset-r.y),Nr(this.diagram)}}},t.prototype.fitToPage=function(t){var e=(t=t||{}).mode,i=t.region,n=t.margin||{},o=t.canZoomIn,r=t.customBounds;n.bottom=n.bottom||25,n.top=n.top||25,n.left=n.left||25,n.right=n.right||25;var s,a=r,l=-this.horizontalOffset,h=-this.verticalOffset;if("PageSettings"===(i=i||"PageSettings")&&this.diagram.pageSettings.width&&this.diagram.pageSettings.height||this.diagram.nodes.length>0||this.diagram.connectors.length>0){e=e||"Page","CustomBounds"!==i&&(a=this.getPageBounds(!0,i));var c={x:0,y:0};c.x=(this.viewPortWidth-(n.left+n.right))/a.width,c.y=(this.viewPortHeight-(n.top+n.bottom))/a.height,!o&&a.width-this.horizontalOffset<this.viewPortWidth&&a.height-this.verticalOffset<this.viewPortHeight&&(c.x=Math.min(1,c.x),c.y=Math.min(1,c.y));var d=void 0,p=void 0,u=void 0;switch(e){case"Width":s=(d=c.x)/this.currentZoom,l+=(p=(this.viewPortWidth-a.width*d)/2-a.x*d)+(n.left-n.right)/2*d,h-=-this.verticalOffset*s,h="CustomBounds"!==i?h:h-this.verticalOffset*s;break;case"Height":s=(d=c.y)/this.currentZoom,p=(this.viewPortWidth-a.width*d)/2-a.x*d,u=(this.viewPortHeight-a.height*d)/2-a.y*d,l+=p+(n.left-n.right)/2*d,h+=u+(n.top-n.bottom)/2*d;break;case"Page":s=(d=Math.min(c.x,c.y))/this.currentZoom,p=(this.viewPortWidth-a.width*d)/2-a.x*d,u=(this.viewPortHeight-a.height*d)/2-a.y*d,l+=p+(n.left-n.right)/2*d,h+=u+(n.top-n.bottom)/2*d}this.zoom(s,l,h,{x:0,y:0})}else s=1/this.currentZoom,this.zoom(s,l,h,{x:0,y:0})},t.prototype.bringIntoView=function(t){var e=0,i=0,n=this.currentZoom,o=t,r=-this.horizontalOffset,s=-this.verticalOffset;o=new ah(o.x*n,o.y*n,o.width*n,o.height*n),new ah(r,s,this.viewPortWidth,this.viewPortHeight).containsRect(o)||(o.right>-r+this.viewPortWidth&&(e=o.right-this.viewPortWidth),o.x<-r&&(e=o.x),o.bottom>-s+this.viewPortHeight&&(i=o.bottom-this.viewPortHeight),o.y<-s&&(i=o.y),this.zoom(1,-this.horizontalOffset-e,-this.verticalOffset-i,null))},t.prototype.bringToCenter=function(t){var e=this.currentZoom,i=new ah(t.x*e,t.y*e,t.width*e,t.height*e),n=i.x+i.width/2-this.viewPortWidth/2,o=i.y+i.height/2-this.viewPortHeight/2;this.zoom(1,-this.horizontalOffset-n,-this.verticalOffset-o,null)},t.prototype.applyScrollLimit=function(t,e){if("Infinity"!==this.diagram.scrollSettings.scrollLimit){var i=void 0;"Limited"===this.diagram.scrollSettings.scrollLimit&&(i=this.diagram.scrollSettings.scrollableArea),(i=i||this.getPageBounds(!0)).x*=this.currentZoom,i.y*=this.currentZoom,i.width*=this.currentZoom,i.height*=this.currentZoom,t*=-1,e*=-1;var n=Math.max(i.right,this.viewPortWidth);if(!(t<=i.x&&(t+this.viewPortWidth>=i.right||t>=i.right-this.viewPortWidth)||t>=i.x&&t+this.viewPortWidth<=n))if(t>=i.x)t=Math.max(i.x,Math.min(t,t-(t+this.viewPortWidth-this.vScrollSize-n)));else{r=i.right-this.viewPortWidth;t=Math.min(r,i.x)}var o=Math.max(i.bottom,this.viewPortHeight);if(!(e<=i.y&&e+this.viewPortHeight>=i.bottom||e>=i.y&&e+this.viewPortHeight<=o))if(e>=i.y)e=Math.max(i.y,Math.min(e,e-(e+this.viewPortHeight-this.hScrollSize-o)));else{var r=i.bottom-this.viewPortHeight;e=Math.min(i.y,r)}t*=-1,e*=-1}return{x:t,y:e}},t}(),cu=function(){function t(t,e,i,n,o){this.objects=[],this.left=t,this.top=e,this.width=i,this.height=n,this.spatialSearch=o}return t.prototype.findQuads=function(t,e){null!=this.first&&this.first.isIntersect(t)&&this.first.findQuads(t,e),null!=this.second&&this.second.isIntersect(t)&&this.second.findQuads(t,e),null!=this.third&&this.third.isIntersect(t)&&this.third.findQuads(t,e),null!=this.fourth&&this.fourth.isIntersect(t)&&this.fourth.findQuads(t,e),this.objects.length>0&&e.push(this)},t.prototype.isIntersect=function(t){return!(this.left+this.width<t.left||this.top+this.height<t.top||this.left>t.right||this.top>t.bottom)},t.prototype.selectQuad=function(){for(var t,e=null,i=this;null!=i;)i=(t=i.getQuad(e)).source,e=t.target||e;return e},t.prototype.getQuad=function(e){var i=this.width/2,n=this.height/2;if(i>=1e3&&n>=1e3){var o=this.left+i,r=this.top+n;if(this.spatialSearch.childRight<=o){if(this.spatialSearch.childBottom<=r)return this.first||((s=new t(this.left,this.top,i,n,this.spatialSearch)).parent=this,this.first=s),{source:this.first};if(this.spatialSearch.childTop>=r)return this.third||((s=new t(this.left,r,i,n,this.spatialSearch)).parent=this,this.third=s),{source:this.third}}else if(this.spatialSearch.childLeft>=o){if(this.spatialSearch.childBottom<=r)return this.second||((s=new t(o,this.top,i,n,this.spatialSearch)).parent=this,this.second=s),{source:this.second};if(this.spatialSearch.childTop>=r){if(!this.fourth){var s=new t(o,r,i,n,this.spatialSearch);s.parent=this,this.fourth=s}return{source:this.fourth}}}}return this,this.objects.push(this.spatialSearch.childNode),{target:this}},t.prototype.isContained=function(){return this.spatialSearch.childLeft>=this.left&&this.spatialSearch.childRight<=this.left+this.width&&this.spatialSearch.childTop>=this.top&&this.spatialSearch.childBottom<=this.top+this.height},t.prototype.addIntoAQuad=function(t){var e={};this.spatialSearch.setCurrentNode(t);for(var i=null;!e.isAdded;)i=(e=this.spatialSearch.parentQuad.add(i)).quad;return i},t.prototype.add=function(e){if(e=null,this.isContained())return e=this.selectQuad(),{isAdded:!0,quad:e};var i=void 0,n=!(0!==this.objects.length||this.first||this.second||this.third||this.fourth),o=2*this.width,r=2*this.height;return this.spatialSearch.childLeft<this.left?this.spatialSearch.childTop<this.top?(i=new t(this.left-this.width,this.top-this.height,o,r,this.spatialSearch),n||(i.fourth=this)):(i=new t(this.left-this.width,this.top,o,r,this.spatialSearch),n||(i.second=this)):this.spatialSearch.childTop<this.top?(i=new t(this.left,this.top-this.height,o,r,this.spatialSearch),n||(i.third=this)):(i=new t(this.left,this.top,o,r,this.spatialSearch),n||(i.first=this)),this.parent=i,this.spatialSearch.parentQuad=i,{isAdded:!1,quad:e}},t}(),du=function(){function t(t){this.quadSize=500,this.objectTable=t,this.parentQuad=new cu(0,0,2*this.quadSize,2*this.quadSize,this),this.pageLeft=Number.MAX_VALUE,this.pageRight=-Number.MAX_VALUE,this.pageTop=Number.MAX_VALUE,this.pageBottom=-Number.MAX_VALUE,this.quadTable={}}return t.prototype.removeFromAQuad=function(t){if(this.quadTable[t.id]){var e=this.quadTable[t.id],i=e.objects.indexOf(t);-1!==i&&(e.objects.splice(i,1),this.update(e),delete this.quadTable[t.id])}},t.prototype.update=function(t){if(!(t.parent&&0===t.objects.length&&t.first&&t.second&&t.third&&t.fourth))return void(t!==this.parentQuad||t.first||t.second||t.third||t.fourth||(t.left=0,t.width=1e3,t.top=0,t.height=1e3));var e=t.parent;e.first===t?e.first=null:e.second===t?e.second=null:e.third===t?e.third=null:e.fourth===t&&(e.fourth=null),this.update(t.parent)},t.prototype.addIntoAQuad=function(t){var e=this.parentQuad.addIntoAQuad(t);this.quadTable[t.id]=e},t.prototype.updateQuad=function(t){this.setCurrentNode(t);var e=t.outerBounds;if(isNaN(e.x)||isNaN(e.y)||isNaN(e.width)||isNaN(e.height))return!1;if(this.quadTable[t.id]?this.quadTable[t.id].isContained()||(this.removeFromAQuad(t),this.addIntoAQuad(t)):this.addIntoAQuad(t),!this.isWithinPageBounds(e)||this.leftElement===t||this.topElement===t||this.rightElement===t||this.bottomElement===t){var i=!1;return this.pageLeft===this.childLeft&&t===this.leftElement||(this.pageLeft>=this.childLeft?(this.pageLeft=this.childLeft,this.leftElement=t,i=!0):t===this.leftElement&&(this.pageLeft=Number.MAX_VALUE,this.findLeft(this.parentQuad),i=!0)),this.pageTop===this.childTop&&t===this.topElement||(this.pageTop>=this.childTop?(this.pageTop=this.childTop,this.topElement=t,i=!0):t===this.topElement&&(this.pageTop=Number.MAX_VALUE,this.findTop(this.parentQuad),i=!0)),this.pageBottom===this.childBottom&&t===this.bottomElement||(this.pageBottom<=this.childBottom?(i=!0,this.pageBottom=this.childBottom,this.bottomElement=t):t===this.bottomElement&&(this.pageBottom=-Number.MAX_VALUE,this.findBottom(this.parentQuad),i=!0)),this.pageRight===this.childRight&&t===this.rightElement||(this.pageRight<=this.childRight?(this.pageRight=this.childRight,this.rightElement=t,i=!0):t===this.rightElement&&(this.pageRight=-Number.MAX_VALUE,this.findRight(this.parentQuad),i=!0)),i}return this.setCurrentNode(null),!1},t.prototype.isWithinPageBounds=function(t){return t.left>=this.pageLeft&&t.right<=this.pageRight&&t.top>=this.pageTop&&t.bottom<=this.pageBottom},t.prototype.findQuads=function(t){var e=[];return this.parentQuad.findQuads(t,e),e},t.prototype.findObjects=function(t){for(var e=[],i=0,n=this.findQuads(t);i<n.length;i++)for(var o=0,r=n[i].objects;o<r.length;o++){var s=r[o];s.outerBounds.intersects(t)&&e.push(this.objectTable[s.id])}return e},t.prototype.updateBounds=function(t){var e=!1;return t===this.topElement&&(this.pageTop=Number.MAX_VALUE,this.topElement=null,this.findTop(this.parentQuad),e=!0),t===this.leftElement&&(this.pageLeft=Number.MAX_VALUE,this.leftElement=null,this.findLeft(this.parentQuad),e=!0),t===this.rightElement&&(this.pageRight=-Number.MAX_VALUE,this.rightElement=null,this.findRight(this.parentQuad),e=!0),t===this.bottomElement&&(this.pageBottom=-Number.MAX_VALUE,this.bottomElement=null,this.findBottom(this.parentQuad),e=!0),e},t.prototype.findBottom=function(t){t.third||t.fourth?(t.third&&this.findBottom(t.third),t.fourth&&this.findBottom(t.fourth)):(t.second&&this.findBottom(t.second),t.first&&this.findBottom(t.first));for(var e=0,i=t.objects;e<i.length;e++){var n=i[e];this.pageBottom<=n.outerBounds.bottom&&(this.pageBottom=n.outerBounds.bottom,this.bottomElement=n)}},t.prototype.findRight=function(t){t.second||t.fourth?(t.second&&this.findRight(t.second),t.fourth&&this.findRight(t.fourth)):(t.first&&this.findRight(t.first),t.third&&this.findRight(t.third));for(var e=0,i=t.objects;e<i.length;e++){var n=i[e];this.pageRight<=n.outerBounds.right&&(this.pageRight=n.outerBounds.right,this.rightElement=n)}},t.prototype.findLeft=function(t){t.first||t.third?(t.first&&this.findLeft(t.first),t.third&&this.findLeft(t.third)):(t.second&&this.findLeft(t.second),t.fourth&&this.findLeft(t.fourth));for(var e=0,i=t.objects;e<i.length;e++){var n=i[e];this.pageLeft>=n.outerBounds.left&&(this.pageLeft=n.outerBounds.left,this.leftElement=n)}},t.prototype.findTop=function(t){t.first||t.second?(t.first&&this.findTop(t.first),t.second&&this.findTop(t.second)):(t.third&&this.findTop(t.third),t.fourth&&this.findTop(t.fourth));for(var e=0,i=t.objects;e<i.length;e++){var n=i[e];this.pageTop>=n.outerBounds.top&&(this.pageTop=n.outerBounds.top,this.topElement=n)}},t.prototype.setCurrentNode=function(t){if(this.childNode=t,t){var e=t.outerBounds;this.childLeft=Number(e.left),this.childTop=Number(e.top),this.childRight=Number(e.right),this.childBottom=Number(e.bottom)}else this.childLeft=Number.MAX_VALUE,this.childTop=Number.MAX_VALUE,this.childRight=-Number.MAX_VALUE,this.childBottom=-Number.MAX_VALUE},t.prototype.getPageBounds=function(t,e){if(this.pageLeft===Number.MAX_VALUE)return new ah(0,0,0,0);var i=void 0!==t?Math.min(this.pageLeft,0):this.pageLeft,n=void 0!==e?Math.min(this.pageTop,0):this.pageTop;return new ah(Math.round(i),Math.round(n),Math.round(this.pageRight-i),Math.round(this.pageBottom-n))},t.prototype.getQuad=function(t){return this.quadTable[t.id]},t}(),pu=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uu=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},gu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pu(e,t),uu([et()],e.prototype,"key",void 0),uu([et()],e.prototype,"keyModifiers",void 0),e}(qa),mu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pu(e,t),uu([et("")],e.prototype,"name",void 0),uu([et()],e.prototype,"canExecute",void 0),uu([et()],e.prototype,"execute",void 0),uu([it({},gu)],e.prototype,"gesture",void 0),uu([et("")],e.prototype,"parameter",void 0),e}(qa),fu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pu(e,t),uu([ot([],mu)],e.prototype,"commands",void 0),e}(qa),vu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pu(e,t),uu([et()],e.prototype,"show",void 0),uu([et()],e.prototype,"showCustomMenuOnly",void 0),uu([et()],e.prototype,"items",void 0),e}(qa),yu=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),bu=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},wu=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.connectorTable={},n.groupTable={},n.activeLabel={id:"",parentId:"",isGroup:!1},n.renderTimer=null,n}return yu(e,t),e.prototype.clearCollection=function(t){for(var e,i=[],n=0,o=Object.keys(this.nameTable);n<o.length;n++){var r=o[n];(e=this.nameTable[r])&&(t&&e instanceof Vd||!t&&e instanceof gp)&&i.push(e)}this.clearObjects(i)},e.prototype.onPropertyChanged=function(t,i){for(var n=[],o=!1,r=!1,s=0,a=Object.keys(t);s<a.length;s++)switch(a[s]){case"width":case"height":this.element.style.width=this.getSizeValue(this.width),this.element.style.height=this.getSizeValue(this.height),this.eventHandler.updateViewPortSize(this.element);for(var l=0,h=this.views;l<h.length;l++){var c=h[l],d=this.views[c];d instanceof e||d.updateView(d)}break;case"nodes":if(t.nodes.length>0&&0===i.nodes.length)this.clearCollection(),r=!0;else{for(var p=0,u=Object.keys(t.nodes);p<u.length;p++){var g=u[p],m=Number(g),f=this.nodes[m],v=t.nodes[m];o=o||void 0!==v.excludeFromLayout,this.nodePropertyChange(f,i.nodes[m],v),n.push(f)}"Canvas"===this.mode&&this.refreshDiagramLayer()}break;case"connectors":if(t.connectors.length>0&&0===i.connectors.length)this.clearCollection(!0),r=!0;else{for(var y=0,b=Object.keys(t.connectors);y<b.length;y++){var g=b[y],m=Number(g),f=this.connectors[m],v=t.connectors[m];this.connectorPropertyChange(f,i.connectors[m],v,!0),n.push(f)}this.updateBridging(),"Canvas"===this.mode&&this.refreshDiagramLayer()}break;case"bridgeDirection":this.updateBridging(),"Canvas"===this.mode&&this.refreshDiagramLayer();break;case"backgroundColor":this.intOffPageBackground();break;case"pageSettings":this.validatePageSize(),this.updatePage();break;case"selectedItems":if(t.selectedItems.userHandles&&this.selectedItems.wrapper&&this.selectedItems.userHandles&&this.selectedItems.userHandles.length>0){this.renderSelector(!0);break}if(t.selectedItems.constraints){this.renderSelector(!0);break}break;case"snapSettings":this.updateSnapSettings(t);break;case"commandManager":this.initCommands();break;case"layout":o=!0;break;case"dataSourceSettings":this.clear(),this.initObjects(),o=!0;break;case"tooltip":Hn(this);break;case"rulerSettings":this.updateRulerSettings(t);break;case"layers":this.updateLayer(t);break;case"scrollSettings":this.updateScrollSettings(t)}o&&this.doLayout();var w={element:n,cause:this.diagramActions,oldValue:i,newValue:t};if(this.triggerEvent(Ph.propertyChange,w),!r&&this.canLogChange()&&this.modelChanged(t,i)){var x={type:"PropertyChanged",undoObject:i,redoObject:t,category:"Internal"};this.addHistoryEntry(x)}this.resetDiagramActions(),r&&(this.initObjects(!0),this.refreshDiagramLayer())},e.prototype.updateSnapSettings=function(t){(t.snapSettings.constraints||t.snapSettings.horizontalGridlines||t.snapSettings.verticalGridlines)&&this.diagramRenderer.updateGrid(this.snapSettings,ze(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler)},e.prototype.updateRulerSettings=function(t){void 0!==t.rulerSettings.dynamicGrid&&this.diagramRenderer.updateGrid(this.snapSettings,ze(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler),void 0!==t.rulerSettings.showRulers?(this.intOffPageBackground(),this.scroller.setSize(),this.renderRulers()):void 0===t.rulerSettings.horizontalRuler&&void 0===t.rulerSettings.verticalRuler||(void 0!==t.rulerSettings.horizontalRuler.thickness||void 0!==t.rulerSettings.verticalRuler.thickness?(Hr(this),this.intOffPageBackground(),this.scroller.setSize(),this.renderRulers()):Nr(this)),this.diagramRenderer.updateGrid(this.snapSettings,ze(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler)},e.prototype.getPersistData=function(){var t=["loaded"];return this.addOnPersist(t)},e.prototype.preRender=function(){this.initializePrivateVariables(),this.isProtectedOnChange=!0,this.serviceLocator=new Ep,this.initializeServices(),this.initDiagram(),this.initViews(),this.unWireEvents(),this.wireEvents(),this.element.classList.add("e-diagram")},e.prototype.initializePrivateVariables=function(){this.defaultLocale={Copy:"Copy",Cut:"Cut",Paste:"Paste",Undo:"Undo",Redo:"Redo",SelectAll:"Select All",Grouping:"Grouping",Group:"Group",UnGroup:"Un Group",Order:"Order",BringToFront:"Bring To Front",MoveForward:"Move Forward",SendToBack:"Send To Back",SendBackward:"Send Backward"},this.layerZIndex=-1,this.layerZIndexTable={},this.nameTable={},this.groupTable={},this.commands={},this.isLoading||(this.views=[]),this.commandHandler=new lu(this),this.eventHandler=new nu(this,this.commandHandler),this.spatialSearch=new du(this.nameTable),this.scroller=new hu(this)},e.prototype.initializeServices=function(){this.serviceLocator.register("localization",this.localeObj=new Dl(this.getModuleName(),this.defaultLocale,this.locale))},e.prototype.render=function(){this.initHistory(),this.diagramRenderer=new bp(this.element.id,new dh,"SVG"===this.mode),this.initLayers(),this.initializeDiagramLayers(),this.diagramRenderer.setLayers(),this.initObjects(!0),this.doLayout(),this.validatePageSize(),this.renderPageBreaks(),this.diagramRenderer.renderSvgGridlines(this.snapSettings,ze(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler),this.commandHandler.initSelectorWrapper(),this.notify("initial-load",{}),this.trigger("load"),this.scroller.setSize(),this.scroller.updateScrollOffsets(),this.refreshDiagramLayer(),this.notify("initial-end",{}),this.isProtectedOnChange=!1,this.tooltipObject=Hn(this),this.diagramActions=Lh.Render,this.initCommands(),this.isLoading=!1},e.prototype.getModuleName=function(){return"diagram"},e.prototype.requiredModules=function(){var t=[];return t.push({member:"Bpmn",args:[]}),t.push({member:"Bridging",args:[]}),t.push({member:"ConnectorEditingTool",args:[]}),this.constraints&yh.UndoRedo&&t.push({member:"UndoRedo",args:[]}),("OrganizationalChart"===this.layout.type||"HierarchicalTree"===this.layout.type||this.layout.enableAnimation)&&t.push({member:"LayoutAnimate",args:[]}),this.snapSettings.constraints&&t.push({member:"Snapping",args:[this]}),t.push({member:"PrintandExport",args:[this]}),this.contextMenuSettings.show&&t.push({member:"contextMenu",args:[this,this.serviceLocator]}),"OrganizationalChart"!==this.layout.type&&"HierarchicalTree"!==this.layout.type||t.push({member:"OrganizationalChart",args:[]}),"ComplexHierarchicalTree"===this.layout.type&&t.push({member:"ComplexHierarchicalTree",args:[]}),"MindMap"===this.layout.type&&t.push({member:"MindMapChart",args:[]}),"RadialTree"===this.layout.type&&t.push({member:"RadialTree",args:[]}),"SymmetricalLayout"===this.layout.type&&t.push({member:"SymmetricalLayout",args:[]}),(this.dataSourceSettings.dataManager||this.dataSourceSettings.data)&&t.push({member:"DataBinding",args:[]}),t},e.prototype.destroy=function(){if(clearInterval(this.renderTimer),this.renderTimer=null,this.hRuler&&this.vRuler&&(this.hRuler.destroy(),this.vRuler.destroy()),this.tooltipObject.destroy(),this.droppable.destroy(),this.unWireEvents(),this.notify("destroy",{}),t.prototype.destroy.call(this),document.getElementById(this.element.id)){this.element.classList.remove("e-diagram");for(var e=document.getElementsByClassName("e-tooltip-wrap");e.length>0;)e[0].parentNode.removeChild(e[0]);var i=document.getElementById(this.element.id+"content");i&&this.element.removeChild(i);window.measureElement&&(window.measureElement.usageCount-=1,0===window.measureElement.usageCount&&(window.measureElement.parentNode.removeChild(window.measureElement),window.measureElement=null))}},e.prototype.wireEvents=function(){var t=za.touchStartEvent,e=za.touchEndEvent,i=za.touchMoveEvent,n=za.isPointer?"pointerleave":"mouseleave",o=za.isPointer,r="mozilla"===za.info.name?o?"mousewheel":"DOMMouseScroll":"mousewheel";Ma.add(this.diagramCanvas,t,this.eventHandler.mouseDown,this.eventHandler),Ma.add(this.diagramCanvas,i,this.eventHandler.mouseMove,this.eventHandler),Ma.add(this.diagramCanvas,e,this.eventHandler.mouseUp,this.eventHandler),Ma.add(this.diagramCanvas,n,this.eventHandler.mouseLeave,this.eventHandler),Ma.add(this.diagramCanvas,"keydown",this.eventHandler.keyDown,this.eventHandler),Ma.add(this.diagramCanvas,"dblclick",this.eventHandler.doubleClick,this.eventHandler),Ma.add(this.diagramCanvas,"scroll",this.eventHandler.scrolled,this.eventHandler),Ma.add(this.diagramCanvas,r,this.eventHandler.mouseWheel,this.eventHandler),Ma.add(window,"resize",this.eventHandler.windowResize,this.eventHandler),this.initDroppables()},e.prototype.unWireEvents=function(){var t=za.touchStartEvent,e=za.touchMoveEvent,i=za.isPointer?"pointerleave":"mouseleave",n=za.isPointer,o="mozilla"===za.info.name?n?"mousewheel":"DOMMouseScroll":"mousewheel",r=za.touchEndEvent;Ma.remove(this.diagramCanvas,t,this.eventHandler.mouseDown),Ma.remove(this.diagramCanvas,e,this.eventHandler.mouseMove),Ma.remove(this.diagramCanvas,r,this.eventHandler.mouseUp),Ma.remove(this.diagramCanvas,i,this.eventHandler.mouseLeave),Ma.remove(this.diagramCanvas,"keydown",this.eventHandler.keyDown),Ma.remove(this.diagramCanvas,"dblclick",this.eventHandler.doubleClick),Ma.remove(this.diagramCanvas,"scroll",this.eventHandler.scrolled),Ma.remove(this.diagramCanvas,o,this.eventHandler.mouseWheel),Ma.remove(window,"resize",this.eventHandler.windowResize)},e.prototype.select=function(t,e){null!=t&&this.commandHandler.selectObjects(t,e)},e.prototype.selectAll=function(){var t=[];t=this.getObjectsOfLayer(this.activeLayer.objects),this.select(t)},e.prototype.unSelect=function(t){t&&Rs(this,t)&&this.commandHandler.unSelect(t)},e.prototype.clearSelection=function(){this.commandHandler.clearSelection(!0)},e.prototype.updateViewPort=function(){this.eventHandler.updateViewPortSize(this.element)},e.prototype.cutCommand=function(){this.cut()},e.prototype.cut=function(){this.commandHandler.cut()},e.prototype.addProcess=function(t,e){this.bpmnModule&&this.bpmnModule.addProcess(t,e,this)},e.prototype.removeProcess=function(t){this.bpmnModule&&this.bpmnModule.removeProcess(t,this)},e.prototype.pasteCommand=function(){this.paste()},e.prototype.paste=function(t){this.commandHandler.paste(t)},e.prototype.fitToPage=function(t){this.scroller.fitToPage(t)},e.prototype.bringIntoView=function(t){this.scroller.bringIntoView(t)},e.prototype.bringToCenter=function(t){this.scroller.bringToCenter(t)},e.prototype.copyCommand=function(){this.copy()},e.prototype.copy=function(){return this.commandHandler.copy()},e.prototype.group=function(){this.commandHandler.group()},e.prototype.unGroup=function(){this.commandHandler.unGroup()},e.prototype.sendToBack=function(){this.commandHandler.sendToBack()},e.prototype.setActiveLayer=function(t){var e=this.commandHandler.getLayer(t);this.activeLayer=e},e.prototype.addLayer=function(t,e){this.commandHandler.addLayer(t,e)},e.prototype.removeLayer=function(t){this.commandHandler.removeLayer(t)},e.prototype.moveObjects=function(t,e){this.commandHandler.moveObjects(t,e)},e.prototype.sendLayerBackward=function(t){this.commandHandler.sendLayerBackward(t)},e.prototype.bringLayerForward=function(t){this.commandHandler.bringLayerForward(t)},e.prototype.cloneLayer=function(t){this.commandHandler.cloneLayer(t)},e.prototype.bringToFront=function(){this.commandHandler.bringToFront()},e.prototype.moveForward=function(){this.commandHandler.sendForward()},e.prototype.sendBackward=function(){this.commandHandler.sendBackward()},e.prototype.getObject=function(t){return this.nameTable[t]},e.prototype.getActiveLayer=function(){return this.activeLayer},e.prototype.nudgeCommand=function(t,e,i){"object"!=typeof t&&this.nudge(t)},e.prototype.nudge=function(t,e,i){var n=0,o=0;"Left"===t||"Right"===t?n=("Left"===t?-1:1)*(e||1):o=("Up"===t?-1:1)*(i||1);var r=this.selectedItems;this.drag(r,n,o)},e.prototype.drag=function(t,e,i){if(!(this.bpmnModule&&t instanceof gp&&this.bpmnModule.updateAnnotationDrag(t,this,e,i)))if(t instanceof Ud){if(t.nodes&&t.nodes.length)for(var n=0,o=t.nodes;n<o.length;n++){var r=o[n];this.drag(r,e,i)}if(t.connectors&&t.connectors.length)for(var s=0,a=t.connectors;s<a.length;s++){var l=a[s];this.drag(l,e,i)}this.updateSelector()}else t instanceof gp&&this.bpmnModule&&this.bpmnModule.updateAnnotationDrag(t,this,e,i),this.commandHandler.drag(t,e,i)},e.prototype.scale=function(t,e,i,n){var o=!0;if(t instanceof Ud){if(t.nodes&&t.nodes.length)for(var r=0,s=t.nodes;r<s.length;r++){var a=s[r];o=this.commandHandler.scale(a,e,i,n,t)}if(t.connectors&&t.connectors.length)for(var l=0,h=t.connectors;l<h.length;l++){var c=h[l];this.commandHandler.scale(c,e,i,n,t)}this.updateSelector()}else this.commandHandler.scale(t,e,i,n);return o},e.prototype.rotate=function(t,e,i){var n;if(t)if(i=i||{x:t.wrapper.offsetX,y:t.wrapper.offsetY},t instanceof Ud){t.rotateAngle+=e,t.wrapper.rotateAngle+=e;var o=ee(t.wrapper);if(!(n=this.commandHandler.checkBoundaryConstraints(void 0,void 0,o)))return t.rotateAngle-=e,t.wrapper.rotateAngle-=e,n;var r=[];r=(r=r.concat(t.nodes)).concat(t.connectors),this.commandHandler.rotateObjects(t,r,e,i)}else this.commandHandler.rotateObjects(t,[t],e,i);return n},e.prototype.dragSourceEnd=function(t,e,i){this.commandHandler.dragSourceEnd(t,e,i)},e.prototype.dragTargetEnd=function(t,e,i){this.commandHandler.dragTargetEnd(t,e,i)},e.prototype.findObjectsUnderMouse=function(t,e){return this.eventHandler.findObjectsUnderMouse(t,e)},e.prototype.findObjectUnderMouse=function(t,e,i){return this.eventHandler.findObjectUnderMouse(t,e,i)},e.prototype.findTargetObjectUnderMouse=function(t,e,i,n,o){return this.eventHandler.findTargetUnderMouse(t,e,i,n,o)},e.prototype.findElementUnderMouse=function(t,e){return this.eventHandler.findElementUnderMouse(t,e)},e.prototype.findActionToBeDone=function(t,e,i,n){return this.eventHandler.findActionToBeDone(t,e,i,n)},e.prototype.getTool=function(t){var e,i=fe(this.getCustomTool);return i&&(e=i(t))?e:this.eventHandler.getTool(t)},e.prototype.getCursor=function(t,e){var i,n=fe(this.getCustomCursor);return n&&(i=n(t,e))?i:this.eventHandler.getCursor(t)},e.prototype.initHistory=function(){this.undoRedoModule&&this.undoRedoModule.initHistory(this)},e.prototype.addHistoryEntry=function(t){this.undoRedoModule&&this.constraints&yh.UndoRedo&&!this.currentSymbol&&(this.undoRedoModule.addHistoryEntry(t,this),"StartGroup"!==t.type&&"EndGroup"!==t.type&&this.historyChangeTrigger(t))},e.prototype.historyChangeTrigger=function(t){var e={},i=[];switch(t&&t.redoObject&&t.redoObject.nodes instanceof Array&&t.redoObject.connectors instanceof Array?i=t.redoObject.nodes.concat(t.redoObject.connectors):t.redoObject&&i.push(t.redoObject),e.type=t.type,t.type){case"PositionChanged":e.oldValue={offsetX:t.undoObject.offsetX,offsetY:t.undoObject.offsetY},e.newValue={offsetX:t.redoObject.offsetX,offsetY:t.redoObject.offsetY};break;case"RotationChanged":e.oldValue={rotateAngle:t.undoObject.rotateAngle},e.newValue={rotateAngle:t.redoObject.rotateAngle};break;case"SizeChanged":e.oldValue={offsetX:t.undoObject.offsetX,offsetY:t.undoObject.offsetY,width:t.undoObject.width,height:t.undoObject.height},e.newValue={offsetX:t.redoObject.offsetX,offsetY:t.redoObject.offsetY,width:t.redoObject.width,height:t.redoObject.height};break;case"CollectionChanged":e[t.changeType]=i;break;case"ConnectionChanged":e.oldValue={offsetX:t.undoObject.offsetX,offsetY:t.undoObject.offsetY},e.newValue={offsetX:t.redoObject.offsetX,offsetY:t.redoObject.offsetY}}var n={cause:t.category,source:i,change:e};i.length&&this.triggerEvent(Ph.historyChange,n)},e.prototype.startGroupAction=function(){var t={type:"StartGroup",category:"Internal"};this.addHistoryEntry(t)},e.prototype.endGroupAction=function(){var t={type:"EndGroup",category:"Internal"};this.addHistoryEntry(t)},e.prototype.undo=function(){this.undoRedoModule&&this.constraints&yh.UndoRedo&&this.undoRedoModule.undo(this)},e.prototype.redo=function(){this.undoRedoModule&&this.constraints&yh.UndoRedo&&this.undoRedoModule.redo(this)},e.prototype.align=function(t,e){e||(e=(e=[]).concat(this.selectedItems.nodes,this.selectedItems.connectors)),this.diagramActions=this.diagramActions|Lh.PublicMethod,this.commandHandler.align(e,t)},e.prototype.distribute=function(t,e){e||(e=(e=[]).concat(this.selectedItems.nodes,this.selectedItems.connectors)),this.diagramActions=this.diagramActions|Lh.PublicMethod,this.commandHandler.distribute(e,t)},e.prototype.sameSize=function(t,e){e||(e=(e=[]).concat(this.selectedItems.nodes,this.selectedItems.connectors)),this.diagramActions=this.diagramActions|Lh.PublicMethod,this.commandHandler.sameSize(e,t)},e.prototype.zoom=function(t,e){this.scroller.zoom(t,0,0,e)},e.prototype.zoomTo=function(t){var e=t.zoomFactor?t.zoomFactor:.2;e="ZoomOut"===t.type?1/(1+e):1+e,this.scroller.zoom(e,0,0,t.focusPoint)},e.prototype.pan=function(t,e,i){this.scroller.zoom(1,t,e,i)},e.prototype.reset=function(){this.scroller.zoom(1/this.scroller.currentZoom,-this.scroller.horizontalOffset,-this.scroller.verticalOffset,{x:0,y:0})},e.prototype.triggerEvent=function(t,e){this.trigger(Ph[t],e)},e.prototype.add=function(t){var e;if(t){if(t=ie(t),this.bpmnModule&&!this.bpmnModule.canAdd(t))return null;var i={element:t,cause:this.diagramActions,state:"Changing",type:"Addition",cancel:!1};this.triggerEvent(Ph.collectionChange,i),t.id=t.id||te();var n=this.activeLayer;if(!i.cancel&&!n.lock){if(n.objects.indexOf(t.id)<0&&!n.lock&&(n.visible||(n.visible=!0,this.dataBind()),n.objects.push(t.id)),yp(t)===Vd)e=new Vd(this,"connectors",t,!0),this.connectors.push(e),this.initObject(e),!1===t.visible&&this.updateElementVisibility(e.wrapper,e,t.visible),this.updateEdges(e);else if(e=new gp(this,"nodes",t,!0),this.nodes.push(e),this.initObject(e,n),this.bpmnModule){if(e.shape.annotations&&0!==e.shape.annotations.length)for(var o=0,r=this.bpmnModule.getTextAnnotationConn(e);o<r.length;o++){var s=r[o];this.initConnectors(s,n,!1)}e.shape.activity&&e.shape.activity.subProcess.processes&&e.shape.activity.subProcess.processes.length&&this.bpmnModule.updateDocks(e,this)}if(i={element:e,cause:this.diagramActions,state:"Changed",type:"Addition",cancel:!1},this.triggerEvent(Ph.collectionChange,i),!(this.diagramActions&Lh.UndoRedo||this.diagramActions&Lh.Group)){var a={type:"CollectionChanged",changeType:"Insert",undoObject:ie(t),redoObject:ie(t),category:"Internal"};this.addHistoryEntry(a)}this.diagramActions=this.diagramActions|Lh.PublicMethod,"SVG"===this.mode&&(this.updateSvgNodes(e),this.updateDiagramObject(e),e.shape.activity&&e.shape.activity.subProcess.processes&&e.shape.activity.subProcess.processes.length&&this.updateProcesses(e))}}return this.resetDiagramActions(Lh.PublicMethod),e},e.prototype.updateSvgNodes=function(t){if(t.children)for(var e=0,i=t.children;e<i.length;e++){var n=i[e];if(this.nameTable[n]&&this.nameTable[n].parentId){var o=Ae(n+"_groupElement");o.parentNode.removeChild(o)}}},e.prototype.updateProcesses=function(t){if(this.bpmnModule&&t&&t.shape&&t.shape.activity&&t.shape.activity.subProcess.processes&&t.shape.activity.subProcess.processes.length){var e=t.shape.activity.subProcess.processes;this.moveSvgNode(t.id);for(var i=0,n=e;i<n.length;i++){l=n[i];this.moveSvgNode(l);for(var o=[],r=(o=o.concat(this.nameTable[l].outEdges,this.nameTable[l].inEdges)).length-1;r>=0;r--)this.moveSvgNode(o[r])}for(var s=0,a=e;s<a.length;s++){var l=a[s];this.nameTable[l].shape.activity.subProcess.processes&&this.nameTable[l].shape.activity.subProcess.processes.length&&this.updateProcesses(this.nameTable[l])}}else this.moveSvgNode(t.id)},e.prototype.moveSvgNode=function(t){var e=Ae(t+"_groupElement"),i=e.parentElement;e.parentNode.removeChild(e),i.appendChild(e)},e.prototype.addTextAnnotation=function(t,e){if(this.bpmnModule){var i=this.bpmnModule.addAnnotation(e,t,this);this.initConnectors(i,this.commandHandler.getObjectLayer(e.id),!1),this.updateDiagramObject(e)}},e.prototype.spliceConnectorEdges=function(t,e){var i,n=[];if(i=e?this.nameTable[t.sourceID]:this.nameTable[t.targetID])for(var o=(n=e?i.outEdges:i.inEdges).length-1;o>=0;o--)n[o]===t.id&&n.splice(o,1)},e.prototype.removeDependentConnector=function(t){for(var e,i=[],n=(i=i.concat(t.outEdges,t.inEdges)).length-1;n>=0;n--)(e=this.nameTable[i[n]])&&(this.connectorTable[e.id]=ie(e),this.remove(e))},e.prototype.removeObjectsFromLayer=function(t){var e=this.layers.indexOf(this.commandHandler.getObjectLayer(t.id)),i=this.layers[e].objects.indexOf(t.id);i>-1&&(Rs(this,t)&&this.unSelect(t),this.layers[e].objects.splice(i,1),delete this.layers[e].zIndexTable[this.nameTable[t.id].zIndex])},e.prototype.removeElements=function(t){if("SVG"===this.mode||"Canvas"===this.mode&&"Native"===t.shape.type){var e=Ae(t.id+"_groupElement");e&&e.parentNode.removeChild(e)}this.refreshCanvasLayers();for(var i,n=t.wrapper.children,o=0;o<n.length;o++)if(n[o]instanceof oc||n[o].id&&n[o].id.indexOf("icon_content")>0){n[o].id.indexOf("icon_content")>0&&((i=Ae(n[o].id+"_shape_groupElement")).parentNode.removeChild(i),(i=Ae(n[o].id+"_rect_groupElement")).parentNode.removeChild(i));for(var r=0,s=this.views;r<s.length;r++){h=s[r];$e(n[o].id+"_groupElement",h)}}else if(n[o]instanceof Xd)for(var a=0,l=this.views;a<l.length;a++){var h=l[a];$e(n[o].id+"_html_element",h)}},e.prototype.removeCommand=function(){this.remove()},e.prototype.remove=function(t){var e=[];e=e.concat(this.selectedItems.nodes,this.selectedItems.connectors);var i,n=!1;if(t){if((t=this.nameTable[t.id])&&(sr(t)||this.diagramActions&Lh.Clear)){if(this.bpmnModule&&this.bpmnModule.checkAndRemoveAnnotations(t,this))return void this.refreshCanvasLayers();if(i={element:t,cause:this.diagramActions,state:"Changing",type:"Removal",cancel:!1},this.diagramActions&Lh.Clear||this.triggerEvent(Ph.collectionChange,i),!i.cancel){if(!(this.diagramActions&Lh.UndoRedo)&&(t instanceof gp||t instanceof Vd)){var o={type:"CollectionChanged",changeType:"Remove",undoObject:ie(t),redoObject:ie(t),category:"Internal"};this.diagramActions&Lh.Clear||e.length>0&&this.undoRedoModule&&!this.layout.type&&(this.historyList.startGroupAction(),n=!0),t instanceof gp&&this.removeDependentConnector(t),this.diagramActions&Lh.Clear||this.addHistoryEntry(o)}t.children&&this.deleteGroup(t),t.parentId&&this.deleteChild(t);var r=void 0;this.diagramActions=this.diagramActions|Lh.PublicMethod;var s=this.nameTable[t.id];s instanceof gp?("Bpmn"===s.shape.type&&this.bpmnModule&&this.bpmnModule.removeBpmnProcesses(s,this),-1!==(r=this.nodes.indexOf(s))&&(this.nodes.splice(r,1),this.updateNodeEdges(s))):(-1!==(r=this.connectors.indexOf(s))&&this.connectors.splice(r,1),this.updateEdges(s),this.spliceConnectorEdges(t,!0),this.spliceConnectorEdges(t,!1)),n&&this.historyList.endGroupAction(),Rs(this,s)&&this.unSelect(s),this.removeObjectsFromLayer(t),this.currentDrawingObject&&(this.currentDrawingObject.wrapper=void 0),delete this.nameTable[t.id],this.removeElements(s),"SVG"!==this.mode&&this.refreshDiagramLayer(),this.diagramActions&Lh.Clear||(this.removeFromAQuad(s),i={element:t,cause:this.diagramActions,state:"Changed",type:"Removal",cancel:!1},this.triggerEvent(Ph.collectionChange,i),this.resetTool())}}}else if(e.length>0){this.undoRedoModule&&(this.historyList.startGroupAction(),n=!0);for(var a=0;a<e.length;a++){e[a];this.nameTable[e[a].id]&&this.remove(e[a])}n&&this.historyList.endGroupAction(),this.clearSelection()}},e.prototype.deleteChild=function(t,e){var i;if(e=e?this.nameTable[e.id]:this.nameTable[t.parentId],i="string"==typeof t?t:t.id,e&&e.children){for(var n=0;n<e.children.length;n++)e.children[n]===i&&(e.children.splice(n,1),e.wrapper.children.splice(n,1));e.wrapper.measure(new nh),e.wrapper.arrange(e.wrapper.desiredSize)}},e.prototype.addChild=function(t,e){var i,n=this.nameTable[t.id];n.children&&("string"==typeof e?this.nameTable[e]&&(i=e):(i=e.id=e.id||te(),this.add(e)),i&&(this.nameTable[i].parentId=n.id,n.children.push(i),n.wrapper.children.push(this.nameTable[i].wrapper),n.wrapper.measure(new nh),n.wrapper.arrange(n.wrapper.desiredSize)))},e.prototype.clear=function(){this.clearObjects()},e.prototype.clearObjects=function(t){var e=[];e=t||(e=e.concat(this.nodes)).concat(this.connectors),this.diagramActions=this.diagramActions|Lh.Clear;for(var i=0,n=e;i<n.length;i++){var o=n[i];this.nameTable[o.id]&&this.remove(o)}this.diagramActions=this.diagramActions&~Lh.Clear,this.spatialSearch=new du(this.nameTable),this.initHistory()},e.prototype.startEditCommad=function(){this.startTextEdit()},e.prototype.startTextEdit=function(t,e){if(!wr(this)||yr(this)){var i=void 0,n=void 0,o=void 0,r=void 0,s=void 0,a=this.scroller.transform;if(t||(t=this.selectedItems.nodes[0]?this.selectedItems.nodes[0]:this.selectedItems.connectors[0]),t){var l=!1;if(this.bpmnModule&&(s=this.bpmnModule.getTextAnnotationWrapper(t,e))&&(t=this.nameTable[t.id.split("_textannotation_")[0]]),s?l=!0:("Text"!==t.shape.type&&0===t.annotations.length&&(this.activeLabel.isGroup=!0,this.startGroupAction(),this.addLabels(t,[{id:te(),content:""}])),!e&&("Text"!==t.shape.type&&t.annotations.length>0||"Text"===t.shape.type)&&(e="Text"===t.shape.type?t.wrapper.children[0].id.split("_")[1]:t.annotations[0].id),e&&(s=this.getWrapper(t.wrapper,e))),t&&s&&(!Ar(s,t)||l)){var h=s.style,c=void 0;c=90>(c=s.bounds.width<t.wrapper.bounds.width?s.bounds.width:t.wrapper.bounds.width)?90:c;var d=document.createElement("div"),p=document.createElement("textarea");d.appendChild(p),i=s.content,(n=Le(s.style,i,void 0,void 0,c)).isEmpty()&&(n="Text"!==t.shape.type?new nh(xs(t,s.id.split(t.id+"_")[1]).width||50,s.style.fontSize):new nh(t.width>50?50:t.width,s.style.fontSize)),n.width=Math.max(n.width,50),o=(s.bounds.center.x+a.tx)*a.scale-n.width/2-2.5,r=(s.bounds.center.y+a.ty)*a.scale-n.height/2-3,ii(d,{id:this.element.id+"_editTextBoxDiv",style:"position: absolute;left:"+o+"px;top:"+r+"px;width:"+(n.width+1)+"px;height:"+n.height+"px; containerName:"+t.id+";"}),ii(p,{id:this.element.id+"_editBox",style:"width:"+(n.width+1)+"px;height:"+n.height+"px;resize: none;outline: none;overflow: hidden;font-family:"+h.fontFamily+";font-size:"+h.fontSize+"px;text-align:"+s.style.textAlign.toLocaleLowerCase()+";",class:"e-diagram-text-edit"}),p.style.fontWeight=h.bold?"bold":"",p.style.fontStyle=h.italic?"italic":"",p.style.textDecoration=h.textDecoration?h.textDecoration:"",p.appendChild(document.createTextNode(i)),this.activeLabel.parentId=t.id,this.activeLabel.id=e,s.visible=!1,this.updateDiagramObject(t),this.diagramActions=this.diagramActions|Lh.TextEdit,this.diagramCanvas.appendChild(d),Ma.add(p,"input",this.eventHandler.inputChange,this.eventHandler),Ma.add(p,"focusout",this.focusOutEdit,this),p.focus(),p.select()}}}},e.prototype.doLayout=function(){var t,e=!1,i=this.isProtectedOnChange;this.protectPropertyChange(!0);var n={x:this.scroller.viewPortWidth,y:this.scroller.viewPortHeight};if(this.organizationalChartModule?(t=this.organizationalChartModule.updateLayout(this.nodes,this.nameTable,this.layout,n,this.dataSourceSettings.id),e=!0):this.mindMapChartModule?(this.mindMapChartModule.updateLayout(this.nodes,this.nameTable,this.layout,n,this.dataSourceSettings.id,this.dataSourceSettings.root),e=!0):this.radialTreeModule?(this.radialTreeModule.updateLayout(this.nodes,this.nameTable,this.layout,n),e=!0):this.symmetricalLayoutModule?(this.symmetricalLayoutModule.maxIteration=this.layout.maxIteration,this.symmetricalLayoutModule.springLength=this.layout.springLength,this.symmetricalLayoutModule.springFactor=this.layout.springFactor,this.symmetricalLayoutModule.updateLayout(this.nodes,this.connectors,this.symmetricalLayoutModule,this.nameTable,this.layout,n),e=!0):this.complexHierarchicalTreeModule&&(this.complexHierarchicalTreeModule.doLayout(this.nodes,this.nameTable,this.layout,n),e=!0),e){this.preventUpdate=!0;for(var o={},r=0,s=this.nodes;r<s.length;r++){var a=s[r];if(this.updateIcon(a),this.updateDefaultLayoutIcons(a),this.nodePropertyChange(a,{},{offsetX:a.offsetX,offsetY:a.offsetY},!0),a.wrapper.measure(new nh(a.wrapper.width,a.wrapper.height)),a.wrapper.arrange(a.wrapper.desiredSize),a.inEdges.length>0)for(var l=0;l<a.inEdges.length;l++)o[(u=this.nameTable[a.inEdges[l]]).id]=u;if(a.outEdges.length>0)for(var h=0;h<a.outEdges.length;h++){var c=this.nameTable[a.outEdges[h]];o[c.id]=c}}for(var d=0,p=Object.keys(o);d<p.length;d++){var u=o[p[d]];fs(u,this.getPoints(u)),u.wrapper.measure(new nh(void 0,void 0)),u.wrapper.arrange(u.wrapper.desiredSize),this.updateQuad(u)}this.preventUpdate=!1,this.updatePage(),this.refreshDiagramLayer()}return i||this.protectPropertyChange(i),t},e.prototype.saveDiagram=function(){return as(this)},e.prototype.loadDiagram=function(t){return ls(t,this)},e.prototype.exportDiagram=function(t){return this.printandExportModule?this.printandExportModule.exportDiagram(t):""},e.prototype.print=function(t){this.printandExportModule&&this.printandExportModule.print(t)},e.prototype.addPorts=function(t,e){var i;e.length>1&&this.startGroupAction();for(var n=0;n<e.length;n++)if(i=new dc(t,"ports",e[n],!0),t.ports.push(i),t.wrapper.children.push(t.initPortWrapper(t.ports[t.ports.length-1])),!(this.diagramActions&Lh.UndoRedo||this.diagramActions&Lh.Group)){var o={type:"PortCollectionChanged",changeType:"Insert",undoObject:ie(i),redoObject:ie(t),category:"Internal"};this.addHistoryEntry(o)}e.length>1&&this.endGroupAction(),t.wrapper.measure(new nh(t.width,t.height)),t.wrapper.arrange(t.wrapper.desiredSize),this.updateDiagramObject(t)},e.prototype.addLabels=function(t,e){var i,n=t.wrapper;e.length>1&&this.startGroupAction();for(var o=0;o<e.length;o++){if(t instanceof gp)if(i=new fc(t,"annotations",e[o],!0),t.annotations.push(i),t.children)for(var r=t,s=0;s<r.wrapper.children.length;s++)"group_container"===r.wrapper.children[s].id&&r.wrapper.children[s].children.push(t.initAnnotationWrapper(t.annotations[t.annotations.length-1]));else n.children.push(t.initAnnotationWrapper(t.annotations[t.annotations.length-1]));else if(t instanceof Vd){i=new vc(t,"annotations",e[o],!0),t.annotations.push(i);var a=n.children[0],l=new ah(a.offsetX-a.width/2,a.offsetY-a.height/2,a.width,a.height);n.children.push(t.getAnnotationElement(t.annotations[t.annotations.length-1],t.intermediatePoints,l,this.getDescription))}if(!(this.diagramActions&Lh.UndoRedo||this.diagramActions&Lh.Group)){var h={type:"LabelCollectionChanged",changeType:"Insert",undoObject:ie(i),redoObject:ie(t),category:"Internal"};this.addHistoryEntry(h)}}e.length>1&&this.endGroupAction(),t.wrapper.measure(new nh(n.width,n.height)),t.wrapper.arrange(n.desiredSize),this.updateDiagramObject(t)},e.prototype.removeLabels=function(t,e){e.length>1&&this.startGroupAction();for(var i=e.length-1;i>=0;i--)for(var n=0;n<t.wrapper.children.length;n++){var o=t.wrapper.children[n];if(o instanceof Fh&&o.id.match("_"+e[i].id+"$")){for(var r=0;r<t.annotations.length;r++)if(o.id.match("_"+t.annotations[r].id+"$")){if(!(this.diagramActions&Lh.UndoRedo)){var s={type:"LabelCollectionChanged",changeType:"Remove",undoObject:ie(t.annotations[r]),redoObject:ie(t),category:"Internal"};this.addHistoryEntry(s)}t.annotations.splice(r,1)}if(t.wrapper.children.splice(n,1),"SVG"===this.mode){var a=Ae(o.id);if(a){var l=Ae(o.id);l.parentNode.removeChild(l)}Ae(o.id+"_text")&&(a=Ae(o.id+"_text")).parentNode.removeChild(a)}else this.refreshCanvasLayers()}}e.length>1&&this.endGroupAction()},e.prototype.removePorts=function(t,e){e.length>1&&this.startGroupAction();for(var i=0;i<e.length;i++)for(var n=0;n<t.wrapper.children.length;n++){var o=t.wrapper.children[n];if(o instanceof Hh&&o.id.match("_"+e[i].id+"$")){for(var r=0;r<t.ports.length;r++)if(o.id.match("_"+t.ports[r].id+"$")){if(!(this.diagramActions&Lh.UndoRedo)){var s={type:"PortCollectionChanged",changeType:"Remove",undoObject:ie(t.ports[r]),redoObject:ie(t),category:"Internal"};this.addHistoryEntry(s)}t.ports.splice(r,1)}if(t.wrapper.children.splice(n,1),"SVG"===this.mode){var a=Ae(o.id);a.parentNode.removeChild(a)}else this.refreshCanvasLayers()}}e.length>1&&this.endGroupAction()},e.prototype.getSizeValue=function(t,e){var i;if(i=t.toString().indexOf("px")>0?t.toString():t.toString().indexOf("%")>0?void 0!==e?"100%":t.toString():t.toString()+"px",e){zr(this);i="calc("+i+" - "+e+"px)"}return i},e.prototype.renderRulers=function(){this.rulerSettings.showRulers?(Dr(this),Br(this,!0),Br(this,!1)):Hr(this)},e.prototype.intOffPageBackground=function(){var t=new nh;t=zr(this);var e=document.getElementById(this.element.id+"content"),i=this.getSizeValue(this.width,t.width),n=this.getSizeValue(this.height,t.height),o=this.rulerSettings.showRulers?"width:"+i+"; height:"+n+";top:"+t.height+"px;left:"+t.width+"px;overflow: scroll;position:absolute;overflow:auto;":"width:"+i+"; height:"+n+";position:absolute; left:0px;  top:0px;overflow: auto;",r={id:this.element.id+"content",tabindex:"0",style:o};e?(this.diagramCanvas=e,this.diagramCanvas.setAttribute("style",o)):(this.diagramCanvas=Ye("div",r),this.element.appendChild(this.diagramCanvas)),this.diagramCanvas.style.background=this.backgroundColor},e.prototype.initDiagram=function(){this.intOffPageBackground(),ii(this.element,{style:"width:"+this.getSizeValue(this.width)+"; height:"+this.getSizeValue(this.height)+";position:relative;overflow:hidden;"})},e.prototype.renderBackgroundLayer=function(t,e){var i=this.createSvg(this.element.id+"_backgroundLayer_svg",t.width,t.height);i.setAttribute("style",e);var n=Ge("g",{id:this.element.id+"_backgroundImageLayer",class:"e-background-image-layer"});i.appendChild(n);var o=Ge("g",{id:this.element.id+"_backgroundLayer",class:"e-background-layer"});i.appendChild(o),this.diagramCanvas.appendChild(i)},e.prototype.renderGridLayer=function(t,e){var i=this.createSvg(this.element.id+"_gridline_svg",t.width,t.height);i.setAttribute("class","e-grid-layer");var n=Ge("g",{id:this.element.id+"_gridline",width:"100%",height:"100%"}),o=Ge("rect",{id:this.element.id+"_grid_rect",x:"0",y:"0",width:"100%",height:"100%",fill:"url(#"+this.element.id+"_pattern)"});n.appendChild(o),i.appendChild(n),this.diagramCanvas.appendChild(i),ei(i,{style:e})},e.prototype.renderDiagramLayer=function(t,e){var i;if(this.diagramLayerDiv=document.createElement("div"),i={id:this.element.id+"_diagramLayer_div",style:"width:"+t.width+"px; height:"+t.height+"px;"+e},ii(this.diagramLayerDiv,i),"SVG"===this.mode){var n=this.createSvg(this.element.id+"_diagramLayer_svg",t.width,t.height);n.setAttribute("style"," pointer-events: none; "),n.setAttribute("class","e-diagram-layer");var o=Ge("g",{id:this.element.id+"_diagramLayer"}),r=Ge("g",{});this.diagramLayer=o,o.setAttribute("style","pointer-events: all;"),r.appendChild(o),n.appendChild(r),this.diagramLayerDiv.appendChild(n)}else this.diagramLayer=ch.createCanvas(this.element.id+"_diagram",t.width,t.height),this.diagramLayer.setAttribute("style","position:absolute;left:0px;top:0px;"),this.diagramLayerDiv.appendChild(this.diagramLayer);this.diagramCanvas.appendChild(this.diagramLayerDiv)},e.prototype.initLayers=function(){var t="position:absolute;top:0px;left:0px;overflow:hidden;pointer-events:none;",e=document.getElementById(this.element.id).getBoundingClientRect(),i=Qe();this.scroller.scrollerWidth=i,this.scroller.setViewPortSize(e.width,e.height),this.renderRulers(),ni(),this.renderBackgroundLayer(e,t),this.renderGridLayer(e,t),this.renderDiagramLayer(e,t),this.renderHTMLLayer(e,t),this.renderPortsExpandLayer(e,t),this.renderNativeLayer(e,t),this.renderAdornerLayer(e,t)},e.prototype.renderAdornerLayer=function(t,e){var i=Ye("div",{id:this.element.id+"_diagramAdornerLayer",style:"width:"+t.width+"px;height:"+t.height+"px;"+e}),n=this.createSvg(this.element.id+"_diagramAdorner_svg",t.width,t.height);n.setAttribute("class","e-adorner-layer"),n.setAttribute("style","pointer-events:none;"),this.adornerLayer=Ge("g",{id:this.element.id+"_diagramAdorner"}),this.adornerLayer.setAttribute("style"," pointer-events: all; "),n.appendChild(this.adornerLayer),i.appendChild(n),this.diagramCanvas.appendChild(i);var o=Ge("g",{id:this.element.id+"_SelectorElement"});this.adornerLayer.appendChild(o),ei(n,{style:"pointer-events:none;"})},e.prototype.renderPortsExpandLayer=function(t,e){var i=this.createSvg(this.element.id+"_diagramPorts_svg",t.width,t.height);i.setAttribute("class","e-ports-expand-layer");var n=Ge("g",{id:this.element.id+"_diagramPorts",class:"e-ports-layer",style:"pointer-events: all;"});i.appendChild(n);var o=Ge("g",{id:this.element.id+"_diagramExpander",class:"e-expand-layer",style:"pointer-events: all;"});i.appendChild(o),this.diagramCanvas.appendChild(i),ei(i,{style:e})},e.prototype.renderHTMLLayer=function(t,e){this.htmlLayer=Ye("div",{id:this.element.id+"_htmlLayer",style:"width:"+t.width+"px; height:"+t.height+"px;position:absolute;top:0px;left:0px;overflow:hidden;pointer-events:none;",class:"e-html-layer"});var i=Ye("div",{id:this.element.id+"_htmlLayer_div",style:"position:absolute;top:0px;left:0px;pointer-events:all;"});this.htmlLayer.appendChild(i),this.diagramCanvas.appendChild(this.htmlLayer)},e.prototype.renderNativeLayer=function(t,e){var i=this.createSvg(this.element.id+"_nativeLayer_svg",t.width,t.height),n=Ge("g",{id:this.element.id+"_nativeLayer",style:"pointer-events:all;"});i.appendChild(n),this.diagramLayerDiv.appendChild(i),ei(i,{class:"e-native-layer",style:e})},e.prototype.createSvg=function(t,e,i){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");return ei(n,{id:t,width:e,height:i}),n},e.prototype.initObjects=function(t){this.isLoading||this.initData(),this.initLayerObjects(),this.updateBridging(t)},e.prototype.initLayerObjects=function(){for(var t=this.layers.length>1,e=[],i={},n={},o=[],r=0,s=this.nodes;r<s.length;r++)(x=s[r]).id=x.id||te(),this.addToLayer(x,t),i[x.id]=x;for(var a=0,l=this.connectors;a<l.length;a++)(x=l[a]).id=x.id||te(),this.addToLayer(x,t),i[x.id]=x;for(var h=0,c=this.layers;h<c.length;h++){for(var d=0,p=(S=c[h]).objects;d<p.length;d++)if(i[x=p[d]])if(i[x]instanceof Vd)if((E=i[x]).sourceID&&E.targetID){var u=i[E.sourceID],g=i[E.targetID];u&&u.wrapper&&g&&g.wrapper?this.initConnectors(i[x],S):e.push(i[x])}else this.initConnectors(i[x],S);else i[x].children?o.push(x):i[x].shape instanceof up&&i[x].shape.activity.subProcess.processes&&i[x].shape.activity.subProcess.processes.length>0?n[i[x].id]=x:this.initNodes(i[x],S);if(this.bpmnModule)for(var m=0,f=this.bpmnModule.textAnnotationConnectors;m<f.length;m++){x=f[m];this.initConnectors(x,S,!1)}}for(var v=0,y=Object.keys(n);v<y.length;v++){x=y[v];this.initObject(i[x]),this.bpmnModule.updateDocks(i[x],this)}for(var b=0,w=o;b<w.length;b++){var x=w[b],S=this.commandHandler.getObjectLayer(x);this.initNodes(i[x],S)}for(var C=0,L=e;C<L.length;C++){var E=L[C],S=this.commandHandler.getObjectLayer(E.id);this.initConnectors(E,S)}},e.prototype.addToLayer=function(t,e){var i;e&&(i=this.commandHandler.getObjectLayer(t.id)),e&&i||-1===this.activeLayer.objects.indexOf(t.id)&&this.activeLayer.objects.push(t.id),this.setZIndex(i||this.activeLayer,t)},e.prototype.updateLayer=function(t){for(var e=0,i=Object.keys(t.layers);e<i.length;e++){for(var n=i[e],o=0,r=this.layers[n].objects;o<r.length;o++){var s=r[o],a=this.nameTable[s];void 0!==t.layers[n].visible?this.updateElementVisibility(a.wrapper,a,t.layers[n].visible):!0===t.layers[n].lock&&this.unSelect(a)}void 0!==t.layers[n].lock&&(this.layers[n].lock=t.layers[n].lock)}"SVG"!==this.mode&&this.refreshDiagramLayer()},e.prototype.updateScrollSettings=function(t){var e=-this.scroller.horizontalOffset+t.scrollSettings.horizontalOffset||0,i=this.scroller.verticalOffset-t.scrollSettings.verticalOffset||0,n={VerticalOffset:this.scrollSettings.verticalOffset,HorizontalOffset:this.scrollSettings.horizontalOffset,ViewportHeight:this.scrollSettings.viewPortHeight,ViewportWidth:this.scrollSettings.viewPortWidth,CurrentZoom:this.scroller.currentZoom};0===e&&0===i||this.pan(e,i);var o={oldValue:n,newValue:{VerticalOffset:this.scrollSettings.verticalOffset,HorizontalOffset:this.scrollSettings.horizontalOffset,ViewportHeight:this.scrollSettings.viewPortHeight,ViewportWidth:this.scrollSettings.viewPortWidth,CurrentZoom:this.scroller.currentZoom},source:this};this.triggerEvent(Ph.scrollChange,o)},e.prototype.initData=function(){this.dataBindingModule&&(this.dataSourceSettings.dataManager&&this.dataSourceSettings.dataManager.dataSource&&void 0!==this.dataSourceSettings.dataManager.dataSource.url?this.dataBindingModule.initSource(this.dataSourceSettings,this):this.dataBindingModule.initData(this.dataSourceSettings,this))},e.prototype.initNodes=function(t,e){this.preventUpdate=!0,this.initObject(t,e),this.preventUpdate=!1},e.prototype.initConnectors=function(t,e,i){this.preventUpdate=!0,this.initObject(t,e,i),this.updateEdges(t),this.preventUpdate=!1},e.prototype.setZIndex=function(t,e){var i=t;if(-1===e.zIndex){for(;i.zIndexTable[i.objectZIndex+1];)t.objectZIndex++;e.zIndex=++i.objectZIndex}else{var n=e.zIndex;if(i.zIndexTable[n])for(var o=Object.keys(i.zIndexTable).length,r=0;r<o;r++)if(r===n){for(var s=o;s>n;s--)i.zIndexTable[s]=i.zIndexTable[s-1],this.nameTable[i.zIndexTable[s]]&&(this.nameTable[i.zIndexTable[s]].zIndex=s);i.zIndexTable[r]=e.id}}},e.prototype.initializeDiagramLayers=function(){for(var t=0,e=this.layers;t<e.length;t++){var i=e[t];i.zIndex=this.layers.indexOf(i),this.layerZIndexTable[i.zIndex]=i.id}if(0===this.layers.length){var n={id:"default_layer",visible:!0,lock:!1,objects:[],zIndex:0,objectZIndex:-1,zIndexTable:{}};this.commandHandler.addLayer(n)}this.setActiveLayer(this.layers[this.layers.length-1].id)},e.prototype.resetTool=function(){this.eventHandler.resetTool()},e.prototype.initObject=function(t,e,i){if(void 0===i&&(i=!0),void 0!==t){if(i&&(e||(this.addToLayer(t,!1),e=this.activeLayer),(t instanceof gp||t instanceof Vd)&&this.setZIndex(e,t)),t instanceof gp)i&&((n=fe(this.getNodeDefaults))&&(o=n(t,this))&&o!==t&&re(o,t),this.initNode(t));else if(t instanceof Vd){var n=fe(this.getConnectorDefaults);if(n){var o=n(t,this);o&&o!==t&&re(o,t),t.segments.length&&t.type!==t.segments[0].type&&(t.segments=[])}var r=this.nameTable[t.sourceID],s=this.nameTable[t.targetID];void 0!==r&&gr(r)&&(t.sourceWrapper=this.getEndNodeWrapper(r,t,!0),t.sourcePortID&&(t.sourcePortWrapper=this.getWrapper(r.wrapper,t.sourcePortID))),void 0!==s&&ur(s)&&(t.targetWrapper=this.getEndNodeWrapper(s,t,!1),t.targetPortID&&(t.targetPortWrapper=this.getWrapper(s.wrapper,t.targetPortID))),i||fs(t,t.getConnectorPoints(t.type)),i&&t.init(this),t.wrapper.measure(new nh(void 0,void 0)),t.wrapper.arrange(t.wrapper.desiredSize)}if(this.bpmnModule&&t instanceof gp&&"Bpmn"===t.shape.type&&t.shape.annotations.length>0&&this.bpmnModule.updateQuad(t,this),i){if(!this.commandHandler.checkBoundaryConstraints(void 0,void 0,t.wrapper.bounds))for(var a=t instanceof gp?this.nodes:this.connectors,l=0;l<=a.length;l++)a[l]&&t.id===a[l].id&&a.splice(l,1);e.zIndexTable[t.zIndex]=t.id}if(this.nameTable[t.id]=t,t instanceof gp&&t.children){this.updateGroupOffset(t),this.groupTable[t.id]=t.children;for(l=0;l<t.children.length;l++)(a=this.nameTable[t.children[l]]).parentId=t.id;!this.isLoading&&t.rotateAngle&&this.commandHandler.rotateObjects(t,[t],t.rotateAngle,{x:t.offsetX,y:t.offsetY},!1)}this.updateQuad(t)}!1===t.visible&&this.updateElementVisibility(t.wrapper,t,!1)},e.prototype.updateDefaultLayoutIcons=function(t){"OrganizationalChart"!==this.layout.type&&"HierarchicalTree"!==this.layout.type&&"ComplexHierarchicalTree"!==this.layout.type||(this.updateDefaultLayoutIcon(t,t.expandIcon),this.updateDefaultLayoutIcon(t,t.collapseIcon))},e.prototype.updateDefaultLayoutIcon=function(t,e){if("None"!==e.shape&&"Auto"===e.horizontalAlignment&&"Auto"===e.verticalAlignment&&.5===e.offset.x&&1===e.offset.y){var i=this.getWrapper(t.wrapper,"icon_content"),n=void 0,o=void 0;"TopToBottom"===this.layout.orientation||"BottomToTop"===this.layout.orientation?(n=.5,o="TopToBottom"===this.layout.orientation?1:0):"RightToLeft"!==this.layout.orientation&&"LeftToRight"!==this.layout.orientation||(n="LeftToRight"===this.layout.orientation?1:0,o=.5),i.setOffsetWithRespectToBounds(n,o,"Fraction"),i.horizontalAlignment="Center",i.verticalAlignment="Center",t.wrapper.measure(new nh(t.wrapper.width,t.wrapper.height)),t.wrapper.arrange(t.wrapper.desiredSize)}},e.prototype.updateGroupOffset=function(t){(t.children&&t.children.length>0||t.processId)&&(this.nameTable[t.id].offsetX=t.wrapper.offsetX,this.nameTable[t.id].offsetY=t.wrapper.offsetY,t.children&&t.children.length>0&&(this.nameTable[t.id].width=t.wrapper.actualSize.width,this.nameTable[t.id].height=t.wrapper.actualSize.height))},e.prototype.initNode=function(t){var e,i=t.initContainer(),n=new sc;if(i.children||(i.children=[]),t.children){i.measureChildren=!1;for(var o=0;o<t.children.length;o++)this.nameTable[t.children[o]]&&i.children.push(this.nameTable[t.children[o]].wrapper);n.id="group_container",n.style.fill="none",n.style.strokeColor="none",n.horizontalAlignment="Stretch",n.verticalAlignment="Stretch",n.children=[],i.children.push(n)}else{var r=fe(this.setNodeTemplate);r&&(e=r(t,this)),e||(e=t.init(this)),i.children.push(e)}var s;s=fe(this.getDescription),(t.children?i:e).description=s||(t.annotations.length?t.annotations[0].content:t.id);var a=t.children?n:i;t.initAnnotations(this.getDescription,a),t.initPorts(this.getDescription,a),t.initIcons(this.getDescription,this.layout,a),i.measure(new nh(t.width,t.height)),i.arrange(i.desiredSize)},e.prototype.canExecute=function(){return!0},e.prototype.initViews=function(){this.isLoading||(this.views.push(this.element.id),this.views[this.element.id]=this)},e.prototype.initCommands=function(){var t=this.commandManager.commands,e={copy:{execute:this.copyCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:Ch.C,keyModifiers:Sh.Control}},paste:{execute:this.pasteCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:Ch.V,keyModifiers:Sh.Control}},cut:{execute:this.cutCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:Ch.X,keyModifiers:Sh.Control}},delete:{execute:this.removeCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:Ch.Delete}},selectAll:{execute:this.selectAll.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:Ch.A,keyModifiers:Sh.Control}},undo:{execute:this.undo.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:Ch.Z,keyModifiers:Sh.Control}},redo:{execute:this.redo.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:Ch.Y,keyModifiers:Sh.Control}},nudgeUp:{execute:this.nudgeCommand.bind(this,"Up"),canExecute:this.canExecute.bind(this),gesture:{key:Ch.Up},parameter:"up"},nudgeRight:{execute:this.nudgeCommand.bind(this,"Right"),canExecute:this.canExecute.bind(this),gesture:{key:Ch.Right},parameter:"right"},nudgeDown:{execute:this.nudgeCommand.bind(this,"Down"),canExecute:this.canExecute.bind(this),gesture:{key:Ch.Down},parameter:"down"},nudgeLeft:{execute:this.nudgeCommand.bind(this,"Left"),canExecute:this.canExecute.bind(this),gesture:{key:Ch.Left},parameter:"left"},startEdit:{execute:this.startEditCommad.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:Ch.F2}},endEdit:{execute:this.endEditCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:Ch.Escape}},focusToNextItem:{canExecute:this.canExecute.bind(this),gesture:{key:Ch.Tab}},focusToPreviousItem:{canExecute:this.canExecute.bind(this),gesture:{key:Ch.Tab,keyModifiers:Sh.Control}},selectFocusedItem:{execute:this.startEditCommad.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:Ch.Enter}}};this.initCommandManager(t,e)},e.prototype.overrideCommands=function(t,e){for(var i,n=0,o=Object.keys(e);n<o.length;n++){var r=o[n];if(i=e[r],t.gesture.key===i.gesture.key&&t.gesture.keyModifiers===i.gesture.keyModifiers){delete e[r];break}}},e.prototype.initCommandManager=function(t,e){var i=0;if(t)for(i=0;i<t.length;i++)e[t[i].name]&&t[i]?(t[i].canExecute&&(e[t[i].name].canExecute=t[i].canExecute),t[i].execute&&(e[t[i].name].execute=t[i].execute),(t[i].gesture.key||t[i].gesture.keyModifiers)&&(e[t[i].name].gesture=t[i].gesture),""!==t[i].parameter&&(e[t[i].name].parameter=t[i].parameter)):(this.overrideCommands(t[i],e),e[t[i].name]={execute:t[i].execute,canExecute:t[i].canExecute,gesture:t[i].gesture,parameter:t[i].parameter});this.commands=e},e.prototype.updateNodeEdges=function(t){for(var e=0,i=t.inEdges;e<i.length;e++){r=i[e];this.nameTable[r]&&(this.nameTable[r].targetID="")}for(var n=0,o=t.outEdges;n<o.length;n++){var r=o[n];this.nameTable[r]&&(this.nameTable[r].sourceID="")}t.inEdges=[],t.outEdges=[]},e.prototype.updateIconVisibility=function(t,e){for(var i=0;i<t.wrapper.children.length;i++){var n=t.wrapper.children[i],o=n.id.split(t.id)[1];n.id&&o&&o.match("^_icon")&&(n.visible=e,this.updateDiagramContainerVisibility(n,e))}},e.prototype.updateEdges=function(t){if(void 0!==t.sourceID&&""!==t.sourceID&&((e=this.nameTable[t.sourceID])&&e.outEdges&&0===e.outEdges.length&&(e.outEdges=[]),e&&e.outEdges&&-1===e.outEdges.indexOf(t.id)&&e.outEdges.push(t.id)),void 0!==t.targetID&&""!==t.targetID){var e=this.nameTable[t.targetID];if(e&&e.inEdges&&0===e.inEdges.length&&(e.inEdges=[]),e&&e.inEdges&&-1===e.inEdges.indexOf(t.id)&&e.inEdges.push(t.id),e&&e.visible&&e.outEdges){var i=0!==e.outEdges.length;this.updateIconVisibility(e,i)}}},e.prototype.refreshDiagram=function(){this.initLayerObjects(),this.doLayout(),this.updateBridging(),this.scroller.setSize()},e.prototype.updateDiagramObject=function(t){for(var e,i=0,n=this.views;i<n.length;i++){var o=n[i];if("SVG"===(e=this.views[o]).mode&&this.diagramActions){var r=Xe(this.element.id),s=document.getElementById(e.element.id+"_diagramLayer");this.diagramRenderer.updateNode(t.wrapper,s,r,void 0)}else this.refreshCanvasDiagramLayer(e)}},e.prototype.getObjectsOfLayer=function(t){for(var e=[],i=0,n=t;i<n.length;i++){var o=n[i];this.nameTable[o]&&e.push(this.nameTable[o])}return e},e.prototype.refreshDiagramLayer=function(){for(var t,e=0,i=this.views;e<i.length;e++){var n=i[e];switch((t=this.views[n]).mode){case"SVG":this.refreshSvgDiagramLayer(t);break;case"Canvas":this.refreshCanvasLayers()}}},e.prototype.refreshCanvasLayers=function(){for(var t=0,e=this.views;t<e.length;t++){var i=e[t],n=this.views[i];this.refreshCanvasDiagramLayer(n)}},e.prototype.renderBasicElement=function(t){for(var e=Xe(t.element.id),i=0;i<this.basicElements.length;i++){var n=this.basicElements[i];n instanceof ic&&(n.prevRotateAngle=0),n.measure(new nh(n.width,n.height)),n.arrange(n.desiredSize),t.diagramRenderer.renderElement(n,t.diagramLayer,e)}},e.prototype.refreshElements=function(t){if(!this.isDestroyed){this.clearCanvas(t),t instanceof e&&(t.diagramLayer.getContext("2d").setTransform(t.scroller.currentZoom,0,0,t.scroller.currentZoom,0,0),t.diagramLayer.getContext("2d").scale(1.5,1.5));var i=Xe(t.element.id);this.spatialSearch.getPageBounds();this.renderDiagramElements(t.diagramLayer,t.diagramRenderer,i),t instanceof e&&(t.diagramLayer.style.transform="scale("+2/3+")",t.diagramLayer.style.transformOrigin="0 0"),this.renderTimer=null}},e.prototype.refreshCanvasDiagramLayer=function(t){var e=this;"SVG"===t.mode||this.isDestroyed||(this.basicElements.length>0&&this.renderBasicElement(t),this.diagramActions&&0!=(this.diagramActions&Lh.Render)?this.renderTimer||(this.renderTimer=setTimeout(function(){e.refreshElements(t)},40)):this.refreshElements(t))},e.prototype.updatePortVisibility=function(t,e,i){var n,o=!this.drawingObject||!this.drawingObject.shape;if(t instanceof gp&&o&&or(t)){for(var r=t.ports,s=!1,a=0;a<r.length;a++)n=this.getWrapper(t.wrapper,r[a].id),(e&lh.Hover||e&lh.Connect)&&ws(r[a],e)&&(n.visible=!i,s=!0);s&&this.updateDiagramObject(t)}},e.prototype.refreshSvgDiagramLayer=function(t){document.getElementById(t.element.id).getBoundingClientRect();for(var e,i=document.getElementById(t.element.id+"_diagramLayer"),n=Xe(t.element.id),o=0;o<this.basicElements.length;o++)(e=this.basicElements[o]).measure(new nh(e.width,e.height)),e.arrange(e.desiredSize),this.diagramRenderer.renderElement(e,i,n);this.renderDiagramElements(i,this.diagramRenderer,n)},e.prototype.renderDiagramElements=function(t,e,i,n){void 0===n&&(n=!0);for(var o=0,r=Object.keys(this.layerZIndexTable);o<r.length;o++)for(var s=r[o],a=this.commandHandler.getLayer(this.layerZIndexTable[s]),l=0,h=Object.keys(a.zIndexTable);l<h.length;l++){var c=h[l],d=this.nameTable[a.zIndexTable[c]].wrapper;this.nameTable[a.zIndexTable[c]].parentId||this.nameTable[a.zIndexTable[c]].processId||e.renderElement(d,t,i,!e.isSvgMode&&n?this.scroller.transform:void 0)}},e.prototype.updateBridging=function(t){if(this.bridgingModule)for(var e=0;e<this.connectors.length;e++){var i=this.connectors[e];this.bridgingModule.updateBridging(i,this);var n=this.connectors[e].wrapper,o=n.children[0],r=o.data;i.getSegmentElement(i,o),o.data!==r&&(n.measure(new nh),n.arrange(n.desiredSize),"SVG"!==this.mode||t||this.updateDiagramObject(i))}},e.prototype.setCursor=function(t){this.diagramRenderer.setCursor(this.diagramCanvas,t)},e.prototype.clearCanvas=function(t){var e,i;e=t.contentWidth||t.diagramLayer.width,i=t.contentHeight||t.diagramLayer.height,"SVG"!==t.mode&&ch.getContext(t.diagramLayer).clearRect(0,0,e,i)},e.prototype.updateScrollOffset=function(){this.scroller.setScrollOffset(this.diagramCanvas.scrollLeft,this.diagramCanvas.scrollTop),Nr(this)},e.prototype.setOffset=function(t,e){var i=document.getElementById(this.element.id+"content");i&&(i.scrollLeft=t,i.scrollTop=e)},e.prototype.setSize=function(t,e){if(this.diagramLayer&&!this.preventUpdate){var i=zr(this);t-=i.width,e-=i.height;var n=this.spatialSearch.getPageBounds();n.x*=this.scroller.currentZoom,n.y*=this.scroller.currentZoom,n.width*=this.scroller.currentZoom,n.height*=this.scroller.currentZoom;var o="SVG"===this.mode?1:1.5,r="SVG"===this.mode?Ie(this.element.id):this.diagramLayer;r.setAttribute("width",(o*t).toString()),r.setAttribute("height",(o*e).toString());var s={width:t.toString(),height:e.toString()};this.diagramLayerDiv.style.width=t+"px",this.diagramLayerDiv.style.height=e+"px",ei(He(this.element.id),s),ei(Ne(this.element.id),s);var a=Me(this.element.id);ei(a,s),a.parentNode.style.width=t+"px",a.parentNode.style.height=e+"px";var l=ze(this.element.id);ei(l,s),this.diagramRenderer.updateGrid(this.snapSettings,l,this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler),ei(je(this.element.id),s),this.htmlLayer.style.width=t+"px",this.htmlLayer.style.height=e+"px",this.diagramRenderer.transformLayers(this.scroller.transform,"SVG"===this.mode),"SVG"!==this.mode&&this.refreshDiagramLayer(),this.updateSelector(),this.renderPageBreaks(n)}},e.prototype.removePageBreaks=function(){if(this.diagramLayer){var t=Fe(this.element.id);if(t&&t.childNodes)for(var e=t.childNodes.length,i=0;i<e;i++)t.removeChild(t.childNodes[0])}},e.prototype.renderPageBreaks=function(t){this.removePageBreaks();var e=Fe(this.element.id);if(e){var i=0;t=this.scroller.getPageBounds(!0);var n=(this.scroller.transform.tx+t.x)*this.scroller.currentZoom,o=(this.scroller.transform.ty+t.y)*this.scroller.currentZoom,r=t.height*this.scroller.currentZoom,s=t.width*this.scroller.currentZoom;bp.renderSvgBackGroundImage(this.pageSettings.background,this.element,n,o,s,r);var a={id:e.id+"rect",x:n,y:o,height:r,width:s,angle:0,stroke:"",strokeWidth:1,fill:this.pageSettings.background.color,opacity:1,pivotX:0,pivotY:0,visible:!0,dashArray:"0"};if(this.diagramRenderer.drawRect(e,a),this.pageSettings.showPageBreaks){var l=this.scroller.getPageBreak(t);for(i=0;i<l.length;i++)this.diagramRenderer.drawLine(e,{class:"e-diagram-page-break",fill:"none",stroke:"#aaaaaa",strokeWidth:1,dashArray:"10 10",opacity:2,x:0,y:0,width:0,height:0,angle:0,pivotX:0,pivotY:0,visible:!0,startPoint:{x:(l[i].x1+this.scroller.transform.tx)*this.scroller.currentZoom,y:(l[i].y1+this.scroller.transform.ty)*this.scroller.currentZoom},endPoint:{x:(l[i].x2+this.scroller.transform.tx)*this.scroller.currentZoom,y:(l[i].y2+this.scroller.transform.ty)*this.scroller.currentZoom},id:l[i].y1===l[i].y2?"HorizontalLines":"VerticalLines"})}}},e.prototype.validatePageSize=function(){var t=0;"Portrait"===this.pageSettings.orientation?this.pageSettings.width>this.pageSettings.height&&(t=this.pageSettings.height,this.pageSettings.height=this.pageSettings.width,this.pageSettings.width=t):this.pageSettings.height>this.pageSettings.width&&(t=this.pageSettings.width,this.pageSettings.width=this.pageSettings.height,this.pageSettings.height=t)},e.prototype.setOverview=function(t,e){if(t)t&&(this.views.push(t.id),this.views[t.id]=t,t.renderDocument(t),t.diagramRenderer.setLayers(),t.updateView(t),this.renderNodes(t));else{for(var i=0;i<this.views.length;i++)this.views[i]===e&&(t=this.views[e]);this.views[e]=void 0;var n=this.views.indexOf(e);this.views.splice(n,1)}},e.prototype.renderNodes=function(t){if(t){var e=new bp(t.id,new dh,!1),i=document.getElementById(t.element.id+"_diagramLayer"),n=Xe(t.element.id);this.renderDiagramElements(i,t.diagramRenderer||e,n)}},e.prototype.updateThumbConstraints=function(t,e){for(var i=t.length,n=0;n<i;n++){var o=t[n],r=!1,s=!1,a=e.thumbsConstraints;o instanceof gp?(r="Bpmn"===o.shape.type&&"Activity"===o.shape.shape&&!1===o.shape.activity.subProcess.collapsed||"TextAnnotation"===o.shape.shape,s="Bpmn"===o.shape.type&&"TextAnnotation"===o.shape.shape,dr(o)&&a&vh.Rotate&&!r||(a&=~vh.Rotate),mr(o,"SouthEast")&&a&vh.ResizeSouthEast&&!s||(a&=~vh.ResizeSouthEast),mr(o,"NorthWest")&&a&vh.ResizeNorthWest&&!s||(a&=~vh.ResizeNorthWest),mr(o,"East")&&a&vh.ResizeEast&&!s||(a&=~vh.ResizeEast),mr(o,"West")&&a&vh.ResizeWest&&!s||(a&=~vh.ResizeWest),mr(o,"North")&&a&vh.ResizeNorth&&!s||(a&=~vh.ResizeNorth),mr(o,"South")&&a&vh.ResizeSouth&&!s||(a&=~vh.ResizeSouth),mr(o,"NorthEast")&&a&vh.ResizeNorthEast&&!s||(a&=~vh.ResizeNorthEast),mr(o,"SouthWest")&&a&vh.ResizeSouthWest&&!s||(a&=~vh.ResizeSouthWest)):(a|=vh.Default,lr(o)?a|=vh.ConnectorSource:a&=~vh.ConnectorSource,hr(o)?a|=vh.ConnectorTarget:a&=~vh.ConnectorTarget),e.thumbsConstraints=a}},e.prototype.renderSelector=function(t){var e=new nh,i=this.selectedItems;i.constraints;if(this.clearSelectorLayer(),this.commandHandler.hasSelection()){if(1===i.nodes.length&&0===i.connectors.length&&(i.rotateAngle=i.nodes[0].rotateAngle,i.pivot=i.nodes[0].pivot),i.wrapper.measure(e),i.wrapper.arrange(i.wrapper.desiredSize),i.width=i.wrapper.actualSize.width,i.height=i.wrapper.actualSize.height,i.offsetX=i.wrapper.offsetX,i.offsetY=i.wrapper.offsetY,0!==i.rotateAngle){for(var n=0,o=i.nodes;n<o.length;n++){var r=o[n];r.offsetX=r.wrapper.offsetX,r.offsetY=r.wrapper.offsetY}for(var s=0,a=i.connectors;s<a.length;s++)a[s]}this.spatialSearch.getPageBounds();var l=void 0;if(l=Re(this.element.id),i.thumbsConstraints=vh.Default,this.updateThumbConstraints(i.nodes,i),this.updateThumbConstraints(i.connectors,i),i.nodes.length+i.connectors.length===1){if(i.nodes[0]instanceof gp)this.diagramRenderer.renderResizeHandle(i.nodes[0].wrapper,l,i.thumbsConstraints,this.scroller.currentZoom,i.constraints,this.scroller.transform,void 0,or(i.nodes[0]));else if(i.connectors[0]instanceof Vd){var h=i.connectors[0];this.diagramRenderer.renderEndPointHandle(h,l,i.thumbsConstraints,i.constraints,this.scroller.transform,void 0!==h.sourceWrapper,void 0!==h.targetWrapper,!(!this.connectorEditingToolModule||!cr(h)))}}else this.diagramRenderer.renderResizeHandle(i.wrapper,l,i.thumbsConstraints,this.scroller.currentZoom,i.constraints,this.scroller.transform,void 0,or(i));this.diagramRenderer.renderUserHandler(i,l,this.scroller.transform)}},e.prototype.updateSelector=function(){this.spatialSearch.getPageBounds();var t=new nh,e=this.selectedItems,i=e.constraints;if(this.diagramActions&Lh.ToolAction||1!==this.selectedItems.nodes.length||(this.selectedItems.rotateAngle=this.selectedItems.nodes[0].rotateAngle,this.selectedItems.wrapper.rotateAngle=this.selectedItems.nodes[0].rotateAngle),void 0!==this.selectedItems&&(this.clearSelectorLayer(),null!==e.wrapper&&e.wrapper.children.length)){if(e.wrapper.measure(t),e.wrapper.arrange(e.wrapper.desiredSize),0!==e.rotateAngle||e.rotateAngle!==e.wrapper.prevRotateAngle)for(var n=0,o=e.nodes;n<o.length;n++){var r=o[n];r.offsetX=r.wrapper.offsetX,r.offsetY=r.wrapper.offsetY}e.width=e.wrapper.actualSize.width,e.height=e.wrapper.actualSize.height,e.offsetX=e.wrapper.offsetX,e.offsetY=e.wrapper.offsetY;var s=void 0;s=Re(this.element.id);var a=this.eventHandler.canHideResizers();if(e.thumbsConstraints=vh.Default,this.updateThumbConstraints(e.nodes,e),this.updateThumbConstraints(e.connectors,e),this.selectedItems.constraints&uh.UserHandle&&this.diagramRenderer.renderUserHandler(e,s,this.scroller.transform),e.nodes.length+e.connectors.length===1)if(e.connectors[0]instanceof Vd){var l=e.connectors[0];this.diagramRenderer.renderEndPointHandle(l,s,e.thumbsConstraints,i,this.scroller.transform,void 0!==l.sourceWrapper,void 0!==l.targetWrapper,!(!this.connectorEditingToolModule||!cr(l)))}else e.nodes[0]instanceof gp&&this.diagramRenderer.renderResizeHandle(e.nodes[0].wrapper,s,e.thumbsConstraints,this.scroller.currentZoom,e.constraints,this.scroller.transform,a,or(e.nodes[0]));else this.diagramRenderer.renderResizeHandle(e.wrapper,s,e.thumbsConstraints,this.scroller.currentZoom,e.constraints,this.scroller.transform,a,or(e))}},e.prototype.drawSelectionRectangle=function(t,e,i,n){this.clearSelectorLayer(),this.diagramRenderer.drawSelectionRectangle(t,e,i,n,this.adornerLayer,this.scroller.transform)},e.prototype.renderHighlighter=function(t){var e=Me(this.element.id);this.diagramRenderer.renderHighlighter(t,e,this.scroller.transform)},e.prototype.clearHighlighter=function(){var t=Me(this.element.id),e=t.getElementById(t.id+"_highlighter");e&&e.parentNode.removeChild(e)},e.prototype.getNodesConnectors=function(t){for(i=0;i<this.nodes.length;i++){var e=this.nodes[i];t.push(e)}for(var i=0;i<this.connectors.length;i++){var n=this.connectors[i];t.push(n)}return t},e.prototype.clearSelectorLayer=function(){var t=Me(this.element.id),e=(t.getElementById(t.id+"_highlighter"),t.getElementById(this.adornerLayer.id+"_selected_region"));e&&e.parentNode.removeChild(e),this.clearHighlighter();for(var i,n=Re(this.element.id).childNodes,o=n.length;o>0;o--)(i=n[o-1]).parentNode.removeChild(i)},e.prototype.getWrapper=function(t,e){var i;e=t.id+"_"+e;for(var n=t instanceof sc?t:this.getPortContainer(this.nameTable[t.id]),o=0;o<n.children.length;o++)e===n.children[o].id&&(i=n.children[o]);return i},e.prototype.getEndNodeWrapper=function(t,e,i){if("Bpmn"===t.shape.type&&t.wrapper.children[0]instanceof sc){if("Activity"===t.shape.shape){if(i&&"Transaction"===t.shape.activity.subProcess.type&&e.sourcePortID){var n=e.sourcePortID,o=t.wrapper.children[0].children[0].children[2];if(o.children)for(var r=0,s=o.children;r<s.length;r++){var a=s[r];if(a.visible&&a.id===t.id+"_"+n)return a.children[0]}}return t.wrapper.children[0].children[0].children[0]}return t.wrapper.children[0].children[0]}return this.containsMargin(t.wrapper.children[0])||t.children?t.wrapper:t.wrapper.children[0]},e.prototype.containsMargin=function(t){return t.margin&&(0!==t.margin.left||0!==t.margin.top||0!==t.margin.right||0!==t.margin.bottom)},e.prototype.focusOutEdit=function(){this.endEdit(!0)},e.prototype.endEditCommand=function(){this.endEdit()},e.prototype.endEdit=function(t){if(this.diagramActions&Lh.TextEdit){var e=document.getElementById(this.element.id+"_editBox"),i=e.value;Ma.remove(e,"input",this.eventHandler.inputChange),Ma.remove(e,"focusout",this.focusOutEdit);var n=document.getElementById(this.element.id+"_editTextBoxDiv"),o={oldValue:n.textContent,newValue:i,cancel:!1},r=!1,s=void 0;n.parentNode.removeChild(n);var a=void 0;if(this.bpmnModule&&(s=this.bpmnModule.isBpmnTextAnnotation(this.activeLabel,this),a=this.bpmnModule.getTextAnnotationWrapper(s,this.activeLabel.id),(r=!!s)&&n.textContent!==i&&(this.triggerEvent(Ph.textEdit,o),o.cancel||this.bpmnModule.updateTextAnnotationContent(s,this.activeLabel,i,this))),!r){s=this.nameTable[this.activeLabel.parentId];var l=this.eventHandler.isAddTextNode(s,!0);l||n.textContent===i||this.triggerEvent(Ph.textEdit,o),a||(a=this.getWrapper(s.wrapper,this.activeLabel.id));var h=xs(s,this.activeLabel.id);if(h.content===i||o.cancel||(h.content=i,this.dataBind(),this.updateSelector()),l&&(this.removeObjectsFromLayer(s),this.removeFromAQuad(s),delete this.nameTable[this.activeLabel.parentId],""!==i)){this.clearSelection();var c=ie(s);s=this.add(c),this.updateDiagramObject(s),this.commandHandler.select(this.nameTable[s.id])}}a.visible=!0,this.updateDiagramObject(s),this.diagramActions=this.diagramActions&~Lh.TextEdit,this.activeLabel.isGroup&&this.endGroupAction(),this.activeLabel={id:"",parentId:"",isGroup:!1}}},e.prototype.canLogChange=function(){return!(!(this.diagramActions&Lh.Render)||this.diagramActions&Lh.ToolAction||this.diagramActions&Lh.UndoRedo||this.diagramActions&Lh.PublicMethod)},e.prototype.modelChanged=function(t,e){return!!(t.connectors||e.connectors||t.nodes||e.connectors||t.pageSettings||e.pageSettings||t.bridgeDirection||e.bridgeDirection)},e.prototype.resetDiagramActions=function(t){var e=!!t;this.diagramActions&Lh.UndoRedo&&(!e||t===Lh.UndoRedo)&&(this.diagramActions=this.diagramActions&~Lh.UndoRedo),this.diagramActions&Lh.PublicMethod&&(!e||t===Lh.PublicMethod)&&(this.diagramActions=this.diagramActions&~Lh.PublicMethod)},e.prototype.removeNode=function(t){this.removeObjectsFromLayer(t),this.removeFromAQuad(this.nameTable[t.id]),delete this.nameTable[t.id],t.children&&delete this.groupTable[t.id],this.nodes.splice(this.nodes.indexOf(t),1)},e.prototype.deleteGroup=function(t){var e=[],i=[];t.children&&(i=this.commandHandler.getChildren(t,e));for(var n=0,o=i;n<o.length;n++){var r=o[n];this.nameTable[r.id]&&this.remove(r)}},e.prototype.updateObject=function(t,e,i){if(!(this.diagramActions&Lh.ToolAction)){var n=t.wrapper.children[0].bounds;if(!this.commandHandler.checkBoundaryConstraints(void 0,void 0,n))if(t instanceof gp){for(var o=e,r=0,s=Object.keys(i);r<s.length;r++)switch(h=s[r]){case"width":t.width=o.width;break;case"height":t.height=o.height;break;case"offsetX":t.offsetX=o.offsetX;break;case"offsetY":t.offsetY=o.offsetY;break;case"rotateAngle":t.rotateAngle=o.rotateAngle}this.nodePropertyChange(t,i,e)}else{for(var a=0,l=Object.keys(i);a<l.length;a++){var h=l[a],c=e,d=t.sourcePoint,p=t.targetPoint;switch(h){case"sourcePoint":d.x=c.sourcePoint.x||d.x,d.y=c.sourcePoint.y||d.y;break;case"targetPoint":p.x=c.targetPoint.x||p.x,p.y=c.targetPoint.y||p.y}}this.connectorPropertyChange(t,i,e)}}},e.prototype.nodePropertyChangeExtend=function(t,e,i,n){return void 0!==i.style&&"Bpmn"!==t.shape.type&&(cs(i.style,t.wrapper.children[0]),n=!0),void 0!==i.constraints&&(this.updateThumbConstraints(this.selectedItems.nodes,this.selectedItems),this.updateSelector(),n=!0),n},e.prototype.connectorSegmentChange=function(t,e){var i,n,o=!0;if(!1===e.equals(e,t.wrapper.bounds)&&t.outEdges.length>0)for(var r=0;r<t.outEdges.length;r++){var s=this.nameTable[t.outEdges[r]];if(o=""!==s.targetID?!this.commandHandler.isSelected(this.nameTable[s.targetID]):!this.commandHandler.isSelected(this.nameTable[s.id]),"Orthogonal"===s.type&&s.segments&&s.segments.length>1&&o){switch(s.segments[0].direction){case"Bottom":i=t.wrapper.bounds.bottomCenter.x-e.bottomCenter.x,n=t.wrapper.bounds.bottomCenter.y-e.bottomCenter.y;break;case"Top":i=t.wrapper.bounds.topCenter.x-e.topCenter.x,n=t.wrapper.bounds.topCenter.y-e.topCenter.y;break;case"Left":i=t.wrapper.bounds.middleLeft.x-e.middleLeft.x,n=t.wrapper.bounds.middleLeft.y-e.middleLeft.y;break;case"Right":i=t.wrapper.bounds.middleRight.x-e.middleRight.x,n=t.wrapper.bounds.middleRight.y-e.middleRight.y}this.commandHandler.dragSourceEnd(s,i,n,!0,null,"ConnectorSourceEnd",void 0,void 0,void 0,!0)}}},e.prototype.nodePropertyChange=function(t,e,i,n){var o,r=t.wrapper.outerBounds,s=t.wrapper.bounds,a=!1;if(void 0===i.width||t.children||(t.wrapper.children[0].width=i.width,o=!0,a=!0),void 0===i.height||t.children||(t.wrapper.children[0].height=i.height,o=!0,a=!0),o=this.nodePropertyChangeExtend(t,e,i,o),void 0!==i.constraints&&pr(e)!==pr(i)&&(t.wrapper.children[0].shadow=pr(t)?t.shadow:null),void 0!==i.offsetX&&(t.wrapper.offsetX=i.offsetX,o=!0,a=!0),void 0!==i.offsetY&&(t.wrapper.offsetY=i.offsetY,o=!0,a=!0),void 0!==i.pivot&&(t.wrapper.pivot=i.pivot,o=!0),void 0!==i.minWidth&&(t.wrapper.minWidth=i.minWidth,o=!0,a=!0),void 0!==i.minHeight&&(t.wrapper.minHeight=i.minHeight,o=!0,a=!0),void 0!==i.maxWidth&&(t.wrapper.maxWidth=i.maxWidth,o=!0,a=!0),void 0!==i.maxHeight&&(t.wrapper.maxHeight=i.maxHeight,o=!0,a=!0),void 0!==i.rotateAngle&&(t.wrapper.rotateAngle=i.rotateAngle,o=!0,a=!0),void 0!==i.backgroundColor&&(t.wrapper.style.fill=i.backgroundColor),void 0!==i.visible&&this.updateElementVisibility(t.wrapper,t,t.visible),void 0!==i.shape&&"Bpmn"!==t.shape.type&&(o=!0,us(i,t,e,this),a=!0),i.margin&&(o=!0,this.updateMargin(t,i),a=!0),(void 0!==i.shape&&void 0===i.shape.type||void 0!==i.width||void 0!==i.height||void 0!==i.style)&&"Bpmn"===t.shape.type&&this.bpmnModule&&(o=!0,a=!0,this.bpmnModule.updateBPMN(i,e,t,this)),void 0!==i.ports)for(var l=0,h=Object.keys(i.ports);l<h.length;l++){var c=h[l],d=Number(c);o=!0;var p=i.ports[c],u=t.ports[d];this.updatePort(p,u,t.wrapper)}if(void 0!==i.annotations||void 0!==i.width)for(var g=0,m=Object.keys(i.annotations||t.annotations);g<m.length;g++){var c=m[g],d=Number(c);o=!0;var p=i.annotations?i.annotations[c]:t.annotations,f=t.annotations[d];if(f){var v=!!t.width;this.updateAnnotation(p,f,t.wrapper,t,v)}}void 0===i.expandIcon&&void 0===i.collapseIcon&&void 0===i.isExpanded||(this.updateIcon(t),this.updateDefaultLayoutIcons(t),void 0!==i.isExpanded&&this.commandHandler.expandNode(t,!0,this),o=!0),void 0!==i.tooltip&&this.updateTooltip(t,i),o&&(this.diagramActions&Lh.ToolAction||this.checkSelectedItem(t)&&this.updateSelector(),void 0!==this.bpmnModule&&this.bpmnModule.updateTextAnnotationProp(t,{offsetX:e.offsetX||t.offsetX,offsetY:e.offsetY||t.offsetY},this),t.wrapper.measure(new nh(t.wrapper.bounds.width,t.wrapper.bounds.height)),t.wrapper.arrange(t.wrapper.desiredSize),this.updateObject(t,e,i),n?t&&t.visible&&t.outEdges&&this.updateIconVisibility(t,0!==t.outEdges.length):(this.connectorSegmentChange(t,s),a&&this.updateConnectorEdges(t)),void 0!==this.bpmnModule&&this.bpmnModule.updateDocks(t,this),this.updateGroupOffset(t),!1===r.equals(r,t.wrapper.outerBounds)&&this.updateQuad(t),!1===s.equals(s,t.wrapper.bounds)&&(this.updateGroupSize(t),t.children&&this.updateGroupOffset(t)),"SVG"===this.mode&&this.updateDiagramObject(t))},e.prototype.updateConnectorEdges=function(t){if(t.inEdges.length>0)for(var e=0;e<t.inEdges.length;e++){var i=this.nameTable[t.inEdges[e]],n={sourcePoint:i.sourcePoint,targetPoint:i.targetPoint,sourceID:i.sourceID,targetID:i.targetID,sourcePortID:i.sourcePortID,targetPortID:i.targetPortID};this.connectorPropertyChange(i,{},n)}if(t.outEdges.length>0)for(var o=0;o<t.outEdges.length;o++){var r=this.nameTable[t.outEdges[o]],n={sourcePoint:r.sourcePoint,targetPoint:r.targetPoint,sourceID:r.sourceID,targetID:r.targetID,sourcePortID:r.sourcePortID,targetPortID:r.targetPortID};this.connectorPropertyChange(r,{},n)}t.parentId&&this.updateConnectorEdges(this.nameTable[t.parentId])},e.prototype.connectorProprtyChangeExtend=function(t,e,i,n){return void 0!==i.type&&i.type!==e.type&&t.segments.length>0&&void 0===i.segments&&(t.segments=[]),void 0!==i.shape&&void 0!==t.shape&&t.shape&&"Bpmn"===t.shape.type&&this.bpmnModule&&this.bpmnModule.updateBPMNConnector(t,e,i,this),void 0!==t.constraints?(this.updateThumbConstraints(this.selectedItems.connectors,this.selectedItems),n=!0):n},e.prototype.connectorPropertyChange=function(t,e,i,n){var o=t.wrapper.bounds,r=!1,s=[];if(r=this.connectorProprtyChangeExtend(t,e,i,r),void 0!==i.visible&&this.updateElementVisibility(t.wrapper,i,t.visible),void 0!==i.sourcePoint||void 0!==i.targetPoint||void 0!==i.sourceID||void 0!==i.targetID||void 0!==i.sourcePortID||void 0!==i.targetPortID||void 0!==i.type||void 0!==i.segments){if(void 0!==i.sourceID&&i.sourceID!==e.sourceID||i.sourcePortID){var a=this.nameTable[t.sourceID];if(a&&!gr(a)||(t.sourceWrapper=a?this.getEndNodeWrapper(a,t,!0):void 0),void 0!==i.sourceID&&void 0!==e.sourceID&&""!==e.sourceID){var l=this.nameTable[e.sourceID];void 0!==l&&l.outEdges&&-1!==l.outEdges.indexOf(t.id)&&ms(l.outEdges,t.id)}this.updateEdges(t)}if(void 0!==i.targetID&&i.targetID!==e.targetID){var h=this.nameTable[i.targetID];if(h&&!ur(h)||(t.targetWrapper=h?this.getEndNodeWrapper(h,t,!1):void 0),void 0!==e&&void 0!==e.targetID&&""!==e.targetID){var c=this.nameTable[e.targetID];void 0!==c&&c.inEdges&&-1!==c.inEdges.indexOf(t.id)&&ms(c.inEdges,t.id)}this.updateEdges(t)}if(void 0!==i.sourcePortID&&i.sourcePortID!==e.sourcePortID){var d=void 0;t.sourceID&&this.nameTable[t.sourceID]&&(d=this.nameTable[t.sourceID].wrapper),t.sourcePortWrapper=d?this.getWrapper(d,i.sourcePortID):void 0}if(void 0!==i.targetPortID&&i.targetPortID!==e.targetPortID){var p=void 0;t.targetID&&this.nameTable[t.targetID]&&(p=this.nameTable[t.targetID].wrapper),t.targetPortWrapper=p?this.getWrapper(p,i.targetPortID):void 0}s=this.getPoints(t)}if(void 0!==i.style&&cs(i.style,t.wrapper.children[0]),(s.length>0||void 0!==i.sourceDecorator||void 0!==i.targetDecorator||void 0!==i.cornerRadius)&&(fs(t,s.length>0?s:t.intermediatePoints),void 0!==i.type&&(r=!0),s.length>0)){if(t.wrapper.measure(new nh(t.wrapper.width,t.wrapper.height)),t.wrapper.arrange(t.wrapper.desiredSize),t.annotations.length)for(var u=0,g=t.annotations;u<g.length;u++){var m=g[u],f=void 0;f=this.getWrapper(t.wrapper,m.id),t.updateAnnotation(m,t.intermediatePoints,t.wrapper.bounds,f)}t.wrapper.measure(new nh(t.wrapper.width,t.wrapper.height)),t.wrapper.arrange(t.wrapper.desiredSize),this.updateObject(t,e,i)}(i.sourcePoint||i.targetPoint||i.segments)&&this.diagramActions===Lh.Render&&(r=!0),n||this.updateBridging(),this.updateAnnotations(i,t),t.wrapper.measure(new nh(t.wrapper.width,t.wrapper.height)),t.wrapper.arrange(t.wrapper.desiredSize),!1===o.equals(o,t.wrapper.bounds)&&(this.updateQuad(t),this.updateGroupSize(t)),!0===r&&this.checkSelectedItem(t)&&this.updateSelector(),"SVG"===this.mode&&this.updateDiagramObject(t)},e.prototype.getPoints=function(t,e){return t.getConnectorPoints(t.type,e,"ComplexHierarchicalTree"===this.layout.type||"HierarchicalTree"===this.layout.type?this.layout.orientation:void 0)},e.prototype.updateNodeProperty=function(t,e,i){if(void 0===e)this.updateElementVisibility(t,this.nameTable[t.id],e);else{t.style.opacity=i;for(var n=0;n<t.children.length;n++)t.children[n]instanceof ic&&this.updateNodeProperty(t.children[n],void 0,i),t.children[n].style.opacity=i}},e.prototype.checkSelectedItem=function(t){var e=this.selectedItems,i=!1,n=[];return(n=n.concat(e.nodes,e.connectors)).length>0&&t.id===n[n.length-1].id&&(i=!0),i},e.prototype.updateDiagramContainerVisibility=function(t,e){if(t instanceof ic)for(var i=0;i<t.children.length;i++)this.updateDiagramContainerVisibility(t.children[i],e);t.visible=e},e.prototype.updateElementVisibility=function(t,e,i){if(void 0!==i){if(t.visible=i,e instanceof gp){if(e.children)for(var n=0,o=e.children;n<o.length;n++){var r=o[n];this.updateElementVisibility(this.nameTable[r].wrapper,this.nameTable[r],i)}else t.children[0].visible=i,this.updateDiagramContainerVisibility(t.children[0],i),"Bpmn"===e.shape.type&&this.bpmnModule&&this.bpmnModule.updateElementVisibility(e,i,this);if(e.ports)for(var s=0,a=e.ports;s<a.length;s++){var l=a[s];l.visibility&lh.Visible&&((g=this.getWrapper(t,l.id)).visible=i)}if(e.annotations)for(var h=0,c=e.annotations;h<c.length;h++){u=c[h];(g=this.getWrapper(t,u.id)).visible=i}}else for(m=0;m<3;m++)t.children[m].visible=i;if(e.annotations)for(var d=0,p=e.annotations;d<p.length;d++){var u=p[d];(g=this.getWrapper(t,u.id)).visible=i}if(e.expandIcon||e.collapseIcon){var g=this.getWrapper(t,"icon_content");if(g){for(var m=0;m<g.children.length;m++)g.children[m].visible=i;g.visible=i}}!1===i&&this.unSelect(this.nameTable[t.id]),this.updateDiagramObject(this.nameTable[t.id])}},e.prototype.updateAnnotations=function(t,e){if(void 0!==t.annotations)for(var i=0,n=Object.keys(t.annotations);i<n.length;i++){var o=n[i],r=Number(o),s=t.annotations[o],a=e.annotations[r];this.updateAnnotation(s,a,e.wrapper,e)}},e.prototype.updateAnnotation=function(t,e,i,n,o){var r,s=!1;if(void 0!==(r=this.getWrapper(i,e.id))){if(void 0!==t.width&&void 0!==t.height&&(r.width=t.width,r.height=t.height,s=!0),o&&r.refreshTextElement(),e instanceof fc&&void 0!==t.offset){var a=t.offset;s=!0;var l=void 0!==a.x?a.x:e.offset.x,h=void 0!==a.y?a.y:e.offset.y;r.setOffsetWithRespectToBounds(l,h,"Fraction"),r.relativeMode="Point"}else e instanceof vc&&void 0!==t.offset&&n.updateAnnotation(e,n.intermediatePoints,n.wrapper.bounds,r);e instanceof vc&&t.displacement&&(void 0===t.displacement.x&&void 0===t.displacement.y||(s=!0)),void 0!==t.margin&&(s=!0,void 0!==t.margin.bottom&&(r.margin.bottom=t.margin.bottom),void 0!==t.margin.top&&(r.margin.top=t.margin.top),void 0!==t.margin.left&&(r.margin.left=t.margin.left),void 0!==t.margin.right&&(r.margin.right=t.margin.right)),(s||o)&&(r.width=(e.width||n.width)-r.margin.left-r.margin.right),void 0!==t.horizontalAlignment&&(r.horizontalAlignment=t.horizontalAlignment,s=!0),void 0!==t.verticalAlignment&&(r.verticalAlignment=t.verticalAlignment,s=!0),void 0!==t.visibility&&(r.visible=!(!i.visible||!t.visibility)),void 0!==t.constraints&&(r.constraints=t.constraints),void 0!==t.style&&cs(t.style,r),void 0!==t.hyperlink&&ds(t.hyperlink,r,e),void 0!==t.content&&r&&(s=!0,r.content=t.content),!0===s&&(r.measure(new nh(r.width,r.height)),r.arrange(r.desiredSize)),r.refreshTextElement()}},e.prototype.updatePort=function(t,e,i){var n,o=!1;if(void 0!==(n=this.getWrapper(i,e.id))){if(void 0!==t.offset){o=!0;var r=void 0!==t.offset.x?t.offset.x:e.offset.x,s=void 0!==t.offset.y?t.offset.y:e.offset.y;n.setOffsetWithRespectToBounds(r,s,"Fraction"),n.relativeMode="Point"}if(void 0!==t.width&&(o=!0,n.width=t.width),void 0!==t.height&&(o=!0,n.height=t.height),void 0!==t.visibility&&(n.visible=!(!i.visible||!ws(e,lh.Visible))),void 0!==t.margin&&(o=!0,void 0!==t.margin.bottom&&(n.margin.bottom=t.margin.bottom),void 0!==t.margin.top&&(n.margin.top=t.margin.top),void 0!==t.margin.right&&(n.margin.right=t.margin.right),void 0!==t.margin.right&&(n.margin.left=t.margin.left)),void 0!==t.horizontalAlignment&&(o=!0,n.horizontalAlignment=t.horizontalAlignment),void 0!==t.verticalAlignment&&(o=!0,n.verticalAlignment=t.verticalAlignment),void 0!==t.style&&(void 0!==t.style.fill&&(n.style.fill=t.style.fill),void 0!==t.style.opacity&&(n.style.opacity=t.style.opacity),void 0!==t.style.strokeColor&&(n.style.strokeColor=t.style.strokeColor),void 0!==t.style.strokeWidth&&(n.style.strokeWidth=t.style.strokeWidth),void 0!==t.style.strokeDashArray&&(n.style.strokeDashArray=t.style.strokeDashArray)),void 0!==t.shape&&n)if("Custom"===t.shape&&t.pathData)n.data=String(t.pathData),o=!0;else{var a=ri(t.shape);n.data=a}!0===o&&(n.measure(new nh(n.width,n.height)),n.arrange(n.desiredSize))}},e.prototype.updateIcon=function(t){var e=this.getWrapper(t.wrapper,"icon_content");if(e){if("SVG"===this.mode){var i=Ae(t.wrapper.id+"_icon_content");if(i){var n=Ae(i.id+"_rect"),o=Ae(i.id+"_shape"),r=Ae(o.id+"_native_element");r&&r.parentNode.removeChild(r),o.parentNode.removeChild(o),n.parentNode.removeChild(n),i.parentNode.removeChild(i)}}var s=t.wrapper.children.indexOf(e);t.wrapper.children.splice(s,1)}var a=this.getPortContainer(t);t.initIcons(this.getDescription,this.layout,a)},e.prototype.getPortContainer=function(t){if(t.children)for(var e=0;e<t.wrapper.children.length;e++)if("group_container"===t.wrapper.children[e].id)return t.wrapper.children[e];return t.wrapper},e.prototype.updateTooltip=function(t,e){void 0!==e.tooltip.content&&(t.tooltip.content=e.tooltip.content),void 0!==e.tooltip.position&&(t.tooltip.position=e.tooltip.position),void 0!==e.tooltip.height&&(t.tooltip.height=e.tooltip.height),void 0!==e.tooltip.width&&(t.tooltip.width=e.tooltip.width),void 0!==e.tooltip.showTipPointer&&(t.tooltip.showTipPointer=e.tooltip.showTipPointer)},e.prototype.updateQuad=function(t){this.spatialSearch.updateQuad(t.wrapper)&&!this.preventUpdate&&this.updatePage()},e.prototype.removeFromAQuad=function(t){this.spatialSearch.removeFromAQuad(t.wrapper),this.spatialSearch.updateBounds(t.wrapper)&&!this.preventUpdate&&this.updatePage()},e.prototype.updateGroupSize=function(t){var e;t.parentId&&((e=this.nameTable[t.parentId]).parentId?this.updateGroupSize(e):(e.wrapper.measure(new nh),e.wrapper.arrange(e.wrapper.desiredSize),this.updateGroupOffset(e),this.updateDiagramObject(e)))},e.prototype.updatePage=function(){if(this.diagramActions&Lh.Render){this.scroller.setSize(),this.scroller.updateScrollOffsets();for(var t=0,i=this.views;t<i.length;t++){var n=i[t],o=this.views[n];o instanceof e||o.updateView(o)}}},e.prototype.protectPropertyChange=function(t){this.isProtectedOnChange=t},e.prototype.updateMargin=function(t,e){void 0!==e.margin.top&&(t.margin.top=e.margin.top),void 0!==e.margin.bottom&&(t.margin.bottom=e.margin.bottom),void 0!==e.margin.left&&(t.margin.left=e.margin.left),void 0!==e.margin.right&&(t.margin.right=e.margin.right)},e.prototype.initDroppables=function(){var t=this;this.droppable=new Ol(this.element),this.droppable.accept=".e-dragclone",this.droppable.over=function(e){if(t.currentSymbol)e.event.touches&&e.event.touches.length&&t.eventHandler.mouseMove(e.event,e.event.touches);else if(e.dragData){var i=void 0,n=t.eventHandler.getMousePosition(e.event),o=void 0,r=e.dragData.helper,s=r.getAttribute("paletteId");if(s){var a=document.getElementById(s).ej2_instances[0];t.droppable.sourceElement=a;if(a){var l=a.selectedSymbols;o=ie(a.selectedSymbols);var h=l.wrapper.children[0].children[0];if(a.selectedSymbols instanceof gp){o.offsetX=n.x+5+(o.width||h.actualSize.width)/2,o.offsetY=n.y+(o.height||h.actualSize.height)/2;var c=new gp(t,"nodes",o,!0);"Bpmn"===c.shape.type&&c.shape.activity.subProcess.processes&&c.shape.activity.subProcess.processes.length&&(c.shape.activity.subProcess.processes=[]),i=c}else if(a.selectedSymbols instanceof Vd){i=new Vd(t,"connectors",o,!0);var d=ah.toBounds([i.sourcePoint,i.targetPoint]),p=n.x-d.center.x,u=n.y-d.center.y;i.sourcePoint.x+=p,i.sourcePoint.y+=u,i.targetPoint.x+=p,i.targetPoint.y+=u}i.id+=te();var g={source:a,element:i,cancel:!1,diagram:t};t.triggerEvent(Ph.dragEnter,g),t.activeLayer.lock||g.cancel||(t.preventUpdate=!0,t.initObject(i),t.currentSymbol=i,"SVG"!==t.mode&&t.refreshDiagramLayer(),t.commandHandler.select(i),t.eventHandler.mouseDown(e.event),t.eventHandler.mouseMove(e.event,e),t.preventUpdate=!1,t.updatePage(),r.style.opacity="0")}t.droppable.selectedSymbols=r}}},this.droppable.drop=function(e){if(t.currentSymbol){e.event.touches&&t.eventHandler.mouseUp(e.event);var i=void 0,n={source:t.droppable.sourceElement,element:t.currentSymbol,target:t,cancel:!1,position:{x:t.currentSymbol.wrapper.offsetX,y:t.currentSymbol.wrapper.offsetY}};t.triggerEvent(Ph.drop,n);var o=void 0;o=ie(t.currentSymbol),t.removeFromAQuad(t.currentSymbol),t.removeObjectsFromLayer(t.nameTable[t.currentSymbol.id]),delete t.nameTable[t.currentSymbol.id],t.currentSymbol=null,t.protectPropertyChange(!0),n.cancel||(t.startGroupAction(),t.add(o),yr(t)&&t.select([t.nameTable[o.id]])),t.protectPropertyChange(!1),i=t.nameTable[o.id],t.bpmnModule&&i instanceof gp&&o.processId&&(i.processId=o.processId,t.bpmnModule.dropBPMNchild(t.nameTable[i.processId],i,t)),t.endGroupAction(),"SVG"!==t.mode&&t.refreshDiagramLayer(),delete t.droppable.sourceElement}M(t.droppable.selectedSymbols)},this.droppable.out=function(e){if(t.currentSymbol&&!t.eventHandler.focus){t.unSelect(t.currentSymbol),t.removeFromAQuad(t.currentSymbol),"SVG"!==t.mode&&"Native"===t.currentSymbol.shape.type&&t.removeElements(t.currentSymbol),t.removeObjectsFromLayer(t.nameTable[t.currentSymbol.id]),delete t.nameTable[t.currentSymbol.id],t.triggerEvent(Ph.dragLeave,{element:t.currentSymbol,diagram:t}),"SVG"!==t.mode?t.refreshDiagramLayer():t.removeElements(t.currentSymbol),t.currentSymbol=null;t.droppable.selectedSymbols.style.opacity="1";delete t.droppable.sourceElement}}},bu([et("100%")],e.prototype,"width",void 0),bu([et("SVG")],e.prototype,"mode",void 0),bu([et("100%")],e.prototype,"height",void 0),bu([it({},vu)],e.prototype,"contextMenuSettings",void 0),bu([et(yh.Default)],e.prototype,"constraints",void 0),bu([et(bh.Default)],e.prototype,"tool",void 0),bu([et("Top")],e.prototype,"bridgeDirection",void 0),bu([et("transparent")],e.prototype,"backgroundColor",void 0),bu([it({},Op)],e.prototype,"snapSettings",void 0),bu([it({},Rp)],e.prototype,"rulerSettings",void 0),bu([it({},Cp)],e.prototype,"pageSettings",void 0),bu([ot([],gp)],e.prototype,"nodes",void 0),bu([et()],e.prototype,"drawingObject",void 0),bu([ot([],Vd)],e.prototype,"connectors",void 0),bu([et([])],e.prototype,"basicElements",void 0),bu([it({},Ld)],e.prototype,"tooltip",void 0),bu([it({},Np)],e.prototype,"dataSourceSettings",void 0),bu([et()],e.prototype,"addInfo",void 0),bu([et()],e.prototype,"getNodeDefaults",void 0),bu([et()],e.prototype,"getConnectorDefaults",void 0),bu([et()],e.prototype,"setNodeTemplate",void 0),bu([et()],e.prototype,"getDescription",void 0),bu([et()],e.prototype,"getCustomProperty",void 0),bu([et()],e.prototype,"getCustomTool",void 0),bu([et()],e.prototype,"getCustomCursor",void 0),bu([it({},Ud)],e.prototype,"selectedItems",void 0),bu([it({},Lp)],e.prototype,"scrollSettings",void 0),bu([it({},jp)],e.prototype,"layout",void 0),bu([it({},fu)],e.prototype,"commandManager",void 0),bu([st()],e.prototype,"dataLoaded",void 0),bu([st()],e.prototype,"dragEnter",void 0),bu([st()],e.prototype,"dragLeave",void 0),bu([st()],e.prototype,"dragOver",void 0),bu([st()],e.prototype,"click",void 0),bu([st()],e.prototype,"historyChange",void 0),bu([st()],e.prototype,"doubleClick",void 0),bu([st()],e.prototype,"textEdit",void 0),bu([st()],e.prototype,"scrollChange",void 0),bu([st()],e.prototype,"selectionChange",void 0),bu([st()],e.prototype,"sizeChange",void 0),bu([st()],e.prototype,"connectionChange",void 0),bu([st()],e.prototype,"sourcePointChange",void 0),bu([st()],e.prototype,"targetPointChange",void 0),bu([st()],e.prototype,"propertyChange",void 0),bu([st()],e.prototype,"positionChange",void 0),bu([st()],e.prototype,"animationComplete",void 0),bu([st()],e.prototype,"rotateChange",void 0),bu([st()],e.prototype,"collectionChange",void 0),bu([st()],e.prototype,"created",void 0),bu([st()],e.prototype,"contextMenuOpen",void 0),bu([st()],e.prototype,"contextMenuClick",void 0),bu([ot([],au)],e.prototype,"layers",void 0),bu([st()],e.prototype,"drop",void 0),e}(wl),xu=function(){function t(t){this.diagram=t}return t.prototype.exportDiagram=function(t){var e,i,n,o,r="data",s=[],a=t.margin||{},l=t&&t.region?t.region:"Content";o=t&&t.mode?t.mode:"Download";var h=this.getDiagramBounds(l,t);t.bounds&&(i=!0,h.x=t.bounds.x?t.bounds.x:h.x,h.y=t.bounds.y?t.bounds.y:h.y,h.width=t.bounds.width||h.width,h.height=t.bounds.height||h.height),a={top:void 0!==a.top?a.top:25,bottom:void 0!==a.bottom?a.bottom:25,right:void 0!==a.right?a.right:25,left:void 0!==a.left?a.left:25};this.diagram.nodes;"PageSettings"!==l&&(h.x-=a.left,h.y-=a.top,h.width+=a.left+a.right,h.height+=a.top+a.bottom);var c=t.fileName||"diagram";if("SVG"!==t.format){if(null!==(r=this.setCanvas(t,h,a,o,i,l,c)))return r}else{e=t.format,t.bounds=h,t.margin=a;var d=n=this.diagramAsSvg(t,a);if("Data"===o)return n;var p=(new XMLSerializer).serializeToString(d);s.push(p)}if("Download"===o&&null!==r)for(var u=0;u<s.length;u++){var g=new Blob([s[u]],{type:"application/octet-stream"});if("msie"===za.info.name)window.navigator.msSaveOrOpenBlob(g,c+"."+e);else{var m=document.createElement("a"),f=URL.createObjectURL(g);m.href=f,m.setAttribute("download",c+"."+e);var v=document.createEvent("MouseEvents");v.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),m.dispatchEvent(v)}}return null},t.prototype.setCanvas=function(t,e,i,n,o,r,s){var a,l,h=this;t.bounds=e,t.region=r;var c=[];this.setScaleValueforCanvas(t,e);var d=this.diagramAsCanvas({bounds:e,margin:i,region:r,scaleX:t.scaleX,scaleY:t.scaleY},o);a=t.format||"JPG";var p=l=d.toDataURL();if("Data"===n)return l;if(t.multiplePage){if(t.pageHeight=t.pageHeight?t.pageHeight:this.diagram.pageSettings.height,t.pageWidth=t.pageWidth?t.pageWidth:this.diagram.pageSettings.width,t.pageHeight=t.pageHeight?t.pageHeight:d.width,t.pageWidth=t.pageWidth?t.pageWidth:d.height,i=t.margin||{},t.pageOrientation&&("Landscape"===t.pageOrientation&&t.pageHeight>t.pageWidth||"Portrait"===t.pageOrientation&&t.pageWidth>t.pageHeight)){var u=t.pageWidth;t.pageWidth=t.pageHeight,t.pageHeight=u}t.margin={top:isNaN(i.top)?0:i.top,bottom:isNaN(i.bottom)?0:i.bottom,left:isNaN(i.left)?0:i.left,right:isNaN(i.right)?0:i.right};var g=document.createElement("img"),m={id:this.diagram.element.id+"_printImage",src:p};g.setAttribute("id",this.diagram.element.id+"_printImage"),ii(g,m),g.onload=function(){c=h.getMultipleImage(g,t,!0),h.exportImage(c,s,a,p)}}else c=[p],this.exportImage(c,s,a,p);return null},t.prototype.exportImage=function(t,e,i,n){for(var o=[],r=t instanceof HTMLElement?0:t.length,s=0;s<r;s++){for(var a=(n=(n=t[s]).replace(/^data:[a-z]*;,/,"")).split(","),l=atob(a[1]),h=new ArrayBuffer(l.length),c=new Uint8Array(h),d=0;d<l.length;d++)c[d]=l.charCodeAt(d);o.push(h)}for(var p=0;p<o.length;p++)!function(t){var n=new Blob([o[t]],{type:"application/octet-stream"});if("msie"===za.info.name)window.navigator.msSaveOrOpenBlob(n,e+"."+i);else{var r=document.createElement("a"),s=URL.createObjectURL(n);r.href=s,r.setAttribute("download",e+"."+i);var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),setTimeout(function(){r.dispatchEvent(a)},5*(t+1))}}(p)},t.prototype.getObjectsBound=function(t){for(var e,i=0,n=this.diagram.nodes;i<n.length;i++){var o=n[i];o.visible&&(("SVG"===t.format||o instanceof oc||o instanceof Xd)&&("SVG"!==t.format||o instanceof Xd)||(e=e?e.uniteRect(o.wrapper.outerBounds):o.wrapper.outerBounds))}for(var r=0,s=this.diagram.connectors;r<s.length;r++){var a=s[r];a.visible&&(e=e?e.uniteRect(a.wrapper.outerBounds):a.wrapper.outerBounds)}return e||new ah(0,0,0,0)},t.prototype.getDiagramBounds=function(t,e){var i=this.getObjectsBound(e),n=i.left,o=i.top,r=i.right-i.left,s=i.bottom-i.top;"Content"!==t&&(this.diagram.pageSettings&&this.diagram.pageSettings.multiplePage?(n=i.left,o=i.top,this.diagram.pageSettings.width&&(n=Math.floor(n/this.diagram.pageSettings.width)*this.diagram.pageSettings.width,r=Math.ceil(i.right/this.diagram.pageSettings.width)*this.diagram.pageSettings.width-n),this.diagram.pageSettings.height&&(o=Math.floor(o/this.diagram.pageSettings.height)*this.diagram.pageSettings.height,s=Math.ceil(i.bottom/this.diagram.pageSettings.height)*this.diagram.pageSettings.height-o),0===i.width&&null!==this.diagram.pageSettings.width&&(r=this.diagram.pageSettings.width),0===i.height&&null!==this.diagram.pageSettings.height&&(s=this.diagram.pageSettings.height)):(this.diagram.pageSettings.width&&(n=0,r=this.diagram.pageSettings.width),this.diagram.pageSettings.height&&(o=0,s=this.diagram.pageSettings.height)));var a=new ah;return a.x=n,a.y=o,a.width=r,a.height=s,a},t.prototype.setScaleValueforCanvas=function(t,e){t.scaleX=1,t.scaleY=1,t.pageHeight=t.pageHeight||this.diagram.pageSettings.height,t.pageWidth=t.pageWidth||this.diagram.pageSettings.width;var i=t.pageHeight||e.height,n=t.pageWidth||e.width;"Stretch"!==t.stretch&&"Meet"!==t.stretch&&"Slice"!==t.stretch||(t.scaleX=n/e.width,t.scaleY=i/e.height,"Meet"===t.stretch?t.scaleX=t.scaleY=Math.min(t.scaleX,t.scaleY):"Slice"===t.stretch&&(t.scaleX=t.scaleY=Math.max(t.scaleX,t.scaleY)),e.width=n,e.height=i),e.x*=t.scaleX,e.y*=t.scaleY},t.prototype.diagramAsSvg=function(t,e){var i=this.diagram.createSvg(this.diagram.element.id+"_diagram_svg",t.bounds.width,t.bounds.height);document.body.appendChild(i);var n=Ge("g",{id:this.diagram.element.id+"_pageBackground"}),o=t&&t.region?t.region:"Content",r=this.getDiagramBounds(o,t),s=r.x,a=r.y,l=r.width,h=r.height;i.appendChild(n);var c={transform:"translate("+(-t.bounds.x+e.left)+", "+(-t.bounds.y+e.top)+")",x:String(s),y:String(a),width:String(l),height:String(h)};ei(n,c);var d=document.getElementById(this.diagram.element.id+"_backgroundLayerrect").cloneNode(!0);if(c={x:0,y:0,width:String(l+e.left+e.right),height:String(h+e.top+e.bottom)},ei(d,c),i.appendChild(d),"SVG"===this.diagram.mode){var p=Ie(this.diagram.element.id);i.appendChild(p.getElementById(this.diagram.diagramLayer.id).cloneNode(!0));for(var u=0;u<i.childNodes.length;u++){var g=i.childNodes[u];"diagram_diagramLayer"===g.id&&g.setAttribute("transform","translate("+(-r.x+e.left)+", "+(-r.y+e.top)+")")}}else{n=Ge("g",{id:this.diagram.element.id+"_diagramLayer"}),i.appendChild(n),n.setAttribute("transform","translate("+(-t.bounds.x+e.left)+", "+(-t.bounds.y+e.top)+")");this.diagram.nodes;var m=new bp("",null,!0),f=Xe(this.diagram.element.id);this.diagram.renderDiagramElements(i,m,f,!1)}return document.body.removeChild(i),i},t.prototype.diagramAsCanvas=function(t,e){var i=t.bounds,n=t.margin,o=t&&t.region?t.region:"Content",r=this.getDiagramBounds(o,t),s=this.diagram.pageSettings.background.color,a=ch.createCanvas(this.diagram.element.id+"_diagram",t.bounds.width,t.bounds.height),l=a.getContext("2d");l.translate(-i.x,-i.y),l.save(),l.fillStyle=this.diagram.pageSettings.background.color,i="Content"===o?r:i,l.fillRect(i.x,i.y,i.width,i.height);var h=this.diagram.pageSettings.background;if(h&&h.source){r=this.getDiagramBounds(o,t);var c=new Image;c.src=h.source;var d=r.width/c.width,p=r.height/c.height,u=r.x,g=r.y,m=r.width,f=r.height,v=this.isImageExportable(h);if("None"!==h.scale&&"None"!==h.align){var y="Meet"===h.scale?Math.min(d,p):Math.max(d,p);m=y*c.width,f=y*c.height,h.align.indexOf("xmid")>-1?u+=(r.width-m)/2:h.align.indexOf("xmax")>-1&&(u=u+r.width-m),h.align.indexOf("ymid")>-1?g+=(r.height-f)/2:h.align.indexOf("ymax")>-1&&(g=g+r.height-f),"none"!==this.diagram.pageSettings.background.color&&"transparent"!==this.diagram.pageSettings.background.color||(l.fillStyle="white",l.fillRect(r.x*t.scaleX,r.y*t.scaleY,r.width*t.scaleX,r.height*t.scaleY)),v&&l.drawImage(c,u,g,y*c.width,y*c.height)}else v&&l.drawImage(c,u,g,r.width,r.height)}else l.fillStyle="transparent"===s?"white":s,l.fillRect(r.x*t.scaleX-n.left,r.y*t.scaleY-n.top,r.width*t.scaleX+n.left+n.right,t.scaleY*r.height+n.top+n.bottom);var b=this.diagram.pageSettings.background.color,w=this.diagram.pageSettings.width;w&&(l.strokeStyle="none"===b?"transparent":b,l.lineWidth=w,l.strokeRect(r.x*t.scaleX,r.y*t.scaleY,r.width*t.scaleX,r.height*t.scaleY)),l.restore();var x=Xe(this.diagram.element.id),S=new bp("",null,!1);return this.diagram.renderDiagramElements(a,S,x,!1),a},t.prototype.isImageExportable=function(t){var e,i=!0;if(t.source)try{var n=(e=ch.createCanvas(this.diagram.element.id+"temp_canvas",100,100)).getContext("2d");n.save();var o=new Image;o.src=t.source,n.drawImage(o,0,0,100,100),n.restore(),e.toDataURL()}catch(t){i=!1}return i},t.prototype.getPrintCanvasStyle=function(t,e){var i=0,n=0,o=new nh;if(i=t.width,n=t.height,(e.pageHeight||e.pageWidth)&&(n=e.pageHeight?e.pageHeight:n,i=e.pageWidth?e.pageWidth:i),e.pageOrientation&&("Landscape"===e.pageOrientation&&n>i||"Portrait"===e.pageOrientation&&i>n)){var r=i;i=n,n=r}return o.height=n,o.width=i,o},t.prototype.getMultipleImage=function(t,e,i){var n,o,r=[],s=document.createElement("div"),a=this.getPrintCanvasStyle(t,e),l=e.margin,h=l.left,c=l.top,d=l.right,p=l.bottom,u=0;n=a.width+u,o=a.height+0;var g=0,m=0;if(e&&e.multiplePage&&"Content"!==e.region){s.style.height="auto",s.style.width="auto";var f=t.height,v=t.width,y=0,b=0,w=void 0,x=0,S=0,C=void 0,L=void 0;do{do{x=a.width,S=a.height,g+a.width>=v&&(x=v-g),m+a.height>=f&&(S=f-m),(C=(L=ch.createCanvas(this.diagram.element.id+"_multiplePrint",a.width,a.height)).getContext("2d")).drawImage(t,u+g+h,0+m+c,x-d-h,S-p-c,0+h,0+c,x-d-h,S-p-c),g+a.width>=v&&(g-=g-v),w=L.toDataURL(),C.restore(),g+=n,i?r.push(w):this.printImage(s,w,y+""+b,n+"px;",o+"px;"),y++}while(g<v);b++,y=u=g=0,m+a.height>=f&&(m-=m-f),m+=o}while(m<f)}else{var E,P,k=this.getPrintCanvasStyle(t,e);E=k.width,P=k.height;var C=void 0,L=void 0,w=void 0;(C=(L=ch.createCanvas(this.diagram.element.id+"_diagram",E,P)).getContext("2d")).drawImage(t,0+h,0+c,t.width-(d+h),t.height-(c+p),0+h,0+c,E-(d+h),P-(c+p)),w=L.toDataURL(),C.restore(),this.printImage(s,w,0)}return i?r:s},t.prototype.printImage=function(t,e,i,n,o){var r,s=document.createElement("img"),a=document.createElement("div");ii(s,r={class:"e-diagram-print-page",style:"width:"+n+"height:"+o}),ii(a,r),ii(s,r={id:this.diagram.element.id+"_multiplePrint_img"+i,style:"float:left",src:e}),a.appendChild(s),t.appendChild(a)},t.prototype.print=function(t){var e=this;t.mode="Data",t.margin={top:0,bottom:0,right:0,left:0};var i=this.exportDiagram(t),n=document.createElement("img"),o={id:this.diagram.element.id+"_printImage",src:i};ii(n,o),n.onload=function(){var i=e.getMultipleImage(n,t),o=window.open("");null!=o&&i instanceof HTMLElement&&(o.document.write("<html><head><style> body{margin:0px;}  @media print { .e-diagram-print-page{page-break-after: left; }.e-diagram-print-page:last-child {page-break-after: avoid;}}</style><title></title></head>"),o.document.write('<BODY onload="setTimeout(function(){window.print();}, 100)">'),o.document.write("<center>"+i.innerHTML+"</center>"),o.document.close())}},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"PrintandExport"},t}(),Su=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Cu=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.orientation="Vertical",e.measureChildren=void 0,e}return Su(e,t),e.prototype.measure=function(t){var e="Horizontal"===this.orientation?this.updateHorizontalStack:this.updateVerticalStack;return this.desiredSize=this.measureStackPanel(t,e),this.desiredSize},e.prototype.arrange=function(t){var e="Horizontal"===this.orientation?this.arrangeHorizontalStack:this.arrangeVerticalStack;return this.actualSize=this.arrangeStackPanel(t,e),this.updateBounds(),this.actualSize},e.prototype.measureStackPanel=function(e,i){var n=void 0;if(void 0!==this.children&&this.children.length>0)for(var o=0,r=this.children;o<r.length;o++){var s=r[o];s.parentTransform=this.rotateAngle+this.parentTransform,s.measure(e);var a=s.desiredSize.clone();this.applyChildMargin(s,a),0!==s.rotateAngle&&(a=ue(a,s.rotateAngle)),void 0===n?n=a:i(a,n)}return n=t.prototype.validateDesiredSize.call(this,n,e),this.stretchChildren(n),this.applyPadding(n),n},e.prototype.arrangeStackPanel=function(e,i){if(void 0!==this.children&&this.children.length>0){var n=void 0,o=void 0;n=this.offsetX-e.width*this.pivot.x+this.padding.left,o=this.offsetY-e.height*this.pivot.y+this.padding.top;for(var r=0,s=this.children;r<s.length;r++){var a=s[r],l=a.desiredSize.clone(),h=l;"Vertical"===this.orientation?o+=a.margin.top:n+=a.margin.left,0!==a.rotateAngle&&(h=ue(l,a.rotateAngle));var c=i(n,o,a,this,e,h);t.prototype.findChildOffsetFromCenter.call(this,a,c),a.arrange(l),"Vertical"===this.orientation?o+=h.height+a.margin.bottom:n+=h.width+a.margin.right}}return e},e.prototype.updateHorizontalStack=function(t,e){e.height=Math.max(t.height,e.height),e.width+=t.width},e.prototype.updateVerticalStack=function(t,e){e.width=Math.max(t.width,e.width),e.height+=t.height},e.prototype.arrangeHorizontalStack=function(t,e,i,n,o,r){var s=0;return s="Top"===i.verticalAlignment?e+i.margin.top+r.height/2:"Bottom"===i.verticalAlignment?n.offsetY+o.height*(1-n.pivot.y)-n.padding.bottom-i.margin.bottom-r.height/2:n.offsetY-o.height*n.pivot.y+o.height/2,{x:t+r.width/2,y:s}},e.prototype.arrangeVerticalStack=function(t,e,i,n,o,r){var s=0;return s="Left"===i.horizontalAlignment?t+i.margin.left+r.width/2:"Right"===i.horizontalAlignment?n.offsetX+o.width*(1-n.pivot.x)-n.padding.right-i.margin.right-r.width/2:n.offsetX-o.width*n.pivot.x+o.width/2,{x:s,y:e+r.height/2}},e.prototype.stretchChildren=function(t){if(void 0!==this.children&&this.children.length>0)for(var e=0,i=this.children;e<i.length;e++){var n=i[e];"Vertical"===this.orientation?"Stretch"===n.horizontalAlignment&&(n.desiredSize.width=t.width):"Stretch"===n.verticalAlignment&&(n.desiredSize.height=t.height)}},e.prototype.applyChildMargin=function(t,e){e.height+=t.margin.top+t.margin.bottom,e.width+=t.margin.left+t.margin.right},e}(ic),Lu=function(){function t(t){return this.subQuery=null,this.isChild=!1,this.queries=[],this.key="",this.fKey="","string"==typeof t?this.fromTable=t:t&&t instanceof Array&&(this.lookups=t),this.expands=[],this.sortedColumns=[],this.groupedColumns=[],this.subQuery=null,this.isChild=!1,this.params=[],this}return t.prototype.setKey=function(t){return this.key=t,this},t.prototype.using=function(t){return this.dataManager=t,this},t.prototype.execute=function(t,e,i,n){return t=t||this.dataManager,t?t.executeQuery(this,e,i,n):ku.throwError('Query - execute() : dataManager needs to be is set using "using" function or should be passed as argument')},t.prototype.executeLocal=function(t){return t=t||this.dataManager,t?t.executeLocal(this):ku.throwError('Query - executeLocal() : dataManager needs to be is set using "using" function or should be passed as argument')},t.prototype.clone=function(){var e=new t;return e.queries=this.queries.slice(0),e.key=this.key,e.isChild=this.isChild,e.dataManager=this.dataManager,e.fromTable=this.fromTable,e.params=this.params.slice(0),e.expands=this.expands.slice(0),e.sortedColumns=this.sortedColumns.slice(0),e.groupedColumns=this.groupedColumns.slice(0),e.subQuerySelector=this.subQuerySelector,e.subQuery=this.subQuery,e.fKey=this.fKey,e.isCountRequired=this.isCountRequired,e},t.prototype.from=function(t){return this.fromTable=t,this},t.prototype.addParams=function(t,e){return"function"==typeof e?this.params.push({key:t,fn:e}):this.params.push({key:t,value:e}),this},t.prototype.expand=function(t){return this.expands="string"==typeof t?[].slice.call([t],0):t.slice(0),this},t.prototype.where=function(t,e,i,n,o){e=e?e.toLowerCase():null;var r=null;return"string"==typeof t?r=new Eu(t,e,i,n,o):t instanceof Eu&&(r=t),this.queries.push({fn:"onWhere",e:r}),this},t.prototype.search=function(t,e,i,n,o){"string"==typeof e&&(e=[e]),i=i||"contains";var r=ku.fnOperators[i];return this.queries.push({fn:"onSearch",e:{fieldNames:e,operator:i,searchKey:t,ignoreCase:n,ignoreAccent:o,comparer:r}}),this},t.prototype.sortBy=function(e,i,n){var o,r,s="ascending";if("string"==typeof e&&ku.endsWith(e.toLowerCase()," desc")&&(e=e.replace(/ desc$/i,""),i="descending"),i&&"string"!=typeof i||(s=i?i.toLowerCase():"ascending",i=ku.fnSort(i)),n){o=t.filterQueries(this.queries,"onSortBy");for(var a=0;a<o.length;a++)if("string"==typeof(r=o[a].e.fieldName)){if(r===e)return this}else if(r instanceof Array)for(var l=0;l<r.length;l++)if(r[l]===e||e.toLowerCase()===r[l]+" desc")return this}return this.queries.push({fn:"onSortBy",e:{fieldName:e,comparer:i,direction:s}}),this},t.prototype.sortByDesc=function(t){return this.sortBy(t,"descending")},t.prototype.group=function(t,e,i){return this.sortBy(t,null,!0),this.queries.push({fn:"onGroup",e:{fieldName:t,comparer:e||null,format:i||null}}),this},t.prototype.page=function(t,e){return this.queries.push({fn:"onPage",e:{pageIndex:t,pageSize:e}}),this},t.prototype.range=function(t,e){return this.queries.push({fn:"onRange",e:{start:t,end:e}}),this},t.prototype.take=function(t){return this.queries.push({fn:"onTake",e:{nos:t}}),this},t.prototype.skip=function(t){return this.queries.push({fn:"onSkip",e:{nos:t}}),this},t.prototype.select=function(t){return"string"==typeof t&&(t=[].slice.call([t],0)),this.queries.push({fn:"onSelect",e:{fieldNames:t}}),this},t.prototype.hierarchy=function(t,e){return this.subQuerySelector=e,this.subQuery=t,this},t.prototype.foreignKey=function(t){return this.fKey=t,this},t.prototype.requiresCount=function(){return this.isCountRequired=!0,this},t.prototype.aggregate=function(t,e){return this.queries.push({fn:"onAggregates",e:{field:e,type:t}}),this},t.filterQueries=function(t,e){return t.filter(function(t){return t.fn===e})},t.filterQueryLists=function(t,e){for(var i=t.filter(function(t){return-1!==e.indexOf(t.fn)}),n={},o=0;o<i.length;o++)n[i[o].fn]||(n[i[o].fn]=i[o].e);return n},t}(),Eu=function(){function t(e,i,n,o,r){return void 0===o&&(o=!1),this.ignoreAccent=!1,this.isComplex=!1,"string"==typeof e?(this.field=e,this.operator=i.toLowerCase(),this.value=n,this.ignoreCase=o,this.ignoreAccent=r,this.isComplex=!1,this.comparer=ku.fnOperators.processOperator(this.operator)):(e instanceof t&&n instanceof t||n instanceof Array)&&(this.isComplex=!0,this.condition=i.toLowerCase(),this.predicates=[e],n instanceof Array?[].push.apply(this.predicates,n):this.predicates.push(n)),this}return t.and=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return t.combinePredicates([].slice.call(e,0),"and")},t.prototype.and=function(e,i,n,o,r){return t.combine(this,e,i,n,"and",o,r)},t.or=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return t.combinePredicates([].slice.call(e,0),"or")},t.prototype.or=function(e,i,n,o,r){return t.combine(this,e,i,n,"or",o,r)},t.fromJson=function(t){if(t instanceof Array){for(var e=[],i=0,n=t.length;i<n;i++)e.push(this.fromJSONData(t[i]));return e}var o=t;return this.fromJSONData(o)},t.prototype.validate=function(t){var e,i,n=this.predicates?this.predicates:[];if(!this.isComplex&&this.comparer)return this.comparer.call(this,ku.getObject(this.field,t),this.value,this.ignoreCase,this.ignoreAccent);e="and"===this.condition;for(var o=0;o<n.length;o++)if(i=n[o].validate(t),e){if(!i)return!1}else if(i)return!0;return e},t.prototype.toJson=function(){var t,e;if(this.isComplex){t=[],e=this.predicates;for(var i=0;i<e.length;i++)t.push(e[i].toJson())}return{isComplex:this.isComplex,field:this.field,operator:this.operator,value:this.value,ignoreCase:this.ignoreCase,ignoreAccent:this.ignoreAccent,condition:this.condition,predicates:t}},t.combinePredicates=function(e,i){if(1===e.length){if(!(e[0]instanceof Array))return e[0];e=e[0]}return new t(e[0],i,e.slice(1))},t.combine=function(e,i,n,o,r,s,a){return i instanceof t?t[r](e,i):"string"==typeof i?t[r](e,new t(i,n,o,s,a)):ku.throwError("Predicate - "+r+" : invalid arguments")},t.fromJSONData=function(e){for(var i=e.predicates||[],n=i.length,o=[],r=0;r<n;r++)o.push(this.fromJSONData(i[r]));return e.isComplex?new t(o[0],e.condition,o.slice(1)):new t(e.field,e.operator,e.value,e.ignoreCase,e.ignoreAccent)},t}(),Pu={GroupGuid:"{271bbba0-1ee7}"},ku=function(){function t(){}return t.getValue=function(t,e){return"function"==typeof t?t.call(e||{}):t},t.endsWith=function(t,e){return t.slice(-e.length)===e},t.startsWith=function(t,e){return t.slice(0,e.length)===e},t.fnSort=function(e){return e=e?t.toLowerCase(e):"ascending","ascending"===e?this.fnAscending:this.fnDescending},t.fnAscending=function(t,e){return null===e||void 0===e?-1:"string"==typeof t?t.localeCompare(e):null===t||void 0===t?1:t-e},t.fnDescending=function(t,e){return null===e||void 0===e?1:"string"==typeof t?-1*t.localeCompare(e):null===t||void 0===t?-1:e-t},t.extractFields=function(t,e){for(var i={},n=0;n<e.length;n++)i=this.setValue(e[n],this.getObject(e[n],t),i);return i},t.select=function(t,e){for(var i=[],n=0;n<t.length;n++)i.push(this.extractFields(t[n],e));return i},t.group=function(e,i,n,o,r,s){o=o||1;var a=e;if(a.GroupGuid===Pu.GroupGuid){for(var l=this,h=0;h<a.length;h++)!function(t){if(c(r))a[t].items=l.group(a[t].items,i,n,a.level+1,null,s),a[t].count=a[t].items.length;else{var e=-1,o=r.filter(function(e){return e.key===a[t].key});e=r.indexOf(o[0]),a[t].items=l.group(a[t].items,i,n,a.level+1,r[e].items,s),a[t].count=r[e].count}}(h);return a.childLevels+=1,a}var d={},p=[];p.GroupGuid=Pu.GroupGuid,p.level=o,p.childLevels=0,p.records=a;for(var u=this,g=0;g<a.length;g++)!function(t){var e=u.getVal(a,t,i);if(c(s)||(e=s(e,i)),!d[e]&&(d[e]={key:e,count:0,items:[],aggregates:{},field:i},p.push(d[e]),!c(r))){var n=r.filter(function(t){return t.key===d[e].key});d[e].count=n[0].count}d[e].count=c(r)?d[e].count+=1:d[e].count,d[e].items.push(a[t])}(g);if(n&&n.length)for(g=0;g<p.length;g++)!function(e){for(var i={},o=void 0,s=n,a=0;a<n.length;a++)if(o=t.aggregates[n[a].type],c(r))o&&(i[s[a].field+" - "+s[a].type]=o(p[e].items,s[a].field));else{var l=r.filter(function(t){return t.key===p[e].key});o&&(i[s[a].field+" - "+s[a].type]=o(l[0].items,s[a].field))}p[e].aggregates=i}(g);return a.length&&p||a},t.buildHierarchy=function(t,e,i,n,o){var r,s={};for(n.result&&(n=n.result),n.GroupGuid&&this.throwError("DataManager: Do not have support Grouping in hierarchy"),r=0;r<n.length;r++)(s[a=this.getObject(t,n[r])]||(s[a]=[])).push(n[r]);for(r=0;r<i.length;r++){var a=this.getObject(o||t,i[r]);i[r][e]=s[a]}},t.getFieldList=function(t,e,i){if(void 0===i&&(i=""),void 0===e||null===e)return this.getFieldList(t,[],i);for(var n=t,o=0,r=Object.keys(t);o<r.length;o++){var s=r[o];"object"!=typeof n[s]||n[s]instanceof Array?e.push(i+s):this.getFieldList(n[s],e,i+s+".")}return e},t.getObject=function(t,e){if(!t)return e;if(e){if(-1===t.indexOf("."))return e[t];for(var i=e,n=t.split("."),o=0;o<n.length&&null!=i;o++)i=i[n[o]];return i}},t.setValue=function(t,e,i){var n,o,r=t.toString().split("."),s=i||{},a=s,l=r.length;for(n=0;n<l;n++)o=r[n],n+1===l?a[o]=void 0===e?void 0:e:c(a[o])&&(a[o]={}),a=a[o];return s},t.sort=function(t,e,i){if(t.length<=1)return t;var n=parseInt((t.length/2).toString(),10),o=t.slice(0,n),r=t.slice(n);return o=this.sort(o,e,i),r=this.sort(r,e,i),this.merge(o,r,e,i)},t.ignoreDiacritics=function(e){return"string"!=typeof e?e:e.split("").map(function(e){return e in t.diacritics?t.diacritics[e]:e}).join("")},t.merge=function(t,e,i,n){for(var o,r=[];t.length>0||e.length>0;)o=t.length>0&&e.length>0?n?n(this.getVal(t,0,i),this.getVal(e,0,i))<=0?t:e:t[0][i]<t[0][i]?t:e:t.length>0?t:e,r.push(o.shift());return r},t.getVal=function(t,e,i){return i?this.getObject(i,t[e]):t[e]},t.toLowerCase=function(t){return t?"string"==typeof t?t.toLowerCase():t.toString():0===t||!1===t?t.toString():""},t.callAdaptorFunction=function(t,e,i,n){if(e in t){var o=t[e](i,n);c(o)||(i=o)}return i},t.isPlainObject=function(t){return!!t&&t.constructor===Object},t.isCors=function(){var t=null;try{t=new window.XMLHttpRequest}catch(t){}return!!t&&"withCredentials"in t},t.getGuid=function(t){var e;return(t||"")+"00000000-0000-4000-0000-000000000000".replace(/0/g,function(t,i){if("crypto"in window&&"getRandomValues"in crypto){var n=new Uint8Array(1);window.crypto.getRandomValues(n),e=n[0]%16|0}else e=16*Math.random()|0;return"0123456789abcdef"[19===i?3&e|8:e]})},t.isNull=function(t){return void 0===t||null===t},t.getItemFromComparer=function(e,i,n){var o,r,s,a=0,l="string"==typeof t.getVal(e,0,i);if(e.length)for(;c(o)&&a<e.length;)o=t.getVal(e,a,i),s=e[a++];for(;a<e.length;a++)c(r=t.getVal(e,a,i))||(l&&(o=+o,r=+r),n(o,r)>0&&(o=r,s=e[a]));return s},t.distinct=function(e,i,n){n=!c(n)&&n;var o,r=[],s={};return e.forEach(function(a,l){(o=t.getVal(e,l,i))in s||(r.push(n?e[l]:o),s[o]=1)}),r},t.serverTimezoneOffset=null,t.throwError=function(t){try{throw new Error(t)}catch(t){throw t.message+"\n"+t.stack}},t.aggregates={sum:function(e,i){for(var n,o=0,r="number"!=typeof t.getVal(e,0,i),s=0;s<e.length;s++)n=t.getVal(e,s,i),isNaN(n)||null===n||(r&&(n=+n),o+=n);return o},average:function(e,i){return t.aggregates.sum(e,i)/e.length},min:function(e,i){var n;return"function"==typeof i&&(n=i,i=null),t.getObject(i,t.getItemFromComparer(e,i,n||t.fnAscending))},max:function(e,i){var n;return"function"==typeof i&&(n=i,i=null),t.getObject(i,t.getItemFromComparer(e,i,n||t.fnDescending))},truecount:function(t,e){return new zu(t).executeLocal((new Lu).where(e,"equal",!0,!0)).length},falsecount:function(t,e){return new zu(t).executeLocal((new Lu).where(e,"equal",!1,!0)).length},count:function(t,e){return t.length}},t.operatorSymbols={"<":"lessthan",">":"greaterthan","<=":"lessthanorequal",">=":"greaterthanorequal","==":"equal","!=":"notequal","*=":"contains","$=":"endswith","^=":"startswith"},t.odBiOperator={"<":" lt ",">":" gt ","<=":" le ",">=":" ge ","==":" eq ","!=":" ne ",lessthan:" lt ",lessthanorequal:" le ",greaterthan:" gt ",greaterthanorequal:" ge ",equal:" eq ",notequal:" ne "},t.odUniOperator={"$=":"endswith","^=":"startswith","*=":"substringof",endswith:"endswith",startswith:"startswith",contains:"substringof"},t.odv4UniOperator={"$=":"endswith","^=":"startswith","*=":"contains",endswith:"endswith",startswith:"startswith",contains:"contains"},t.diacritics={"":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"AA","":"AE","":"AE","":"AE","":"AO","":"AU","":"AV","":"AV","":"AY","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"DZ","":"DZ","":"Dz","":"Dz","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"F","":"F","":"F","":"F","":"F","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"J","":"J","":"J","":"J","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"LJ","":"Lj","":"M","":"M","":"M","":"M","":"M","":"M","":"M","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"NJ","":"Nj","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"OI","":"OO","":"OU","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"Q","":"Q","":"Q","":"Q","":"Q","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"TZ","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"VY","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"X","":"X","":"X","":"X","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"aa","":"ae","":"ae","":"ae","":"ao","":"au","":"av","":"av","":"ay","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"dz","":"dz","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"f","":"f","":"f","":"f","":"f","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"hv","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"j","":"j","":"j","":"j","":"j","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"lj","":"m","":"m","":"m","":"m","":"m","":"m","":"m","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"nj","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"oi","":"ou","":"oo","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"q","":"q","":"q","":"q","":"q","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"tz","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"vy","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"x","":"x","":"x","":"x","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},t.fnOperators={equal:function(e,i,n,o){return o&&(e=t.ignoreDiacritics(e),i=t.ignoreDiacritics(i)),n?t.toLowerCase(e)===t.toLowerCase(i):e===i},notequal:function(e,i,n,o){return o&&(e=t.ignoreDiacritics(e),i=t.ignoreDiacritics(i)),!t.fnOperators.equal(e,i,n)},lessthan:function(e,i,n){return n?t.toLowerCase(e)<t.toLowerCase(i):e<i},greaterthan:function(e,i,n){return n?t.toLowerCase(e)>t.toLowerCase(i):e>i},lessthanorequal:function(e,i,n){return n?t.toLowerCase(e)<=t.toLowerCase(i):e<=i},greaterthanorequal:function(e,i,n){return n?t.toLowerCase(e)>=t.toLowerCase(i):e>=i},contains:function(e,i,n,o){return o&&(e=t.ignoreDiacritics(e),i=t.ignoreDiacritics(i)),n?!c(e)&&!c(i)&&-1!==t.toLowerCase(e).indexOf(t.toLowerCase(i)):!c(e)&&!c(i)&&-1!==e.toString().indexOf(i)},notnull:function(t){return null!==t},isnull:function(t){return null===t},startswith:function(e,i,n,o){return o&&(e=t.ignoreDiacritics(e),i=t.ignoreDiacritics(i)),n?e&&i&&t.startsWith(t.toLowerCase(e),t.toLowerCase(i)):e&&i&&t.startsWith(e,i)},endswith:function(e,i,n,o){return o&&(e=t.ignoreDiacritics(e),i=t.ignoreDiacritics(i)),n?e&&i&&t.endsWith(t.toLowerCase(e),t.toLowerCase(i)):e&&i&&t.endsWith(e,i)},processSymbols:function(e){var i=t.operatorSymbols[e];return i?t.fnOperators[i]:t.throwError("Query - Process Operator : Invalid operator")},processOperator:function(e){var i=t.fnOperators[e];return i||t.fnOperators.processSymbols(e)}},t.parse={parseJson:function(e){return"string"==typeof e?e=JSON.parse(e,t.parse.jsonReviver):e instanceof Array?t.parse.iterateAndReviveArray(e):"object"==typeof e&&t.parse.iterateAndReviveJson(e),e},iterateAndReviveArray:function(e){for(var i=0;i<e.length;i++)"object"==typeof e[i]?t.parse.iterateAndReviveJson(e[i]):"string"!=typeof e[i]||/^[\s]*\[|^[\s]*\{|\"/g.test(e[i])?e[i]=t.parse.parseJson(e[i]):e[i]=t.parse.jsonReviver("",e[i])},iterateAndReviveJson:function(e){for(var i,n=0,o=Object.keys(e);n<o.length;n++){var r=o[n];t.startsWith(r,"__")||("object"==typeof(i=e[r])?i instanceof Array?t.parse.iterateAndReviveArray(i):i&&t.parse.iterateAndReviveJson(i):e[r]=t.parse.jsonReviver(e[r],i))}},jsonReviver:function(e,i){var n=i;if("string"==typeof i){var o=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(i);if(o)return t.dateParse.toTimeZone(new Date(parseInt(o[1],10)),t.serverTimezoneOffset,!0);if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(i)){var r=n.split(/[^0-9]/);i=t.dateParse.toTimeZone(new Date(parseInt(r[0],10),parseInt(r[1],10)-1,parseInt(r[2],10),parseInt(r[3],10),parseInt(r[4],10),parseInt(r[5],10)),t.serverTimezoneOffset,!0)}}return i},isJson:function(e){return"string"==typeof e[0]?e:t.parse.parseJson(e)},isGuid:function(t){return null!=/[A-Fa-f0-9]{8}(?:-[A-Fa-f0-9]{4}){3}-[A-Fa-f0-9]{12}/i.exec(t)},replacer:function(e,i){return t.isPlainObject(e)?t.parse.jsonReplacer(e,i):e instanceof Array?t.parse.arrayReplacer(e):e instanceof Date?t.parse.jsonReplacer({val:e},i).val:e},jsonReplacer:function(e,i){for(var n,o=0,r=Object.keys(e);o<r.length;o++){var s=r[o];if((n=e[s])instanceof Date){var a=n;e[s]=t.dateParse.toTimeZone(t.dateParse.addSelfOffset(a),t.serverTimezoneOffset).toJSON()}}return e},arrayReplacer:function(e){for(var i=0;i<e.length;i++)t.isPlainObject(e[i])?e[i]=t.parse.jsonReplacer(e[i]):e[i]instanceof Date&&(e[i]=t.parse.jsonReplacer({date:e[i]}).date);return e}},t.dateParse={addSelfOffset:function(t){return new Date(+t-6e4*t.getTimezoneOffset())},toUTC:function(t){return new Date(+t+6e4*t.getTimezoneOffset())},toTimeZone:function(e,i,n){if(null===i)return e;var o=n?t.dateParse.toUTC(e):e;return new Date(+o-36e5*i)}},t}(),Tu=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ou=function(){function t(e){this.options={from:"table",requestType:"json",sortBy:"sorted",select:"select",skip:"skip",group:"group",take:"take",search:"search",count:"requiresCounts",where:"where",aggregates:"aggregates"},this.type=t,this.dataSource=e,this.pvt={}}return t.prototype.processResponse=function(t,e,i,n){return t},t}(),Iu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Tu(e,t),e.prototype.processQuery=function(t,e){for(var i,n,o=t.dataSource.json.slice(0),r=o.length,s=!0,a={},l=0;l<e.queries.length;l++)i=this[(n=e.queries[l]).fn].call(this,o,n.e,e),"onAggregates"===n.fn?a[n.e.field+" - "+n.e.type]=i:o=void 0!==i?i:o,"onPage"!==n.fn&&"onSkip"!==n.fn&&"onTake"!==n.fn&&"onRange"!==n.fn||(s=!1),s&&(r=o.length);return e.isCountRequired&&(o={result:o,count:r,aggregates:a}),o},e.prototype.batchRequest=function(t,e,i){var n;for(n=0;n<e.addedRecords.length;n++)this.insert(t,e.addedRecords[n]);for(n=0;n<e.changedRecords.length;n++)this.update(t,i.key,e.changedRecords[n]);for(n=0;n<e.deletedRecords.length;n++)this.remove(t,i.key,e.deletedRecords[n]);return e},e.prototype.onWhere=function(t,e){return t&&t.length?t.filter(function(t){if(e)return e.validate(t)}):t},e.prototype.onAggregates=function(t,e){var i=ku.aggregates[e.type];return t&&i&&0!==t.length?i(t,e.field):null},e.prototype.onSearch=function(t,e){return t&&t.length?(0===e.fieldNames.length&&ku.getFieldList(t[0],e.fieldNames),t.filter(function(t){for(var i=0;i<e.fieldNames.length;i++)if(e.comparer.call(t,ku.getObject(e.fieldNames[i],t),e.searchKey,e.ignoreCase,e.ignoreAccent))return!0;return!1})):t},e.prototype.onSortBy=function(t,e,i){if(!t||!t.length)return t;var n,o=ku.getValue(e.fieldName,i);if(!o)return t.sort(e.comparer);if(o instanceof Array){for(var r=(o=o.slice(0)).length-1;r>=0;r--)o[r]&&(n=e.comparer,ku.endsWith(o[r]," desc")&&(n=ku.fnSort("descending"),o[r]=o[r].replace(" desc","")),t=ku.sort(t,o[r],n));return t}return ku.sort(t,o,e.comparer)},e.prototype.onGroup=function(t,e,i){if(!t||!t.length)return t;var n=Lu.filterQueries(i.queries,"onAggregates"),o=[];if(n.length)for(var r=void 0,s=0;s<n.length;s++)r=n[s].e,o.push({type:r.type,field:ku.getValue(r.field,i)});return ku.group(t,ku.getValue(e.fieldName,i),o,null,null,e.comparer)},e.prototype.onPage=function(t,e,i){var n=ku.getValue(e.pageSize,i),o=(ku.getValue(e.pageIndex,i)-1)*n,r=o+n;return t&&t.length?t.slice(o,r):t},e.prototype.onRange=function(t,e){return t&&t.length?t.slice(ku.getValue(e.start),ku.getValue(e.end)):t},e.prototype.onTake=function(t,e){return t&&t.length?t.slice(0,ku.getValue(e.nos)):t},e.prototype.onSkip=function(t,e){return t&&t.length?t.slice(ku.getValue(e.nos)):t},e.prototype.onSelect=function(t,e){return t&&t.length?ku.select(t,ku.getValue(e.fieldNames)):t},e.prototype.insert=function(t,e,i,n,o){return c(o)?t.dataSource.json.push(e):t.dataSource.json.splice(o,0,e)},e.prototype.remove=function(t,e,i,n){var o,r=t.dataSource.json;for("object"==typeof i&&(i=i[e]),o=0;o<r.length&&r[o][e]!==i;o++);return o!==r.length?r.splice(o,1):null},e.prototype.update=function(t,e,i,n){var o,r=t.dataSource.json,s=i[e];for(o=0;o<r.length&&r[o][e]!==s;o++);return o<r.length?l(r[o],i):null},e}(Ou),Au=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Tu(e,t),e.prototype.processQuery=function(t,e,i){var n,o,r=this.getQueryRequest(e),s=Lu.filterQueryLists(e.queries,["onSelect","onPage","onSkip","onTake","onRange"]),a=e.params,l=t.dataSource.url,h=null,c=this.options,d={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};"onPage"in s?(n=s.onPage,o=((o=ku.getValue(n.pageIndex,e))-1)*(h=ku.getValue(n.pageSize,e))):"onRange"in s&&(o=(n=s.onRange).start,h=n.end-n.start);for(g=0;g<r.sorts.length;g++)n=ku.getValue(r.sorts[g].e.fieldName,e),d.sorts.push(ku.callAdaptorFunction(this,"onEachSort",{name:n,direction:r.sorts[g].e.direction},e));i&&(n=this.getFiltersFrom(i,e))&&d.filters.push(ku.callAdaptorFunction(this,"onEachWhere",n.toJson(),e));for(g=0;g<r.filters.length;g++){d.filters.push(ku.callAdaptorFunction(this,"onEachWhere",r.filters[g].e.toJson(),e));for(var p=0,u="object"==typeof d.filters[g]?Object.keys(d.filters[g]):[];p<u.length;p++){y=u[p];ku.isNull(d[y])&&delete d[y]}}for(g=0;g<r.searches.length;g++)n=r.searches[g].e,d.searches.push(ku.callAdaptorFunction(this,"onEachSearch",{fields:n.fieldNames,operator:n.operator,key:n.searchKey,ignoreCase:n.ignoreCase},e));for(g=0;g<r.groups.length;g++)d.groups.push(ku.getValue(r.groups[g].e.fieldName,e));for(var g=0;g<r.aggregates.length;g++)n=r.aggregates[g].e,d.aggregates.push({type:n.type,field:ku.getValue(n.field,e)});var m={};this.getRequestQuery(c,e,s,d,m),ku.callAdaptorFunction(this,"addParams",{dm:t,query:e,params:a,reqParams:m});for(var f=0,v=Object.keys(m);f<v.length;f++){var y=v[f];(ku.isNull(m[y])||""===m[y]||0===m[y].length)&&delete m[y]}c.skip in m&&c.take in m||null===h||(m[c.skip]=ku.callAdaptorFunction(this,"onSkip",o,e),m[c.take]=ku.callAdaptorFunction(this,"onTake",h,e));var b=this.pvt;return this.pvt={},"json"===this.options.requestType?{data:JSON.stringify(m),url:l,pvtData:b,type:"POST",contentType:"application/json; charset=utf-8"}:(n=this.convertToQueryString(m,e,t),n=(-1!==t.dataSource.url.indexOf("?")?"&":"/")+n,{type:"GET",url:n.length?l.replace(/\/*$/,n):l,pvtData:b})},e.prototype.getRequestQuery=function(t,e,i,n,o){var r=o;r[t.from]=e.fromTable,t.expand&&(r[t.expand]=e.expands),r[t.select]="onSelect"in i?ku.callAdaptorFunction(this,"onSelect",ku.getValue(i.onSelect.fieldNames,e),e):"",r[t.count]=e.isCountRequired?ku.callAdaptorFunction(this,"onCount",e.isCountRequired,e):"",r[t.search]=n.searches.length?ku.callAdaptorFunction(this,"onSearch",n.searches,e):"",r[t.skip]="onSkip"in i?ku.callAdaptorFunction(this,"onSkip",ku.getValue(i.onSkip.nos,e),e):"",r[t.take]="onTake"in i?ku.callAdaptorFunction(this,"onTake",ku.getValue(i.onTake.nos,e),e):"",r[t.where]=n.filters.length||n.searches.length?ku.callAdaptorFunction(this,"onWhere",n.filters,e):"",r[t.sortBy]=n.sorts.length?ku.callAdaptorFunction(this,"onSortBy",n.sorts,e):"",r[t.group]=n.groups.length?ku.callAdaptorFunction(this,"onGroup",n.groups,e):"",r[t.aggregates]=n.aggregates.length?ku.callAdaptorFunction(this,"onAggregates",n.aggregates,e):"",r.param=[]},e.prototype.convertToQueryString=function(t,e,i){return""},e.prototype.processResponse=function(t,e,i,n,o,r){var s=o,a=s.pvtData||{},l=t.groupDs;if(n&&n.getResponseHeader("Content-Type")&&-1!==n.getResponseHeader("Content-Type").indexOf("xml"))return i.isCountRequired?{result:[],count:0}:[];var h=JSON.parse(s.data);if(h&&"batch"===h.action&&t.addedRecords)return r.addedRecords=t.addedRecords,r;t.d&&(t=t.d);var c={};return"count"in t&&(c.count=t.count),c.result=t.result?t.result:t,this.getAggregateResult(a,t,c,l),ku.isNull(c.count)?c.result:{result:c.result,count:c.count,aggregates:c.aggregates}},e.prototype.onGroup=function(t){return this.pvt.groups=t,t},e.prototype.onAggregates=function(t){this.pvt.aggregates=t},e.prototype.batchRequest=function(t,e,i){return{type:"POST",url:t.dataSource.batchUrl||t.dataSource.crudUrl||t.dataSource.removeUrl||t.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({changed:e.changedRecords,added:e.addedRecords,deleted:e.deletedRecords,action:"batch",table:i[void 0],key:i[void 0]})}},e.prototype.beforeSend=function(t,e){},e.prototype.insert=function(t,e,i){return{url:t.dataSource.insertUrl||t.dataSource.crudUrl||t.dataSource.url,data:JSON.stringify({value:e,table:i,action:"insert"})}},e.prototype.remove=function(t,e,i,n){return{type:"POST",url:t.dataSource.removeUrl||t.dataSource.crudUrl||t.dataSource.url,data:JSON.stringify({key:i,keyColumn:e,table:n,action:"remove"})}},e.prototype.update=function(t,e,i,n){return{type:"POST",url:t.dataSource.updateUrl||t.dataSource.crudUrl||t.dataSource.url,data:JSON.stringify({value:i,action:"update",keyColumn:e,key:i[e],table:n})}},e.prototype.getFiltersFrom=function(t,e){var i,n=e.fKey,o=n,r=e.key,s=[];"object"!=typeof t[0]&&(o=null);for(var a=0;a<t.length;a++)i="object"==typeof t[0]?ku.getObject(r||o,t[a]):t[a],s.push(new Eu(n,"equal",i));return Eu.or(s)},e.prototype.getAggregateResult=function(t,e,i,n){var o=e;if(e&&e.result&&(o=e.result),t&&t.aggregates&&t.aggregates.length){var r=t.aggregates,s=void 0,a=o,l={};e.aggregate&&(a=e.aggregate);for(d=0;d<r.length;d++)(s=ku.aggregates[r[d].type])&&(l[r[d].field+" - "+r[d].type]=s(a,r[d].field));i.aggregates=l}if(t&&t.groups&&t.groups.length){for(var h=t.groups,d=0;d<h.length;d++){c(n)||(n=ku.group(n,h[d])),o=ku.group(o,h[d],t.aggregates,null,n)}i.result=o}return i},e.prototype.getQueryRequest=function(t){var e={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};return e.sorts=Lu.filterQueries(t.queries,"onSortBy"),e.groups=Lu.filterQueries(t.queries,"onGroup"),e.filters=Lu.filterQueries(t.queries,"onWhere"),e.searches=Lu.filterQueries(t.queries,"onSearch"),e.aggregates=Lu.filterQueries(t.queries,"onAggregates"),e},e.prototype.addParams=function(t){var e=t.reqParams;t.params.length&&(e.params={});for(var i=0,n=t.params;i<n.length;i++){var o=n[i];if(e[o.key])throw new Error("Query() - addParams: Custom Param is conflicting other request arguments");e[o.key]=o.value,o.fn&&(e[o.key]=o.fn.call(t.query,o.key,t.query,t.dm)),e.params[o.key]=e[o.key]}},e}(Ou),Mu=function(t){function e(){var e=t.call(this)||this;return e.options=h({},e.options,{requestType:"get",accept:"application/json;odata=light;q=1,application/json;odata=verbose;q=0.5",multipartAccept:"multipart/mixed",sortBy:"$orderby",select:"$select",skip:"$skip",take:"$top",count:"$inlinecount",where:"$filter",expand:"$expand",batch:"$batch",changeSet:"--changeset_",batchPre:"batch_",contentId:"Content-Id: ",batchContent:"Content-Type: multipart/mixed; boundary=",changeSetContent:"Content-Type: application/http\nContent-Transfer-Encoding: binary ",batchChangeSetContentType:"Content-Type: application/json; charset=utf-8 "}),e.getModuleName=n("getModulename",e),e}return Tu(e,t),e.prototype.onPredicate=function(t,i,n){var o,r,s="",a=t.value,l=typeof a,h=t.field?e.getField(t.field):null;if(a instanceof Date&&(a="datetime'"+ku.parse.replacer(a)+"'"),"string"===l&&(a="'"+a+"'",n&&(h="cast("+h+", 'Edm.String')"),ku.parse.isGuid(a)&&(r="guid"),t.ignoreCase&&(r||(h="tolower("+h+")"),a=a.toLowerCase())),o=ku.odBiOperator[t.operator])return s+=h,s+=o,r&&(s+=r),s+a;if(c(this.getModuleName)?o=ku.odUniOperator[t.operator]:"ODataV4Adaptor"===this.getModuleName()&&(o=ku.odv4UniOperator[t.operator]),"substringof"===o){var d=a;a=h,h=d}return s+=o+"(",s+=h+",",r&&(s+=r),s+=a+")"},e.prototype.onComplexPredicate=function(t,e,i){for(var n=[],o=0;o<t.predicates.length;o++)n.push("("+this.onEachWhere(t.predicates[o],e,i)+")");return n.join(" "+t.condition+" ")},e.prototype.onEachWhere=function(t,e,i){return t.isComplex?this.onComplexPredicate(t,e,i):this.onPredicate(t,e,i)},e.prototype.onWhere=function(t){return this.pvt.search&&t.push(this.onEachWhere(this.pvt.search,null,!0)),t.join(" and ")},e.prototype.onEachSearch=function(t){t.fields&&0===t.fields.length&&ku.throwError("Query() - Search : oData search requires list of field names to search");for(var e=this.pvt.search||[],i=0;i<t.fields.length;i++)e.push(new Eu(t.fields[i],t.operator,t.key,t.ignoreCase));this.pvt.search=e},e.prototype.onSearch=function(t){return this.pvt.search=Eu.or(this.pvt.search),""},e.prototype.onEachSort=function(t){var i=[];if(t.name instanceof Array)for(var n=0;n<t.name.length;n++)i.push(e.getField(t.name[n])+("descending"===t.direction?" desc":""));else i.push(e.getField(t.name)+("descending"===t.direction?" desc":""));return i.join(",")},e.prototype.onSortBy=function(t){return t.reverse().join(",")},e.prototype.onGroup=function(t){return this.pvt.groups=t,[]},e.prototype.onSelect=function(t){for(var i=0;i<t.length;i++)t[i]=e.getField(t[i]);return t.join(",")},e.prototype.onAggregates=function(t){return this.pvt.aggregates=t,""},e.prototype.onCount=function(t){return!0===t?"allpages":""},e.prototype.beforeSend=function(t,e,i){ku.endsWith(i.url,this.options.batch)&&"post"===i.type.toLowerCase()?(e.setRequestHeader("Accept",this.options.multipartAccept),e.setRequestHeader("DataServiceVersion","2.0"),e.overrideMimeType("text/plain; charset=x-user-defined")):e.setRequestHeader("Accept",this.options.accept),e.setRequestHeader("DataServiceVersion","2.0"),e.setRequestHeader("MaxDataServiceVersion","2.0")},e.prototype.processResponse=function(t,e,i,n,o,r){if(!c(t.d)){var s=i&&i.isCountRequired?t.d.results:t.d;if(!c(s))for(var a=0;a<s.length;a++)c(s[a].__metadata)||delete s[a].__metadata}var l=o&&o.pvtData,h=this.processBatchResponse(t,i,n,o,r);if(h)return h;var d=n&&o.getResponseHeader("DataServiceVersion"),p=null,u=d&&parseInt(d,10)||2;if(i&&i.isCountRequired){(t.__count||t["odata.count"])&&(p=t.__count||t["odata.count"]),t.d&&(t=t.d),(t.__count||t["odata.count"])&&(p=t.__count||t["odata.count"])}3===u&&t.value&&(t=t.value),t.d&&(t=t.d),u<3&&t.results&&(t=t.results);var g={};return g.count=p,g.result=t,this.getAggregateResult(l,t,g),ku.isNull(p)?g.result:{result:g.result,count:g.count,aggregates:g.aggregates}},e.prototype.convertToQueryString=function(t,e,i){var n=[],o=t.table||"";delete t.table,i.dataSource.requiresFormat&&(t.$format="json");for(var r=0,s=Object.keys(t);r<s.length;r++){var a=s[r];n.push(a+"="+t[a])}return n=n.join("&"),i.dataSource.url&&-1!==i.dataSource.url.indexOf("?")&&!o?n:n.length?o+"?"+n:o||""},e.prototype.insert=function(t,e,i){return{url:t.dataSource.url.replace(/\/*$/,i?"/"+i:""),data:JSON.stringify(e)}},e.prototype.remove=function(t,e,i,n){return{type:"DELETE",url:t.dataSource.url.replace(/\/*$/,n?"/"+n:"")+"("+i+")"}},e.prototype.update=function(t,e,i,n){return{type:"PUT",url:t.dataSource.url.replace(/\/*$/,n?"/"+n:"")+"("+i[e]+")",data:JSON.stringify(i),accept:this.options.accept}},e.prototype.batchRequest=function(t,e,i){var n=i.guid=ku.getGuid(this.options.batchPre),o=t.dataSource.url.replace(/\/*$/,"/"+this.options.batch),r={url:i.url,key:i.key,cid:1,cSet:ku.getGuid(this.options.changeSet)},s="--"+n+"\n";return s+="Content-Type: multipart/mixed; boundary="+r.cSet.replace("--","")+"\n",this.pvt.changeSet=0,s+=this.generateInsertRequest(e.addedRecords,r),s+=this.generateUpdateRequest(e.changedRecords,r),s+=this.generateDeleteRequest(e.deletedRecords,r),s+=r.cSet+"--\n",s+="--"+n+"--",{type:"POST",url:o,dataType:"json",contentType:"multipart/mixed; charset=UTF-8;boundary="+n,data:s}},e.prototype.generateDeleteRequest=function(t,e){if(!t)return"";var i={method:"DELETE ",url:function(t,e,i){return"("+t[e][i]+")"},data:function(t,e){return""}};return this.generateBodyContent(t,e,i)+"\n"},e.prototype.generateInsertRequest=function(t,e){if(!t)return"";var i={method:"POST ",url:function(t,e,i){return""},data:function(t,e){return JSON.stringify(t[e])+"\n\n"}};return this.generateBodyContent(t,e,i)},e.prototype.generateUpdateRequest=function(t,e){if(!t)return"";var i={method:"PUT ",url:function(t,e,i){return"("+t[e][i]+")"},data:function(t,e){return JSON.stringify(t[e])+"\n\n"}};return this.generateBodyContent(t,e,i)},e.getField=function(t){return t.replace(/\./g,"/")},e.prototype.generateBodyContent=function(t,e,i){for(var n="",o=0;o<t.length;o++)n+="\n"+e.cSet+"\n",n+=this.options.changeSetContent+"\n\n",n+=i.method,n+=e.url+i.url(t,o,e.key)+" HTTP/1.1\n",n+="Accept: "+this.options.accept+"\n",n+="Content-Id: "+this.pvt.changeSet+++"\n",n+=this.options.batchChangeSetContentType+"\n\n",n+=i.data(t,o);return n},e.prototype.processBatchResponse=function(t,e,i,n,o){if(i&&i.getResponseHeader("Content-Type")&&-1!==i.getResponseHeader("Content-Type").indexOf("xml"))return e.isCountRequired?{result:[],count:0}:[];if(n&&this.options.batch&&ku.endsWith(n.url,this.options.batch)&&"post"===n.type.toLowerCase()){var r=i.getResponseHeader("Content-Type"),s=void 0,a=void 0,l=t+"";if(r=r.substring(r.indexOf("=batchresponse")+1),(l=l.split(r)).length<2)return{};l=l[1];var c=/(?:\bContent-Type.+boundary=)(changesetresponse.+)/i.exec(l);c&&l.replace(c[0],"");for(var d=c?c[1]:"",p=(l=l.split(d)).length;p>-1;p--)/\bContent-ID:/i.test(l[p])&&/\bHTTP.+201/.test(l[p])&&(s=parseInt(/\bContent-ID: (\d+)/i.exec(l[p])[1],10),o.addedRecords[s]&&(a=ku.parse.parseJson(/^\{.+\}/m.exec(l[p])[0]),h({},o.addedRecords[s],this.processResponse(a))));return o}return null},e}(Au),Ru=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.options=h({},e.options,{requestType:"get",accept:"application/json, text/javascript, */*; q=0.01",multipartAccept:"multipart/mixed",sortBy:"$orderby",select:"$select",skip:"$skip",take:"$top",count:"$count",search:"$search",where:"$filter",expand:"$expand",batch:"$batch",changeSet:"--changeset_",batchPre:"batch_",contentId:"Content-Id: ",batchContent:"Content-Type: multipart/mixed; boundary=",changeSetContent:"Content-Type: application/http\nContent-Transfer-Encoding: binary ",batchChangeSetContentType:"Content-Type: application/json; charset=utf-8 "}),e}return Tu(e,t),e.prototype.getModulename=function(){return"ODataV4Adaptor"},e.prototype.onCount=function(t){return!0===t?"true":""},e.prototype.onPredicate=function(e,i,n){var o="",r=e.value instanceof Date;return o=t.prototype.onPredicate.call(this,e,i,n),r&&(o=o.replace(/datetime'(.*)'$/,"$1")),o},e.prototype.onEachSearch=function(t){var e=this.pvt.searches||[];e.push(t.key),this.pvt.searches=e},e.prototype.onSearch=function(t){return this.pvt.searches.join(" OR ")},e.prototype.beforeSend=function(t,e,i){e.setRequestHeader("Accept",this.options.accept)},e.prototype.processResponse=function(e,i,n,o,r,s){var a=r&&r.pvtData,l=t.prototype.processBatchResponse.call(this,e,n,o,r,s);if(l)return l;var h=null;n&&n.isCountRequired&&"@odata.count"in e&&(h=e["@odata.count"]),e=e.value;var c={};return c.count=h,c.result=e,this.getAggregateResult(a,e,c),ku.isNull(h)?c.result:{result:c.result,count:h,aggregates:c.aggregates}},e}(Mu),Du=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Tu(e,t),e.prototype.insert=function(t,e,i){return{type:"POST",url:t.dataSource.url,data:JSON.stringify(e)}},e.prototype.remove=function(t,e,i,n){return{type:"DELETE",url:t.dataSource.url+"/"+i,data:JSON.stringify(i)}},e.prototype.update=function(t,e,i,n){return{type:"PUT",url:t.dataSource.url,data:JSON.stringify(i)}},e.prototype.beforeSend=function(t,e,i){e.setRequestHeader("Accept","application/json, text/javascript, */*; q=0.01")},e.prototype.processResponse=function(t,e,i,n,o,r){var s=o&&o.pvtData,a=null,l={};if(o&&"post"!==o.type.toLowerCase()){var h=n&&o.getResponseHeader("DataServiceVersion"),c=h&&parseInt(h,10)||2;i&&i.isCountRequired&&(ku.isNull(t.Count)||(a=t.Count)),c<3&&t.Items&&(t=t.Items),l.count=a,l.result=t,this.getAggregateResult(s,t,l)}return l.result=l.result||t,ku.isNull(a)?l.result:{result:l.result,count:l.count,aggregates:l.aggregates}},e}(Mu),Bu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Tu(e,t),e.prototype.processQuery=function(t,e,i){var n=(new Au).processQuery(t,e,i),o=ku.parse.parseJson(n.data),r={};if(o.param)for(var s=0;s<o.param.length;s++){var a=o.param[s],l=Object.keys(a)[0];r[l]=a[l]}r.value=o;return{data:JSON.stringify(r),url:n.url,pvtData:n.pvtData,type:"POST",contentType:"application/json; charset=utf-8"}},e}(Au),Nu=function(t){function e(){var e=t.call(this)||this;return o("beforeSend",Au.prototype.beforeSend,e),e}return Tu(e,t),e.prototype.insert=function(e,i,n){return t.prototype.insert.call(this,e,i,null,null,0),{url:e.dataSource.insertUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify({value:i,table:n,action:"insert"})}},e.prototype.remove=function(e,i,n,o){return t.prototype.remove.call(this,e,i,n),{type:"POST",url:e.dataSource.removeUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify({key:n,keyColumn:i,table:o,action:"remove"})}},e.prototype.update=function(e,i,n,o){return t.prototype.update.call(this,e,i,n),{type:"POST",url:e.dataSource.updateUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify({value:n,action:"update",keyColumn:i,key:n[i],table:o})}},e.prototype.batchRequest=function(t,e,i){var n;for(n=0;n<e.addedRecords.length;n++)Iu.prototype.insert(t,e.addedRecords[n]);for(n=0;n<e.changedRecords.length;n++)Iu.prototype.update(t,i.key,e.changedRecords[n]);for(n=0;n<e.deletedRecords.length;n++)Iu.prototype.remove(t,i.key,e.deletedRecords[n]);return{type:"POST",url:t.dataSource.batchUrl||t.dataSource.crudUrl||t.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({changed:e.changedRecords,added:e.addedRecords,deleted:e.deletedRecords,action:"batch",table:i.url,key:i.key})}},e}(Iu),Hu=function(t){function e(e,i,n){var o=t.call(this)||this;o.isCrudAction=!1,o.isInsertAction=!1,c(e)||(o.cacheAdaptor=e),o.pageSize=n,o.guidId=ku.getGuid("cacheAdaptor");var r={keys:[],results:[]};window.localStorage.setItem(o.guidId,JSON.stringify(r));var s=o.guidId;return c(i)||setInterval(function(){var t;t=ku.parse.parseJson(window.localStorage.getItem(s));for(var e=[],n=0;n<t.results.length;n++){var o=+new Date,r=+new Date(t.results[n].timeStamp);t.results[n].timeStamp=o-r,o-r>i&&e.push(n)}for(n=0;n<e.length;n++)t.results.splice(e[n],1),t.keys.splice(e[n],1);window.localStorage.removeItem(s),window.localStorage.setItem(s,JSON.stringify(t))},i),o}return Tu(e,t),e.prototype.generateKey=function(t,e){var i=this.getQueryRequest(e),n=Lu.filterQueryLists(e.queries,["onSelect","onPage","onSkip","onTake","onRange"]),o=t;"onPage"in n&&(o+=n.onPage.pageIndex),i.sorts.forEach(function(t){o+=t.e.direction+t.e.fieldName}),i.groups.forEach(function(t){o+=t.e.fieldName}),i.searches.forEach(function(t){o+=t.e.searchKey});for(var r=0;r<i.filters.length;r++){var s=i.filters[r];if(s.e.isComplex){var a=e.clone();a.queries=[];for(var l=0;l<s.e.predicates.length;l++)a.queries.push({fn:"onWhere",e:s.e.predicates[l],filter:e.queries.filter});o+=s.e.condition+this.generateKey(t,a)}else o+=s.e.field+s.e.operator+s.e.value}return o},e.prototype.processQuery=function(t,e,i){var n,o=this.generateKey(t.dataSource.url,e),r=(n=ku.parse.parseJson(window.localStorage.getItem(this.guidId)))?n.results[n.keys.indexOf(o)]:null;return null==r||this.isCrudAction||this.isInsertAction?(this.isCrudAction=null,this.isInsertAction=null,this.cacheAdaptor.processQuery.apply(this.cacheAdaptor,[].slice.call(arguments,0))):r},e.prototype.processResponse=function(t,e,i,n,o,r){if(this.isInsertAction||o&&this.cacheAdaptor.options.batch&&ku.endsWith(o.url,this.cacheAdaptor.options.batch)&&"post"===o.type.toLowerCase())return this.cacheAdaptor.processResponse(t,e,i,n,o,r);t=this.cacheAdaptor.processResponse.apply(this.cacheAdaptor,[].slice.call(arguments,0));var s=i?this.generateKey(e.dataSource.url,i):e.dataSource.url,a={},l=(a=ku.parse.parseJson(window.localStorage.getItem(this.guidId))).keys.indexOf(s);for(-1!==l&&(a.results.splice(l,1),a.keys.splice(l,1)),a.results[a.keys.push(s)-1]={keys:s,result:t.result,timeStamp:new Date,count:t.count};a.results.length>this.pageSize;)a.results.splice(0,1),a.keys.splice(0,1);return window.localStorage.setItem(this.guidId,JSON.stringify(a)),t},e.prototype.beforeSend=function(t,e,i){ku.endsWith(i.url,this.cacheAdaptor.options.batch)&&"post"===i.type.toLowerCase()&&e.setRequestHeader("Accept",this.cacheAdaptor.options.multipartAccept),t.dataSource.crossDomain||e.setRequestHeader("Accept",this.cacheAdaptor.options.accept)},e.prototype.update=function(t,e,i,n){return this.isCrudAction=!0,this.cacheAdaptor.update(t,e,i,n)},e.prototype.insert=function(t,e,i){return this.isInsertAction=!0,this.cacheAdaptor.insert(t,e,i)},e.prototype.remove=function(t,e,i,n){return this.isCrudAction=!0,this.cacheAdaptor.remove(t,e,i,n)},e.prototype.batchRequest=function(t,e,i){return this.cacheAdaptor.batchRequest(t,e,i)},e}(Au),zu=function(){function t(t,e,i){var n=this;this.dateParse=!0,this.requests=[],t||this.dataSource||(t=[]),i=i||t.adaptor;var o;return t instanceof Array?o={json:t,offline:!0}:"object"==typeof t?(t.json||(t.json=[]),o={url:t.url,insertUrl:t.insertUrl,removeUrl:t.removeUrl,updateUrl:t.updateUrl,crudUrl:t.crudUrl,batchUrl:t.batchUrl,json:t.json,headers:t.headers,accept:t.accept,data:t.data,timeTillExpiration:t.timeTillExpiration,cachingPageSize:t.cachingPageSize,enableCaching:t.enableCaching,requestType:t.requestType,key:t.key,crossDomain:t.crossDomain,jsonp:t.jsonp,dataType:t.dataType,offline:void 0!==t.offline?t.offline:!(t.adaptor instanceof Nu)&&!t.url,requiresFormat:t.requiresFormat}):ku.throwError("DataManager: Invalid arguments"),void 0!==o.requiresFormat||ku.isCors()||(o.requiresFormat=!!c(o.crossDomain)||o.crossDomain),void 0===o.dataType&&(o.dataType="json"),this.dataSource=o,this.defaultQuery=e,o.url&&o.offline&&!o.json.length?(this.isDataAvailable=!1,this.adaptor=i||new Mu,this.dataSource.offline=!1,this.ready=this.executeQuery(e||new Lu),this.ready.then(function(t){n.dataSource.offline=!0,n.isDataAvailable=!0,o.json=t.result,n.adaptor=new Iu})):this.adaptor=o.offline?new Iu:new Mu,!o.jsonp&&this.adaptor instanceof Mu&&(o.jsonp="callback"),this.adaptor=i||this.adaptor,o.enableCaching&&(this.adaptor=new Hu(this.adaptor,o.timeTillExpiration,o.cachingPageSize)),this}return t.prototype.setDefaultQuery=function(t){return this.defaultQuery=t,this},t.prototype.executeLocal=function(e){this.defaultQuery||e instanceof Lu||ku.throwError("DataManager - executeLocal() : A query is required to execute"),this.dataSource.json||ku.throwError("DataManager - executeLocal() : Json data is required to execute"),e=e||this.defaultQuery;var i=this.adaptor.processQuery(this,e);if(e.subQuery){var n=e.subQuery.fromTable,o=e.subQuery.lookups,r=e.isCountRequired?i.result:i;o&&o instanceof Array&&ku.buildHierarchy(e.subQuery.fKey,n,r,o,e.subQuery.key);for(var s=0;s<r.length;s++)r[s][n]instanceof Array&&(r[s]=h({},{},r[s]),r[s][n]=this.adaptor.processResponse(e.subQuery.using(new t(r[s][n].slice(0))).executeLocal(),this,e))}return this.adaptor.processResponse(i,this,e)},t.prototype.executeQuery=function(e,i,n,o){var r=this;"function"==typeof e&&(n,n=i,i=e,e=null),e||(e=this.defaultQuery),e instanceof Lu||ku.throwError("DataManager - executeQuery() : A query is required to execute");var s=new ju,a={query:e};if(this.dataSource.offline||void 0===this.dataSource.url)t.nextTick(function(){var i=r.executeLocal(e);a=t.getDeferedArgs(e,i,a),s.resolve(a)});else{var l=this.adaptor.processQuery(this,e);this.makeRequest(l,s,a,e)}return s.promise},t.getDeferedArgs=function(t,e,i){return t.isCountRequired?(i.result=e.result,i.count=e.count,i.aggregates=e.aggregates):i.result=e,i},t.nextTick=function(t){(window.setImmediate||window.setTimeout)(t,0)},t.prototype.extendRequest=function(t,e,i){return h({},{type:"GET",dataType:this.dataSource.dataType,crossDomain:this.dataSource.crossDomain,jsonp:this.dataSource.jsonp,cache:!0,processData:!1,onSuccess:e,onFailure:i},t)},t.prototype.makeRequest=function(t,e,i,n){var o=this,r=!!n.subQuerySelector,s=function(t){i.error=t,e.reject(i)},a=function(t,n,o,r,s,a,l){i.xhr=o,i.count=n?parseInt(n.toString(),10):0,i.result=t,i.request=r,i.aggregates=a,i.actual=s,i.virtualSelectRecords=l,e.resolve(i)},l=function(t,e){var l=new ju,h={parent:i};n.subQuery.isChild=!0;var c=o.adaptor.processQuery(o,n.subQuery,t?o.adaptor.processResponse(t):e),d=o.makeRequest(c,l,h,n.subQuery);return r||l.then(function(e){t&&(ku.buildHierarchy(n.subQuery.fKey,n.subQuery.fromTable,t,e,n.subQuery.key),a(t,e.count,e.xhr))},s),d},h=function(t,e){-1===e.httpRequest.getResponseHeader("Content-Type").indexOf("xml")&&o.dateParse&&(t=ku.parse.parseJson(t));var i=o.adaptor.processResponse(t,o,n,e.httpRequest,e),s=0,h=null,c=t.virtualSelectRecords;if(n.isCountRequired&&(s=i.count,h=i.aggregates,i=i.result),!n.subQuery)return void a(i,s,e.httpRequest,e.type,t,h,c);r||l(i,e)},c=this.extendRequest(t,h,s),d=new Aa(c);if(d.beforeSend=function(){o.beforeSend(d.httpRequest,d)},(c=d.send()).catch(function(t){return!0}),this.requests.push(d),r){var p=n.subQuerySelector.call(this,{query:n.subQuery,parent:n});p&&p.length?Promise.all([c,l(null,p)]).then(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0],s=o.adaptor.processResponse(i[0],o,n,o.requests[0].httpRequest,o.requests[0]),l=0;n.isCountRequired&&(l=s.count,s=s.result);var h=o.adaptor.processResponse(i[1],o,n.subQuery,o.requests[1].httpRequest,o.requests[1]);l=0,n.subQuery.isCountRequired&&(l=h.count,h=h.result),ku.buildHierarchy(n.subQuery.fKey,n.subQuery.fromTable,s,h,n.subQuery.key),r=!1,a(s,l,o.requests[0].httpRequest)}):r=!1}return c},t.prototype.beforeSend=function(t,e){this.adaptor.beforeSend(this,t,e);for(var i,n=this.dataSource.headers,o=0;n&&o<n.length;o++){i=[];for(var r=0,s=Object.keys(n[o]);r<s.length;r++){var a=s[r];i.push(a),t.setRequestHeader(a,n[o][a])}}},t.prototype.saveChanges=function(t,e,i,n){var o=this;i instanceof Lu&&(n=i,i=null);var r={url:i,key:e||this.dataSource.key},s=this.adaptor.batchRequest(this,t,r,n);if(this.dataSource.offline)return s;var a=new ju,l=new Aa(s);return l.beforeSend=function(){o.beforeSend(l.httpRequest,l)},l.onSuccess=function(e,i){a.resolve(o.adaptor.processResponse(ku.parse.parseJson(e),o,null,i.httpRequest,i,t))},l.onFailure=function(t){a.reject([{error:t}])},l.send().catch(function(t){return!0}),a.promise},t.prototype.insert=function(t,e,i,n){e instanceof Lu&&(i=e,e=null);var o=this.adaptor.insert(this,t,e,i,n);return this.dataSource.offline?o:this.doAjaxRequest(o)},t.prototype.remove=function(t,e,i,n){"object"==typeof e&&(e=e[t]),i instanceof Lu&&(n=i,i=null);var o=this.adaptor.remove(this,t,e,i,n);return this.dataSource.offline?o:this.doAjaxRequest(o)},t.prototype.update=function(t,e,i,n){i instanceof Lu&&(n=i,i=null);var o=this.adaptor.update(this,t,e,i,n);return this.dataSource.offline?o:this.doAjaxRequest(o)},t.prototype.doAjaxRequest=function(t){var e=this,i=new ju;t=h({},{type:"POST",contentType:"application/json; charset=utf-8",processData:!1},t);var n=new Aa(t);return n.beforeSend=function(){e.beforeSend(n.httpRequest,n)},n.onSuccess=function(t,n){try{ku.parse.parseJson(t)}catch(e){t=[]}t=e.adaptor.processResponse(ku.parse.parseJson(t),e,null,n.httpRequest,n),i.resolve(t)},n.onFailure=function(t){i.reject([{error:t}])},n.send().catch(function(t){return!0}),i.promise},t}(),ju=function(){function t(){var t=this;this.promise=new Promise(function(e,i){t.resolve=e,t.reject=i}),this.then=this.promise.then.bind(this.promise),this.catch=this.promise.catch.bind(this.promise)}return t}(),Vu=Object.freeze({DataManager:zu,Deferred:ju,Query:Lu,Predicate:Eu,Adaptor:Ou,JsonAdaptor:Iu,UrlAdaptor:Au,ODataAdaptor:Mu,ODataV4Adaptor:Ru,WebApiAdaptor:Du,WebMethodAdaptor:Bu,RemoteSaveAdaptor:Nu,CacheAdaptor:Hu,DataUtil:ku}),Fu=function(){function t(){this.dataTable={}}return t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"DataBinding"},t.prototype.initData=function(t,e){var i,n=t.dataManager||{};(i=t.data||n.data||n.json||(n.dataSource?n.dataSource.json:void 0))&&i.length&&this.applyDataSource(t,i,e)},t.prototype.initSource=function(t,e){var i,n=this,o=t;if(t.dataManager instanceof zu){var r=o.dataManager.defaultQuery;t.dataManager.executeQuery(r).then(function(o){i=o.result,e.isDestroyed||(n.applyDataSource(t,i,e),e.refreshDiagram(),e.trigger("dataLoaded",{diagram:e}))})}},t.prototype.applyDataSource=function(t,e,i){this.dataTable={};var n,o,r,s,a=[],l=[];if(void 0!==e){for(var h=0;h<e.length;h++)void 0===(n=e[h])[t.parentId]||null===n[t.parentId]||"object"!=typeof n[t.parentId]?void 0!==a[n[t.parentId]]?a[n[t.parentId]].items.push(n):a[n[t.parentId]]={items:[n]}:a=this.updateMultipleRootNodes(n,a,t,e),t.root===n[t.id]&&(o={items:[n]});if(o)l.push(o);else for(var c=0,d=Object.keys(a);c<d.length;c++){var p=d[c];p&&"undefined"!==p&&"''"!==p&&"null"!==p||l.push(a[p])}for(var u=0;u<l.length;u++)for(var g=0;g<l[u].items.length;g++){r=l[u].items[g];var m=this.applyNodeTemplate(t,r,i);i.nodes.push(m),this.dataTable[r[t.id]]=m,void 0!==(s=a[m.data[t.id]])&&this.renderChildNodes(t,s,m.id,a,i)}}this.dataTable=null},t.prototype.updateMultipleRootNodes=function(t,e,i,n){for(var o,r=t[i.parentId],s=0;s<r.length;s++)e[o=r[s]]?e[o].items.push(t):e[o]={items:[t]};return e},t.prototype.applyNodeTemplate=function(t,e,i){var n={id:te(),data:e},o=fe(t.doBinding);o&&o(n,e,i);var r=new gp(i,"nodes",n,!0);return this.collectionContains(r,i,t.id,t.parentId)?this.dataTable[e[t.id]]:r},t.prototype.renderChildNodes=function(t,e,i,n,o){for(var r,s,a,l=0;l<e.items.length;l++){r=e.items[l],a=this.applyNodeTemplate(t,r,o);var h=!1;this.collectionContains(a,o,t.id,t.parentId)?h=!0:(this.dataTable[r[t.id]]=a,o.nodes.push(a)),this.containsConnector(o,i,a.id)||o.connectors.push(this.applyConnectorTemplate(i,a.id,o)),h||void 0!==(s=n[a.data[t.id]])&&this.renderChildNodes(t,s,a.id,n,o)}},t.prototype.containsConnector=function(t,e,i){if(""!==e&&""!==i)for(var n=0;n<t.connectors.length;n++){var o=t.connectors[n];if(void 0!==o&&o.sourceID===e&&o.targetID===i)return!0}return!1},t.prototype.collectionContains=function(t,e,i,n){var o=this.dataTable[t.data[i]];return void 0!==o&&o.data[i]===t.data[i]&&o.data[n]===t.data[n]},t.prototype.applyConnectorTemplate=function(t,e,i){var n={id:te(),sourceID:t,targetID:e};return new Vd(i,"connectors",n,!0)},t}(),_u={li:"e-list-item",ul:"e-list-parent e-ul",group:"e-list-group-item",icon:"e-list-icon",text:"e-list-text",check:"e-list-check",checked:"e-checked",selected:"e-selected",expanded:"e-expanded",textContent:"e-text-content",hasChild:"e-has-child",level:"e-level",url:"e-list-url",collapsible:"e-icon-collapsible",disabled:"e-disabled",image:"e-list-img",iconWrapper:"e-icon-wrapper"};!function(t){function e(t,e,n){var o=h({},B,e),s=h({},D,o.ariaAttributes),a=m(t).typeof;return"string"===a||"number"===a?i(t,n,e):r(t,e,s.level,n)}function i(t,e,i){return A(n(t,e,i),null,i)}function n(t,e,i){var n=[],o=h({},B,i);_u=C(o.moduleName);for(var r=w(),s=0;s<t.length;s++)if(!c(t[s])){var a=void 0;if(o.itemCreating&&"function"==typeof o.itemCreating){l={dataSource:t,curData:t[s],text:t[s],options:o};o.itemCreating(l)}if(a=e?S(t[s],null,null,[],null,r,s,i):k(t[s],null,null,i),o.itemCreated&&"function"==typeof o.itemCreated){var l={dataSource:t,curData:t[s],text:t[s],item:a,options:o};o.itemCreated(l)}n.push(a)}return n}function o(e,i,n,o){var r=h({},B,i);_u=C(r.moduleName);var s,a=h({},t.defaultMappedFields,r.fields),d=h({},D,r.ariaAttributes);n&&(d.level=n);var p,u=[];Object.keys(e).length&&!m(e).item.hasOwnProperty(a.id)&&(s=w());for(var g=0;g<e.length;g++){var v=Bs(e[g],a);if(!c(e[g])){if(r.itemCreating&&"function"==typeof r.itemCreating){P={dataSource:e,curData:e[g],text:v[a.text],options:r,fields:a};r.itemCreating(P)}var y=e[g];r.itemCreating&&"function"==typeof r.itemCreating&&(v=Bs(e[g],a)),Object.keys(e).length&&v.hasOwnProperty(a.id)&&!c(v[a.id])&&(s=v.id);var b=[];if(r.showCheckBox&&b.push(L("input",{className:_u.check,attrs:{type:"checkbox"}})),!0===o)r.showIcon&&v.hasOwnProperty(a.iconCss)&&(c(v[a.iconCss])||b.push(L("span",{className:_u.icon+" "+v[a.iconCss]}))),p=S(y,a,r.itemClass,b,!(!y.hasOwnProperty("isHeader")||!y.isHeader),s,g,i);else{if((p=k(y,a,r.itemClass,i)).classList.add(_u.level+"-"+d.level),p.setAttribute("aria-level",d.level.toString()),v.hasOwnProperty(a.tooltip)&&p.setAttribute("title",v[a.tooltip]),v.hasOwnProperty(a.htmlAttributes)&&v[a.htmlAttributes]&&f(p,v[a.htmlAttributes]),v.hasOwnProperty(a.enabled)&&!1===v[a.enabled]&&p.classList.add(_u.disabled),v.hasOwnProperty(a.isVisible)&&!1===v[a.isVisible]&&(p.style.display="none"),v.hasOwnProperty(a.imageUrl)&&!c(v[a.imageUrl])){var E={src:v[a.imageUrl]};v.hasOwnProperty(a.imageUrl)&&l(E,v[a.imageAttributes]),O([L("img",{className:_u.image,attrs:E})],p.firstElementChild)}r.showIcon&&v.hasOwnProperty(a.iconCss)&&!r.template&&(c(v[a.iconCss])||O([L("div",{className:_u.icon+" "+v[a.iconCss]})],p.firstElementChild)),b.length&&O(b,p.firstElementChild),x(y,a,e,r,p,d.level)}if(r.itemCreated&&"function"==typeof r.itemCreated){var P={dataSource:e,curData:e[g],text:v[a.text],item:p,options:r,fields:a};r.itemCreated(P)}u.push(p)}}return u}function r(t,e,i,n){var r=h({},B,e);return A(o(t,e,i,n),r.listClass,e)}function s(t,e,i){if(_u=C(B.moduleName),t&&t.length){var n,o,r=Array.prototype.slice.call(t);for(n=r[(o=e?a(e,r):!0===i?r.length:-1)+(!0===i?-1:1)];n&&(!T(n)||n.classList.contains(_u.disabled));)n=r[o+=!0===i?-1:1];return n}}function a(t,e){if(e&&t){return Array.prototype.slice.call(e).indexOf(t)}}function d(t,e,i){void 0===i&&(i="None");var n=(new Lu).group(e.groupBy),o=u(t,n=p(i,"key",n));t=[];for(var r=0;r<o.length;r++){var s=o[r].items,a={};a[e.text]=o[r].key,a.isHeader=!0,a.id="group-list-item-"+(o[r].key?o[r].key.toString().trim():"undefined"),a.items=s,t.push(a);for(var l=0;l<s.length;l++)t.push(s[l])}return t}function p(t,e,i){if(void 0===i&&(i=new Lu),"Ascending"===t)i.sortBy(e,"ascending",!0);else if("Descending"===t)i.sortBy(e,"descending",!0);else for(var n=0;n<i.queries.length;n++)"onSortBy"===i.queries[n].fn&&i.queries.splice(n,1);return i}function u(t,e){return new zu(t).executeLocal(e)}function g(e,i){var n=h({},B,i),o=h({},t.defaultMappedFields,n.fields),r=e.cloneNode(!0),s=[];r.classList.add("json-parent");var a=r.querySelectorAll(".json-parent>li");r.classList.remove("json-parent");for(var l=0;l<a.length;l++){for(var c=a[l],d=c.querySelector("a"),p=c.querySelector("ul"),u={},m=d?d.childNodes:c.childNodes,f=Object.keys(m),y=0;y<m.length;y++)m[Number(f[y])].hasChildNodes()||(u[o.text]=m[Number(f[y])].textContent);u[o.id]=w();var b=v(c);Object.keys(b).length&&(u[o.htmlAttributes]=b),d&&(b=v(d),Object.keys(b).length&&(u[o.urlAttributes]=b)),p&&(u[o.child]=g(p,i)),s.push(u)}return s}function m(t){for(var e={typeof:null,item:null},i=0;i<t.length;i++)if(!c(t[i]))return e={typeof:typeof t[i],item:t[i]};return e}function f(t,e){var i={};l(i,e),i.class&&(E([t],i.class.split(" ")),delete i.class),R(t,i)}function v(t){for(var e={},i=t.attributes,n=0;n<i.length;n++)e[i[n].nodeName]=i[n].nodeValue;return e}function y(t,e,i,n){for(var o=L("ul",{className:(_u=C(B.moduleName)).ul,attrs:{role:"presentation"}}),r=h({},B,n),s=Tt(t),a=[],l=w(),c=0;c<e.length;c++){var d=Bs(e[c],i),p=e[c],u=p.isHeader,g="string"==typeof p||"number"==typeof p?p:d[i.value];if(r.itemCreating&&"function"==typeof r.itemCreating){f={dataSource:e,curData:p,text:g,options:r,fields:i};r.itemCreating(f)}r.itemCreating&&"function"==typeof r.itemCreating&&(g=(d=Bs(e[c],i))[i.value]);var m=L("li",{id:l+"-"+c,className:u?_u.group:_u.li,attrs:{role:"presentation"}});if(u?m.innerText=d[i.text]:(I(s(p),m),m.setAttribute("data-value",g),m.setAttribute("role","option")),r.itemCreated&&"function"==typeof r.itemCreated){var f={dataSource:e,curData:p,text:g,item:m,options:r,fields:i};r.itemCreated(f)}a.push(m)}return I(a,o),o}function b(t,e,i,n){for(var o=Tt(t),r=i.groupBy,s=0,a=n;s<a.length;s++){var l=a[s],h={};h[r]=l.textContent,l.innerHTML="",I(o(h),l)}return n}function w(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function x(t,e,i,n,o,s){var a=Bs(t,e),l=a[e.child]||[],h=a[e.hasChildren];if(l.length&&(h=!0,o.classList.add(_u.hasChild),n.processSubChild)){var c=r(l,n,++s);o.appendChild(c)}n.expandCollapse&&h&&!n.template&&(o.firstElementChild.classList.contains(_u.textContent)&&o.firstElementChild.classList.add(_u.iconWrapper),("Left"===n.expandIconPosition?O:I)([L("div",{className:"e-icons "+n.expandIconClass})],o.querySelector("."+_u.textContent)))}function S(t,e,i,n,o,r,s,a){var l,d=h({},B,a),p=h({},D,d.ariaAttributes),u=t,g=t,m=Bs(t,e);"string"!=typeof t&&"number"!=typeof t&&"boolean"!=typeof t&&(l=t,u="boolean"==typeof m[e.text]||"number"==typeof m[e.text]?m[e.text]:m[e.text]||"",g=m[e.value]);var v;v=c(l)||c(m[e.id])||""===m[e.id]?r+"-"+s:r;var y=L("li",{className:(!0===o?_u.group:_u.li)+" "+(c(i)?"":i),id:v,attrs:""!==p.groupItemRole&&""!==p.itemRole?{role:!0===o?p.groupItemRole:p.itemRole}:{}});return l&&m.hasOwnProperty(e.enabled)&&"false"===m[e.enabled].toString()&&y.classList.add(_u.disabled),o?y.innerText=u:(c(g)||y.setAttribute("data-value",g),y.setAttribute("role","option"),l&&m.hasOwnProperty(e.htmlAttributes)&&m[e.htmlAttributes]&&f(y,m[e.htmlAttributes]),n.length&&I(n,y),l&&m.hasOwnProperty(e.url)&&m[e.url]?y.appendChild(P(l,e,u)):y.appendChild(document.createTextNode(u))),y}function C(t){return{li:"e-"+t+"-item",ul:"e-"+t+"-parent e-ul",group:"e-"+t+"-group-item",icon:"e-"+t+"-icon",text:"e-"+t+"-text",check:"e-"+t+"-check",checked:"e-checked",selected:"e-selected",expanded:"e-expanded",textContent:"e-text-content",hasChild:"e-has-child",level:"e-level",url:"e-"+t+"-url",collapsible:"e-icon-collapsible",disabled:"e-disabled",image:"e-"+t+"-img",iconWrapper:"e-icon-wrapper"}}function P(t,e,i){var n=Bs(t,e),o={href:n[e.url]};n.hasOwnProperty(e.urlAttributes)&&n[e.urlAttributes]&&l(o,n[e.urlAttributes]);var r=L("a",{className:_u.text+" "+_u.url,innerHTML:i});return f(r,o),r}function k(t,e,i,n){var o,r,s,a,l=h({},B,n),d=h({},D,l.ariaAttributes),p=t;"string"!=typeof t&&"number"!=typeof t&&(s=t,p=(a=Bs(t,e))[e.text]||"",o=a[e.id],r=!(!t.hasOwnProperty("isHeader")||!t.isHeader));var u=L("li",{className:(!0===r?_u.group:_u.li)+" "+(c(i)?"":i),attrs:""!==d.groupItemRole&&""!==d.itemRole?{role:!0===r?d.groupItemRole:d.itemRole}:{}});if(c(o)?u.setAttribute("data-uid",w()):u.setAttribute("data-uid",o),r&&n&&n.groupTemplate)I((g=Tt(n.groupTemplate))(t),u);else if(!r&&n&&n.template){var g=Tt(n.template);I(g(t),u)}else{var m=L("div",{className:_u.textContent,attrs:""!==d.wrapperRole?{role:d.wrapperRole}:{}});s&&a.hasOwnProperty(e.url)&&a[e.url]?m.appendChild(P(s,e,p)):m.appendChild(L("span",{className:_u.text,innerHTML:p,attrs:""!==d.itemText?{role:d.itemText}:{}})),u.appendChild(m)}return u}function A(t,e,i){var n=h({},B,i),o=h({},D,n.ariaAttributes),r=L("ul",{className:(_u=C(n.moduleName)).ul+" "+(c(e)?"":e),attrs:""!==o.listRole?{role:o.listRole}:{}});return I(t,r),r}function M(t,e,i){var n=h({},B,i);h({},D,n.ariaAttributes);return _u=C(n.moduleName),("Left"===n.expandIconPosition?O:I)([L("div",{className:"e-icons "+n.expandIconClass+" "+(c(e)?"":e)})],t.querySelector("."+_u.textContent)),t}t.defaultMappedFields={id:"id",text:"text",url:"url",value:"value",isChecked:"isChecked",enabled:"enabled",expanded:"expanded",selected:"selected",iconCss:"iconCss",child:"child",isVisible:"isVisible",hasChildren:"hasChildren",tooltip:"tooltip",htmlAttributes:"htmlAttributes",urlAttributes:"urlAttributes",imageAttributes:"imageAttributes",imageUrl:"imageUrl",groupBy:null};var D={level:1,listRole:"presentation",itemRole:"presentation",groupItemRole:"group",itemText:"list-item",wrapperRole:"presentation"},B={showCheckBox:!1,showIcon:!1,expandCollapse:!1,fields:t.defaultMappedFields,ariaAttributes:D,listClass:"",itemClass:"",processSubChild:!1,sortOrder:"None",template:null,groupTemplate:null,headerTemplate:null,expandIconClass:"e-icon-collapsible",moduleName:"list",expandIconPosition:"Right"};t.createList=e,t.createListFromArray=i,t.createListItemFromArray=n,t.createListItemFromJson=o,t.createListFromJson=r,t.getSiblingLI=s,t.indexOf=a,t.groupDataSource=d,t.addSorting=p,t.getDataSource=u,t.createJsonFromElement=g,t.renderContentTemplate=y,t.renderGroupTemplate=b,t.generateId=w,t.generateUL=A,t.generateIcon=M}(Dh||(Dh={}));var Wu,Uu=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),qu=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Xu={None:[],SlideLeft:["SlideRightOut","SlideLeftOut","SlideLeftIn","SlideRightIn"],SlideDown:["SlideTopOut","SlideBottomOut","SlideBottomIn","SlideTopIn"],Zoom:["FadeOut","FadeZoomOut","FadeZoomIn","FadeIn"],Fade:["FadeOut","FadeOut","FadeIn","FadeIn"]},Yu={None:[],SlideLeft:["SlideLeftOut","SlideRightOut","SlideRightIn","SlideLeftIn"],SlideDown:["SlideBottomOut","SlideTopOut","SlideTopIn","SlideBottomIn"],Zoom:["FadeZoomOut","FadeOut","FadeIn","FadeZoomIn"],Fade:["FadeOut","FadeOut","FadeIn","FadeIn"]},Gu={root:"e-listview",hover:"e-hover",selected:"e-active",focused:"e-focused",parentItem:"e-list-parent",listItem:"e-list-item",listIcon:"e-list-icon",textContent:"e-text-content",listItemText:"e-list-text",groupListItem:"e-list-group-item",hasChild:"e-has-child",view:"e-view",header:"e-list-header",headerText:"e-headertext",headerTemplateText:"e-headertemplate-text",text:"e-text",disable:"e-disabled",content:"e-content",icon:"e-icons",backIcon:"e-icon-back",checkboxWrapper:"e-checkbox-wrapper",checkbox:"e-checkbox",checked:"e-check",checklist:"e-checklist",checkboxIcon:"e-frame",checkboxRight:"e-checkbox-right",checkboxLeft:"e-checkbox-left",listviewCheckbox:"e-listview-checkbox",itemCheckList:"e-checklist"},Zu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Uu(e,t),qu([et("id")],e.prototype,"id",void 0),qu([et("text")],e.prototype,"text",void 0),qu([et("isChecked")],e.prototype,"isChecked",void 0),qu([et("isVisible")],e.prototype,"isVisible",void 0),qu([et("enabled")],e.prototype,"enabled",void 0),qu([et("iconCss")],e.prototype,"iconCss",void 0),qu([et("child")],e.prototype,"child",void 0),qu([et("tooltip")],e.prototype,"tooltip",void 0),qu([et("groupBy")],e.prototype,"groupBy",void 0),qu([et("text")],e.prototype,"sortBy",void 0),qu([et("htmlAttributes")],e.prototype,"htmlAttributes",void 0),qu([et("tableName")],e.prototype,"tableName",void 0),e}(qa),Ku=function(t){function e(e,i){return t.call(this,e,i)||this}return Uu(e,t),e.prototype.onPropertyChanged=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++)switch(n[i]){case"htmlAttributes":this.setHTMLAttribute();break;case"cssClass":this.setCSSClass(e.cssClass);break;case"enable":this.setEnable();break;case"width":case"height":this.setSize();break;case"enableRtl":this.setEnableRTL();break;case"fields":this.listBaseOption.fields=this.fields.properties,this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():this.reRender();break;case"headerTitle":this.curDSLevel.length||this.header(this.headerTitle,!1);break;case"showHeader":this.header(this.headerTitle,!1);break;case"enableVirtualization":A(this.contentContainer),this.refresh();break;case"showCheckBox":case"checkBoxPosition":this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():this.setCheckbox();break;case"dataSource":this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():this.reRender();break;case"sortOrder":case"showIcon":this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():(this.listBaseOption.showIcon=this.showIcon,this.curViewDS=this.getSubDS(),this.resetCurrentList())}},e.prototype.setHTMLAttribute=function(){Object.keys(this.htmlAttributes).length&&R(this.element,this.htmlAttributes)},e.prototype.setCSSClass=function(t){this.cssClass&&E([this.element],this.cssClass.split(" ")),t&&P([this.element],t.split(" "))},e.prototype.setSize=function(){this.element.style.height=b(this.height),this.element.style.width=b(this.width),this.isWindow=!this.element.getBoundingClientRect().height},e.prototype.setEnable=function(){this.enableElement(this.element,this.enable)},e.prototype.setEnableRTL=function(){this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")},e.prototype.enableElement=function(t,e){e?t.classList.remove(Gu.disable):t.classList.add(Gu.disable)},e.prototype.header=function(t,e){if(void 0===this.headerEle&&this.showHeader){this.headerEle=L("div",{className:Gu.header});var i=L("span",{className:Gu.headerText,innerHTML:this.headerTitle}),n=L("div",{className:Gu.text,innerHTML:i.outerHTML}),o=L("div",{className:Gu.icon+" "+Gu.backIcon+" e-but-back",attrs:{style:"display:none;"}});if(this.headerEle.appendChild(o),this.headerEle.appendChild(n),this.headerTemplate){var r=Tt(this.headerTemplate),s=L("div",{className:Gu.headerTemplateText});I(r({}),s),I([s],this.headerEle)}this.headerTemplate&&this.headerTitle&&n.classList.add("header"),this.element.classList.add("e-has-header"),O([this.headerEle],this.element)}else if(this.headerEle)if(this.showHeader){this.headerEle.style.display="";var n=this.headerEle.querySelector("."+Gu.headerText),o=this.headerEle.querySelector("."+Gu.backIcon);n.innerHTML=t,this.headerTemplate&&e&&(n.parentElement.classList.remove("header"),this.headerEle.querySelector("."+Gu.headerTemplateText).classList.add("nested-header")),this.headerTemplate&&!e&&(n.parentElement.classList.add("header"),this.headerEle.querySelector("."+Gu.headerTemplateText).classList.remove("nested-header"),this.headerEle.querySelector("."+Gu.headerTemplateText).classList.add("header")),o.style.display=!0===e?"":"none"}else this.headerEle.style.display="none"},e.prototype.switchView=function(t,e,i){var n=this;if(t&&e){var o=t.style.position,r="hidden"!==this.element.style.overflow?this.element.style.overflow:"";t.style.position="absolute",t.classList.add("e-view");var s=void 0,a=this.animation.duration;if(this.animation.effect)s=this.enableRtl?Yu[this.animation.effect]:Xu[this.animation.effect];else{s=Xu.SlideLeft,i=this.enableRtl,a=0}this.element.style.overflow="hidden",this.aniObj.animate(t,{name:!0===i?s[0]:s[1],duration:a,timingFunction:this.animation.easing,end:function(e){t.style.display="none",n.element.style.overflow=r,t.style.position=o,t.classList.remove("e-view")}}),e.style.display="",this.aniObj.animate(e,{name:!0===i?s[2]:s[3],duration:a,timingFunction:this.animation.easing,end:function(){n.trigger("actionComplete")}}),this.curUL=e}},e.prototype.preRender=function(){this.listBaseOption={template:this.template,headerTemplate:this.headerTemplate,groupTemplate:this.groupTemplate,expandCollapse:!0,listClass:"",ariaAttributes:{itemRole:"listitem",listRole:"list",itemText:"",groupItemRole:"group",wrapperRole:"presentation"},fields:this.fields.properties,sortOrder:this.sortOrder,showIcon:this.showIcon,itemCreated:this.renderCheckbox.bind(this)},this.initialization()},e.prototype.initialization=function(){this.curDSLevel=[],this.animateOptions={},this.curViewDS=[],this.currentLiElements=[],this.isNestedList=!1,this.selectedData=[],this.selectedId=[],this.aniObj=new Fa(this.animateOptions)},e.prototype.renderCheckbox=function(t){if(t.item.classList.contains(Gu.hasChild)&&(this.isNestedList=!0),this.showCheckBox&&this.isValidLI(t.item)){var e=void 0;(e=ui(!1,{checked:!1,enableRtl:this.enableRtl,cssClass:Gu.listviewCheckbox})).setAttribute("role","checkbox");var i=e.querySelector("."+Gu.checkboxIcon);t.item.classList.add(Gu.itemCheckList),t.item.firstElementChild.classList.add(Gu.checkbox),"string"!=typeof this.dataSource[0]&&"number"!=typeof this.dataSource[0]?Bs(t.curData,this.listBaseOption.fields)[this.listBaseOption.fields.isChecked]&&this.checkInternally(t,e):"string"!=typeof this.dataSource[0]&&"number"!=typeof this.dataSource[0]||-1===this.selectedData.indexOf(t.text)||this.checkInternally(t,e),e.setAttribute("aria-checked",i.classList.contains(Gu.checked)?"true":"false"),"Left"===this.checkBoxPosition?(e.classList.add(Gu.checkboxLeft),t.item.firstElementChild.classList.add(Gu.checkboxLeft),t.item.firstElementChild.insertBefore(e,t.item.firstElementChild.childNodes[0])):(e.classList.add(Gu.checkboxRight),t.item.firstElementChild.classList.add(Gu.checkboxRight),t.item.firstElementChild.appendChild(e)),this.currentLiElements.push(t.item)}},e.prototype.checkInternally=function(t,e){t.item.classList.add(Gu.selected),t.item.setAttribute("aria-selected","true"),e.querySelector("."+Gu.checkboxIcon).classList.add(Gu.checked),e.setAttribute("aria-checked","true")},e.prototype.checkItem=function(t){this.toggleCheckBase(t,!0)},e.prototype.toggleCheckBase=function(t,e){if(this.showCheckBox){var i=t;if(t instanceof Object&&t.constructor!==HTMLLIElement&&(i=this.getLiFromObjOrElement(t)),!c(i)){var n=i.querySelector("."+Gu.checkboxIcon);e?i.classList.add(Gu.selected):i.classList.remove(Gu.selected),i.setAttribute("aria-selected",e?"true":"false"),e?n.classList.add(Gu.checked):n.classList.remove(Gu.checked),n.parentElement.setAttribute("aria-checked",e?"true":"false")}this.setSelectedItemData(i)}},e.prototype.uncheckItem=function(t){this.toggleCheckBase(t,!1)},e.prototype.checkAllItems=function(){this.toggleAllCheckBase(!0)},e.prototype.uncheckAllItems=function(){this.toggleAllCheckBase(!1)},e.prototype.toggleAllCheckBase=function(t){if(this.showCheckBox){for(var e=0;e<this.liCollection.length;e++){var i=this.liCollection[e].querySelector("."+Gu.checkboxIcon);i&&(t?i.classList.contains(Gu.checked)||this.checkItem(this.liCollection[e]):i.classList.contains(Gu.checked)&&this.uncheckItem(this.liCollection[e]))}this.enableVirtualization&&this.virtualizationModule.checkedItem(t)}},e.prototype.setCheckbox=function(){var t=this;if(this.showCheckBox){var e={item:void 0,curData:void 0,dataSource:void 0,fields:void 0,options:void 0,text:""};(i=Array.prototype.slice.call(this.element.querySelectorAll("."+Gu.listItem))).forEach(function(i){e.item=i,e.curData=t.getItemData(i),i.querySelector("."+Gu.checkboxWrapper)&&t.removeElement(i.querySelector("."+Gu.checkboxWrapper)),t.renderCheckbox(e),e.item.classList.contains(Gu.selected)&&t.checkInternally(e,e.item.querySelector("."+Gu.checkboxWrapper))})}else{var i=Array.prototype.slice.call(this.element.querySelectorAll("."+Gu.itemCheckList));i.forEach(function(e){e.classList.remove(Gu.selected),e.firstElementChild.classList.remove(Gu.checkbox),t.removeElement(e.querySelector("."+Gu.checkboxWrapper))}),this.selectedItems&&this.selectedItems.item.classList.add(Gu.selected)}},e.prototype.clickHandler=function(t){var e=t.target,i=e.classList;if(i.contains(Gu.backIcon)||i.contains(Gu.headerText))this.showCheckBox&&this.curDSLevel[this.curDSLevel.length-1]&&this.uncheckAllItems(),this.back();else{var n=N(e.parentNode,"."+Gu.listItem);if(null===n&&(n=e),this.removeFocus(),this.enable&&this.showCheckBox&&this.isValidLI(n))if(t.target.classList.contains(Gu.checkboxIcon)){if(n.classList.add(Gu.focused),c(n.querySelector("."+Gu.checked))){var o={curData:void 0,dataSource:void 0,fields:void 0,options:void 0,text:void 0,item:n};this.checkInternally(o,o.item.querySelector("."+Gu.checkboxWrapper))}else this.uncheckItem(n),n.classList.add(Gu.focused);if(t){var r=this.selectEventData(n,t);l(r,{isChecked:n.querySelector("."+Gu.checkboxIcon).classList.contains(Gu.checked)}),this.trigger("select",r)}}else n.classList.contains(Gu.hasChild)?(this.removeHover(),this.removeSelect(),this.removeSelect(n),this.setSelectLI(n,t),n.classList.remove(Gu.selected)):this.setCheckboxLI(n,t);else this.setSelectLI(n,t)}},e.prototype.removeElement=function(t){return t&&t.parentNode&&t.parentNode.removeChild(t)},e.prototype.hoverHandler=function(t){var e=N(t.target.parentNode,"."+Gu.listItem);this.setHoverLI(e)},e.prototype.leaveHandler=function(t){this.removeHover()},e.prototype.homeKeyHandler=function(t,e){if(Object.keys(this.dataSource).length&&this.curUL){var i=this.curUL.querySelectorAll("."+Gu.listItem),n=this.curUL.querySelector("."+Gu.focused)||this.curUL.querySelector("."+Gu.selected);n&&(n.classList.remove(Gu.focused),this.showCheckBox||n.classList.remove(Gu.selected));var o=e?i.length-1:0;i[o].classList.contains(Gu.hasChild)||this.showCheckBox?i[o].classList.add(Gu.focused):this.setSelectLI(i[o],t)}},e.prototype.onArrowKeyDown=function(t,e){var i,n;return!c(this.curUL.querySelector("."+Gu.hasChild))||this.showCheckBox?(n=this.curUL.querySelector("."+Gu.focused)||this.curUL.querySelector("."+Gu.selected),c(i=Dh.getSiblingLI(this.curUL.querySelectorAll("."+Gu.listItem),n,e))||(n&&(n.classList.remove(Gu.focused),this.showCheckBox||n.classList.remove(Gu.selected)),i.classList.contains(Gu.hasChild)||this.showCheckBox?i.classList.add(Gu.focused):this.setSelectLI(i,t))):(n=this.curUL.querySelector("."+Gu.selected),i=Dh.getSiblingLI(this.curUL.querySelectorAll("."+Gu.listItem),n,e),this.setSelectLI(i,t)),i},e.prototype.arrowKeyHandler=function(t,e){var i=this;if(Object.keys(this.dataSource).length&&this.curUL){var n=this.onArrowKeyDown(t,e),o=this.element.getBoundingClientRect().top,r=this.element.getBoundingClientRect().height,s=this.curUL.querySelector("."+Gu.listItem).getBoundingClientRect(),a=void 0,l=void 0;if(this.fields.groupBy&&(l=this.curUL.querySelector("."+Gu.groupListItem).getBoundingClientRect()),n){var h=n.getBoundingClientRect().top,c=n.getBoundingClientRect().height;if(e)(a=this.isWindow?h:h-o)<0&&(this.isWindow?window.scrollTo(0,pageYOffset+a):this.element.scrollTo(0,this.element.scrollTop+a));else{var d=this.isWindow?window.innerHeight:r;(a=this.isWindow?h+c:h-o+c)>d&&(this.isWindow?window.scrollTo(0,pageYOffset+(a-d)):this.element.scrollTo(0,this.element.scrollTop+(a-d)))}}else if(this.enableVirtualization&&e&&this.virtualizationModule.uiFirstIndex)this.onUIScrolled=function(){i.onArrowKeyDown(t,e),i.onUIScrolled=void 0},a=this.virtualizationModule.listItemHeight,this.isWindow?window.scrollTo(0,pageYOffset-a):this.element.scrollTo(0,this.element.scrollTop-a);else if(e)if(this.showHeader&&this.headerEle){var p=l?l.top:s.top,u=this.headerEle.getBoundingClientRect();a=u.top<0?u.height-p:0,this.isWindow?window.scrollTo(0,pageYOffset-a):this.element.scrollTo(0,0)}else this.fields.groupBy&&(a=this.isWindow?l.top<0?l.top:0:o-s.top+l.height,this.isWindow?window.scrollTo(0,pageYOffset+a):this.element.scrollTo(0,this.element.scrollTop-a))}},e.prototype.enterKeyHandler=function(t){if(Object.keys(this.dataSource).length&&this.curUL){var e=!c(this.curUL.querySelector("."+Gu.hasChild)),i=this.curUL.querySelector("."+Gu.focused);e&&i&&(i.classList.remove(Gu.focused),this.showCheckBox&&(this.removeSelect(),this.removeSelect(i),this.removeHover()),this.setSelectLI(i,t))}},e.prototype.spaceKeyHandler=function(t){if(this.enable&&this.showCheckBox&&Object.keys(this.dataSource).length&&this.curUL){var e=this.curUL.querySelector("."+Gu.focused);if(!c(e)&&c(e.querySelector("."+Gu.checked))){var i={curData:void 0,dataSource:void 0,fields:void 0,options:void 0,text:void 0,item:e};this.checkInternally(i,i.item.querySelector("."+Gu.checkboxWrapper))}else this.uncheckItem(e)}},e.prototype.keyActionHandler=function(t){switch(t.preventDefault(),t.keyCode){case 36:this.homeKeyHandler(t);break;case 35:this.homeKeyHandler(t,!0);break;case 40:this.arrowKeyHandler(t);break;case 38:this.arrowKeyHandler(t,!0);break;case 13:this.enterKeyHandler(t);break;case 8:this.showCheckBox&&this.curDSLevel[this.curDSLevel.length-1]&&this.uncheckAllItems(),this.back();break;case 9:this.tabFocus(t);break;case 32:this.spaceKeyHandler(t)}},e.prototype.swipeActionHandler=function(t){"Right"===t.swipeDirection&&(this.showCheckBox&&this.curDSLevel[this.curDSLevel.length-1]&&this.uncheckAllItems(),this.back())},e.prototype.focusout=function(){if(Object.keys(this.dataSource).length&&this.curUL){var t=this.curUL.querySelector("."+Gu.focused),e=this.curUL.querySelector("[aria-selected = true]");t&&!this.showCheckBox&&(t.classList.remove(Gu.focused),e&&e.classList.add(Gu.selected))}},e.prototype.wireEvents=function(){Ma.add(this.element,"keydown",this.keyActionHandler,this),Ma.add(this.element,"click",this.clickHandler,this),this.enableVirtualization||(Ma.add(this.element,"mouseover",this.hoverHandler,this),Ma.add(this.element,"mouseout",this.leaveHandler,this)),Ma.add(this.element,"focusout",this.focusout,this),this.touchModule=new Vl(this.element,{swipe:this.swipeActionHandler.bind(this)})},e.prototype.unWireEvents=function(){Ma.remove(this.element,"click",this.clickHandler),this.enableVirtualization||(Ma.remove(this.element,"mouseover",this.hoverHandler),Ma.remove(this.element,"mouseout",this.leaveHandler)),Ma.remove(this.element,"mouseover",this.hoverHandler),Ma.remove(this.element,"mouseout",this.leaveHandler),this.touchModule.destroy()},e.prototype.tabFocus=function(t){if(Object.keys(this.dataSource).length&&this.curUL&&(!this.curUL.querySelector("."+Gu.selected)&&this.curUL||this.showCheckBox)){var e=this.curUL.querySelector("."+Gu.listItem);e.classList.contains(Gu.hasChild)||this.showCheckBox?c(this.curUL.querySelector("."+Gu.focused))&&e.classList.add(Gu.focused):this.setSelectLI(e,t)}},e.prototype.removeFocus=function(){for(var t=0,e=this.element.querySelectorAll("."+Gu.focused);t<e.length;t++)e[t].classList.remove(Gu.focused)},e.prototype.removeHover=function(){var t=this.element.querySelector("."+Gu.hover);t&&t.classList.remove(Gu.hover)},e.prototype.removeSelect=function(t){if(c(t))for(var e=0,i=this.element.querySelectorAll("."+Gu.selected);e<i.length;e++){var n=i[e];this.showCheckBox&&n.querySelector("."+Gu.checked)||(n.setAttribute("aria-selected","false"),n.classList.remove(Gu.selected))}else t.classList.remove(Gu.selected),t.setAttribute("aria-selected","false")},e.prototype.isValidLI=function(t){return t&&t.classList.contains(Gu.listItem)&&!t.classList.contains(Gu.groupListItem)&&!t.classList.contains(Gu.disable)},e.prototype.setCheckboxLI=function(t,e){if(this.isValidLI(t)&&this.enable&&this.showCheckBox){this.curUL.querySelector("."+Gu.focused)&&this.curUL.querySelector("."+Gu.focused).classList.remove(Gu.focused),t.classList.add(Gu.focused);var i=t.querySelector("."+Gu.checkboxWrapper),n=i.querySelector("."+Gu.checkboxIcon+"."+Gu.icon);if(this.removeHover(),n.classList.contains(Gu.checked)?(n.classList.remove(Gu.checked),t.classList.remove(Gu.selected),t.setAttribute("aria-selected","false")):(n.classList.add(Gu.checked),t.classList.add(Gu.selected),t.setAttribute("aria-selected","true")),i.setAttribute("aria-checked",n.classList.contains(Gu.checked)?"true":"false"),e){var o=this.selectEventData(t,e);l(o,{isChecked:n.classList.contains(Gu.checked)}),this.enableVirtualization&&this.virtualizationModule.setCheckboxLI(t,e),this.trigger("select",o)}this.setSelectedItemData(t),this.renderSubList(t)}},e.prototype.selectEventData=function(t,e){var i,n=this.getItemData(t),o=Bs(n,this.listBaseOption.fields);try{i=n&&"string"==typeof this.dataSource[0]||"number"==typeof this.dataSource[0]?{item:t,text:t.innerText.trim(),data:this.dataSource}:{item:t,text:o[this.listBaseOption.fields.text],data:n}}catch(e){}var r={};return l(r,i),e&&l(r,{isInteracted:!0,event:e,index:Array.prototype.indexOf.call(this.curUL.children,t)}),r},e.prototype.setSelectedItemData=function(t){var e=this.getItemData(t),i=Bs(e,this.listBaseOption.fields);try{!e||"string"!=typeof this.dataSource[0]&&"number"!=typeof this.dataSource[0]?this.selectedItems={item:t,text:i[this.listBaseOption.fields.text],data:e}:this.selectedItems={item:t,text:t.innerText.trim(),data:this.dataSource}}catch(t){}},e.prototype.setSelectLI=function(t,e){if(this.isValidLI(t)&&!t.classList.contains(Gu.selected)&&this.enable){this.showCheckBox||this.removeSelect(),t.classList.add(Gu.selected),t.setAttribute("aria-selected","true"),this.removeHover(),this.setSelectedItemData(t),this.enableVirtualization&&this.virtualizationModule.setSelectLI(t,e);var i=this.selectEventData(t,e);this.trigger("select",i),this.selectedLI=t,this.renderSubList(t)}},e.prototype.setHoverLI=function(t){if(this.isValidLI(t)&&!t.classList.contains(Gu.hover)&&this.enable){var e=this.element.querySelectorAll("."+Gu.hover);e&&e.length&&P(e,Gu.hover),t.classList.contains(Gu.selected)&&!this.showCheckBox||t.classList.add(Gu.hover)}},e.prototype.hoverSiblingLI=function(t){var e,i=this.curUL.querySelector("."+Gu.hover);if(i||(i=this.curUL.querySelector("."+Gu.selected)),i)e=Dh.getSiblingLI(this.curUL.querySelectorAll("."+Gu.listItem),i,t);else if(t){var n=this.curUL.querySelectorAll("."+Gu.listItem);e=n[n.length-1]}else e=this.curUL.querySelector("."+Gu.listItem);this.setHoverLI(e)},e.prototype.getSubDS=function(){var t=this.curDSLevel;if(t.length){for(var e=this.localData,i=0,n=t;i<n.length;i++){var o=n[i],r={};r[this.fields.id]=o,this.curDSJSON=this.findItemFromDS(e,r);var s=Bs(this.curDSJSON,this.listBaseOption.fields);e=this.curDSJSON?s[this.fields.child]:e}return e}return this.localData},e.prototype.getItemData=function(t){var e,i=this.getElementUID(t);return e=c(this.curUL.querySelector("."+Gu.hasChild))&&this.fields.groupBy?this.curViewDS:this.dataSource,this.findItemFromDS(e,i)},e.prototype.findItemFromDS=function(t,e,i){var n,o=this;return t&&t.length&&e?t.some(function(r){var s=Bs(r,o.listBaseOption.fields);if(!e[o.fields.id]&&!e[o.fields.text]||e[o.fields.id]&&(!c(s[o.fields.id])&&s[o.fields.id].toString())!==e[o.fields.id].toString()||e[o.fields.text]&&s[o.fields.text]!==e[o.fields.text])if("object"!=typeof r&&-1!==t.indexOf(r))n=i?t:r;else if(!c(e[o.fields.id])&&c(s[o.fields.id])){var a=o.element.querySelector('[data-uid="'+e[o.fields.id]+'"]');a&&a.innerText.trim()===s[o.fields.text]&&(n=r)}else s.hasOwnProperty(o.fields.child)&&s[o.fields.child].length&&(n=o.findItemFromDS(s[o.fields.child],e,i));else n=i?t:r;return!!n}):n=t,n},e.prototype.getQuery=function(){var t=[],e=this.query?this.query:new Lu;if(!this.query){for(var i=0,n=Object.keys(this.fields.properties);i<n.length;i++){var o=n[i];"tableName"!==o&&this.fields[o]&&this.fields[o]!==Dh.defaultMappedFields[o]&&-1===t.indexOf(this.fields[o])&&t.push(this.fields[o])}e.select(t),this.fields.properties.hasOwnProperty("tableName")&&e.from(this.fields.tableName)}return e},e.prototype.setViewDataSource=function(t){void 0===t&&(t=this.localData),t&&this.fields.groupBy?this.curViewDS=Dh.groupDataSource(t,this.fields,this.sortOrder):t&&"None"!==this.sortOrder?this.curViewDS=Dh.getDataSource(t,Dh.addSorting(this.sortOrder,this.fields.sortBy)):this.curViewDS=t},e.prototype.isInAnimation=function(){return this.curUL.classList.contains(".e-animate")},e.prototype.setLocalData=function(){var t=this;if(this.trigger("actionBegin"),this.dataSource instanceof zu)this.dataSource.executeQuery(this.getQuery()).then(function(e){t.isDestroyed||(t.localData=e.result,t.renderList(),t.trigger("actionComplete",e))}).catch(function(e){t.isDestroyed||t.trigger("actionFailure",e)});else if(this.dataSource&&this.dataSource.length)this.localData=this.dataSource,this.renderList(),this.trigger("actionComplete",{data:this.localData});else{var e=this.element.querySelector("ul");e&&(M(e),this.setProperties({dataSource:Dh.createJsonFromElement(e)},!0),this.localData=this.dataSource,this.renderList(),this.trigger("actionComplete",{data:this.localData}))}},e.prototype.reRender=function(){this.element.innerHTML="",this.headerEle=this.ulElement=this.liCollection=void 0,this.setLocalData(),this.header()},e.prototype.resetCurrentList=function(){this.setViewDataSource(this.curViewDS),this.contentContainer.innerHTML="",this.createList(),this.renderIntoDom(this.curUL)},e.prototype.createList=function(){this.currentLiElements=[],this.isNestedList=!1,this.ulElement=this.curUL=Dh.createList(this.curViewDS,this.listBaseOption),this.liCollection=this.curUL.querySelectorAll("."+Gu.listItem)},e.prototype.renderSubList=function(t){var e=t.getAttribute("data-uid");if(t.classList.contains(Gu.hasChild)&&e){var i=N(t.parentNode,"."+Gu.parentItem),n=this.element.querySelector("[pid='"+e+"']");if(this.curDSLevel.push(e),this.setViewDataSource(this.getSubDS()),!n){var o=this.curViewDS;(n=Dh.createListFromJson(o,this.listBaseOption,this.curDSLevel.length)).setAttribute("pID",e),n.style.display="none",this.renderIntoDom(n)}if(this.switchView(i,n),this.liCollection=this.curUL.querySelectorAll("."+Gu.listItem),this.selectedItems){var r=Bs(this.selectedItems.data,this.listBaseOption.fields);this.header(r[this.listBaseOption.fields.text],!0)}this.selectedLI=void 0}},e.prototype.renderIntoDom=function(t){this.contentContainer.appendChild(t)},e.prototype.renderList=function(t){this.setViewDataSource(t),this.enableVirtualization&&Object.keys(this.dataSource).length?((this.template||this.groupTemplate)&&(this.listBaseOption.template=null,this.listBaseOption.groupTemplate=null,this.listBaseOption.itemCreated=this.virtualizationModule.createUIItem.bind(this.virtualizationModule)),this.virtualizationModule.uiVirtualization()):(this.createList(),this.contentContainer=L("div",{className:Gu.content}),this.element.appendChild(this.contentContainer),this.renderIntoDom(this.ulElement))},e.prototype.getElementUID=function(t){var e={};return t instanceof Element?e[this.fields.id]=t.getAttribute("data-uid"):e=t,e},e.prototype.render=function(){this.element.classList.add(Gu.root),R(this.element,{role:"list",tabindex:"0"}),this.setCSSClass(),this.setEnableRTL(),this.setEnable(),this.setSize(),this.wireEvents(),this.header(),this.setLocalData(),this.setHTMLAttribute(),this.rippleFn=pt(this.element,{selector:"."+Gu.listItem})},e.prototype.destroy=function(){this.unWireEvents();var e=[Gu.root,this.cssClass,Gu.disable,"e-rtl","e-has-header","e-control"];P([this.element],e),this.rippleFn(),this.element.removeAttribute("role"),this.element.removeAttribute("tabindex"),this.element.innerHTML="",this.curUL=this.ulElement=this.liCollection=this.headerEle=void 0,t.prototype.destroy.call(this)},e.prototype.back=function(){var t=this.curDSLevel[this.curDSLevel.length-1];if(void 0!==t&&!this.isInAnimation()){this.curDSLevel.pop(),this.setViewDataSource(this.getSubDS());var e=this.element.querySelector("[data-uid='"+t+"']"),i=this.curUL;e?e=e.parentElement:(this.createList(),this.renderIntoDom(this.ulElement),e=this.curUL);var n=Bs(this.curDSJSON,this.listBaseOption.fields)[this.fields.text];this.switchView(i,e,!0),this.removeFocus();var o=this.element.querySelector("[data-uid='"+t+"']");o.classList.add(Gu.focused),this.showCheckBox&&o.querySelector("."+Gu.checkboxIcon).classList.contains(Gu.checked)?o.setAttribute("aria-selected","true"):(o.classList.remove(Gu.selected),o.setAttribute("aria-selected","false")),this.liCollection=this.curUL.querySelectorAll("."+Gu.listItem),this.header(this.curDSLevel.length?n:this.headerTitle,!!this.curDSLevel.length)}},e.prototype.selectItem=function(t){c(t)||(this.enableVirtualization?this.virtualizationModule.selectItem(t):this.showCheckBox?this.setCheckboxLI(this.getLiFromObjOrElement(t)):this.setSelectLI(this.getLiFromObjOrElement(t)))},e.prototype.getLiFromObjOrElement=function(t){var e;if(!c(t))if("string"==typeof this.dataSource[0]||"number"==typeof this.dataSource[0])if(t instanceof Element){for(var i=t.getAttribute("data-uid").toString(),n=0;n<this.liCollection.length;n++)if(this.liCollection[n].getAttribute("data-uid").toString()===i){e=this.liCollection[n];break}}else Array.prototype.some.call(this.curUL.querySelectorAll("."+Gu.listItem),function(i){return i.innerText.trim()===t.toString()&&(e=i,!0)});else{var o=this.getItemData(t),r=Bs(o,this.listBaseOption.fields);if(o&&(e=this.element.querySelector('[data-uid="'+r[this.fields.id]+'"]'),c(e)))for(var s=this.element.querySelectorAll("."+Gu.listItem),n=0;n<s.length;n++)s[n].innerText.trim()===o.text&&(e=s[n])}return e},e.prototype.selectMultipleItems=function(t){if(!c(t))for(var e=0;e<t.length;e++)c(t[e])||this.selectItem(t[e])},e.prototype.getParentId=function(){var t=[];if(this.isNestedList)for(var e=this.curDSLevel.length-1;e>=0;e--)t.push(this.curDSLevel[e]);return t},e.prototype.getSelectedItems=function(){if(this.selectedId=[],this.enableVirtualization)return this.virtualizationModule.getSelectedItems();if(this.showCheckBox){var t=this.curUL.getElementsByClassName(Gu.selected),e=[],i=[];this.selectedId=[];for(var n=[],o=0;o<t.length;o++)if("string"==typeof this.dataSource[0]||"number"==typeof this.dataSource[0])e.push(t[o].innerText.trim());else{var r=this.getItemData(t[o]),s=Bs(r,this.listBaseOption.fields);this.isNestedList?n.push({data:r,parentId:this.getParentId()}):i.push(r),s?(e.push(s[this.listBaseOption.fields.text]),this.selectedId.push(s[this.listBaseOption.fields.id])):(e.push(void 0),this.selectedId.push(void 0))}return"string"==typeof this.dataSource[0]||"number"==typeof this.dataSource[0]?{item:t,data:this.dataSource,text:e}:this.isNestedList?{item:t,data:n,text:e}:{item:t,data:i,text:e}}var a=this.element.getElementsByClassName(Gu.selected)[0],s=Bs(this.getItemData(a),this.listBaseOption.fields);return"string"==typeof this.dataSource[0]||"number"==typeof this.dataSource[0]?c(a)?void 0:{item:a,data:this.dataSource,text:a.innerText.trim()}:c(s)||c(a)?void 0:(this.selectedId.push(s[this.listBaseOption.fields.id]),{text:s[this.listBaseOption.fields.text],item:a,data:this.getItemData(a)})},e.prototype.findItem=function(t){return this.getItemData(t)},e.prototype.enableItem=function(t){this.setItemState(t,!0),this.enableVirtualization&&this.virtualizationModule.enableItem(t)},e.prototype.disableItem=function(t){this.setItemState(t,!1),this.enableVirtualization&&this.virtualizationModule.disableItem(t)},e.prototype.setItemState=function(t,e){var i=this.getItemData(t),n=Bs(i,this.listBaseOption.fields);if(i){var o=this.element.querySelector('[data-uid="'+n[this.fields.id]+'"]');e?(o&&o.classList.remove(Gu.disable),delete i[this.fields.enabled]):e||(o&&o.classList.add(Gu.disable),i[this.fields.enabled]=!1)}},e.prototype.showItem=function(t){this.showHideItem(t,!1,""),this.enableVirtualization&&this.virtualizationModule.showItem(t)},e.prototype.hideItem=function(t){this.showHideItem(t,!0,"none"),this.enableVirtualization&&this.virtualizationModule.hideItem(t)},e.prototype.showHideItem=function(t,e,i){var n=this.getItemData(t),o=Bs(n,this.listBaseOption.fields);if(n){var r=this.element.querySelector('[data-uid="'+o[this.fields.id]+'"]');r&&(r.style.display=i),e?n[this.fields.isVisible]=!1:delete n[this.fields.isVisible]}},e.prototype.addItem=function(t,e){var i=this;if(void 0===e&&(e=void 0),t instanceof Array)if(this.enableVirtualization)this.virtualizationModule.addItem(t,e);else{var n=this.findItemFromDS(this.dataSource,e),o=Bs(n,this.listBaseOption.fields)[this.fields.child];o||(o=[]),o=o.concat(t),n instanceof Array?(t.forEach(function(t){if(i.dataSource.push(t),i.setViewDataSource(i.dataSource),i.ulElement){var e=i.curViewDS.indexOf(t);i.addListItem(t,e);var n=i.curViewDS[e-1];n&&n.isHeader&&1===n.items.length&&i.addListItem(n,e-1)}else i.reRender()}),this.liCollection=this.curUL.querySelectorAll("."+Gu.listItem)):(n[this.fields.child]=o,this.reRender())}},e.prototype.addListItem=function(t,e){var i=this.getLiFromObjOrElement(this.curViewDS[e+1])||this.getLiFromObjOrElement(this.curViewDS[e+2])||null,n=Dh.createListItemFromJson([t],this.listBaseOption);this.ulElement.insertBefore(n[0],i)},e.prototype.removeItem=function(t){this.enableVirtualization?this.virtualizationModule.removeItem(t):this.removeItemFromList(t)},e.prototype.removeItemFromList=function(t){var e,i=t instanceof Element?this.getElementUID(t):t;if(e=this.findItemFromDS(this.dataSource,i,!0)){var n=void 0;n=this.findItemFromDS(e,i);var o=this.curViewDS.indexOf(n);this.fields.groupBy&&this.curViewDS[o-1]&&this.curViewDS[o-1].isHeader&&1===this.curViewDS[o-1].items.length&&A(this.getLiFromObjOrElement(this.curViewDS[o-1])),this.getLiFromObjOrElement(t)&&A(this.getLiFromObjOrElement(t));var r=e.indexOf(n);e.splice(r,1),this.setViewDataSource(this.dataSource),this.liCollection=Array.prototype.slice.call(this.element.querySelectorAll("."+Gu.listItem))}},e.prototype.removeMultipleItems=function(t){if(t.length)for(var e=0;e<t.length;e++)this.enableVirtualization?this.removeItem(t[e]):this.removeItemFromList(t[e])},e.prototype.getModuleName=function(){return"listview"},e.prototype.requiredModules=function(){var t=[];return this.enableVirtualization&&t.push({args:[this],member:"virtualization"}),t},e.prototype.getPersistData=function(){return this.addOnPersist(["cssClass","enableRtl","htmlAttributes","enable","fields","animation","headerTitle","sortOrder","showIcon","height","width","showCheckBox","checkBoxPosition"])},qu([et()],e.prototype,"cssClass",void 0),qu([et(!1)],e.prototype,"enableVirtualization",void 0),qu([et({})],e.prototype,"htmlAttributes",void 0),qu([et(!0)],e.prototype,"enable",void 0),qu([et([])],e.prototype,"dataSource",void 0),qu([et()],e.prototype,"query",void 0),qu([it(Dh.defaultMappedFields,Zu)],e.prototype,"fields",void 0),qu([et({effect:"SlideLeft",duration:400,easing:"ease"})],e.prototype,"animation",void 0),qu([et("None")],e.prototype,"sortOrder",void 0),qu([et(!1)],e.prototype,"showIcon",void 0),qu([et(!1)],e.prototype,"showCheckBox",void 0),qu([et("Left")],e.prototype,"checkBoxPosition",void 0),qu([et("")],e.prototype,"headerTitle",void 0),qu([et(!1)],e.prototype,"showHeader",void 0),qu([et("")],e.prototype,"height",void 0),qu([et("")],e.prototype,"width",void 0),qu([et(null)],e.prototype,"template",void 0),qu([et(null)],e.prototype,"headerTemplate",void 0),qu([et(null)],e.prototype,"groupTemplate",void 0),qu([st()],e.prototype,"select",void 0),qu([st()],e.prototype,"actionBegin",void 0),qu([st()],e.prototype,"actionComplete",void 0),qu([st()],e.prototype,"actionFailure",void 0),e=qu([at],e)}(wl),Qu=function(){function t(t){this.listViewInstance=t}return t.prototype.uiVirtualization=function(){var t=this.listViewInstance.curViewDS,e=t.slice(0,1);this.listViewInstance.ulElement=this.listViewInstance.curUL=Dh.createList(e,this.listViewInstance.listBaseOption),this.listViewInstance.contentContainer=L("div",{className:Gu.content}),this.listViewInstance.element.appendChild(this.listViewInstance.contentContainer),this.listViewInstance.contentContainer.appendChild(this.listViewInstance.ulElement),this.listItemHeight=this.listViewInstance.ulElement.firstElementChild.getBoundingClientRect().height,this.expectedDomItemCount=this.ValidateItemCount(1e4),this.domItemCount=this.ValidateItemCount(Object.keys(this.listViewInstance.curViewDS).length),this.uiFirstIndex=0,this.uiLastIndex=this.domItemCount-1,this.wireScrollEvent(!1);var i=t.slice(1,this.domItemCount);I(Dh.createListItemFromJson(i,this.listViewInstance.listBaseOption),this.listViewInstance.ulElement),this.listViewInstance.liCollection=this.listViewInstance.curUL.querySelectorAll("li"),this.topElement=L("div"),this.listViewInstance.ulElement.insertBefore(this.topElement,this.listViewInstance.ulElement.firstElementChild),this.bottomElement=L("div"),this.listViewInstance.ulElement.insertBefore(this.bottomElement,null),this.totalHeight=Object.keys(t).length*this.listItemHeight-this.domItemCount*this.listItemHeight,this.topElement.style.height="0px",this.bottomElement.style.height=this.totalHeight+"px",this.topElementHeight=0,this.bottomElementHeight=this.totalHeight,this.listDiff=0,this.uiIndicesInitialization()},t.prototype.wireScrollEvent=function(t){t?this.listViewInstance.isWindow?window.removeEventListener("scroll",this.onVirtualScroll):Ma.remove(this.listViewInstance.element,"scroll",this.onVirtualUiScroll):this.listViewInstance.isWindow?(this.onVirtualScroll=this.onVirtualUiScroll.bind(this),window.addEventListener("scroll",this.onVirtualScroll)):Ma.add(this.listViewInstance.element,"scroll",this.onVirtualUiScroll,this)},t.prototype.ValidateItemCount=function(t){var e=this.listViewInstance.isWindow?Math.round(window.innerHeight/this.listItemHeight*3):Math.round(this.listViewInstance.height/this.listItemHeight*1.5);return e>t&&(e=t),e},t.prototype.uiIndicesInitialization=function(){var t=this;this.uiIndices={activeIndices:[],disabledItemIndices:[],hiddenItemIndices:[]},this.listViewInstance.curViewDS.forEach(function(e,i){t.listViewInstance.showCheckBox&&e[t.listViewInstance.fields.isChecked]&&t.uiIndices.activeIndices.push(i),c(e[t.listViewInstance.fields.enabled])||e[t.listViewInstance.fields.enabled]||t.uiIndices.disabledItemIndices.push(i)})},t.prototype.getscrollerHeight=function(){return this.listViewInstance.isWindow?pageYOffset-this.startingHeight<=0?0:pageYOffset-this.startingHeight:this.listViewInstance.element.scrollTop-this.startingHeight<=0?0:this.listViewInstance.element.scrollTop-this.startingHeight},t.prototype.onVirtualUiScroll=function(){c(this.startingHeight)&&(this.listViewInstance.isWindow?this.startingHeight=document.documentElement.getBoundingClientRect().height-this.listViewInstance.ulElement.getBoundingClientRect().height:this.startingHeight=this.listViewInstance.headerEle?this.listViewInstance.headerEle.getBoundingClientRect().height:0,this.scrollPosition=0);var t=this.getscrollerHeight();if(this.topElementHeight=this.listItemHeight*Math.floor(t/this.listItemHeight),this.bottomElementHeight=this.totalHeight-this.topElementHeight,i=t<=this.totalHeight?[this.topElementHeight,this.bottomElementHeight]:[this.totalHeight,0],this.topElementHeight=i[0],this.bottomElementHeight=i[1],this.topElementHeight!==parseFloat(this.topElement.style.height)){if(this.topElement.style.height=this.topElementHeight+"px",this.bottomElement.style.height=this.bottomElementHeight+"px",t>this.scrollPosition)(e=this.topElementHeight/this.listItemHeight-this.listDiff)>this.expectedDomItemCount+5?this.onLongScroll(e,!0):this.onNormalScroll(e,!0);else{var e=this.listDiff-this.topElementHeight/this.listItemHeight;e>this.expectedDomItemCount+5?this.onLongScroll(e,!1):this.onNormalScroll(e,!1)}this.listDiff=this.topElementHeight/this.listItemHeight,"function"==typeof this.listViewInstance.onUIScrolled&&this.listViewInstance.onUIScrolled()}this.scrollPosition=t;var i},t.prototype.onLongScroll=function(t,e){var i=this,n=e?this.uiFirstIndex+t:this.uiFirstIndex-t;Array.prototype.forEach.call(this.listViewInstance.ulElement.querySelectorAll("li"),function(t){i.updateUI(t,n),n++}),this.uiLastIndex=e?this.uiLastIndex+t:this.uiLastIndex-t,this.uiFirstIndex=e?this.uiFirstIndex+t:this.uiFirstIndex-t},t.prototype.onNormalScroll=function(t,e){if(e)for(i=0;i<t;i++){n=++this.uiLastIndex;this.updateUI(this.topElement.nextElementSibling,n,this.bottomElement),this.uiFirstIndex++}else for(var i=0;i<t;i++){var n=--this.uiFirstIndex,o=this.topElement.nextSibling;this.updateUI(this.bottomElement.previousElementSibling,n,o),this.uiLastIndex--}},t.prototype.updateUiContent=function(t,e){var i=this.listViewInstance.curViewDS;if("string"==typeof this.listViewInstance.dataSource[0]||"number"==typeof this.listViewInstance.dataSource[0]?(t.dataset.uid=Dh.generateId(),t.getElementsByClassName(Gu.listItemText)[0].innerHTML=this.listViewInstance.curViewDS[e].toString()):(t.dataset.uid=i[e][this.listViewInstance.fields.id]?i[e][this.listViewInstance.fields.id].toString():Dh.generateId(),t.getElementsByClassName(Gu.listItemText)[0].innerHTML=i[e][this.listViewInstance.fields.text].toString()),this.listViewInstance.showIcon&&(t.querySelector("."+Gu.listIcon)&&A(t.querySelector("."+Gu.listIcon)),this.listViewInstance.curViewDS[e][this.listViewInstance.fields.iconCss])){var n=t.querySelector("."+Gu.textContent),o=L("div",{className:Gu.listIcon+" "+this.listViewInstance.curViewDS[e][this.listViewInstance.fields.iconCss]});n.insertBefore(o,t.querySelector("."+Gu.listItemText))}if(this.listViewInstance.showCheckBox&&this.listViewInstance.fields.groupBy){this.checkListWrapper||(this.checkListWrapper=this.listViewInstance.curUL.querySelector("."+Gu.checkboxWrapper).cloneNode(!0));n=t.querySelector("."+Gu.textContent);this.listViewInstance.curViewDS[e].isHeader?t.querySelector("."+Gu.checkboxWrapper)&&(t.classList.remove(Gu.checklist),n.classList.remove(Gu.checkbox),A(t.querySelector("."+Gu.checkboxWrapper))):t.querySelector("."+Gu.checkboxWrapper)||(t.classList.add(Gu.checklist),n.classList.add(Gu.checkbox),n.insertBefore(this.checkListWrapper.cloneNode(!0),t.querySelector("."+Gu.listItemText)))}},t.prototype.changeElementAttributes=function(t,e){if(t.classList.remove(Gu.disable),this.uiIndices.disabledItemIndices.length&&-1!==this.uiIndices.disabledItemIndices.indexOf(e)&&t.classList.add(Gu.disable),t.style.display="",this.uiIndices.hiddenItemIndices.length&&-1!==this.uiIndices.hiddenItemIndices.indexOf(e)&&(t.style.display="none"),this.listViewInstance.showCheckBox){var i=t.querySelector("."+Gu.checkboxWrapper);t.classList.remove(Gu.selected),t.classList.remove(Gu.focused),i&&(i.removeAttribute("aria-checked"),i.firstElementChild.classList.remove(Gu.checked)),this.uiIndices.activeIndices.length&&-1!==this.uiIndices.activeIndices.indexOf(e)&&!this.listViewInstance.curUL.querySelector(Gu.selected)&&(t.classList.add(Gu.selected),i.firstElementChild.classList.add(Gu.checked),i.setAttribute("aria-checked","true"),this.activeIndex===e&&t.classList.add(Gu.focused))}else t.classList.remove(Gu.selected),t.removeAttribute("aria-selected"),c(this.activeIndex)||this.activeIndex!==e||this.listViewInstance.curUL.querySelector(Gu.selected)||(t.classList.add(Gu.selected),t.setAttribute("aria-selected","true"));this.listViewInstance.fields.groupBy&&(this.listViewInstance.curViewDS[e].isHeader?t.classList.contains(Gu.listItem)&&(t.classList.remove(Gu.listItem),t.setAttribute("role","group"),t.classList.add(Gu.groupListItem)):t.classList.contains(Gu.groupListItem)&&(t.classList.remove(Gu.groupListItem),t.setAttribute("role","listitem"),t.classList.add(Gu.listItem)))},t.prototype.findDSAndIndexFromId=function(t,e){var i=this,n={};return t.some(function(t,o){return!!(e[i.listViewInstance.fields.id]&&e[i.listViewInstance.fields.id].toString()===(t[i.listViewInstance.fields.id]&&t[i.listViewInstance.fields.id].toString())||e===t)&&(n.index=o,n.data=t,!0)}),n},t.prototype.getSelectedItems=function(){var t=this;if(!c(this.activeIndex)||this.listViewInstance.showCheckBox&&this.uiIndices.activeIndices.length){var e=[],i=[];if("string"==typeof this.listViewInstance.dataSource[0]||"number"==typeof this.listViewInstance.dataSource[0]){var n=this.listViewInstance.curViewDS;return this.listViewInstance.showCheckBox?(this.uiIndices.activeIndices.forEach(function(t){e.push(n[t])}),{text:e,data:e,index:this.uiIndices.activeIndices.map(function(e){return t.listViewInstance.dataSource.indexOf(n[e])})}):{text:n[this.activeIndex],data:n[this.activeIndex],index:this.listViewInstance.dataSource.indexOf(n[this.activeIndex])}}var o=this.listViewInstance.curViewDS,r=this.listViewInstance.fields.text;return this.listViewInstance.showCheckBox?(this.uiIndices.activeIndices.forEach(function(t){i.push(o[t][r]),e.push(o[t])}),{text:i,data:e,index:this.uiIndices.activeIndices.map(function(e){return t.listViewInstance.dataSource.indexOf(o[e])})}):{text:o[this.activeIndex][this.listViewInstance.fields.text],data:o[this.activeIndex],index:this.listViewInstance.dataSource.indexOf(o[this.activeIndex])}}},t.prototype.selectItem=function(t){var e=this.findDSAndIndexFromId(this.listViewInstance.curViewDS,t);if(Object.keys(e).length)if(this.activeIndex=e.index,this.listViewInstance.showCheckBox&&-1===this.uiIndices.activeIndices.indexOf(e.index)&&this.uiIndices.activeIndices.push(e.index),this.listViewInstance.removeSelect(),this.listViewInstance.showCheckBox&&this.listViewInstance.curUL.querySelector("."+Gu.focused)&&this.listViewInstance.curUL.querySelector("."+Gu.focused).classList.remove(Gu.focused),this.listViewInstance.getLiFromObjOrElement(t))this.listViewInstance.showCheckBox?this.listViewInstance.setCheckboxLI(this.listViewInstance.getLiFromObjOrElement(t)):this.listViewInstance.setSelectLI(this.listViewInstance.getLiFromObjOrElement(t));else{var i=void 0;if("string"==typeof this.listViewInstance.dataSource[0]||"number"==typeof this.listViewInstance.dataSource[0])i={text:this.listViewInstance.curViewDS[this.activeIndex],data:this.listViewInstance.curViewDS[this.activeIndex],index:this.activeIndex};else{var n=this.listViewInstance.curViewDS;i={text:n[this.activeIndex][this.listViewInstance.fields.text],data:n[this.activeIndex],index:this.uiIndices.activeIndices}}this.listViewInstance.trigger("select",i)}},t.prototype.enableItem=function(t){var e=this.findDSAndIndexFromId(this.listViewInstance.curViewDS,t);Object.keys(e).length&&this.uiIndices.disabledItemIndices.splice(this.uiIndices.disabledItemIndices.indexOf(e.index),1)},t.prototype.disableItem=function(t){var e=this.findDSAndIndexFromId(this.listViewInstance.curViewDS,t);Object.keys(e).length&&-1===this.uiIndices.disabledItemIndices.indexOf(e.index)&&this.uiIndices.disabledItemIndices.push(e.index)},t.prototype.showItem=function(t){var e=this.findDSAndIndexFromId(this.listViewInstance.curViewDS,t);Object.keys(e).length&&this.uiIndices.hiddenItemIndices.splice(this.uiIndices.hiddenItemIndices.indexOf(e.index),1)},t.prototype.hideItem=function(t){var e=this.findDSAndIndexFromId(this.listViewInstance.curViewDS,t);Object.keys(e).length&&-1===this.uiIndices.hiddenItemIndices.indexOf(e.index)&&this.uiIndices.hiddenItemIndices.push(e.index)},t.prototype.removeItem=function(t){var e,i=this.findDSAndIndexFromId(this.listViewInstance.curViewDS,t);Object.keys(i).length&&(e=i.data,this.listViewInstance.curViewDS[i.index-1]&&this.listViewInstance.curViewDS[i.index-1].isHeader&&1===this.listViewInstance.curViewDS[i.index-1].items.length?(this.removeUiItem(i.index-1),this.removeUiItem(i.index-1)):this.removeUiItem(i.index));var n=this.listViewInstance.dataSource.indexOf(e);-1!==n&&(this.listViewInstance.dataSource.splice(n,1),this.listViewInstance.setViewDataSource(this.listViewInstance.dataSource))},t.prototype.setCheckboxLI=function(t,e){var i=Array.prototype.indexOf.call(this.listViewInstance.curUL.querySelectorAll("li"),t)+this.uiFirstIndex;this.activeIndex=Array.prototype.indexOf.call(this.listViewInstance.curUL.querySelectorAll("li"),t)+this.uiFirstIndex,t.classList.contains(Gu.selected)?-1===this.uiIndices.activeIndices.indexOf(i)&&this.uiIndices.activeIndices.push(i):this.uiIndices.activeIndices.splice(this.uiIndices.activeIndices.indexOf(i),1)},t.prototype.setSelectLI=function(t,e){this.activeIndex=Array.prototype.indexOf.call(this.listViewInstance.curUL.querySelectorAll("li"),t)+this.uiFirstIndex},t.prototype.checkedItem=function(t){var e=this;t?(this.uiIndices.activeIndices=[],this.activeIndex=void 0,this.listViewInstance.curViewDS.forEach(function(t,i){t.isHeader||e.uiIndices.activeIndices.push(i)})):(this.activeIndex=void 0,this.uiIndices.activeIndices=[])},t.prototype.addUiItem=function(t){var e=this.listViewInstance.curViewDS;if(this.changeUiIndices(t,!0),this.activeIndex&&this.activeIndex>=t&&this.activeIndex++,this.listViewInstance.showCheckBox&&e[t][this.listViewInstance.fields.isChecked]&&this.uiIndices.activeIndices.push(t),parseFloat(this.bottomElement.style.height)||parseFloat(this.topElement.style.height)||(this.bottomElement.style.height=parseFloat(this.bottomElement.style.height)+this.listItemHeight+"px"),parseFloat(this.bottomElement.style.height)){i=this.listViewInstance.curUL.lastElementChild.previousSibling;(n=this.listViewInstance.getLiFromObjOrElement(e[t+1])||this.listViewInstance.getLiFromObjOrElement(e[t+2]))&&(this.bottomElement.style.height=parseFloat(this.bottomElement.style.height)+this.listItemHeight+"px",this.updateUI(i,t,n))}else{var i=this.listViewInstance.curUL.firstElementChild.nextSibling,n=void 0;n=Object.keys(this.listViewInstance.curViewDS).length-1===t?this.listViewInstance.curUL.lastElementChild:this.listViewInstance.getLiFromObjOrElement(e[t+1])||this.listViewInstance.getLiFromObjOrElement(e[t+2]),this.topElement.style.height=parseFloat(this.topElement.style.height)+this.listItemHeight+"px",this.uiFirstIndex++,this.uiLastIndex++,n&&(this.updateUI(i,t,n),this.listViewInstance.isWindow?window.scrollTo(0,pageYOffset+this.listItemHeight):this.listViewInstance.element.scrollTop+=this.listItemHeight)}this.totalHeight+=this.listItemHeight,this.listDiff=parseFloat(this.topElement.style.height)/this.listItemHeight},t.prototype.removeUiItem=function(t){this.totalHeight-=this.listItemHeight;var e=this.listViewInstance.curViewDS[t],i=this.listViewInstance.getLiFromObjOrElement(e);if(this.listViewInstance.curViewDS.splice(t,1),this.activeIndex&&this.activeIndex>=t&&this.activeIndex--,i)if(this.domItemCount>Object.keys(this.listViewInstance.curViewDS).length)A(i),this.domItemCount--,this.uiLastIndex--,this.totalHeight=0;else{if(i.classList.contains(Gu.disable)&&(i.classList.remove(Gu.disable),this.uiIndices.disabledItemIndices.splice(this.uiIndices.disabledItemIndices.indexOf(t),1)),"none"===i.style.display&&(i.style.display="",this.uiIndices.hiddenItemIndices.splice(this.uiIndices.hiddenItemIndices.indexOf(t),1)),this.listViewInstance.showCheckBox&&i.classList.contains(Gu.selected)){this.listViewInstance.removeSelect(),this.uiIndices.activeIndices.splice(this.uiIndices.activeIndices.indexOf(t),1);var n=i.querySelector("."+Gu.checkboxWrapper);n.removeAttribute("aria-checked"),n.firstElementChild.classList.remove(Gu.checked),i.classList.contains(Gu.focused)&&(i.classList.remove(Gu.focused),this.activeIndex=void 0)}else i.classList.contains(Gu.selected)&&(this.listViewInstance.removeSelect(),this.activeIndex=void 0);parseFloat(this.bottomElement.style.height)||parseFloat(this.topElement.style.height)?parseFloat(this.bottomElement.style.height)?(this.bottomElement.style.height=parseFloat(this.bottomElement.style.height)-this.listItemHeight+"px",this.updateUI(i,this.uiLastIndex,this.bottomElement)):(this.topElement.style.height=parseFloat(this.topElement.style.height)-this.listItemHeight+"px",this.updateUI(i,this.uiFirstIndex-1,this.topElement.nextSibling),this.uiLastIndex--,this.uiFirstIndex--):this.updateUI(i,this.uiLastIndex,this.bottomElement)}this.changeUiIndices(t,!1),this.listDiff=parseFloat(this.topElement.style.height)/this.listItemHeight},t.prototype.changeUiIndices=function(t,e){var i=this;Object.keys(this.uiIndices).forEach(function(n){i.uiIndices[n]=i.uiIndices[n].map(function(i){return i>=t?e?++i:--i:i})})},t.prototype.addItem=function(t,e){var i=this;t.forEach(function(t){if(i.listViewInstance.dataSource.push(t),i.listViewInstance.setViewDataSource(i.listViewInstance.dataSource),i.domItemCount)if(i.domItemCount<i.expectedDomItemCount)i.wireScrollEvent(!0),A(i.listViewInstance.contentContainer),i.uiVirtualization();else{var e=i.listViewInstance.curViewDS.indexOf(t);i.addUiItem(e);var n=i.listViewInstance.curViewDS[e-1];n&&n.isHeader&&1===n.items.length&&i.addUiItem(e-1)}else i.uiVirtualization()})},t.prototype.createUIItem=function(t){var e=document.createElement("div"),i='<div class="e-text-content" role="presentation"> <span class="e-list-text"> ${'+this.listViewInstance.fields.text+"} </span></div>";e.innerHTML=this.listViewInstance.template||i;var n=e.getElementsByTagName("*"),o=document.createElement("div");this.listViewInstance.fields.groupBy&&(o.innerHTML=this.listViewInstance.groupTemplate||i);var r=o.getElementsByTagName("*");t.curData.isHeader&&(this.headerData=t.curData),this.templateData=t.curData.isHeader?t.curData.items[0]:t.curData,t.item.innerHTML="",t.item.context={data:t.curData,nodes:{flatTemplateNodes:[],groupTemplateNodes:[]}};for(s=0;s<n.length;s++)this.compileTemplate(n[s],t.item,!1);for(var s=0;s<r.length;s++)this.compileTemplate(r[s],t.item,!0);t.item.context.template=t.curData.isHeader?e.firstElementChild:o.firstElementChild,t.item.context.type=t.curData.isHeader?"flatList":"groupList";var a=t.curData.isHeader?o:e;t.item.insertBefore(a.firstElementChild,null)},t.prototype.compileTemplate=function(t,e,i){this.textProperty(t,e,i),this.classProperty(t,e,i),this.attributeProperty(t,e,i)},t.prototype.onChange=function(t,e){e.context.data=t;var i=e.context.nodes.groupTemplateNodes,n=e.context.nodes.flatTemplateNodes;if(!c(t.isHeader)&&t.isHeader&&"groupList"===e.context.type){o=e.firstElementChild;A(e.firstElementChild),e.insertBefore(e.context.template,null),e.context.template=o,e.context.type="flatList",i.forEach(function(e){return e.onChange(t)})}else if(t.isHeader||"flatList"!==e.context.type)t.isHeader?i.forEach(function(e){return e.onChange(t)}):n.forEach(function(e){return e.onChange(t)});else{var o=e.firstElementChild;A(e.firstElementChild),e.insertBefore(e.context.template,null),e.context.template=o,e.context.type="groupList",n.forEach(function(e){return e.onChange(t)})}},t.prototype.updateContextData=function(t,e,i){i?t.context.nodes.groupTemplateNodes.push(e):t.context.nodes.flatTemplateNodes.push(e)},t.prototype.classProperty=function(t,e,i){for(var n,o=this,r=new RegExp("\\${([^}]*)}","g"),s=[];null!==n;){var a=r.exec(t.className);s.push(a),null===(n=a)&&s.pop()}s&&s.length&&s.forEach(function(n){var r;r=-1!==n[1].indexOf("?")&&-1!==n[1].indexOf(":")?new Function("data","return "+n[1].replace(/\$/g,"data.")):new Function("data","return data."+n[1]);var s={};s.bindedvalue=r(i?o.headerData:o.templateData),s.onChange=function(e){t.classList.remove(s.bindedvalue),t.classList.add(r(e)),s.bindedvalue=r(e)},n[0].split(" ").forEach(function(e){t.classList.remove(e)}),t.classList.add(s.bindedvalue),o.updateContextData(e,s,i)})},t.prototype.attributeProperty=function(t,e,i){for(var n=this,o=[],r=0;r<t.attributes.length;r++)o.push(t.attributes[r].nodeName);-1!==o.indexOf("class")&&o.splice(o.indexOf("class"),1),o.forEach(function(o){var r,s,a=new RegExp("\\${([^}]*)}","g").exec(o)||[],l=new RegExp("\\${([^}]*)}","g").exec(t.getAttribute(o))||[];if(a.length||l.length){a[1]&&(r=new Function("data","return data."+a[1])),l[1]&&(s=-1!==l[1].indexOf("?")&&-1!==l[1].indexOf(":")?new Function("data","return "+l[1].replace(/\$/g,"data.")):new Function("data","return data."+l[1]));var h={};h.bindedvalue=i?[void 0===a[1]?void 0:r(n.headerData),void 0===l[1]?void 0:s(n.headerData)]:[void 0===a[1]?void 0:r(n.templateData),void 0===l[1]?void 0:s(n.templateData)],h.attrName=void 0===h.bindedvalue[0]?o:h.bindedvalue[0],h.onChange=function(e){var i=void 0===h.bindedvalue[1]?t.getAttribute(h.attrName):s(e);t.removeAttribute(h.attrName),h.attrName=void 0===h.bindedvalue[0]?h.attrName:r(e),t.setAttribute(h.attrName,i),h.bindedvalue=[void 0===h.bindedvalue[0]?void 0:r(e),void 0===h.bindedvalue[1]?void 0:s(e)]};var c=void 0===h.bindedvalue[1]?t.getAttribute(o):h.bindedvalue[1];t.removeAttribute(o),t.setAttribute(h.attrName,c),n.updateContextData(e,h,i)}})},t.prototype.textProperty=function(t,e,i){for(var n,o=this,r=new RegExp("\\${([^}]*)}","g"),s=[];null!==n;){var a=r.exec(t.innerText);s.push(a),null===(n=a)&&s.pop()}var l=Array.prototype.some.call(t.children,function(t){return!!new RegExp("\\${([^}]*)}","g").exec(t.innerText)});s&&s.length&&!l&&s.forEach(function(n){var r,s={};r=-1!==n[1].indexOf("?")&&-1!==n[1].indexOf(":")?new Function("data","return "+n[1].replace(/\$/g,"data.")):new Function("data","return data."+n[1]),s.bindedvalue=r(i?o.headerData:o.templateData),s.onChange=function(e){t.innerText=t.innerText.replace(s.bindedvalue,r(e)),s.bindedvalue=r(e)},t.innerText=t.innerText.replace(n[0],s.bindedvalue),o.updateContextData(e,s,i)})},t.prototype.reRenderUiVirtualization=function(){this.wireScrollEvent(!0),this.listViewInstance.contentContainer&&A(this.listViewInstance.contentContainer),this.listViewInstance.preRender(),this.listViewInstance.localData=this.listViewInstance.dataSource,this.listViewInstance.renderList()},t.prototype.updateUI=function(t,e,i){if(this.listViewInstance.template||this.listViewInstance.groupTemplate){var n=this.listViewInstance.curViewDS[e];t.dataset.uid=n[this.listViewInstance.fields.id]?n[this.listViewInstance.fields.id].toString():Dh.generateId(),this.onChange(n,t)}else this.updateUiContent(t,e);this.changeElementAttributes(t,e),i&&this.listViewInstance.ulElement.insertBefore(t,i)},t.prototype.getModuleName=function(){return"virtualization"},t.prototype.destroy=function(){this.wireScrollEvent(!0)},t}(),Ju=Object.freeze({classNames:Gu,FieldSettings:Zu,ListView:Ku,Virtualization:Qu,get cssClass(){return _u},get ListBase(){return Dh},getFieldValues:Bs}),$u=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),tg=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},eg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $u(e,t),tg([et("")],e.prototype,"iconCss",void 0),tg([et("")],e.prototype,"id",void 0),tg([et(!1)],e.prototype,"separator",void 0),tg([et("")],e.prototype,"text",void 0),tg([et("")],e.prototype,"url",void 0),e}(qa),ig=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ng=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},og={DISABLED:"e-disabled",FOCUS:"e-focused",ICON:"e-menu-icon",ITEM:"e-item",POPUP:"e-dropdown-popup",RTL:"e-rtl",SEPARATOR:"e-separator",VERTICAL:"e-vertical"},rg=function(t){function e(e,i){return t.call(this,e,i)||this}return ig(e,t),e.prototype.preRender=function(){},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.toggle=function(){this.canOpen()?this.openPopUp():this.closePopup()},e.prototype.render=function(){this.initialize(),this.disabled||this.wireEvents()},e.prototype.createPopup=function(){var t=L("div",{className:og.POPUP,id:this.element.id+"-popup"});document.body.appendChild(t),this.dropDown=new Xc(t,{relateTo:this.element,collision:{X:"fit",Y:"flip"},position:{X:"left",Y:"bottom"},targetType:"relative",content:this.target?this.getTargetElement():"",zIndex:Qi(t),enableRtl:this.enableRtl}),this.dropDown.hide(),R(this.element,(e={},e.role="menu",e["aria-haspopup"]=this.items.length||this.target?"true":"false",e["aria-expanded"]="false",e["aria-owns"]=this.getPopUpElement().id,e.type="button",e)),this.cssClass&&E([t],this.cssClass.split(" "));var e},e.prototype.getTargetElement=function(){return"string"==typeof this.target?D(this.target):this.target},e.prototype.createItems=function(t){for(var e,i,n,o,r=this.hasIcon(t,"iconCss"),s=L("ul",{attrs:{tabindex:"0"}}),a=0;a<t.length;a++)n=L("li",{innerHTML:(i=t[a]).url?"":i.text,className:i.separator?og.ITEM+" "+og.SEPARATOR:og.ITEM,attrs:{role:"menuItem",tabindex:"-1"},id:i.id?i.id:p("e-"+this.getModuleName()+"-item")}),i.iconCss?(e=L("span",{className:og.ICON+" "+i.iconCss}),n.insertBefore(e,n.childNodes[0])):r&&!i.separator&&n.classList.add("e-blank-icon"),i.url&&n.appendChild(this.createAnchor(i)),o={item:i,element:n},this.trigger("beforeItemRender",o),s.appendChild(n);return s},e.prototype.hasIcon=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i][e])return!0;return!1},e.prototype.createAnchor=function(t){return L("a",{className:"e-menu-text e-menu-url",innerHTML:t.text,attrs:{href:t.url}})},e.prototype.initialize=function(){this.button=new kc({iconCss:this.iconCss,cssClass:this.cssClass,content:this.content,disabled:this.disabled,enableRtl:this.enableRtl,enablePersistence:this.enablePersistence}),this.button.appendTo(this.element),this.element.id||(this.element.id=p("e-"+this.getModuleName())),this.setIconPositionTop(),this.appendArrowSpan(),this.createPopup(),this.setActiveElem([this.element])},e.prototype.setIconPositionTop=function(){var t=this.element.querySelector(".e-icon-left");t&&"Top"===this.iconPosition&&(E([this.element],"e-top-icon-btn"),P([t],"e-icon-left"),E([t],"e-icon-top"))},e.prototype.appendArrowSpan=function(){this.element.appendChild(L("span",{className:"e-btn-icon e-icons e-icon-"+(this.cssClass.indexOf(og.VERTICAL)>-1?"bottom":"right")+" e-caret"}))},e.prototype.setActiveElem=function(t){this.activeElem=t},e.prototype.getModuleName=function(){return"dropdown-btn"},e.prototype.canOpen=function(){return this.getPopUpElement().classList.contains("e-popup-close")},e.prototype.destroy=function(){var e=this;this.element.querySelector("span.e-caret")&&A(this.element.querySelector("span.e-caret")),t.prototype.destroy.call(this),this.button.destroy(),["role","aria-haspopup","aria-expanded","aria-owns","type"].forEach(function(t){e.element.removeAttribute(t)}),P([this.element],["e-btn"]),P(this.activeElem,["e-active"]),this.dropDown.destroy();var i=document.getElementById(this.getPopUpElement().id);i&&(P([i],["e-popup-open","e-popup-close"]),A(i)),this.disabled||this.unWireEvents()},e.prototype.getPopUpElement=function(){return this.dropDown.element},e.prototype.getULElement=function(){return this.getPopUpElement().children[0]},e.prototype.wireEvents=function(){var t=this.getPopUpElement();this.delegateMousedownHandler=this.mousedownHandler.bind(this),Ma.add(document,"mousedown touchstart",this.delegateMousedownHandler,this),Ma.add(this.element,"click",this.clickHandler,this),Ma.add(t,"click",this.clickHandler,this),Ma.add(this.element,"keydown",this.keyBoardHandler,this),Ma.add(t,"keydown",this.keyBoardHandler,this),this.rippleFn=pt(t,{selector:"."+og.ITEM})},e.prototype.keyBoardHandler=function(t){if(t.target!==this.element||9!==t.keyCode&&(t.altKey||40!==t.keyCode)&&38!==t.keyCode)switch(t.keyCode){case 38:case 40:!t.altKey||38!==t.keyCode&&40!==t.keyCode?this.upDownKeyHandler(t):this.keyEventHandler(t);break;case 9:case 13:case 27:case 32:this.keyEventHandler(t)}},e.prototype.upDownKeyHandler=function(t){if(!this.target||38!==t.keyCode&&40!==t.keyCode){t.preventDefault();var e=this.getULElement(),i=40===t.keyCode?0:e.childElementCount-1,n=i,o=null;this.removeCustomSelection();for(var r=0,s=e.children.length;r<s;r++)e.children[r].classList.contains(og.FOCUS)&&(n=r,(o=e.children[r]).classList.remove(og.FOCUS),40===t.keyCode?n++:n--,n===(40===t.keyCode?e.childElementCount:-1)&&(n=i));o=e.children[n],-1!==(n=this.isValidLI(o,n,t.keyCode))&&(E([e.children[n]],og.FOCUS),e.children[n].focus())}},e.prototype.removeCustomSelection=function(){var t=this.getULElement().querySelector(".e-selected");t&&t.classList.remove("e-selected")},e.prototype.isValidLI=function(t,e,i,n){if(void 0===n&&(n=0),(t.classList.contains(og.SEPARATOR)||t.classList.contains(og.DISABLED))&&(e===(40===i?this.items.length-1:0)?e=40===i?0:this.items.length-1:40===i?e++:e--),(t=this.getULElement().children[e]).classList.contains(og.SEPARATOR)||t.classList.contains(og.DISABLED)){if(++n===this.items.length)return e=-1;e=this.isValidLI(t,e,i,n)}return e},e.prototype.keyEventHandler=function(t){(!this.target||13!==t.keyCode&&9!==t.keyCode)&&(9!==t.keyCode&&t.preventDefault(),27===t.keyCode||38===t.keyCode||9===t.keyCode?this.canOpen()||this.closePopup(t,this.element):this.clickHandler(t))},e.prototype.getLI=function(t){return"LI"===t.tagName?t:N(t,"li")},e.prototype.mousedownHandler=function(t){var e=t.target;this.canOpen()||N(e,"#"+this.getPopUpElement().id)||N(e,"#"+this.element.id)||this.closePopup(t)},e.prototype.clickHandler=function(t){var e=t.target,i=this.canOpen();if(N(e,"#"+this.element.id))i?this.openPopUp(t):this.closePopup(t,this.activeElem[0]);else if(N(e,"#"+this.getPopUpElement().id)){var n=void 0,o=void 0,r=void 0,s=this.getLI(e);s&&(o=Array.prototype.indexOf.call(this.getULElement().children,s),(r=this.items[o])&&(n={element:s,item:r},this.trigger("select",n)),this.closePopup(t,this.activeElem[0]))}else i||this.closePopup(t)},e.prototype.openPopUp=function(t){void 0===t&&(t=null),this.target||this.getPopUpElement().appendChild(this.createItems(this.items));var e=this.getULElement(),i={element:e,items:this.items,event:t,cancel:!1};if(this.trigger("beforeOpen",i),!i.cancel){this.dropDown.show(),E([this.element],"e-active"),this.element.setAttribute("aria-expanded","true"),e.focus();var n={element:e,items:this.items};this.trigger("open",n)}},e.prototype.closePopup=function(t,e){void 0===t&&(t=null);var i=this.getULElement(),n={element:i,items:this.items,event:t,cancel:!1};if(this.trigger("beforeClose",n),!n.cancel){this.removeCustomSelection(),this.dropDown.hide(),P(this.activeElem,"e-active"),this.element.setAttribute("aria-expanded","false"),e&&e.focus();var o={element:i,items:this.items};this.trigger("close",o),!this.target&&i&&A(i)}},e.prototype.unWireEvents=function(){Ma.remove(document,"mousedown touchstart",this.delegateMousedownHandler),Ma.remove(this.element,"click",this.clickHandler),Ma.remove(this.getPopUpElement(),"click",this.clickHandler),Ma.remove(this.element,"keydown",this.keyBoardHandler),Ma.remove(this.getPopUpElement(),"keydown",this.keyBoardHandler),this.rippleFn()},e.prototype.onPropertyChanged=function(t,e){var i=["content","cssClass","iconCss","disabled","enableRtl"];"Left"===t.iconPosition&&i.push("iconPosition"),this.button.setProperties(Ns(t,i));for(var n=this.getPopUpElement(),o=0,r=Object.keys(t);o<r.length;o++)switch(r[o]){case"content":this.element.querySelector("span.e-caret")||this.appendArrowSpan();break;case"disabled":t.disabled?(this.unWireEvents(),this.canOpen()||this.closePopup()):this.wireEvents();break;case"cssClass":t.cssClass.indexOf(og.VERTICAL)>-1&&V(this.element.querySelector("span.e-caret"),["e-icon-bottom"],["e-icon-right"]),e.cssClass&&P([n],e.cssClass.split(" ")),t.cssClass&&E([n],t.cssClass.split(" "));break;case"iconPosition":this.setIconPositionTop();break;case"enableRtl":n.classList.toggle(og.RTL);break;case"target":this.target=t.target,A(this.getULElement()),n.appendChild(this.getTargetElement()),this.dropDown.content=this.getTargetElement();break;case"items":this.dropDown.refresh(),n.classList.contains("e-popup-open")&&V(n,["e-popup-close"],["e-popup-open"])}},ng([et("")],e.prototype,"content",void 0),ng([et("")],e.prototype,"cssClass",void 0),ng([et(!1)],e.prototype,"disabled",void 0),ng([et("")],e.prototype,"iconCss",void 0),ng([et("Left")],e.prototype,"iconPosition",void 0),ng([ot([],eg)],e.prototype,"items",void 0),ng([et("")],e.prototype,"target",void 0),ng([st()],e.prototype,"beforeItemRender",void 0),ng([st()],e.prototype,"beforeOpen",void 0),ng([st()],e.prototype,"beforeClose",void 0),ng([st()],e.prototype,"close",void 0),ng([st()],e.prototype,"open",void 0),ng([st()],e.prototype,"select",void 0),e=ng([at],e)}(wl),sg=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ag=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},lg="EJS-SPLITBUTTON",hg=function(t){function e(e,i){return t.call(this,e,i)||this}return sg(e,t),e.prototype.preRender=function(){var t=this.element;if(t.tagName===lg){for(var e=n("ej2_instances",t),i=L("button",{attrs:{type:"button"}}),r=L(lg,{className:"e-"+this.getModuleName()+"-wrapper"}),s=0,a=t.attributes.length;s<a;s++)i.setAttribute(t.attributes[s].nodeName,t.attributes[s].nodeValue);t.parentNode.insertBefore(r,t),A(t),t=i,r.appendChild(t),o("ej2_instances",e,t),this.wrapper=r,this.element=t}this.element.id||(this.element.id=p("e-"+this.getModuleName()))},e.prototype.render=function(){this.initWrapper(),this.createPrimaryButton(),this.createSecondaryButton(),this.setActiveElem([this.element,this.secondaryBtnObj.element]),this.setAria(),this.wireEvents()},e.prototype.initWrapper=function(){this.wrapper||(this.wrapper=L("div",{className:"e-"+this.getModuleName()+"-wrapper"}),this.element.parentNode.insertBefore(this.wrapper,this.element)),this.element.classList.remove("e-"+this.getModuleName()),this.enableRtl&&this.wrapper.classList.add("e-rtl"),this.cssClass&&E([this.wrapper],this.cssClass.split(" "))},e.prototype.createPrimaryButton=function(){var t={cssClass:this.cssClass,enableRtl:this.enableRtl,iconCss:this.iconCss,content:this.content,disabled:this.disabled};this.primaryBtnObj=new kc(t,this.element),this.element.classList.add("e-"+this.getModuleName()),this.element.type="button",this.wrapper.appendChild(this.element),this.setIconPositionTop()},e.prototype.createSecondaryButton=function(){var t=this,e=L("button",{className:"e-icon-btn",attrs:{tabindex:"-1"},id:this.element.id+"_dropdownbtn"});this.wrapper.appendChild(e);var i={cssClass:this.cssClass,disabled:this.disabled,enableRtl:this.enableRtl,items:this.items,target:this.target,beforeItemRender:function(e){t.trigger("beforeItemRender",e)},beforeOpen:function(e){t.trigger("beforeOpen",e)},beforeClose:function(e){t.trigger("beforeClose",e)},open:function(e){t.trigger("open",e)},close:function(e){t.trigger("close",e)},select:function(e){t.trigger("select",e)}};this.secondaryBtnObj=new rg(i,e),this.secondaryBtnObj.dropDown.relateTo=this.wrapper,this.dropDown=this.secondaryBtnObj.dropDown,this.secondaryBtnObj.activeElem=[this.element,this.secondaryBtnObj.element],Ma.remove(this.getPopUpElement(),"keydown",this.secondaryBtnObj.keyBoardHandler),this.secondaryBtnObj.element.querySelector(".e-btn-icon").classList.remove("e-icon-right")},e.prototype.setAria=function(){R(this.element,{role:"listbox","aria-expanded":"false","aria-haspopup":"true","aria-label":this.element.textContent+" splitbutton","aria-owns":this.secondaryBtnObj.dropDown.element.id})},e.prototype.getModuleName=function(){return"split-btn"},e.prototype.toggle=function(){this.secondaryBtnObj.toggle()},e.prototype.destroy=function(){var t=this;this.primaryBtnObj.destroy(),this.secondaryBtnObj.destroy();var e=document.getElementById(this.element.id);e&&e.parentElement===this.wrapper&&(this.wrapper.tagName===lg?(this.wrapper.innerHTML="",P([this.wrapper],["e-rtl","e-"+this.getModuleName()+"-wrapper"]),P([this.wrapper],this.cssClass.split(" "))):(P([this.element],["e-"+this.getModuleName(),"e-rtl"]),["role","aria-label","aria-haspopup","aria-expanded","aria-owns","type"].forEach(function(e){t.element.removeAttribute(e)}),this.wrapper.parentNode.insertBefore(this.element,this.wrapper),M(this.wrapper)),this.unWireEvents())},e.prototype.wireEvents=function(){Ma.add(this.element,"click",this.primaryBtnClickHandler,this),Ma.add(this.getPopUpElement(),"keydown",this.keyBoardHandler,this),new Rl(this.element,{keyAction:this.btnKeyBoardHandler.bind(this),keyConfigs:{altdownarrow:"alt+downarrow"}})},e.prototype.unWireEvents=function(){Ma.remove(this.element,"click",this.primaryBtnClickHandler),w(this.element,Rl).destroy()},e.prototype.primaryBtnClickHandler=function(){this.trigger("click",{element:this.element})},e.prototype.btnKeyBoardHandler=function(t){switch(t.action){case"altdownarrow":this.clickHandler(t)}},e.prototype.onPropertyChanged=function(t,e){var i=["content","iconCss","cssClass","disabled","enableRtl"];"Left"===t.iconPosition&&i.push("iconPosition"),this.primaryBtnObj.setProperties(Ns(t,i)),i=["items","beforeOpen","beforeItemRender","select","open","close","cssClass","disabled","enableRtl"],this.secondaryBtnObj.setProperties(Ns(t,i));for(var n=0,o=Object.keys(t);n<o.length;n++)switch(o[n]){case"cssClass":e.cssClass&&P([this.wrapper],e.cssClass.split(" ")),E([this.wrapper],t.cssClass.split(" "));break;case"iconPosition":this.setIconPositionTop();break;case"enableRtl":t.enableRtl?E([this.wrapper],"e-rtl"):P([this.wrapper],"e-rtl")}},ag([et("")],e.prototype,"content",void 0),ag([et("")],e.prototype,"cssClass",void 0),ag([et(!1)],e.prototype,"disabled",void 0),ag([et("")],e.prototype,"iconCss",void 0),ag([et("Left")],e.prototype,"iconPosition",void 0),ag([ot([],eg)],e.prototype,"items",void 0),ag([et("")],e.prototype,"target",void 0),ag([st()],e.prototype,"beforeItemRender",void 0),ag([st()],e.prototype,"beforeOpen",void 0),ag([st()],e.prototype,"beforeClose",void 0),ag([st()],e.prototype,"click",void 0),ag([st()],e.prototype,"close",void 0),ag([st()],e.prototype,"open",void 0),ag([st()],e.prototype,"select",void 0),e=ag([at],e)}(rg),cg={RTL:"e-rtl",DISABLE:"e-disabled",INPUT:"e-input",INPUTGROUP:"e-input-group",FLOATINPUT:"e-float-input",FLOATLINE:"e-float-line",FLOATTEXT:"e-float-text",CLEARICON:"e-clear-icon",CLEARICONHIDE:"e-clear-icon-hide",LABELTOP:"e-label-top",LABELBOTTOM:"e-label-bottom",NOFLOATLABEL:"e-no-float-label",INPUTCUSTOMTAG:"e-input-custom-tag",FLOATCUSTOMTAG:"e-float-custom-tag"};!function(t){function e(t){var e={container:null,buttons:[],clearButton:null};if(c(t.floatLabelType)||"Never"===t.floatLabelType?(e.container=m(t,cg.INPUTGROUP,cg.INPUTCUSTOMTAG,"span"),t.element.parentNode.insertBefore(e.container,t.element),E([t.element],cg.INPUT),e.container.appendChild(t.element)):s(t,e),t.element.addEventListener("focus",function(){var t=d(this);t.classList.contains("e-input-group")&&t.classList.add("e-input-focus")}),t.element.addEventListener("blur",function(){var t=d(this);t.classList.contains("e-input-group")&&t.classList.remove("e-input-focus")}),c(t.properties)||c(t.properties.showClearButton)||!t.properties.showClearButton||(S(t.properties.showClearButton,t.element,e,!0),e.container.classList.contains(cg.FLOATINPUT)&&E([e.container],cg.INPUTGROUP)),!c(t.buttons))for(var i=0;i<t.buttons.length;i++)e.buttons.push(z(t.buttons[i],e.container));return e=a(t,e)}function i(){var t=d(this).getElementsByClassName("e-float-text")[0];E([t],cg.LABELTOP),t.classList.contains(cg.LABELBOTTOM)&&P([t],cg.LABELBOTTOM)}function n(){var t=d(this);if(""===t.getElementsByTagName("input")[0].value){var e=t.getElementsByClassName("e-float-text")[0];e.classList.contains(cg.LABELTOP)&&P([e],cg.LABELTOP),E([e],cg.LABELBOTTOM)}}function o(t){t.addEventListener("focus",i),t.addEventListener("blur",n)}function r(t){t.removeEventListener("focus",i),t.removeEventListener("blur",n)}function s(t,e){var i,n;"Auto"===t.floatLabelType&&o(t.element),c(e.container)?(e.container=m(t,cg.FLOATINPUT,cg.FLOATCUSTOMTAG,"div"),t.element.parentNode.insertBefore(e.container,t.element)):(c(t.customTag)||e.container.classList.add(cg.FLOATCUSTOMTAG),e.container.classList.add(cg.FLOATINPUT)),i=L("span",{className:cg.FLOATLINE}),n=L("label",{className:cg.FLOATTEXT}),c(t.element.id)||""===t.element.id||(n.id="label_"+t.element.id.replace(/ /g,"_"),R(t.element,{"aria-labelledby":n.id})),c(t.element.placeholder)||""===t.element.placeholder||(n.innerHTML=t.element.placeholder,t.element.removeAttribute("placeholder")),c(t.properties)||c(t.properties.placeholder)||""===t.properties.placeholder||(n.innerHTML=t.properties.placeholder),n.innerHTML||e.container.classList.add(cg.NOFLOATLABEL),e.container.appendChild(t.element),e.container.appendChild(i),e.container.appendChild(n),h(t.element.value,n),"Always"===t.floatLabelType&&(n.classList.contains(cg.LABELBOTTOM)&&P([n],cg.LABELBOTTOM),E([n],cg.LABELTOP)),"Auto"===t.floatLabelType&&(t.element.addEventListener("input",function(e){h(t.element.value,n)}),t.element.addEventListener("blur",function(e){h(t.element.value,n)}))}function a(t,e){if(!c(t.properties))for(var i=0,n=Object.keys(t.properties);i<n.length;i++)switch(n[i]){case"cssClass":v(t.properties.cssClass,[e.container]);break;case"enabled":x(t.properties.enabled,t.element);break;case"enableRtl":w(t.properties.enableRtl,[e.container]);break;case"placeholder":y(t.properties.placeholder,t.element);break;case"readonly":b(t.properties.readonly,t.element)}return e}function l(t,e){t?P([e],cg.CLEARICONHIDE):E([e],cg.CLEARICONHIDE)}function h(t,e){t?(E([e],cg.LABELTOP),e.classList.contains(cg.LABELBOTTOM)&&P([e],cg.LABELBOTTOM)):(e.classList.contains(cg.LABELTOP)&&P([e],cg.LABELTOP),E([e],cg.LABELBOTTOM))}function d(t){return t.parentNode}function p(t,e,i){var n=L("span",{className:cg.CLEARICON}),o=e.container;return c(i)?(e.container.classList.contains(cg.FLOATINPUT)?e.container.querySelector("."+cg.FLOATTEXT):t).insertAdjacentElement("afterend",n):o.appendChild(n),!c(o)&&o.classList.contains(cg.FLOATINPUT)&&E([o],cg.INPUTGROUP),E([n],cg.CLEARICONHIDE),u(t,n,o),n}function u(t,e,i){e.addEventListener("click",function(i){t.classList.contains(cg.DISABLE)||t.readOnly||(i.preventDefault(),t!==document.activeElement&&t.focus(),t.value="",E([e],cg.CLEARICONHIDE))}),t.addEventListener("input",function(i){l(t.value,e)}),t.addEventListener("focus",function(i){l(t.value,e)}),t.addEventListener("blur",function(t){setTimeout(function(){E([e],cg.CLEARICONHIDE)},200)})}function g(t,e){if(d(t).classList.contains(cg.FLOATINPUT)&&"Auto"===e){var i=d(t).getElementsByClassName("e-float-text")[0];h(t.value,i)}}function m(t,e,i,n){var o;return c(t.customTag)?o=L(n,{className:e}):(o=L(t.customTag,{className:e})).classList.add(i),o.classList.add("e-control-wrapper"),o}function f(t,e,i,n){if(e.value=t,c(i)||"Auto"!==i||g(e,i),!c(n)&&n){var o=d(e),r=o.getElementsByClassName(cg.CLEARICON)[0];e.value&&o.classList.contains("e-input-focus")?P([r],cg.CLEARICONHIDE):E([r],cg.CLEARICONHIDE)}}function v(t,e,i){c(i)||""===i||P(e,i),c(t)||""===t||E(e,t)}function y(t,e){var i;(i=d(e)).classList.contains(cg.FLOATINPUT)?c(t)||""===t?(i.classList.add(cg.NOFLOATLABEL),i.getElementsByClassName(cg.FLOATTEXT)[0].textContent=""):(i.getElementsByClassName(cg.FLOATTEXT)[0].textContent=t,i.classList.remove(cg.NOFLOATLABEL)):c(t)||""===t?(e.removeAttribute("placeholder"),e.removeAttribute("aria-placeholder")):R(e,{placeholder:t,"aria-placeholder":t})}function b(t,e,i){t?R(e,{readonly:""}):e.removeAttribute("readonly"),c(i)||g(e,i)}function w(t,e){t?E(e,cg.RTL):P(e,cg.RTL)}function x(t,e,i){var n={disabled:"disabled","aria-disabled":"true"};t?(e.classList.remove(cg.DISABLE),C(n,e)):(e.classList.add(cg.DISABLE),k(n,e)),c(i)||g(e,i)}function S(t,e,i,n){t?i.clearButton=p(e,i,n):(i.clearButton.remove(),i.clearButton=null)}function C(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++){var o=n[i],r=void 0;r=d(e),"disabled"===o&&e.classList.remove(cg.DISABLE),"disabled"===o&&r.classList.contains(cg.INPUTGROUP)&&r.classList.remove(cg.DISABLE),"placeholder"===o&&r.classList.contains(cg.FLOATINPUT)?r.getElementsByClassName(cg.FLOATTEXT)[0].textContent="":e.removeAttribute(o)}}function k(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++){var o=n[i],r=void 0;r=d(e),"disabled"===o&&e.classList.add(cg.DISABLE),"disabled"===o&&r.classList.contains(cg.INPUTGROUP)&&r.classList.add(cg.DISABLE),"placeholder"===o&&r.classList.contains(cg.FLOATINPUT)?r.getElementsByClassName(cg.FLOATTEXT)[0].textContent=t[o]:e.setAttribute(o,t[o])}}function T(t){var e=t.container;if(!c(e)&&e.classList.contains(cg.FLOATINPUT)){var i=e.querySelector("input"),n=e.querySelector("."+cg.FLOATTEXT).textContent,o=null!==e.querySelector(".e-clear-icon");A(e.querySelector("."+cg.FLOATLINE)),A(e.querySelector("."+cg.FLOATTEXT)),V(e,[cg.INPUTGROUP],[cg.FLOATINPUT]),r(i),R(i,{placeholder:n}),i.classList.add(cg.INPUT),o||i.removeAttribute("required")}}function O(t,e,i){var n=N(t,"."+cg.INPUTGROUP);if("Never"!==e){var o=n.tagName,r={element:t,floatLabelType:e,customTag:o="DIV"!==o&&"SPAN"!==o?o:null,properties:{placeholder:i}},a=n.querySelector(".e-clear-icon"),l={container:n};if(t.classList.remove(cg.INPUT),s(r,l),c(a)&&(a=n.querySelector(".e-input-group-icon")),c(a))n.classList.remove(cg.INPUTGROUP);else{var h=n.querySelector("."+cg.FLOATLINE),d=n.querySelector("."+cg.FLOATTEXT);n.insertBefore(t,a),n.insertBefore(h,a),n.insertBefore(d,a)}}}function I(t,e){for(var i=0;i<e.length;i++)M(t,e[i].container)}function M(t,e,i){var n=[];n.push(i);var o=c(i)?e.querySelectorAll(".e-input-group-icon"):n;if(t&&o.length>0)for(r=0;r<o.length;r++)o[r].addEventListener("mousedown",B,!1),o[r].addEventListener("mouseup",H,!1);else if(o.length>0)for(var r=0;r<o.length;r++)o[r].removeEventListener("mousedown",B,this),o[r].removeEventListener("mouseup",H,this)}function D(t,e){t.classList.contains("e-disabled")||t.querySelector("input").readOnly||e.classList.add("e-input-btn-ripple")}function B(){for(var t=this,e=this.parentElement;!e.classList.contains("e-input-group");)e=e.parentElement;D(e,t)}function H(){var t=this;setTimeout(function(){t.classList.remove("e-input-btn-ripple")},500)}function z(t,e){var i=L("span",{className:t});return i.classList.add("e-input-group-icon"),e.appendChild(i),e.classList.contains(cg.INPUTGROUP)||e.classList.add(cg.INPUTGROUP),M(!0,e,i),i}t.createInput=e,t.setValue=f,t.setCssClass=v,t.setPlaceholder=y,t.setReadonly=b,t.setEnableRtl=w,t.setEnabled=x,t.setClearButton=S,t.removeAttributes=C,t.addAttributes=k,t.removeFloating=T,t.addFloating=O,t.setRipple=I,t.appendSpan=z}(Wu||(Wu={}));var dg,pg=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ug=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},gg="e-input-group-icon",mg=new RegExp("/^(-)?(d*)$/"),fg=function(t){function e(e,i){return t.call(this,e,i)||this}return pg(e,t),e.prototype.preRender=function(){this.isPrevFocused=!1,this.decimalSeparator=".",this.intRegExp=new RegExp("/^(-)?(d*)$/"),this.isCalled=!1;var t=n("ej2_instances",this.element);if(this.cloneElement=this.element.cloneNode(!0),this.angularTagName=null,"EJS-NUMERICTEXTBOX"===this.element.tagName){this.angularTagName=this.element.tagName;var e=L("input"),i=0;for(i;i<this.element.attributes.length;i++)e.setAttribute(this.element.attributes[i].nodeName,this.element.attributes[i].nodeValue),e.innerHTML=this.element.innerHTML;this.element.hasAttribute("id")&&this.element.removeAttribute("id"),this.element.classList.remove("e-control","e-numerictextbox"),this.element.appendChild(e),this.element=e,o("ej2_instances",t,this.element)}R(this.element,{role:"spinbutton",tabindex:"0",autocomplete:"off","aria-live":"assertive"});var r={incrementTitle:"Increment value",decrementTitle:"Decrement value",placeholder:""};this.l10n=new Dl("numerictextbox",r,this.locale),this.isValidState=!0,this.inputStyle=null,this.inputName=null,this.cultureInfo={},this.initCultureInfo(),this.initCultureFunc(),this.checkAttributes(),this.prevValue=this.value,this.validateMinMax(),this.validateStep(),null===this.placeholder&&this.updatePlaceholder()},e.prototype.render=function(){"input"===this.element.tagName.toLowerCase()&&(this.createWrapper(),this.showSpinButton&&this.spinBtnCreation(),c(this.width)||j(this.container,{width:b(this.width)}),this.container.classList.contains("e-input-group")||this.container.classList.add("e-input-group"),this.changeValue(null===this.value||isNaN(this.value)?null:this.strictMode?this.trimValue(this.value):this.value),this.wireEvents(),null===this.value||isNaN(this.value)||this.decimals&&this.setProperties({value:this.roundNumber(this.value,this.decimals)},!0))},e.prototype.checkAttributes=function(){for(var t=0,e=["value","min","max","step","disabled","readonly","style","name"];t<e.length;t++){var i=e[t];if(!c(this.element.getAttribute(i)))switch(i){case"disabled":var n="disabled"!==this.element.getAttribute(i)&&"true"!==this.element.getAttribute(i);this.setProperties({enabled:n},!0);break;case"readonly":var r="readonly"===this.element.getAttribute(i)||"true"===this.element.getAttribute(i);this.setProperties({readonly:r},!0);break;case"style":this.inputStyle=this.element.getAttribute(i);break;case"name":this.inputName=this.element.getAttribute(i);break;default:var s=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(i));(null!==s&&!isNaN(s)||"value"===i)&&this.setProperties(o(i,s,{}),!0)}}},e.prototype.updatePlaceholder=function(){this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0)},e.prototype.initCultureFunc=function(){this.instance=new ml(this.locale)},e.prototype.initCultureInfo=function(){this.cultureInfo.format=this.format,null!==n("currency",this)&&(o("currency",this.currency,this.cultureInfo),this.setProperties({currencyCode:this.currency},!0))},e.prototype.createWrapper=function(){var t=Wu.createInput({element:this.element,floatLabelType:this.floatLabelType,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:this.cssClass,enableRtl:this.enableRtl,showClearButton:this.showClearButton,enabled:this.enabled}});this.inputWrapper=t,this.container=t.container,this.container.setAttribute("class","e-control-wrapper e-numeric "+this.container.getAttribute("class")),this.readonly&&R(this.element,{"aria-readonly":"true"}),this.hiddenInput=L("input",{attrs:{type:"hidden",validateHidden:"true"}}),this.inputName=null!==this.inputName?this.inputName:this.element.id,this.element.removeAttribute("name"),R(this.hiddenInput,{name:this.inputName}),this.container.insertBefore(this.hiddenInput,this.container.childNodes[1]),null!==this.inputStyle&&R(this.container,{style:this.inputStyle})},e.prototype.spinBtnCreation=function(){this.spinDown=Wu.appendSpan(gg+" e-spin-down",this.container),R(this.spinDown,{title:this.l10n.getConstant("decrementTitle"),"aria-label":this.l10n.getConstant("decrementTitle")}),this.spinUp=Wu.appendSpan(gg+" e-spin-up",this.container),R(this.spinUp,{title:this.l10n.getConstant("incrementTitle"),"aria-label":this.l10n.getConstant("incrementTitle")}),this.wireSpinBtnEvents()},e.prototype.validateMinMax=function(){("number"!=typeof this.min||isNaN(this.min))&&this.setProperties({min:-Number.MAX_VALUE},!0),("number"!=typeof this.max||isNaN(this.max))&&this.setProperties({max:Number.MAX_VALUE},!0),null!==this.decimals&&(this.min!==-Number.MAX_VALUE&&this.setProperties({min:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.min))},!0),this.max!==Number.MAX_VALUE&&this.setProperties({max:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.max))},!0)),this.setProperties({min:this.min>this.max?this.max:this.min},!0),R(this.element,{"aria-valuemin":this.min.toString(),"aria-valuemax":this.max.toString()})},e.prototype.formattedValue=function(t,e){return this.instance.getNumberFormat({maximumFractionDigits:t,minimumFractionDigits:t,useGrouping:!1})(e)},e.prototype.validateStep=function(){null!==this.decimals&&this.setProperties({step:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.step))},!0)},e.prototype.action=function(t,e){this.isInteract=!0;var i=this.isFocused?this.instance.getNumberParser({format:"n"})(this.element.value):this.value;this.changeValue(this.performAction(i,this.step,t)),this.raiseChangeEvent(e)},e.prototype.checkErrorClass=function(){this.isValidState?P([this.container],"e-error"):E([this.container],"e-error"),R(this.element,{"aria-invalid":this.isValidState?"false":"true"})},e.prototype.bindClearEvent=function(){this.showClearButton&&Ma.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this)},e.prototype.resetHandler=function(t){t.preventDefault(),this.inputWrapper.clearButton.classList.contains("e-clear-icon-hide")||this.clear(t)},e.prototype.clear=function(t){this.setProperties({value:null},!0),this.setElementValue("")},e.prototype.wireEvents=function(){Ma.add(this.element,"focus",this.focusIn,this),Ma.add(this.element,"blur",this.focusOut,this),Ma.add(this.element,"keydown",this.keyDownHandler,this),Ma.add(this.element,"keyup",this.keyUpHandler,this),Ma.add(this.element,"input",this.inputHandler,this),Ma.add(this.element,"keypress",this.keyPressHandler,this),Ma.add(this.element,"change",this.changeHandler,this),Ma.add(this.element,"paste",this.pasteHandler,this),this.enabled&&this.bindClearEvent()},e.prototype.wireSpinBtnEvents=function(){Ma.add(this.spinUp,za.touchStartEvent,this.mouseDownOnSpinner,this),Ma.add(this.spinDown,za.touchStartEvent,this.mouseDownOnSpinner,this),Ma.add(this.spinUp,za.touchEndEvent,this.mouseUpOnSpinner,this),Ma.add(this.spinDown,za.touchEndEvent,this.mouseUpOnSpinner,this),Ma.add(this.spinUp,za.touchMoveEvent,this.touchMoveOnSpinner,this),Ma.add(this.spinDown,za.touchMoveEvent,this.touchMoveOnSpinner,this)},e.prototype.unwireEvents=function(){Ma.remove(this.element,"focus",this.focusIn),Ma.remove(this.element,"blur",this.focusOut),Ma.remove(this.element,"keyup",this.keyUpHandler),Ma.remove(this.element,"input",this.inputHandler),Ma.remove(this.element,"keydown",this.keyDownHandler),Ma.remove(this.element,"keypress",this.keyPressHandler),Ma.remove(this.element,"change",this.changeHandler),Ma.remove(this.element,"paste",this.pasteHandler)},e.prototype.unwireSpinBtnEvents=function(){Ma.remove(this.spinUp,za.touchStartEvent,this.mouseDownOnSpinner),Ma.remove(this.spinDown,za.touchStartEvent,this.mouseDownOnSpinner),Ma.remove(this.spinUp,za.touchEndEvent,this.mouseUpOnSpinner),Ma.remove(this.spinDown,za.touchEndEvent,this.mouseUpOnSpinner),Ma.remove(this.spinUp,za.touchMoveEvent,this.touchMoveOnSpinner),Ma.remove(this.spinDown,za.touchMoveEvent,this.touchMoveOnSpinner)},e.prototype.changeHandler=function(t){this.element.value.length||this.setProperties({value:null},!0);var e=this.instance.getNumberParser({format:"n"})(this.element.value);this.updateValue(e,t)},e.prototype.raiseChangeEvent=function(t){if(this.prevValue!==this.value){var e={};this.changeEventArgs={value:this.value,previousValue:this.prevValue,isInteraction:this.isInteract,event:t},t&&(this.changeEventArgs.event=t),l(e,this.changeEventArgs),this.prevValue=this.value,this.isInteract=!1,this.trigger("change",e)}},e.prototype.pasteHandler=function(){var t=this,e=this.element.value;setTimeout(function(){t.numericRegex().test(t.element.value)||t.setElementValue(e)})},e.prototype.preventHandler=function(){var t=this,e=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);setTimeout(function(){if(t.element.selectionStart>0){var i=t.element.selectionStart,o=t.element.selectionStart-1,r=void 0,s=t.element.value.split("");r=n("decimal",Ct(t.locale)).charCodeAt(0)," "===t.element.value[o]&&t.element.selectionStart>0&&!e?(c(t.prevVal)?t.element.value=t.element.value.trim():0!==o?t.element.value=t.prevVal:0===o&&(t.element.value=t.element.value.trim()),t.element.setSelectionRange(o,o)):isNaN(parseFloat(t.element.value[t.element.selectionStart-1]))&&45!==t.element.value[t.element.selectionStart-1].charCodeAt(0)?(s.indexOf(t.element.value[t.element.selectionStart-1])!==s.lastIndexOf(t.element.value[t.element.selectionStart-1])&&t.element.value[t.element.selectionStart-1].charCodeAt(0)===r||t.element.value[t.element.selectionStart-1].charCodeAt(0)!==r)&&(t.element.value=t.element.value.substring(0,o)+t.element.value.substring(i,t.element.value.length),t.element.setSelectionRange(o,o),isNaN(parseFloat(t.element.value[t.element.selectionStart-1]))&&t.element.selectionStart>0&&t.element.value.length&&t.preventHandler()):isNaN(parseFloat(t.element.value[t.element.selectionStart-2]))&&t.element.selectionStart>1&&45!==t.element.value[t.element.selectionStart-2].charCodeAt(0)&&(s.indexOf(t.element.value[t.element.selectionStart-2])!==s.lastIndexOf(t.element.value[t.element.selectionStart-2])&&t.element.value[t.element.selectionStart-2].charCodeAt(0)===r||t.element.value[t.element.selectionStart-2].charCodeAt(0)!==r)&&(t.element.setSelectionRange(o,o),t.nextEle=t.element.value[t.element.selectionStart],t.cursorPosChanged=!0,t.preventHandler()),!0===t.cursorPosChanged&&t.element.value[t.element.selectionStart]===t.nextEle&&isNaN(parseFloat(t.element.value[t.element.selectionStart-1]))&&(t.element.setSelectionRange(t.element.selectionStart+1,t.element.selectionStart+1),t.cursorPosChanged=!1,t.nextEle=null),""===t.element.value.trim()&&t.element.setSelectionRange(0,0),t.element.selectionStart>0&&45===t.element.value[t.element.selectionStart-1].charCodeAt(0)&&t.element.selectionStart>1&&(c(t.prevVal)?t.element.value=t.element.value:t.element.value=t.prevVal,t.element.setSelectionRange(t.element.selectionStart,t.element.selectionStart)),t.prevVal=t.element.value}})},e.prototype.keyUpHandler=function(t){!(!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform))&&za.isDevice&&this.preventHandler()},e.prototype.inputHandler=function(t){!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)&&za.isDevice&&this.preventHandler()},e.prototype.keyDownHandler=function(t){if(!this.readonly)switch(t.keyCode){case 38:t.preventDefault(),this.action("increment",t);break;case 40:t.preventDefault(),this.action("decrement",t)}},e.prototype.performAction=function(t,e,i){(null===t||isNaN(t))&&(t=0);var n="increment"===i?t+e:t-e;return n=this.correctRounding(t,e,n),this.strictMode?this.trimValue(n):n},e.prototype.correctRounding=function(t,e,i){var n=new RegExp("[,.](.*)"),o=(t.toString(),e.toString(),n.test(t.toString())),r=n.test(e.toString());if(o||r){var s=o?n.exec(t.toString())[0].length:0,a=r?n.exec(e.toString())[0].length:0,l=Math.max(s,a);return t=this.roundValue(i,l)}return i},e.prototype.roundValue=function(t,e){e=e||0;var i=Math.pow(10,e);return t*=i,t=Math.round(t)/i},e.prototype.updateValue=function(t,e){e&&(this.isInteract=!0),null===t||isNaN(t)||this.decimals&&(t=this.roundNumber(t,this.decimals)),this.changeValue(null===t||isNaN(t)?null:this.strictMode?this.trimValue(t):t),this.raiseChangeEvent(e)},e.prototype.updateCurrency=function(t,e){o(t,e,this.cultureInfo),this.updateValue(this.value)},e.prototype.changeValue=function(t){if(t||0===t){var e=void 0,i=t.toString().split(".")[1];e=i&&i.length?i.length:0,null!==this.decimals&&(e=e<this.decimals?e:this.decimals),this.setProperties({value:this.roundNumber(t,e)},!0)}else t=null,this.setProperties({value:t},!0);this.modifyText(),this.strictMode||this.validateState()},e.prototype.modifyText=function(){if(this.value||0===this.value){var t=this.formatNumber(),e=this.isFocused?t:this.instance.getNumberFormat(this.cultureInfo)(this.value);this.setElementValue(e),R(this.element,{"aria-valuenow":t}),this.hiddenInput.value=t}else this.setElementValue(""),this.element.removeAttribute("aria-valuenow"),this.hiddenInput.value=null},e.prototype.setElementValue=function(t,e){Wu.setValue(t,e||this.element,this.floatLabelType,this.showClearButton)},e.prototype.validateState=function(){this.isValidState=!0,(this.value||0===this.value)&&(this.isValidState=!(this.value>this.max||this.value<this.min)),this.checkErrorClass()},e.prototype.formatNumber=function(){var t,e=this.value.toString().split(".")[1];return t=e&&e.length?e.length:0,null!==this.decimals&&(t=t<this.decimals?t:this.decimals),this.instance.getNumberFormat({maximumFractionDigits:t,minimumFractionDigits:t,useGrouping:!1})(this.value)},e.prototype.trimValue=function(t){return t>this.max?this.max:t<this.min?this.min:t},e.prototype.roundNumber=function(t,e){var i=t,n=e||0,o=i.toString().split("e"),r=(i=Math.round(Number(o[0]+"e"+(o[1]?Number(o[1])+n:n)))).toString().split("e");return i=Number(r[0]+"e"+(r[1]?Number(r[1])-n:-n)),Number(i.toFixed(n))},e.prototype.cancelEvent=function(t){return t.preventDefault(),!1},e.prototype.keyPressHandler=function(t){if(0===t.which||t.metaKey||t.ctrlKey||8===t.keyCode||13===t.keyCode)return!0;var e=String.fromCharCode(t.which),i=this.element.value;return i=i.substring(0,this.element.selectionStart)+e+i.substring(this.element.selectionEnd),!!this.numericRegex().test(i)||(t.preventDefault(),t.stopPropagation(),!1)},e.prototype.numericRegex=function(){var t=n("decimal",Ct(this.locale)),e="*";return"."===t&&(t="\\"+t),0===this.decimals?mg:(this.decimals&&this.validateDecimalOnType&&(e="{0,"+this.decimals+"}"),new RegExp("^(-)?(((\\d+("+t+"\\d"+e+")?)|("+t+"\\d"+e+")))?$"))},e.prototype.mouseWheel=function(t){t.preventDefault();var e,i=t;i.wheelDelta?e=i.wheelDelta/120:i.detail&&(e=-i.detail/3),e>0?this.action("increment",t):e<0&&this.action("decrement",t),this.cancelEvent(t)},e.prototype.focusIn=function(t){var e=this;if(this.enabled&&!this.readonly){if(this.isFocused=!0,P([this.container],"e-error"),this.prevValue=this.value,this.value||0===this.value){var i=this.formatNumber();if(this.setElementValue(i),!this.isPrevFocused){var n=za.isDevice&&za.isIos?600:0;setTimeout(function(){e.element.setSelectionRange(0,i.length)},n)}}za.isDevice||Ma.add(this.element,"mousewheel DOMMouseScroll",this.mouseWheel,this)}},e.prototype.focusOut=function(t){var e=this;if(this.isPrevFocused){if(t.preventDefault(),za.isDevice){var i=this.element.value;this.element.focus(),this.isPrevFocused=!1;var n=this.element;setTimeout(function(){e.setElementValue(i,n)},200)}}else{this.isFocused=!1,this.element.value.length||this.setProperties({value:null},!0);var o=this.instance.getNumberParser({format:"n"})(this.element.value);this.updateValue(o),za.isDevice||Ma.remove(this.element,"mousewheel DOMMouseScroll",this.mouseWheel)}},e.prototype.mouseDownOnSpinner=function(t){var e=this;if(this.isFocused&&(this.isPrevFocused=!0,t.preventDefault()),this.getElementData(t)){this.getElementData(t);var i=t.currentTarget,n=i.classList.contains("e-spin-up")?"increment":"decrement";Ma.add(i,"mouseleave",this.mouseUpClick,this),this.timeOut=setInterval(function(){e.isCalled=!0,e.action(n,t)},150),Ma.add(document,"mouseup",this.mouseUpClick,this)}},e.prototype.touchMoveOnSpinner=function(t){document.elementFromPoint(t.clientX,t.clientY).classList.contains(gg)||clearInterval(this.timeOut)},e.prototype.mouseUpOnSpinner=function(t){if(this.isPrevFocused&&(this.element.focus(),za.isDevice||(this.isPrevFocused=!1)),za.isDevice||t.preventDefault(),this.getElementData(t)){var e=t.currentTarget,i=e.classList.contains("e-spin-up")?"increment":"decrement";Ma.remove(e,"mouseleave",this.mouseUpClick),this.isCalled||this.action(i,t),this.isCalled=!1,Ma.remove(document,"mouseup",this.mouseUpClick)}},e.prototype.getElementData=function(t){return!(t.which&&3===t.which||t.button&&2===t.button||!this.enabled||this.readonly)&&(clearInterval(this.timeOut),!0)},e.prototype.floatLabelTypeUpdate=function(){Wu.removeFloating(this.inputWrapper);var t=this.hiddenInput;this.hiddenInput.remove(),Wu.addFloating(this.element,this.floatLabelType,this.placeholder),this.container.insertBefore(t,this.container.childNodes[1])},e.prototype.mouseUpClick=function(t){t.stopPropagation(),clearInterval(this.timeOut),this.isCalled=!1,Ma.remove(this.spinUp,"mouseleave",this.mouseUpClick),Ma.remove(this.spinDown,"mouseleave",this.mouseUpClick)},e.prototype.increment=function(t){void 0===t&&(t=this.step),this.isInteract=!1,this.changeValue(this.performAction(this.value,t,"increment")),this.raiseChangeEvent()},e.prototype.decrement=function(t){void 0===t&&(t=this.step),this.isInteract=!1,this.changeValue(this.performAction(this.value,t,"decrement")),this.raiseChangeEvent()},e.prototype.destroy=function(){this.unwireEvents(),A(this.hiddenInput),this.showSpinButton&&(this.unwireSpinBtnEvents(),A(this.spinUp),A(this.spinDown)),this.container.parentElement.appendChild(this.cloneElement),A(this.container),t.prototype.destroy.call(this)},e.prototype.getText=function(){return this.element.value},e.prototype.getPersistData=function(){var t=["value"];return this.addOnPersist(t)},e.prototype.onPropertyChanged=function(t,e){for(var i=0,r=Object.keys(t);i<r.length;i++){var s=r[i];switch(s){case"width":j(this.container,{width:b(t.width)});break;case"cssClass":Wu.setCssClass(t.cssClass,[this.container],e.cssClass);break;case"enabled":Wu.setEnabled(t.enabled,this.element);break;case"enableRtl":Wu.setEnableRtl(t.enableRtl,[this.container]);break;case"readonly":Wu.setReadonly(t.readonly,this.element),this.readonly?R(this.element,{"aria-readonly":"true"}):this.element.removeAttribute("aria-readonly");break;case"placeholder":Wu.setPlaceholder(t.placeholder,this.element);break;case"step":this.step=t.step,this.validateStep();break;case"showSpinButton":t.showSpinButton?this.spinBtnCreation():(A(this.spinUp),A(this.spinDown));break;case"showClearButton":Wu.setClearButton(t.showClearButton,this.element,this.inputWrapper),this.bindClearEvent();break;case"floatLabelType":this.floatLabelType=t.floatLabelType,this.floatLabelTypeUpdate();break;case"value":this.updateValue(t.value);break;case"min":case"max":o(s,n(s,t),this),this.validateMinMax(),this.updateValue(this.value);break;case"strictMode":this.strictMode=t.strictMode,this.updateValue(this.value),this.validateState();break;case"locale":this.initCultureFunc(),this.l10n.setLocale(this.locale),c(this.spinDown)||R(this.spinDown,{title:this.l10n.getConstant("decrementTitle"),"aria-label":this.l10n.getConstant("decrementTitle")}),c(this.spinUp)||R(this.spinUp,{title:this.l10n.getConstant("incrementTitle"),"aria-label":this.l10n.getConstant("incrementTitle")}),this.updatePlaceholder(),Wu.setPlaceholder(this.placeholder,this.element),this.updateValue(this.value);break;case"currency":var a=n(s,t);this.setProperties({currencyCode:a},!0),this.updateCurrency(s,a);break;case"currencyCode":var l=n(s,t);this.setProperties({currency:l},!0),this.updateCurrency("currency",l);break;case"format":o(s,n(s,t),this),this.initCultureInfo(),this.updateValue(this.value);break;case"decimals":this.decimals=t.decimals,this.updateValue(this.value)}}},e.prototype.getModuleName=function(){return"numerictextbox"},ug([et("")],e.prototype,"cssClass",void 0),ug([et(null)],e.prototype,"value",void 0),ug([et(-Number.MAX_VALUE)],e.prototype,"min",void 0),ug([et(Number.MAX_VALUE)],e.prototype,"max",void 0),ug([et(1)],e.prototype,"step",void 0),ug([et(null)],e.prototype,"width",void 0),ug([et(null)],e.prototype,"placeholder",void 0),ug([et(!0)],e.prototype,"showSpinButton",void 0),ug([et(!1)],e.prototype,"readonly",void 0),ug([et(!0)],e.prototype,"enabled",void 0),ug([et(!1)],e.prototype,"enableRtl",void 0),ug([et(!1)],e.prototype,"showClearButton",void 0),ug([et(!1)],e.prototype,"enablePersistence",void 0),ug([et("n2")],e.prototype,"format",void 0),ug([et(null)],e.prototype,"decimals",void 0),ug([et(null)],e.prototype,"currency",void 0),ug([et(null)],e.prototype,"currencyCode",void 0),ug([et(!0)],e.prototype,"strictMode",void 0),ug([et(!1)],e.prototype,"validateDecimalOnType",void 0),ug([et("Never")],e.prototype,"floatLabelType",void 0),ug([st()],e.prototype,"created",void 0),ug([st()],e.prototype,"destroyed",void 0),ug([st()],e.prototype,"change",void 0),e=ug([at],e)}(wl),vg="e-error",yg="e-input-group",bg="e-float-input",wg="e-utility-mask",xg="e-label-top",Sg="e-label-bottom",Cg={0:"[0-9]",9:"[0-9 ]","#":"[0-9 +-]",L:"[A-Za-z]","?":"[A-Za-z ]","&":"[^ ]+",C:"[^]+",A:"[A-Za-z0-9]",a:"[A-Za-z0-9 ]"},Lg=function(){function t(){}return t}(),Eg=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Pg=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},kg=function(t){function e(e,i){return t.call(this,e,i)||this}return Eg(e,t),e.prototype.getModuleName=function(){return"maskedtextbox"},e.prototype.preRender=function(){this.promptMask="",this.hiddenMask="",this.escapeMaskValue="",this.regExpCollec=Cg,this.customRegExpCollec=[],this.undoCollec=[],this.redoCollec=[],this.changeEventArgs={},this.focusEventArgs={},this.maskKeyPress=!1,this.isFocus=!1,this.isInitial=!1,this.isIosInvalid=!1;var t=n("ej2_instances",this.element);if(this.cloneElement=this.element.cloneNode(!0),this.angularTagName=null,"EJS-MASKEDTEXTBOX"===this.element.tagName){this.angularTagName=this.element.tagName;for(var e=L("input"),i=0;i<this.element.attributes.length;i++)e.setAttribute(this.element.attributes[i].nodeName,this.element.attributes[i].nodeValue),e.innerHTML=this.element.innerHTML;this.element.hasAttribute("id")&&this.element.removeAttribute("id"),this.element.classList.remove("e-control","e-maskedtextbox"),this.element.classList.add("e-mask-container"),this.element.appendChild(e),this.element=e,o("ej2_instances",t,this.element)}},e.prototype.getPersistData=function(){var t=["value"];return this.addOnPersist(t)},e.prototype.render=function(){"input"===this.element.tagName.toLowerCase()&&("Never"===this.floatLabelType&&E([this.element],"e-input"),this.createWrapper(),this.isInitial=!0,this.resetMaskedTextBox(),this.isInitial=!1,this.setMaskPlaceholder(!0,!1),this.setWidth(this.width))},e.prototype.resetMaskedTextBox=function(){this.promptMask="",this.hiddenMask="",this.escapeMaskValue="",this.customRegExpCollec=[],this.undoCollec=[],this.redoCollec=[],this.promptChar.length>1&&(this.promptChar=this.promptChar[0]),Hs.call(this),zs.call(this),(null===this.mask||""===this.mask&&void 0!==this.value)&&ga.call(this,this.value);var t=qs.call(this,this.element);this.prevValue=t,this.value=t,this.isInitial||Vs.call(this),js.call(this)},e.prototype.setMaskPlaceholder=function(t,e){(e||this.placeholder)&&(Wu.setPlaceholder(this.placeholder,this.element),this.element.value===this.promptMask&&t&&"Always"!==this.floatLabelType&&ga.call(this,""),"Never"===this.floatLabelType&&Gs.call(this))},e.prototype.setCssClass=function(t,e){t&&E(e,t)},e.prototype.setWidth=function(t){c(t)||(this.element.style.width=b(t),this.inputObj.container.style.width=b(t))},e.prototype.createWrapper=function(){this.inputObj=Wu.createInput({element:this.element,floatLabelType:this.floatLabelType,properties:{enableRtl:this.enableRtl,cssClass:this.cssClass,enabled:this.enabled,placeholder:this.placeholder,showClearButton:this.showClearButton}}),this.inputObj.container.setAttribute("class","e-widget e-control-wrapper e-mask "+this.inputObj.container.getAttribute("class"))},e.prototype.onPropertyChanged=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++)switch(n[i]){case"value":ua.call(this,this.value),this.placeholder&&this.setMaskPlaceholder(!1,!1);break;case"placeholder":this.setMaskPlaceholder(!0,!0);break;case"width":this.setWidth(t.width);break;case"cssClass":this.setCssClass(t.cssClass,[this.inputObj.container]);break;case"enabled":Wu.setEnabled(t.enabled,this.element);break;case"enableRtl":Wu.setEnableRtl(t.enableRtl,[this.inputObj.container]);break;case"customCharacters":this.customCharacters=t.customCharacters,this.resetMaskedTextBox();break;case"showClearButton":Wu.setClearButton(t.showClearButton,this.element,this.inputObj),Fs.call(this);break;case"floatLabelType":this.floatLabelType=t.floatLabelType,Wu.removeFloating(this.inputObj),Wu.addFloating(this.element,this.floatLabelType,this.placeholder);break;case"mask":var o=this.value;this.mask=t.mask,this.updateValue(o);break;case"promptChar":t.promptChar.length>1&&(t.promptChar=t.promptChar[0]),t.promptChar?this.promptChar=t.promptChar:this.promptChar="_";var r=this.element.value.replace(new RegExp("["+e.promptChar+"]","g"),this.promptChar);this.promptMask===this.element.value&&(r=this.promptMask.replace(new RegExp("["+e.promptChar+"]","g"),this.promptChar)),this.promptMask=this.promptMask.replace(new RegExp("["+e.promptChar+"]","g"),this.promptChar),this.undoCollec=this.redoCollec=[],ga.call(this,r)}},e.prototype.updateValue=function(t){this.resetMaskedTextBox(),ua.call(this,t)},e.prototype.getMaskedValue=function(){return Us.call(this,this.element)},e.prototype.destroy=function(){Vs.call(this),this.inputObj.container.parentElement.appendChild(this.cloneElement),A(this.inputObj.container),t.prototype.destroy.call(this)},Pg([et(null)],e.prototype,"cssClass",void 0),Pg([et(null)],e.prototype,"width",void 0),Pg([et(null)],e.prototype,"placeholder",void 0),Pg([et("Never")],e.prototype,"floatLabelType",void 0),Pg([et(!0)],e.prototype,"enabled",void 0),Pg([et(!1)],e.prototype,"showClearButton",void 0),Pg([et(!1)],e.prototype,"enablePersistence",void 0),Pg([et(!1)],e.prototype,"enableRtl",void 0),Pg([et(null)],e.prototype,"mask",void 0),Pg([et("_")],e.prototype,"promptChar",void 0),Pg([et(null)],e.prototype,"value",void 0),Pg([et(null)],e.prototype,"customCharacters",void 0),Pg([st()],e.prototype,"created",void 0),Pg([st()],e.prototype,"destroyed",void 0),Pg([st()],e.prototype,"change",void 0),Pg([st()],e.prototype,"focus",void 0),e=Pg([at],e)}(wl),Tg=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Og=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Ig=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Tg(e,t),Og([et("None")],e.prototype,"placement",void 0),Og([et(10)],e.prototype,"largeStep",void 0),Og([et(1)],e.prototype,"smallStep",void 0),Og([et(!1)],e.prototype,"showSmallTicks",void 0),Og([et(null)],e.prototype,"format",void 0),e}(qa),Ag=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Tg(e,t),Og([et(!1)],e.prototype,"enabled",void 0),Og([et(null)],e.prototype,"minStart",void 0),Og([et(null)],e.prototype,"minEnd",void 0),Og([et(null)],e.prototype,"maxStart",void 0),Og([et(null)],e.prototype,"maxEnd",void 0),Og([et(!1)],e.prototype,"startHandleFixed",void 0),Og([et(!1)],e.prototype,"endHandleFixed",void 0),e}(qa),Mg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Tg(e,t),Og([et("")],e.prototype,"cssClass",void 0),Og([et("Before")],e.prototype,"placement",void 0),Og([et("Focus")],e.prototype,"showOn",void 0),Og([et(!1)],e.prototype,"isVisible",void 0),Og([et(null)],e.prototype,"format",void 0),e}(qa),Rg={root:"e-slider",rtl:"e-rtl",sliderHiddenInput:"e-slider-input",controlWrapper:"e-control-wrapper",sliderHandle:"e-handle",rangeBar:"e-range",sliderButton:"e-slider-button",firstButton:"e-first-button",secondButton:"e-second-button",scale:"e-scale",tick:"e-tick",large:"e-large",tickValue:"e-tick-value",sliderTooltip:"e-slider-tooltip",sliderHover:"e-slider-hover",sliderFirstHandle:"e-handle-first",sliderSecondHandle:"e-handle-second",sliderDisabled:"e-disabled",sliderContainer:"e-slider-container",horizontalTooltipBefore:"e-slider-horizontal-before",horizontalTooltipAfter:"e-slider-horizontal-after",verticalTooltipBefore:"e-slider-vertical-before",verticalTooltipAfter:"e-slider-vertical-after",materialTooltip:"e-material-tooltip",materialTooltipOpen:"e-material-tooltip-open",materialTooltipActive:"e-tooltip-active",materialSlider:"e-material-slider",sliderTrack:"e-slider-track",sliderHandleFocused:"e-handle-focused",verticalSlider:"e-vertical",horizontalSlider:"e-horizontal",sliderHandleStart:"e-handle-start",sliderTooltipStart:"e-material-tooltip-start",sliderTabHandle:"e-tab-handle",sliderButtonIcon:"e-button-icon",sliderSmallSize:"e-small-size",sliderTickPosition:"e-tick-pos",sliderFirstTick:"e-first-tick",sliderLastTick:"e-last-tick",sliderButtonClass:"e-slider-btn",sliderTooltipWrapper:"e-tooltip-wrap",sliderTabTrack:"e-tab-track",sliderTabRange:"e-tab-range",sliderActiveHandle:"e-handle-active",sliderMaterialHandle:"e-material-handle",sliderMaterialRange:"e-material-range",sliderMaterialDefault:"e-material-default",materialTooltipShow:"e-material-tooltip-show",materialTooltipHide:"e-material-tooltip-hide",readonly:"e-read-only",limits:"e-limits",limitBarDefault:"e-limit-bar",limitBarFirst:"e-limit-first",limitBarSecond:"e-limit-second",dragHorizontal:"e-drag-horizontal",dragVertical:"e-drag-vertical"},Dg=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.horDir="left",n.verDir="bottom",n.transition={handle:"left .4s cubic-bezier(.25, .8, .25, 1), right .4s cubic-bezier(.25, .8, .25, 1), top .4s cubic-bezier(.25, .8, .25, 1) , bottom .4s cubic-bezier(.25, .8, .25, 1)",rangeBar:"all .4s cubic-bezier(.25, .8, .25, 1)"},n.transitionOnMaterialTooltip={handle:"left 1ms ease-out, right 1ms ease-out, bottom 1ms ease-out",rangeBar:"left 1ms ease-out, right 1ms ease-out, bottom 1ms ease-out, width 1ms ease-out, height 1ms ease-out"},n.scaleTransform="transform .4s cubic-bezier(.25, .8, .25, 1)",n.customAriaText=null,n.drag=!0,n}return Tg(e,t),e.prototype.preRender=function(){var t={incrementTitle:"Increase",decrementTitle:"Decrease"};this.l10n=new Dl("slider",t,this.locale),this.isElementFocused=!1,this.tickElementCollection=[],this.tooltipFormatInfo={},this.ticksFormatInfo={},this.initCultureInfo(),this.initCultureFunc()},e.prototype.initCultureFunc=function(){this.internationalization=new ml(this.locale)},e.prototype.initCultureInfo=function(){this.tooltipFormatInfo.format=c(this.tooltip.format)?null:this.tooltip.format,this.ticksFormatInfo.format=c(this.ticks.format)?null:this.ticks.format},e.prototype.formatString=function(t,e){var i=null,n=null;if(t||0===t){i=this.formatNumber(t);var o=this.numberOfDecimals(t);n=this.internationalization.getNumberFormat(e)(this.makeRoundNumber(t,o))}return{elementVal:i,formatString:n}},e.prototype.formatNumber=function(t){var e=this.numberOfDecimals(t);return this.internationalization.getNumberFormat({maximumFractionDigits:e,minimumFractionDigits:e,useGrouping:!1})(t)},e.prototype.numberOfDecimals=function(t){var e=t.toString().split(".")[1];return e&&e.length?e.length:0},e.prototype.makeRoundNumber=function(t,e){var i=e||0;return Number(t.toFixed(i))},e.prototype.fractionalToInteger=function(t){t=0===this.numberOfDecimals(t)?Number(t).toFixed(this.noOfDecimals):t;for(var e=1,i=0;i<this.noOfDecimals;i++)e*=10;return t=Number((t*e).toFixed(0))},e.prototype.render=function(){this.initialize(),this.initRender(),this.wireEvents(),this.setZindex()},e.prototype.initialize=function(){E([this.element],Rg.root),this.setCSSClass()},e.prototype.setCSSClass=function(t){t&&P([this.element],t.split(" ")),this.cssClass&&E([this.element],this.cssClass.split(" "))},e.prototype.setEnabled=function(){var t="Range"!==this.type?[this.firstTooltipElement]:[this.firstTooltipElement,this.secondTooltipElement];this.enabled?(P([this.sliderContainer],[Rg.sliderDisabled]),this.tooltip.isVisible&&"Always"===this.tooltip.showOn&&t.forEach(function(t){t.classList.remove(Rg.sliderDisabled)}),this.wireEvents()):(E([this.sliderContainer],[Rg.sliderDisabled]),this.tooltip.isVisible&&"Always"===this.tooltip.showOn&&t.forEach(function(t){t.classList.add(Rg.sliderDisabled)}),this.unwireEvents())},e.prototype.getTheme=function(t){return window.getComputedStyle(t,":after").getPropertyValue("content").replace(/['"]+/g,"")},e.prototype.initRender=function(){this.sliderContainer=L("div",{className:Rg.sliderContainer+" "+Rg.controlWrapper}),this.element.parentNode.insertBefore(this.sliderContainer,this.element),this.sliderContainer.appendChild(this.element),this.sliderTrack=L("div",{className:Rg.sliderTrack}),this.element.appendChild(this.sliderTrack),this.element.tabIndex=-1,this.isMaterial="material"===this.getTheme(this.sliderContainer),this.isBootstrap="bootstrap"===this.getTheme(this.sliderContainer),this.setHandler(),this.createRangeBar(),this.limits.enabled&&this.createLimitBar(),this.setOrientClass(),this.hiddenInput=L("input",{attrs:{type:"hidden",value:c(this.value)?this.min.toString():this.value.toString(),name:this.element.getAttribute("name")||this.element.getAttribute("id")||"_"+(1e3*Math.random()).toFixed(0)+"slider",class:Rg.sliderHiddenInput}}),this.hiddenInput.tabIndex=-1,this.sliderContainer.appendChild(this.hiddenInput),this.showButtons&&this.setButtons(),this.setEnableRTL(),"Range"===this.type?this.rangeValueUpdate():this.value=c(this.value)?parseFloat(b(this.min.toString())):this.value,this.previousVal="Range"!==this.type?this.checkHandleValue(parseFloat(b(this.value.toString()))):[this.checkHandleValue(parseFloat(b(this.value[0].toString()))),this.checkHandleValue(parseFloat(b(this.value[1].toString())))],this.previousChanged=this.previousVal,c(this.element.hasAttribute("name"))||this.element.removeAttribute("name"),this.setValue(),this.limits.enabled&&this.setLimitBar(),"None"!==this.ticks.placement&&this.renderScale(),this.tooltip.isVisible&&this.renderTooltip(),this.enabled?P([this.sliderContainer],[Rg.sliderDisabled]):E([this.sliderContainer],[Rg.sliderDisabled]),this.readonly?E([this.sliderContainer],[Rg.readonly]):P([this.sliderContainer],[Rg.readonly])},e.prototype.createRangeBar=function(){"Default"!==this.type&&(this.rangeBar=L("div",{attrs:{class:Rg.rangeBar}}),this.element.appendChild(this.rangeBar),this.drag&&"Range"===this.type&&("Horizontal"===this.orientation?this.rangeBar.classList.add(Rg.dragHorizontal):this.rangeBar.classList.add(Rg.dragVertical)))},e.prototype.createLimitBar=function(){var t="Range"!==this.type?Rg.limitBarDefault:Rg.limitBarFirst;t+=" "+Rg.limits,this.limitBarFirst=L("div",{attrs:{class:t}}),this.element.appendChild(this.limitBarFirst),"Range"===this.type&&(this.limitBarSecond=L("div",{attrs:{class:Rg.limitBarSecond+" "+Rg.limits}}),this.element.appendChild(this.limitBarSecond))},e.prototype.setOrientClass=function(){"Vertical"!==this.orientation?(this.sliderContainer.classList.remove(Rg.verticalSlider),this.sliderContainer.classList.add(Rg.horizontalSlider),this.firstHandle.setAttribute("aria-orientation","horizontal"),"Range"===this.type&&this.secondHandle.setAttribute("aria-orientation","horizontal")):(this.sliderContainer.classList.remove(Rg.horizontalSlider),this.sliderContainer.classList.add(Rg.verticalSlider),this.firstHandle.setAttribute("aria-orientation","vertical"),"Range"===this.type&&this.secondHandle.setAttribute("aria-orientation","vertical"))},e.prototype.setAriaAttributes=function(t){var e=this,i=this.min,n=this.max;!c(this.customValues)&&this.customValues.length>0&&(i=this.customValues[0],n=this.customValues[this.customValues.length-1]),"Range"!==this.type?R(t,{"aria-valuemin":i.toString(),"aria-valuemax":n.toString()}):(!c(this.customValues)&&this.customValues.length>0?[[i.toString(),this.customValues[this.value[1]].toString()],[this.customValues[this.value[0]].toString(),n.toString()]]:[[i.toString(),this.value[1].toString()],[this.value[0].toString(),n.toString()]]).forEach(function(t,i){var n=0===i?e.firstHandle:e.secondHandle;n&&R(n,{"aria-valuemin":t[0],"aria-valuemax":t[1]})})},e.prototype.createSecondHandle=function(){this.secondHandle=L("div",{attrs:{class:Rg.sliderHandle,role:"slider","aria-labelledby":this.element.id+"_title",tabIndex:"0"}}),this.secondHandle.classList.add(Rg.sliderSecondHandle),this.element.appendChild(this.secondHandle),this.isMaterial&&this.tooltip.isVisible&&(this.secondMaterialHandle=L("div",{attrs:{class:Rg.sliderHandle+" "+Rg.sliderMaterialHandle}}),this.element.appendChild(this.secondMaterialHandle))},e.prototype.createFirstHandle=function(){this.firstHandle=L("div",{attrs:{class:Rg.sliderHandle,role:"slider","aria-labelledby":this.element.id+"_title",tabIndex:"0"}}),this.firstHandle.classList.add(Rg.sliderFirstHandle),this.element.appendChild(this.firstHandle),this.isMaterial&&this.tooltip.isVisible&&(this.firstMaterialHandle=L("div",{attrs:{class:Rg.sliderHandle+" "+Rg.sliderMaterialHandle}}),this.element.appendChild(this.firstMaterialHandle))},e.prototype.wireFirstHandleEvt=function(t){t?(Ma.remove(this.firstHandle,"mousedown touchstart",this.handleFocus),Ma.remove(this.firstHandle,"transitionend",this.transitionEnd),Ma.remove(this.firstHandle,"mouseenter touchenter",this.handleOver),Ma.remove(this.firstHandle,"mouseleave touchend",this.handleLeave)):(Ma.add(this.firstHandle,"mousedown touchstart",this.handleFocus,this),Ma.add(this.firstHandle,"transitionend",this.transitionEnd,this),Ma.add(this.firstHandle,"mouseenter touchenter",this.handleOver,this),Ma.add(this.firstHandle,"mouseleave touchend",this.handleLeave,this))},e.prototype.wireSecondHandleEvt=function(t){t?(Ma.remove(this.secondHandle,"mousedown touchstart",this.handleFocus),Ma.remove(this.secondHandle,"transitionend",this.transitionEnd),Ma.remove(this.secondHandle,"mouseenter touchenter",this.handleOver),Ma.remove(this.secondHandle,"mouseleave touchend",this.handleLeave)):(Ma.add(this.secondHandle,"mousedown touchstart",this.handleFocus,this),Ma.add(this.secondHandle,"transitionend",this.transitionEnd,this),Ma.add(this.secondHandle,"mouseenter touchenter",this.handleOver,this),Ma.add(this.secondHandle,"mouseleave touchend",this.handleLeave,this))},e.prototype.handleStart=function(){var t=1===this.activeHandle?this.handlePos1:this.handlePos2,e=1===this.activeHandle?this.firstTooltipElement:this.secondTooltipElement;0===t&&"Range"!==this.type&&(this.getHandle().classList.add(Rg.sliderHandleStart),this.isMaterial&&this.tooltip.isVisible&&(this.firstMaterialHandle.classList.add(Rg.sliderHandleStart),e&&e.classList.add(Rg.sliderTooltipStart)))},e.prototype.transitionEnd=function(t){if(this.handleStart(),this.getHandle().style.transition="none","Default"!==this.type&&(this.rangeBar.style.transition="none"),this.tooltip.isVisible){var e=1===this.activeHandle?this.firstTooltipObj:this.secondTooltipObj,i=1===this.activeHandle?this.firstTooltipElement:this.secondTooltipElement;this.isMaterial?i.classList.contains(Rg.materialTooltipOpen)||"transform"===t.propertyName?("Default"===this.type&&(i.style.transition=this.transition.handle),this.refreshTooltip()):this.openMaterialTooltip():(e.animation={open:{effect:"None"},close:{effect:"FadeOut",duration:500}},this.tooltipAnimation())}"Always"!==this.tooltip.showOn&&this.closeTooltip()},e.prototype.handleFocusOut=function(){this.firstHandle.classList.contains(Rg.sliderHandleFocused)&&this.firstHandle.classList.remove(Rg.sliderHandleFocused),"Range"===this.type&&this.secondHandle.classList.contains(Rg.sliderHandleFocused)&&this.secondHandle.classList.remove(Rg.sliderHandleFocused)},e.prototype.handleFocus=function(t){t.currentTarget===this.firstHandle?this.firstHandle.classList.add(Rg.sliderHandleFocused):this.secondHandle.classList.add(Rg.sliderHandleFocused)},e.prototype.handleOver=function(t){this.tooltip.isVisible&&"Hover"===this.tooltip.showOn&&(this.tooltipValue(),(t.currentTarget===this.firstHandle?this.firstTooltipObj:this.secondTooltipObj).animation={open:{effect:"None"},close:{effect:"FadeOut",duration:500}},t.currentTarget===this.firstHandle?this.firstTooltipObj.open(this.firstHandle):this.secondTooltipObj.open(this.secondHandle))},e.prototype.handleLeave=function(t){if(this.tooltip.isVisible&&"Hover"===this.tooltip.showOn&&!t.currentTarget.classList.contains(Rg.sliderHandleFocused)&&!t.currentTarget.classList.contains(Rg.sliderTabHandle)){this.tooltipValue();var e=t.currentTarget===this.firstHandle?this.firstTooltipObj:this.secondTooltipObj;t.currentTarget===this.firstHandle?this.firstTooltipObj.close():this.secondTooltipObj.close(),e.animation={open:{effect:"None"},close:{effect:"FadeOut",duration:500}}}},e.prototype.setHandler=function(){this.min>this.max&&(this.min=this.max),this.createFirstHandle(),"Range"===this.type&&this.createSecondHandle()},e.prototype.setEnableRTL=function(){this.enableRtl&&"Vertical"!==this.orientation?E([this.sliderContainer],Rg.rtl):P([this.sliderContainer],Rg.rtl);var t="Vertical"!==this.orientation?this.horDir:this.verDir;this.enableRtl?(this.horDir="right",this.verDir="bottom"):(this.horDir="left",this.verDir="bottom"),t!==("Vertical"!==this.orientation?this.horDir:this.verDir)&&"Horizontal"===this.orientation&&(j(this.firstHandle,{right:"",left:"auto"}),"Range"===this.type&&j(this.secondHandle,{top:"",left:"auto"}))},e.prototype.tooltipValue=function(){var t,e={value:this.value,text:""};this.setTooltipContent(),e.text=t=this.firstTooltipObj.content,this.trigger("tooltipChange",e),this.addTooltipClass(e.text),t!==e.text&&(this.customAriaText=e.text,this.firstTooltipObj.content=e.text,this.setAriaAttrValue(this.firstHandle),"Range"===this.type&&(this.secondTooltipObj.content=e.text,this.setAriaAttrValue(this.secondHandle)))},e.prototype.setTooltipContent=function(){var t;"Range"===this.type?(t=this.formatContent(this.tooltipFormatInfo,!1),this.firstTooltipObj.content=t,this.secondTooltipObj.content=t):c(this.handleVal1)||(t=this.formatContent(this.tooltipFormatInfo,!1),this.firstTooltipObj.content=t)},e.prototype.formatContent=function(t,e){var i="",n=this.handleVal1,o=this.handleVal2;return!c(this.customValues)&&this.customValues.length>0&&(n=this.customValues[this.handleVal1],o=this.customValues[this.handleVal2]),e?("Range"===this.type?i=this.enableRtl&&"Vertical"!==this.orientation?c(this.tooltip)||c(this.tooltip.format)?o.toString()+" - "+n.toString():this.formatString(o,t).elementVal+" - "+this.formatString(n,t).elementVal:c(this.tooltip)||c(this.tooltip.format)?n.toString()+" - "+o.toString():this.formatString(n,t).elementVal+" - "+this.formatString(o,t).elementVal:c(n)||(i=c(this.tooltip)||c(this.tooltip.format)?n.toString():this.formatString(n,t).elementVal),i):("Range"===this.type?i=this.enableRtl&&"Vertical"!==this.orientation?c(t.format)?o.toString()+" - "+n.toString():this.formatString(o,t).formatString+" - "+this.formatString(n,t).formatString:c(t.format)?n.toString()+" - "+o.toString():this.formatString(n,t).formatString+" - "+this.formatString(o,t).formatString:c(n)||(i=c(t.format)?n.toString():this.formatString(n,t).formatString),i)},e.prototype.addTooltipClass=function(t){var e=this;if(this.isMaterial&&this.tooltip.isVisible){var i=t.toString().length;("Range"!==this.type?[this.firstTooltipElement]:[this.firstTooltipElement,this.secondTooltipElement]).forEach(function(t,n){if(t)i>4?(t.classList.remove(Rg.sliderMaterialDefault),t.classList.contains(Rg.sliderMaterialRange)||(t.classList.add(Rg.sliderMaterialRange),t.style.transform="scale(1)")):(t.classList.remove(Rg.sliderMaterialRange),t.classList.contains(Rg.sliderMaterialDefault)||(t.classList.add(Rg.sliderMaterialDefault),t.style.transform=e.getTooltipTransformProperties(e.previousTooltipClass).rotate));else{var o=i>4?Rg.sliderMaterialRange:Rg.sliderMaterialDefault;n?e.secondTooltipObj.cssClass=Rg.sliderTooltip+" "+o:e.firstTooltipObj.cssClass=Rg.sliderTooltip+" "+o}})}},e.prototype.tooltipPlacement=function(){var t;t="Horizontal"===this.orientation?"Before"===this.tooltip.placement?"TopCenter":"BottomCenter":"Before"===this.tooltip.placement?"LeftCenter":"RightCenter",this.firstTooltipObj.position=t,"Range"===this.type&&(this.secondTooltipObj.position=t),this.isMaterial&&(this.firstTooltipObj.showTipPointer=!0,this.setProperties({tooltip:{showOn:"Always"}},!0),this.firstTooltipObj.height=30,"Range"===this.type&&(this.secondTooltipObj.showTipPointer=!0,this.secondTooltipObj.height=30))},e.prototype.tooltipBeforeOpen=function(t){var e=t.target===this.firstHandle?this.firstTooltipElement=t.element:this.secondTooltipElement=t.element;if(""!==this.tooltip.cssClass&&E([e],this.tooltip.cssClass.split(" ")),t.target.removeAttribute("aria-describedby"),this.isMaterial&&this.tooltip.isVisible){var i=this.getTooltipTransformProperties(this.previousTooltipClass);e.firstChild.classList.add(Rg.materialTooltipHide),this.handleStart(),e.firstElementChild.innerText.length>4?e.style.transform=i.translate+" scale(0.01)":e.style.transform=i.translate+" "+i.rotate+" scale(0.01)"}if(this.isBootstrap)switch(this.bootstrapCollisionArgs.collidedPosition){case"TopCenter":this.firstTooltipObj.setProperties({offsetY:-6},!1),"Range"===this.type&&this.secondTooltipObj.setProperties({offsetY:-6},!1);break;case"BottomCenter":this.firstTooltipObj.setProperties({offsetY:6},!1),"Range"===this.type&&this.secondTooltipObj.setProperties({offsetY:6},!1);break;case"LeftCenter":this.firstTooltipObj.setProperties({offsetX:-6},!1),"Range"===this.type&&this.secondTooltipObj.setProperties({offsetX:-6},!1);break;case"RightCenter":this.firstTooltipObj.setProperties({offsetX:6},!1),"Range"===this.type&&this.secondTooltipObj.setProperties({offsetX:6},!1)}},e.prototype.wireMaterialTooltipEvent=function(t){this.isMaterial&&this.tooltip.isVisible&&(t?(Ma.remove(this.firstTooltipElement,"mousedown touchstart",this.sliderDown),"Range"===this.type&&Ma.remove(this.secondTooltipElement,"mousedown touchstart",this.sliderDown)):(Ma.add(this.firstTooltipElement,"mousedown touchstart",this.sliderDown,this),"Range"===this.type&&Ma.add(this.secondTooltipElement,"mousedown touchstart",this.sliderDown,this)))},e.prototype.tooltipPositionCalculation=function(t){var e;switch(t){case"TopCenter":e=Rg.horizontalTooltipBefore;break;case"BottomCenter":e=Rg.horizontalTooltipAfter;break;case"LeftCenter":e=Rg.verticalTooltipBefore;break;case"RightCenter":e=Rg.verticalTooltipAfter}return e},e.prototype.getTooltipTransformProperties=function(t){if(this.firstTooltipElement){var e=void 0;return e="Horizontal"===this.orientation?this.firstTooltipElement.clientHeight+14-this.firstTooltipElement.clientHeight/2:this.firstTooltipElement.clientWidth+14-this.firstTooltipElement.clientWidth/2,"Horizontal"===this.orientation?t===Rg.horizontalTooltipBefore?{rotate:"rotate(45deg)",translate:"translateY("+e+"px)"}:{rotate:"rotate(225deg)",translate:"translateY("+-e+"px)"}:t===Rg.verticalTooltipBefore?{rotate:"rotate(-45deg)",translate:"translateX("+e+"px)"}:{rotate:"rotate(-225deg)",translate:"translateX("+-e+"px)"}}},e.prototype.openMaterialTooltip=function(){var t=this;this.refreshTooltip();var e=1===this.activeHandle?this.firstTooltipElement:this.secondTooltipElement,i=1===this.activeHandle?this.firstMaterialHandle:this.secondMaterialHandle;e.firstChild.classList.contains(Rg.materialTooltipHide)&&e.firstChild.classList.remove(Rg.materialTooltipHide),e.firstChild.classList.add(Rg.materialTooltipShow),this.getHandle().style.cursor="default",e.style.transition=this.scaleTransform,e.classList.add(Rg.materialTooltipOpen),i.style.transform="scale(0)",e.firstElementChild.innerText.length>4?e.style.transform="scale(1)":e.style.transform=this.getTooltipTransformProperties(this.previousTooltipClass).rotate,"Default"===this.type?setTimeout(function(){e.style.transition=t.transition.handle},2500):setTimeout(function(){e.style.transition="none"},2500)},e.prototype.checkTooltipPosition=function(t){var e=t.target===this.firstHandle?this.firstHandleTooltipPosition:this.secondHandleTooltipPosition;if(this.isMaterial&&(void 0===e||e!==t.collidedPosition)){var i=this.tooltipPositionCalculation(t.collidedPosition);t.element.classList.remove(this.previousTooltipClass),t.element.classList.add(i),this.previousTooltipClass=i,t.element.style.transform&&t.element.classList.contains(Rg.materialTooltipOpen)&&t.element.firstElementChild.innerText.length<4&&(t.element.style.transform=this.getTooltipTransformProperties(this.previousTooltipClass).rotate),t.target===this.firstHandle?this.firstHandleTooltipPosition=t.collidedPosition:this.secondHandleTooltipPosition=t.collidedPosition}this.bootstrapCollisionArgs=t},e.prototype.renderTooltip=function(){"Auto"===this.tooltip.showOn&&this.setProperties({tooltip:{showOn:"Hover"}},!0);var t=!!this.isBootstrap;this.firstTooltipObj=new id({showTipPointer:t,cssClass:Rg.sliderTooltip,animation:{open:{effect:"None"},close:{effect:"None"}},opensOn:"Custom",beforeOpen:this.tooltipBeforeOpen.bind(this),beforeCollision:this.checkTooltipPosition.bind(this),afterClose:this.tooltipAfterClose.bind(this)}),this.firstTooltipObj.appendTo(this.firstHandle),"Range"===this.type&&(this.secondTooltipObj=new id({showTipPointer:t,cssClass:Rg.sliderTooltip,animation:{open:{effect:"None"},close:{effect:"None"}},opensOn:"Custom",beforeOpen:this.tooltipBeforeOpen.bind(this),beforeCollision:this.checkTooltipPosition.bind(this),afterClose:this.tooltipAfterClose.bind(this)}),this.secondTooltipObj.appendTo(this.secondHandle)),this.tooltipPlacement(),this.firstHandle.style.transition="none","Default"!==this.type&&(this.rangeBar.style.transition="none"),"Range"===this.type&&(this.secondHandle.style.transition="none"),this.isMaterial&&(this.sliderContainer.classList.add(Rg.materialSlider),this.tooltipValue(),this.firstTooltipObj.open(this.firstHandle),"Range"===this.type&&this.secondTooltipObj.open(this.secondHandle))},e.prototype.tooltipAfterClose=function(t){t.element===this.firstTooltipElement?this.firstTooltipElement=void 0:this.secondTooltipElement=void 0},e.prototype.setButtons=function(){this.firstBtn=L("div",{className:Rg.sliderButton+" "+Rg.firstButton}),this.firstBtn.appendChild(L("span",{className:Rg.sliderButtonIcon})),this.firstBtn.tabIndex=-1,this.secondBtn=L("div",{className:Rg.sliderButton+" "+Rg.secondButton}),this.secondBtn.appendChild(L("span",{className:Rg.sliderButtonIcon})),this.secondBtn.tabIndex=-1,this.sliderContainer.classList.add(Rg.sliderButtonClass),this.sliderContainer.appendChild(this.firstBtn),this.sliderContainer.appendChild(this.secondBtn),this.sliderContainer.appendChild(this.element),this.buttonTitle()},e.prototype.buttonTitle=function(){var t=this.enableRtl&&"Vertical"!==this.orientation;this.l10n.setLocale(this.locale);var e=this.l10n.getConstant("decrementTitle"),i=this.l10n.getConstant("incrementTitle");R(t?this.secondBtn:this.firstBtn,{"aria-label":e,title:e}),R(t?this.firstBtn:this.secondBtn,{"aria-label":i,title:i})},e.prototype.buttonFocusOut=function(){this.isMaterial&&this.getHandle().classList.remove("e-large-thumb-size")},e.prototype.repeatButton=function(t){t.target.parentElement;!(1===this.activeHandle?this.firstTooltipElement:this.secondTooltipElement)&&this.tooltip.isVisible&&this.openTooltip();var e,i=this.handleValueUpdate(),n=this.enableRtl&&"Vertical"!==this.orientation;t.target.parentElement.classList.contains(Rg.firstButton)||t.target.classList.contains(Rg.firstButton)?e=n?this.add(i,parseFloat(this.step.toString()),!0):this.add(i,parseFloat(this.step.toString()),!1):(t.target.parentElement.classList.contains(Rg.secondButton)||t.target.classList.contains(Rg.secondButton))&&(e=n?this.add(i,parseFloat(this.step.toString()),!1):this.add(i,parseFloat(this.step.toString()),!0)),this.limits.enabled&&(e=this.getLimitCorrectedValues(e)),e>=this.min&&e<=this.max&&(this.changeHandleValue(e),this.refreshTooltipOnMove())},e.prototype.repeatHandlerMouse=function(t){t.preventDefault(),"mousedown"!==t.type&&"touchstart"!==t.type||(this.buttonClick(t),this.repeatInterval=setInterval(this.repeatButton.bind(this),180,t))},e.prototype.materialChange=function(){this.getHandle().classList.contains("e-large-thumb-size")||this.getHandle().classList.add("e-large-thumb-size")},e.prototype.repeatHandlerUp=function(t){this.changeEvent("changed"),this.tooltip.isVisible&&"Always"!==this.tooltip.showOn&&!this.isMaterial&&this.closeTooltip(),clearInterval(this.repeatInterval),this.getHandle().focus()},e.prototype.customTickCounter=function(t){var e=4;return!c(this.customValues)&&this.customValues.length>0&&(t>4&&(e=3),t>7&&(e=2),t>14&&(e=1),t>28&&(e=0)),e},e.prototype.renderScale=function(){var t="Vertical"===this.orientation?"v":"h";this.noOfDecimals=this.numberOfDecimals(this.step),this.ul=L("ul",{className:Rg.scale+" e-"+t+"-scale "+Rg.tick+"-"+this.ticks.placement.toLowerCase(),attrs:{role:"presentation",tabIndex:"-1","aria-hidden":"true"}}),this.ul.style.zIndex="-1",za.isAndroid&&"h"===t&&this.ul.classList.add(Rg.sliderTickPosition);var e=this.ticks.smallStep;this.ticks.showSmallTicks?e<=0&&(e=parseFloat(b(this.step))):e=this.ticks.largeStep>0?this.ticks.largeStep:parseFloat(b(this.max))-parseFloat(b(this.min));var i=this.fractionalToInteger(this.min),n=this.fractionalToInteger(this.max),o=this.fractionalToInteger(e),r=!c(this.customValues)&&this.customValues.length>0&&this.customValues.length-1,s=this.customTickCounter(r),a=!c(this.customValues)&&this.customValues.length>0?r*s+r:Math.abs((n-i)/o);this.element.appendChild(this.ul);var l,h=parseFloat(this.min.toString());"v"===t&&(h=parseFloat(this.max.toString()));var d,p=0,u=100/a;u===1/0&&(u=5);for(var g=0,m=!c(this.customValues)&&this.customValues.length>0?this.customValues.length-1:0,f=0;g<=a;g++){if(l=L("li",{attrs:{class:Rg.tick,role:"presentation",tabIndex:"-1","aria-hidden":"true"}}),!c(this.customValues)&&this.customValues.length>0)(d=g%(s+1)==0)&&("h"===t?(h=this.customValues[f],f++):(h=this.customValues[m],m--),l.setAttribute("title",h.toString()));else if(l.setAttribute("title",h.toString()),0===this.numberOfDecimals(this.max)&&0===this.numberOfDecimals(this.min)&&0===this.numberOfDecimals(this.step))d="h"===t?(h-parseFloat(this.min.toString()))%this.ticks.largeStep==0:Math.abs(h-parseFloat(this.max.toString()))%this.ticks.largeStep==0;else{var v=this.fractionalToInteger(this.ticks.largeStep);d=(this.fractionalToInteger(h)-i)%v==0}d&&l.classList.add(Rg.large),"h"===t?l.style.width=u+"%":l.style.height=u+"%";var y=d?"Both"===this.ticks.placement?2:1:0;if(d)for(var w=0;w<y;w++)this.createTick(l,h);else c(this.customValues)&&this.formatTicksValue(l,h);this.ul.appendChild(l),this.tickElementCollection.push(l);var x=void 0;c(this.customValues)&&(x=this.numberOfDecimals(e)>this.numberOfDecimals(h)?this.numberOfDecimals(e):this.numberOfDecimals(h),h="h"===t?this.makeRoundNumber(h+e,x):this.makeRoundNumber(h-e,x),p=this.makeRoundNumber(p+e,x))}this.tickesAlignment(t,u)},e.prototype.tickesAlignment=function(t,e){this.firstChild=this.ul.firstElementChild,this.lastChild=this.ul.lastElementChild,this.firstChild.classList.add(Rg.sliderFirstTick),this.lastChild.classList.add(Rg.sliderLastTick),this.sliderContainer.classList.add(Rg.scale+"-"+this.ticks.placement.toLowerCase()),"h"===t?(this.firstChild.style.width=e/2+"%",this.lastChild.style.width=e/2+"%"):(this.firstChild.style.height=e/2+"%",this.lastChild.style.height=e/2+"%");var i={ticksWrapper:this.ul,tickElements:this.tickElementCollection};this.trigger("renderedTicks",i),this.scaleAlignment()},e.prototype.createTick=function(t,e){var i=L("span",{className:Rg.tickValue+" "+Rg.tick+"-"+this.ticks.placement.toLowerCase(),attrs:{role:"presentation",tabIndex:"-1","aria-hidden":"true"}});t.appendChild(i),i.innerHTML=c(this.customValues)?this.formatTicksValue(t,e):e},e.prototype.formatTicksValue=function(t,e){var i=this.formatNumber(e),n={value:e,text:c(this.ticks)||c(this.ticks.format)?i:this.formatString(e,this.ticksFormatInfo).formatString,tickElement:t};return this.trigger("renderingTicks",n),t.setAttribute("title",n.text.toString()),n.text.toString()},e.prototype.scaleAlignment=function(){this.tickValuePosition();this.orientation;"Vertical"===this.orientation?this.element.getBoundingClientRect().width<=15?this.sliderContainer.classList.add(Rg.sliderSmallSize):this.sliderContainer.classList.remove(Rg.sliderSmallSize):this.element.getBoundingClientRect().height<=15?this.sliderContainer.classList.add(Rg.sliderSmallSize):this.sliderContainer.classList.remove(Rg.sliderSmallSize)},e.prototype.tickValuePosition=function(){var t,e=this.firstChild.getBoundingClientRect(),i=this.ticks.smallStep,n=Math.abs(parseFloat(b(this.max))-parseFloat(b(this.min)))/i;this.firstChild.children.length>0&&(t=this.firstChild.children[0].getBoundingClientRect());var o,r=[this.sliderContainer.querySelectorAll("."+Rg.tick+"."+Rg.large+" ."+Rg.tickValue)];o="Both"===this.ticks.placement?[].slice.call(r[0],2):[].slice.call(r[0],1);for(var s="Vertical"===this.orientation?2*e.height:2*e.width,a=0;a<this.firstChild.children.length;a++)"Vertical"===this.orientation?this.firstChild.children[a].style.top=-t.height/2+"px":this.enableRtl?this.firstChild.children[a].style.left=(s-this.firstChild.children[a].getBoundingClientRect().width)/2+"px":this.firstChild.children[a].style.left=-t.width/2+"px";for(a=0;a<o.length;a++){var l=o[a].getBoundingClientRect();"Vertical"===this.orientation?j(o[a],{top:(s-l.height)/2+"px"}):j(o[a],{left:(s-l.width)/2+"px"})}this.enableRtl&&this.lastChild.children.length&&0!==n&&(this.lastChild.children[0].style.left=-this.lastChild.getBoundingClientRect().width/2+"px","Both"===this.ticks.placement&&(this.lastChild.children[1].style.left=-this.lastChild.getBoundingClientRect().width/2+"px")),0===n&&("Horizontal"===this.orientation&&(this.enableRtl?(this.firstChild.classList.remove(Rg.sliderLastTick),this.firstChild.style.right=this.firstHandle.style.right,this.firstChild.children[0].style.left=this.firstChild.getBoundingClientRect().width/2+2+"px","Both"===this.ticks.placement&&(this.firstChild.children[1].style.left=this.firstChild.getBoundingClientRect().width/2+2+"px")):(this.firstChild.classList.remove(Rg.sliderLastTick),this.firstChild.style.left=this.firstHandle.style.left)),"Vertical"===this.orientation&&this.firstChild.classList.remove(Rg.sliderLastTick))},e.prototype.setAriaAttrValue=function(t){var e,i=!c(this.ticks)&&!c(this.ticks.format),n=i?this.formatContent(this.tooltipFormatInfo,!1):this.formatContent(this.ticksFormatInfo,!1),o=i?this.formatContent(this.ticksFormatInfo,!0):this.formatContent(this.tooltipFormatInfo,!0);e=2===(n=this.customAriaText?this.customAriaText:n).split(" - ").length?n.split(" - "):[n,n],this.setAriaAttributes(t),"Range"!==this.type?R(t,{"aria-valuenow":o,"aria-valuetext":n}):this.enableRtl?t===this.firstHandle?R(t,{"aria-valuenow":o.split(" - ")[1],"aria-valuetext":e[1]}):R(t,{"aria-valuenow":o.split(" - ")[0],"aria-valuetext":e[0]}):t===this.firstHandle?R(t,{"aria-valuenow":o.split(" - ")[0],"aria-valuetext":e[0]}):R(t,{"aria-valuenow":o.split(" - ")[1],"aria-valuetext":e[1]})},e.prototype.handleValueUpdate=function(){return"Range"===this.type?1===this.activeHandle?this.handleVal1:this.handleVal2:this.handleVal1},e.prototype.getLimitCorrectedValues=function(t){return t="MinRange"===this.type||"Default"===this.type?this.getLimitValueAndPosition(t,this.limits.minStart,this.limits.minEnd)[0]:1===this.activeHandle?this.getLimitValueAndPosition(t,this.limits.minStart,this.limits.minEnd)[0]:this.getLimitValueAndPosition(t,this.limits.maxStart,this.limits.maxEnd)[0]},e.prototype.focusSliderElement=function(){this.isElementFocused||(this.element.focus(),this.isElementFocused=!0)},e.prototype.buttonClick=function(t){this.focusSliderElement();var e,i=this.enableRtl&&"Vertical"!==this.orientation,n=this.handleValueUpdate();40===t.keyCode||37===t.keyCode||t.currentTarget.classList.contains(Rg.firstButton)?e=i?this.add(n,parseFloat(this.step.toString()),!0):this.add(n,parseFloat(this.step.toString()),!1):38===t.keyCode||39===t.keyCode||t.currentTarget.classList.contains(Rg.secondButton)?e=i?this.add(n,parseFloat(this.step.toString()),!1):this.add(n,parseFloat(this.step.toString()),!0):33===t.keyCode||t.currentTarget.classList.contains(Rg.firstButton)?e=i?this.add(n,parseFloat(this.ticks.largeStep.toString()),!1):this.add(n,parseFloat(this.ticks.largeStep.toString()),!0):34===t.keyCode||t.currentTarget.classList.contains(Rg.secondButton)?e=i?this.add(n,parseFloat(this.ticks.largeStep.toString()),!0):this.add(n,parseFloat(this.ticks.largeStep.toString()),!1):36===t.keyCode?e=parseFloat(this.min.toString()):35===t.keyCode&&(e=parseFloat(this.max.toString())),this.limits.enabled&&(e=this.getLimitCorrectedValues(e)),this.changeHandleValue(e),!this.isMaterial||this.tooltip.isVisible||this.getHandle().classList.contains(Rg.sliderTabHandle)||this.materialChange(),this.tooltipAnimation(),this.getHandle().focus(),t.currentTarget.classList.contains(Rg.firstButton)&&Ma.add(this.firstBtn,"mouseup touchend",this.buttonUp,this),t.currentTarget.classList.contains(Rg.secondButton)&&Ma.add(this.secondBtn,"mouseup touchend",this.buttonUp,this)},e.prototype.tooltipAnimation=function(){if(this.tooltip.isVisible){var t=1===this.activeHandle?this.firstTooltipObj:this.secondTooltipObj,e=1===this.activeHandle?this.firstTooltipElement:this.secondTooltipElement;this.isMaterial?e.classList.contains(Rg.materialTooltipOpen)?this.refreshTooltip():this.openMaterialTooltip():(t.animation={open:{effect:"None"},close:{effect:"FadeOut",duration:500}},this.openTooltip())}},e.prototype.buttonUp=function(t){this.tooltip.isVisible&&(this.isMaterial||((1===this.activeHandle?this.firstTooltipObj:this.secondTooltipObj).animation={open:{effect:"None"},close:{effect:"None"}})),t.currentTarget.classList.contains(Rg.firstButton)&&Ma.remove(this.firstBtn,"mouseup touchend",this.buttonUp),t.currentTarget.classList.contains(Rg.secondButton)&&Ma.remove(this.secondBtn,"mouseup touchend",this.buttonUp)},e.prototype.setRangeBar=function(){"Horizontal"===this.orientation?"MinRange"===this.type?(this.enableRtl?this.rangeBar.style.right="0px":this.rangeBar.style.left="0px",j(this.rangeBar,{width:c(this.handlePos1)?0:this.handlePos1+"px"})):(this.enableRtl?this.rangeBar.style.right=this.handlePos1+"px":this.rangeBar.style.left=this.handlePos1+"px",j(this.rangeBar,{width:this.handlePos2-this.handlePos1+"px"})):"MinRange"===this.type?(this.rangeBar.style.bottom="0px",j(this.rangeBar,{height:c(this.handlePos1)?0:this.handlePos1+"px"})):(this.rangeBar.style.bottom=this.handlePos1+"px",j(this.rangeBar,{height:this.handlePos2-this.handlePos1+"px"}))},e.prototype.checkValidValueAndPos=function(t){return t=this.checkHandleValue(t),t=this.checkHandlePosition(t)},e.prototype.setLimitBarPositions=function(t,e,i,n){"Horizontal"===this.orientation?this.enableRtl?(this.limitBarFirst.style.right=t+"px",this.limitBarFirst.style.width=e-t+"px"):(this.limitBarFirst.style.left=t+"px",this.limitBarFirst.style.width=e-t+"px"):(this.limitBarFirst.style.bottom=t+"px",this.limitBarFirst.style.height=e-t+"px"),"Range"===this.type&&("Horizontal"===this.orientation?this.enableRtl?(this.limitBarSecond.style.right=i+"px",this.limitBarSecond.style.width=n-i+"px"):(this.limitBarSecond.style.left=i+"px",this.limitBarSecond.style.width=n-i+"px"):(this.limitBarSecond.style.bottom=i+"px",this.limitBarSecond.style.height=n-i+"px"))},e.prototype.setLimitBar=function(){if("Default"===this.type||"MinRange"===this.type){var t=this.getLimitValueAndPosition(this.limits.minStart,this.limits.minStart,this.limits.minEnd,!0)[0];t=this.checkValidValueAndPos(t);var e=this.getLimitValueAndPosition(this.limits.minEnd,this.limits.minStart,this.limits.minEnd,!0)[0];e=this.checkValidValueAndPos(e),this.setLimitBarPositions(t,e)}else if("Range"===this.type){var i=this.getLimitValueAndPosition(this.limits.minStart,this.limits.minStart,this.limits.minEnd,!0)[0];i=this.checkValidValueAndPos(i);var n=this.getLimitValueAndPosition(this.limits.minEnd,this.limits.minStart,this.limits.minEnd,!0)[0];n=this.checkValidValueAndPos(n);var o=this.getLimitValueAndPosition(this.limits.maxStart,this.limits.maxStart,this.limits.maxEnd,!0)[0];o=this.checkValidValueAndPos(o);var r=this.getLimitValueAndPosition(this.limits.maxEnd,this.limits.maxStart,this.limits.maxEnd,!0)[0];r=this.checkValidValueAndPos(r),this.setLimitBarPositions(i,n,o,r)}},e.prototype.getLimitValueAndPosition=function(t,e,i,n){return c(e)&&(e=this.min,c(t)&&n&&(t=e)),c(i)&&(i=this.max,c(t)&&n&&(t=i)),t<e&&(t=e),t>i&&(t=i),[t,this.checkHandlePosition(t)]},e.prototype.setValue=function(){if(!c(this.customValues)&&this.customValues.length>0&&(this.min=0,this.max=this.customValues.length-1),this.setAriaAttributes(this.firstHandle),this.handleVal1=c(this.value)?this.checkHandleValue(parseFloat(this.min.toString())):this.checkHandleValue(parseFloat(this.value.toString())),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.preHandlePos1=this.handlePos1,c(this.activeHandle)?"Range"===this.type?this.activeHandle=2:this.activeHandle=1:this.activeHandle=this.activeHandle,"Default"===this.type||"MinRange"===this.type){if(this.limits.enabled){var t=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=t[0],this.handlePos1=t[1],this.preHandlePos1=this.handlePos1}this.setHandlePosition(),this.handleStart(),this.value=this.handleVal1,this.setAriaAttrValue(this.firstHandle),this.changeEvent("changed")}else this.validateRangeValue();"Default"!==this.type&&this.setRangeBar(),this.limits.enabled&&this.setLimitBar()},e.prototype.rangeValueUpdate=function(){null!==this.value&&"object"==typeof this.value||(this.value=[parseFloat(b(this.min)),parseFloat(b(this.max))])},e.prototype.validateRangeValue=function(){this.rangeValueUpdate(),this.setRangeValue()},e.prototype.modifyZindex=function(){"Range"===this.type?1===this.activeHandle?(this.firstHandle.style.zIndex=this.zIndex+4+"",this.secondHandle.style.zIndex=this.zIndex+3+"",this.isMaterial&&this.tooltip.isVisible&&this.firstTooltipElement&&this.secondTooltipElement&&(this.firstTooltipElement.style.zIndex=this.zIndex+4+"",this.secondTooltipElement.style.zIndex=this.zIndex+3+"")):(this.firstHandle.style.zIndex=this.zIndex+3+"",this.secondHandle.style.zIndex=this.zIndex+4+"",this.isMaterial&&this.tooltip.isVisible&&this.firstTooltipElement&&this.secondTooltipElement&&(this.firstTooltipElement.style.zIndex=this.zIndex+3+"",this.secondTooltipElement.style.zIndex=this.zIndex+4+"")):this.isMaterial&&this.tooltip.isVisible&&this.firstTooltipElement&&(this.firstTooltipElement.style.zIndex=this.zIndex+4+"")},e.prototype.setHandlePosition=function(){var t,e,i=this,n=1===this.activeHandle?this.handlePos1:this.handlePos2;1===this.activeHandle?this.handleVal1:this.handleVal2;this.isMaterial&&this.tooltip.isVisible?(e=1===this.activeHandle?this.firstTooltipElement:this.secondTooltipElement,t=[this.getHandle(),1===this.activeHandle?this.firstMaterialHandle:this.secondMaterialHandle]):t=[this.getHandle()],this.tooltip.isVisible&&0===n&&"Range"!==this.type?(t[0].classList.add(Rg.sliderHandleStart),this.isMaterial&&(t[1].classList.add(Rg.sliderHandleStart),e&&e.classList.add(Rg.sliderTooltipStart))):(t[0].classList.remove(Rg.sliderHandleStart),this.tooltip.isVisible&&this.isMaterial&&(t[1].classList.remove(Rg.sliderHandleStart),e&&e.classList.remove(Rg.sliderTooltipStart))),t.forEach(function(t){"Horizontal"===i.orientation?i.enableRtl?t.style.right=n+"px":t.style.left=n+"px":t.style.bottom=n+"px"}),this.changeEvent("change")},e.prototype.getHandle=function(){return 1===this.activeHandle?this.firstHandle:this.secondHandle},e.prototype.setRangeValue=function(){this.activeHandle;this.updateRangeValue(),this.activeHandle=1,this.setHandlePosition(),this.activeHandle=2,this.setHandlePosition(),this.activeHandle=1},e.prototype.changeEvent=function(t){var e="change"===t?this.previousVal:this.previousChanged;if("Range"!==this.type)this.setProperties({value:this.handleVal1},!0),e!==this.value&&(this.trigger(t,this.changeEventArgs(t)),this.setPreviousVal(t,this.value)),this.setAriaAttrValue(this.firstHandle);else{var i=this.value=[this.handleVal1,this.handleVal2];this.setProperties({value:i},!0),(e.length===this.value.length&&this.value[0]!==e[0]||this.value[1]!==e[1])&&(this.trigger(t,this.changeEventArgs(t)),this.setPreviousVal(t,this.value)),this.setAriaAttrValue(this.getHandle())}this.hiddenInput.value=this.value.toString()},e.prototype.changeEventArgs=function(t){var e;return this.tooltip.isVisible&&this.firstTooltipObj?(this.tooltipValue(),e={value:this.value,previousValue:"change"===t?this.previousVal:this.previousChanged,action:t,text:this.firstTooltipObj.content}):e={value:this.value,previousValue:"change"===t?this.previousVal:this.previousChanged,action:t,text:c(this.ticksFormatInfo.format)?this.value.toString():"Range"!==this.type?this.formatString(this.value,this.ticksFormatInfo).formatString:this.formatString(this.value[0],this.ticksFormatInfo).formatString+" - "+this.formatString(this.value[1],this.ticksFormatInfo).formatString},e},e.prototype.setPreviousVal=function(t,e){"change"===t?this.previousVal=e:this.previousChanged=e},e.prototype.updateRangeValue=function(){var t=this.value.toString().split(",").map(Number);if(this.enableRtl&&"Vertical"!==this.orientation||this.rtl?this.value=[t[1],t[0]]:this.value=[t[0],t[1]],this.enableRtl&&"Vertical"!==this.orientation?(this.handleVal1=this.checkHandleValue(this.value[1]),this.handleVal2=this.checkHandleValue(this.value[0])):(this.handleVal1=this.checkHandleValue(this.value[0]),this.handleVal2=this.checkHandleValue(this.value[1])),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handlePos2=this.checkHandlePosition(this.handleVal2),this.handlePos1>this.handlePos2&&(this.handlePos1=this.handlePos2,this.handleVal1=this.handleVal2),this.preHandlePos1=this.handlePos1,this.preHandlePos2=this.handlePos2,this.limits.enabled){this.activeHandle=1;var e=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=e[0],this.handlePos1=e[1],this.preHandlePos1=this.handlePos1,this.activeHandle=2,e=this.getLimitValueAndPosition(this.handleVal2,this.limits.maxStart,this.limits.maxEnd),this.handleVal2=e[0],this.handlePos2=e[1],this.preHandlePos2=this.handlePos2}},e.prototype.checkHandlePosition=function(t){var e;return t=100*(t-parseFloat(b(this.min)))/(parseFloat(b(this.max))-parseFloat(b(this.min))),e="Horizontal"===this.orientation?this.element.getBoundingClientRect().width*(t/100):this.element.getBoundingClientRect().height*(t/100),parseFloat(b(this.max))===parseFloat(b(this.min))&&(e="Horizontal"===this.orientation?this.element.getBoundingClientRect().width:this.element.getBoundingClientRect().height),e},e.prototype.checkHandleValue=function(t){if(this.min>this.max&&(this.min=this.max),this.min===this.max)return parseFloat(b(this.max));var e=this.tempStartEnd();return t<e.start?t=e.start:t>e.end&&(t=e.end),t},e.prototype.onResize=function(){var t=this;this.firstHandle.style.transition="none","Default"!==this.type&&(this.rangeBar.style.transition="none"),"Range"===this.type&&(this.secondHandle.style.transition="none"),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handleVal2&&(this.handlePos2=this.checkHandlePosition(this.handleVal2)),"Horizontal"===this.orientation?(this.enableRtl?this.firstHandle.style.right=this.handlePos1+"px":this.firstHandle.style.left=this.handlePos1+"px",this.isMaterial&&this.tooltip.isVisible&&this.firstMaterialHandle&&(this.enableRtl?this.firstMaterialHandle.style.right=this.handlePos1+"px":this.firstMaterialHandle.style.left=this.handlePos1+"px"),"MinRange"===this.type?(this.enableRtl?this.rangeBar.style.right="0px":this.rangeBar.style.left="0px",j(this.rangeBar,{width:c(this.handlePos1)?0:this.handlePos1+"px"})):"Range"===this.type&&(this.enableRtl?this.secondHandle.style.right=this.handlePos2+"px":this.secondHandle.style.left=this.handlePos2+"px",this.isMaterial&&this.tooltip.isVisible&&this.secondMaterialHandle&&(this.enableRtl?this.secondMaterialHandle.style.right=this.handlePos2+"px":this.secondMaterialHandle.style.left=this.handlePos2+"px"),this.enableRtl?this.rangeBar.style.right=this.handlePos1+"px":this.rangeBar.style.left=this.handlePos1+"px",j(this.rangeBar,{width:this.handlePos2-this.handlePos1+"px"}))):(this.firstHandle.style.bottom=this.handlePos1+"px",this.isMaterial&&this.tooltip.isVisible&&this.firstMaterialHandle&&(this.firstMaterialHandle.style.bottom=this.handlePos1+"px"),"MinRange"===this.type?(this.rangeBar.style.bottom="0px",j(this.rangeBar,{height:c(this.handlePos1)?0:this.handlePos1+"px"})):"Range"===this.type&&(this.secondHandle.style.bottom=this.handlePos2+"px",this.isMaterial&&this.tooltip.isVisible&&this.secondMaterialHandle&&(this.secondMaterialHandle.style.bottom=this.handlePos2+"px"),this.rangeBar.style.bottom=this.handlePos1+"px",j(this.rangeBar,{height:this.handlePos2-this.handlePos1+"px"}))),this.limits.enabled&&this.setLimitBar(),"None"!==this.ticks.placement&&this.ul&&(this.removeElement(this.ul),this.renderScale()),this.tooltip.isVisible||setTimeout(function(){t.firstHandle.style.transition=t.scaleTransform,"Range"===t.type&&(t.secondHandle.style.transition=t.scaleTransform)}),this.refreshTooltip()},e.prototype.changeHandleValue=function(t){var e=null;1===this.activeHandle?(this.limits.enabled&&this.limits.startHandleFixed||(this.handleVal1=this.checkHandleValue(t),this.handlePos1=this.checkHandlePosition(this.handleVal1),"Range"===this.type&&this.handlePos1>this.handlePos2&&(this.handlePos1=this.handlePos2,this.handleVal1=this.handleVal2),this.handlePos1!==this.preHandlePos1&&(e=this.preHandlePos1=this.handlePos1)),this.modifyZindex()):(this.limits.enabled&&this.limits.endHandleFixed||(this.handleVal2=this.checkHandleValue(t),this.handlePos2=this.checkHandlePosition(this.handleVal2),"Range"===this.type&&this.handlePos2<this.handlePos1&&(this.handlePos2=this.handlePos1,this.handleVal2=this.handleVal1),this.handlePos2!==this.preHandlePos2&&(e=this.preHandlePos2=this.handlePos2)),this.modifyZindex()),null!==e&&("Default"!==this.type&&this.setRangeBar(),this.setHandlePosition())},e.prototype.tempStartEnd=function(){return this.min>this.max?{start:this.max,end:this.min}:{start:this.min,end:this.max}},e.prototype.xyToPosition=function(t){if(this.min===this.max)return 100;if("Horizontal"===this.orientation){var e=t.x-this.element.getBoundingClientRect().left,i=this.element.offsetWidth/100;this.val=e/i}else{var n=t.y-this.element.getBoundingClientRect().top,i=this.element.offsetHeight/100;this.val=100-n/i}var o=this.stepValueCalculation(this.val);return o<0?o=0:o>100&&(o=100),this.enableRtl&&"Vertical"!==this.orientation&&(o=100-o),"Horizontal"===this.orientation?this.element.getBoundingClientRect().width*(o/100):this.element.getBoundingClientRect().height*(o/100)},e.prototype.stepValueCalculation=function(t){0===this.step&&(this.step=1);var e=parseFloat(b(this.step))/((parseFloat(b(this.max))-parseFloat(b(this.min)))/100),i=t%Math.abs(e);return 0!==i&&(e/2>i?t-=i:t+=Math.abs(e)-i),t},e.prototype.add=function(t,e,i){var n=Math.pow(10,3);return i?(Math.round(t*n)+Math.round(e*n))/n:(Math.round(t*n)-Math.round(e*n))/n},e.prototype.round=function(t){var e=this.step.toString().split(".");return e[1]?parseFloat(t.toFixed(e[1].length)):Math.round(t)},e.prototype.positionToValue=function(t){var e,i=parseFloat(b(this.max))-parseFloat(b(this.min));return e="Horizontal"===this.orientation?t/this.element.getBoundingClientRect().width*i:t/this.element.getBoundingClientRect().height*i,this.add(e,parseFloat(this.min.toString()),!0)},e.prototype.sliderBarClick=function(t){t.preventDefault();var e;"mousedown"===t.type||"click"===t.type?e={x:t.clientX,y:t.clientY}:"touchstart"===t.type&&(e={x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY});var i=this.xyToPosition(e),n=this.positionToValue(i);if("Range"===this.type&&this.handlePos2-i<i-this.handlePos1)this.activeHandle=2,this.limits.enabled&&this.limits.endHandleFixed||(this.limits.enabled&&(n=(o=this.getLimitValueAndPosition(n,this.limits.maxStart,this.limits.maxEnd))[0],i=o[1]),this.secondHandle.classList.add(Rg.sliderActiveHandle),this.handlePos2=this.preHandlePos2=i,this.handleVal2=n),this.modifyZindex(),this.secondHandle.focus();else{if(this.activeHandle=1,!this.limits.enabled||!this.limits.startHandleFixed){if(this.limits.enabled){var o=this.getLimitValueAndPosition(n,this.limits.minStart,this.limits.minEnd);n=o[0],i=o[1]}this.firstHandle.classList.add(Rg.sliderActiveHandle),this.handlePos1=this.preHandlePos1=i,this.handleVal1=n}this.modifyZindex(),this.firstHandle.focus()}this.isMaterial&&this.tooltip.isVisible&&(1===this.activeHandle?this.firstTooltipElement:this.secondTooltipElement).classList.add(Rg.materialTooltipActive);var r=this.element.querySelector("."+Rg.sliderTabHandle);r&&this.getHandle()!==r&&r.classList.remove(Rg.sliderTabHandle);var s=1===this.activeHandle?this.firstHandle:this.secondHandle;if(t.target===s)return!this.isMaterial||this.tooltip.isVisible||this.getHandle().classList.contains(Rg.sliderTabHandle)||this.materialChange(),void this.tooltipAnimation();if(this.checkRepeatedValue(n)){var a=this.isMaterial&&this.tooltip.isVisible?this.transitionOnMaterialTooltip:this.transition;this.getHandle().style.transition=a.handle,"Default"!==this.type&&(this.rangeBar.style.transition=a.rangeBar),this.setHandlePosition(),"Default"!==this.type&&this.setRangeBar()}},e.prototype.refreshTooltipOnMove=function(){this.tooltip.isVisible&&(this.tooltipValue(),1===this.activeHandle?this.firstTooltipObj.refresh(this.firstHandle):this.secondTooltipObj.refresh(this.secondHandle))},e.prototype.sliderDown=function(t){if(t.preventDefault(),this.focusSliderElement(),"Range"===this.type&&this.drag&&t.target===this.rangeBar){var e=void 0,i=void 0;"mousedown"===t.type?(e=(n=[t.clientX,t.clientY])[0],i=n[1]):"touchstart"===t.type&&(e=(o=[t.changedTouches[0].clientX,t.changedTouches[0].clientY])[0],i=o[1]),"Horizontal"===this.orientation?(this.firstPartRemain=e-this.rangeBar.getBoundingClientRect().left,this.secondPartRemain=this.rangeBar.getBoundingClientRect().right-e):(this.firstPartRemain=i-this.rangeBar.getBoundingClientRect().top,this.secondPartRemain=this.rangeBar.getBoundingClientRect().bottom-i),this.minDiff=this.handleVal2-this.handleVal1,this.getHandle().focus(),Ma.add(document,"mousemove touchmove",this.dragRangeBarMove,this),Ma.add(document,"mouseup touchend",this.dragRangeBarUp,this)}else this.sliderBarClick(t),Ma.add(document,"mousemove touchmove",this.sliderBarMove,this),Ma.add(document,"mouseup touchend",this.sliderBarUp,this);var n,o},e.prototype.handleValueAdjust=function(t,e,i){1===i?(this.handleVal1=e,this.handleVal2=this.handleVal1+this.minDiff):2===i&&(this.handleVal2=e,this.handleVal1=this.handleVal2-this.minDiff),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handlePos2=this.checkHandlePosition(this.handleVal2)},e.prototype.dragRangeBarMove=function(t){"touchmove"!==t.type&&t.preventDefault();var e;this.rangeBar.style.transition="none",this.firstHandle.style.transition="none",this.secondHandle.style.transition="none";var i,n;if("mousemove"===t.type?(i=(r=[t.clientX,t.clientY])[0],n=r[1]):(i=(s=[t.changedTouches[0].clientX,t.changedTouches[0].clientY])[0],n=s[1]),!(this.limits.enabled&&this.limits.startHandleFixed||this.limits.enabled&&this.limits.endHandleFixed)){if(e=this.enableRtl?{x:i+this.secondPartRemain,y:n+this.secondPartRemain}:{x:i-this.firstPartRemain,y:n+this.secondPartRemain},this.handlePos1=this.xyToPosition(e),this.handleVal1=this.positionToValue(this.handlePos1),e=this.enableRtl?{x:i-this.firstPartRemain,y:n-this.firstPartRemain}:{x:i+this.secondPartRemain,y:n-this.firstPartRemain},this.handlePos2=this.xyToPosition(e),this.handleVal2=this.positionToValue(this.handlePos2),this.limits.enabled){var o=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=o[0],this.handlePos1=o[1],this.handleVal1===this.limits.minEnd&&this.handleValueAdjust(this.handleVal1,this.limits.minEnd,1),this.handleVal1===this.limits.minStart&&this.handleValueAdjust(this.handleVal1,this.limits.minStart,1),o=this.getLimitValueAndPosition(this.handleVal2,this.limits.maxStart,this.limits.maxEnd),this.handleVal2=o[0],this.handlePos2=o[1],this.handleVal2===this.limits.maxStart&&this.handleValueAdjust(this.handleVal2,this.limits.maxStart,2),this.handleVal2===this.limits.maxEnd&&this.handleValueAdjust(this.handleVal2,this.limits.maxEnd,2)}this.handleVal2===this.max&&this.handleValueAdjust(this.handleVal2,this.max,2),this.handleVal1===this.min&&this.handleValueAdjust(this.handleVal1,this.min,1)}this.activeHandle=1,this.setHandlePosition(),this.tooltip.isVisible&&(this.isMaterial?this.firstTooltipElement.classList.contains(Rg.materialTooltipOpen)?this.refreshTooltipOnMove():this.openMaterialTooltip():this.firstTooltipElement?this.refreshTooltipOnMove():this.openTooltip()),this.activeHandle=2,this.setHandlePosition(),this.tooltip.isVisible&&(this.isMaterial?this.secondTooltipElement.classList.contains(Rg.materialTooltipOpen)?this.refreshTooltipOnMove():this.openMaterialTooltip():this.secondTooltipElement?this.refreshTooltipOnMove():this.openTooltip()),this.setRangeBar();var r,s},e.prototype.sliderBarUp=function(){this.changeEvent("changed"),this.handleFocusOut(),this.firstHandle.classList.remove(Rg.sliderActiveHandle),"Range"===this.type&&this.secondHandle.classList.remove(Rg.sliderActiveHandle),this.tooltip.isVisible&&("Always"!==this.tooltip.showOn&&this.closeTooltip(),this.isMaterial||((1===this.activeHandle?this.firstTooltipObj:this.secondTooltipObj).animation={open:{effect:"None"},close:{effect:"None"}})),this.isMaterial&&(this.getHandle().classList.remove("e-large-thumb-size"),this.tooltip.isVisible&&(1===this.activeHandle?this.firstTooltipElement:this.secondTooltipElement).classList.remove(Rg.materialTooltipActive)),Ma.remove(document,"mousemove touchmove",this.sliderBarMove),Ma.remove(document,"mouseup touchend",this.sliderBarUp)},e.prototype.sliderBarMove=function(t){"touchmove"!==t.type&&t.preventDefault();var e;e="mousemove"===t.type?{x:t.clientX,y:t.clientY}:{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY};var i=this.xyToPosition(e),n=this.positionToValue(i);if(i=Math.round(i),"Range"!==this.type&&1===this.activeHandle){if(!this.limits.enabled||!this.limits.startHandleFixed){if(this.limits.enabled){var o=this.getLimitValueAndPosition(n,this.limits.minStart,this.limits.minEnd);i=o[1],n=o[0]}this.handlePos1=i,this.handleVal1=n}this.firstHandle.classList.add(Rg.sliderActiveHandle)}if("Range"===this.type)if(1===this.activeHandle)this.firstHandle.classList.add(Rg.sliderActiveHandle),this.limits.enabled&&this.limits.startHandleFixed||(i>this.handlePos2&&(i=this.handlePos2,n=this.handleVal2),i!==this.preHandlePos1&&(this.limits.enabled&&(n=(r=this.getLimitValueAndPosition(n,this.limits.minStart,this.limits.minEnd))[0],i=r[1]),this.handlePos1=this.preHandlePos1=i,this.handleVal1=n,this.activeHandle=1));else if(2===this.activeHandle&&(this.secondHandle.classList.add(Rg.sliderActiveHandle),!(this.limits.enabled&&this.limits.endHandleFixed||(i<this.handlePos1&&(i=this.handlePos1,n=this.handleVal1),i===this.preHandlePos2)))){if(this.limits.enabled){var r=this.getLimitValueAndPosition(n,this.limits.maxStart,this.limits.maxEnd);n=r[0],i=r[1]}this.handlePos2=this.preHandlePos2=i,this.handleVal2=n,this.activeHandle=2}if(this.checkRepeatedValue(n)){this.getHandle().style.transition=this.scaleTransform,"Default"!==this.type&&(this.rangeBar.style.transition="none"),this.setHandlePosition(),!this.isMaterial||this.tooltip.isVisible||this.getHandle().classList.contains(Rg.sliderTabHandle)||this.materialChange();var s=1===this.activeHandle?this.firstTooltipElement:this.secondTooltipElement;this.tooltip.isVisible&&(this.isMaterial?s.classList.contains(Rg.materialTooltipOpen)?this.refreshTooltipOnMove():this.openMaterialTooltip():s?this.refreshTooltipOnMove():this.openTooltip()),"Default"!==this.type&&this.setRangeBar()}},e.prototype.dragRangeBarUp=function(t){this.changeEvent("changed"),this.tooltip.isVisible&&("Always"===this.tooltip.showOn||this.isMaterial||(this.activeHandle=1,this.firstTooltipObj.animation={open:{effect:"None"},close:{effect:"FadeOut",duration:500}},this.closeTooltip(),this.activeHandle=2,this.secondTooltipObj.animation={open:{effect:"None"},close:{effect:"FadeOut",duration:500}},this.closeTooltip())),Ma.remove(document,"mousemove touchmove",this.dragRangeBarMove),Ma.remove(document,"mouseup touchend",this.dragRangeBarUp)},e.prototype.checkRepeatedValue=function(t){if("Range"===this.type){if(t===(this.enableRtl&&"Vertical"!==this.orientation?1===this.activeHandle?this.previousVal[1]:this.previousVal[0]:1===this.activeHandle?this.previousVal[0]:this.previousVal[1]))return 0}else if(t===this.previousVal)return 0;return 1},e.prototype.refreshTooltip=function(){this.tooltip.isVisible&&this.firstTooltipObj&&(this.tooltipValue(),this.firstTooltipObj.refresh(this.firstHandle),"Range"===this.type&&this.secondTooltipObj.refresh(this.secondHandle))},e.prototype.openTooltip=function(){this.tooltip.isVisible&&this.firstTooltipObj&&(this.tooltipValue(),this.isMaterial?this.openMaterialTooltip():1===this.activeHandle?this.firstTooltipObj.open(this.firstHandle):this.secondTooltipObj.open(this.secondHandle))},e.prototype.keyDown=function(t){switch(t.keyCode){case 37:case 38:case 39:case 40:case 33:case 34:case 36:case 35:t.preventDefault(),this.buttonClick(t),this.tooltip.isVisible&&"Always"!==this.tooltip.showOn&&!this.isMaterial&&this.closeTooltip()}},e.prototype.wireButtonEvt=function(t){t?(Ma.remove(this.firstBtn,"mouseleave touchleave",this.buttonFocusOut),Ma.remove(this.secondBtn,"mouseleave touchleave",this.buttonFocusOut),Ma.remove(this.firstBtn,"mousedown touchstart",this.repeatHandlerMouse),Ma.remove(this.firstBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp),Ma.remove(this.secondBtn,"mousedown touchstart",this.repeatHandlerMouse),Ma.remove(this.secondBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp),Ma.remove(this.firstBtn,"focusout",this.sliderFocusOut),Ma.remove(this.secondBtn,"focusout",this.sliderFocusOut)):(Ma.add(this.firstBtn,"mouseleave touchleave",this.buttonFocusOut,this),Ma.add(this.secondBtn,"mouseleave touchleave",this.buttonFocusOut,this),Ma.add(this.firstBtn,"mousedown touchstart",this.repeatHandlerMouse,this),Ma.add(this.firstBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp,this),Ma.add(this.secondBtn,"mousedown touchstart",this.repeatHandlerMouse,this),Ma.add(this.secondBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp,this),Ma.add(this.firstBtn,"focusout",this.sliderFocusOut,this),Ma.add(this.secondBtn,"focusout",this.sliderFocusOut,this))},e.prototype.wireEvents=function(){this.onresize=this.onResize.bind(this),window.addEventListener("resize",this.onresize),this.enabled&&!this.readonly&&(Ma.add(this.element,"mousedown touchstart",this.sliderDown,this),Ma.add(this.sliderContainer,"keydown",this.keyDown,this),Ma.add(this.sliderContainer,"keyup",this.keyUp,this),Ma.add(this.element,"focusout",this.sliderFocusOut,this),Ma.add(this.sliderContainer,"mouseover mouseout touchstart touchend",this.hover,this),this.wireFirstHandleEvt(!1),"Range"===this.type&&this.wireSecondHandleEvt(!1),this.showButtons&&this.wireButtonEvt(!1),this.wireMaterialTooltipEvent(!1))},e.prototype.unwireEvents=function(){Ma.remove(this.element,"mousedown touchstart",this.sliderDown),Ma.remove(this.sliderContainer,"keydown",this.keyDown),Ma.remove(this.sliderContainer,"keyup",this.keyUp),Ma.remove(this.element,"focusout",this.sliderFocusOut),Ma.remove(this.sliderContainer,"mouseover mouseout touchstart touchend",this.hover),this.wireFirstHandleEvt(!0),"Range"===this.type&&this.wireSecondHandleEvt(!0),this.showButtons&&this.wireButtonEvt(!0),this.wireMaterialTooltipEvent(!0)},e.prototype.keyUp=function(t){if(9===t.keyCode&&t.target.classList.contains(Rg.sliderHandle)&&(this.focusSliderElement(),!t.target.classList.contains(Rg.sliderTabHandle))){this.element.querySelector("."+Rg.sliderTabHandle)&&this.element.querySelector("."+Rg.sliderTabHandle).classList.remove(Rg.sliderTabHandle),t.target.classList.add(Rg.sliderTabHandle);var e=t.target.parentElement;e===this.element&&(e.querySelector("."+Rg.sliderTrack).classList.add(Rg.sliderTabTrack),"Range"!==this.type&&"MinRange"!==this.type||e.querySelector("."+Rg.rangeBar).classList.add(Rg.sliderTabRange)),"Range"===this.type&&(t.target.previousSibling.classList.contains(Rg.sliderHandle)?this.activeHandle=2:this.activeHandle=1),this.getHandle().focus(),this.tooltipAnimation(),this.tooltip.isVisible&&"Always"!==this.tooltip.showOn&&!this.isMaterial&&this.closeTooltip()}this.changeEvent("changed")},e.prototype.hover=function(t){c(t)||("mouseover"===t.type||"touchmove"===t.type||"mousemove"===t.type||"pointermove"===t.type||"touchstart"===t.type?this.sliderContainer.classList.add(Rg.sliderHover):this.sliderContainer.classList.remove(Rg.sliderHover))},e.prototype.sliderFocusOut=function(t){var e=this;if(t.relatedTarget!==this.secondHandle&&t.relatedTarget!==this.firstHandle&&t.relatedTarget!==this.element&&t.relatedTarget!==this.firstBtn&&t.relatedTarget!==this.secondBtn){if(this.isMaterial&&this.tooltip.isVisible){var i=this.getTooltipTransformProperties(this.previousTooltipClass),n="Range"!==this.type?[this.firstTooltipElement]:[this.firstTooltipElement,this.secondTooltipElement],o="Range"!==this.type?[this.firstHandle]:[this.firstHandle,this.secondHandle],r="Range"!==this.type?[this.firstMaterialHandle]:[this.firstMaterialHandle,this.secondMaterialHandle];n.forEach(function(t,n){t&&(t.style.transition=e.scaleTransform,t.firstChild.classList.remove(Rg.materialTooltipShow),t.firstChild.classList.add(Rg.materialTooltipHide),o[n].style.cursor="-webkit-grab",o[n].style.cursor="grab",r[n].style.transform="scale(1)",t.classList.remove(Rg.materialTooltipOpen),t.firstElementChild.innerText.length>4?t.style.transform=i.translate+" scale(0.01)":t.style.transform=i.translate+" "+i.rotate+" scale(0.01)",setTimeout(function(){t.style.transition="none"},2500))})}this.element.querySelector("."+Rg.sliderTabHandle)&&this.element.querySelector("."+Rg.sliderTabHandle).classList.remove(Rg.sliderTabHandle),this.element.querySelector("."+Rg.sliderTabTrack)&&(this.element.querySelector("."+Rg.sliderTabTrack).classList.remove(Rg.sliderTabTrack),"Range"!==this.type&&"MinRange"!==this.type||!this.element.querySelector("."+Rg.sliderTabRange)||this.element.querySelector("."+Rg.sliderTabRange).classList.remove(Rg.sliderTabRange)),this.hiddenInput.focus(),this.hiddenInput.blur(),this.isElementFocused=!1}},e.prototype.closeTooltip=function(){this.tooltip.isVisible&&(this.tooltipValue(),1===this.activeHandle?this.firstTooltipObj.close():this.secondTooltipObj.close())},e.prototype.removeElement=function(t){t.parentNode&&t.parentNode.removeChild(t)},e.prototype.changeSliderType=function(t){this.isMaterial&&this.firstMaterialHandle&&(this.sliderContainer.classList.remove(Rg.materialSlider),this.removeElement(this.firstMaterialHandle),this.firstTooltipElement=void 0,this.firstHandleTooltipPosition=void 0,this.secondMaterialHandle&&(this.removeElement(this.secondMaterialHandle),this.secondTooltipElement=void 0,this.secondHandleTooltipPosition=void 0)),this.tooltip.isVisible&&this.isMaterial&&this.sliderContainer.classList.add(Rg.materialSlider),this.removeElement(this.firstHandle),"Default"!==t&&("Range"===t&&this.removeElement(this.secondHandle),this.removeElement(this.rangeBar)),this.tooltip.isVisible&&!c(this.firstTooltipObj)&&(this.firstTooltipObj.destroy(),"Range"!==t||c(this.secondTooltipObj)||this.secondTooltipObj.destroy()),(this.limits.enabled&&"MinRange"===t||"Default"===t)&&(c(this.limitBarFirst)||this.removeElement(this.limitBarFirst)),"Range"===t&&this.limits.enabled&&(c(this.limitBarFirst)||c(this.limitBarSecond)||(this.removeElement(this.limitBarFirst),this.removeElement(this.limitBarSecond))),this.createRangeBar(),this.limits.enabled&&this.createLimitBar(),this.setHandler(),this.setOrientClass(),this.wireFirstHandleEvt(!1),"Range"===this.type&&this.wireSecondHandleEvt(!1),this.setValue(),this.tooltip.isVisible&&(this.renderTooltip(),this.wireMaterialTooltipEvent(!1)),this.updateConfig()},e.prototype.changeRtl=function(){if(this.enableRtl||"Range"!==this.type||(this.value=[this.handleVal2,this.handleVal1]),this.updateConfig(),this.tooltip.isVisible&&(this.firstTooltipObj.refresh(this.firstHandle),"Range"===this.type&&this.secondTooltipObj.refresh(this.secondHandle)),this.showButtons){var t=this.enableRtl&&"Vertical"!==this.orientation;R(t?this.secondBtn:this.firstBtn,{"aria-label":"Decrease",title:"Decrease"}),R(t?this.firstBtn:this.secondBtn,{"aria-label":"Increase",title:"Increase"})}},e.prototype.changeOrientation=function(){this.changeSliderType(this.type)},e.prototype.updateConfig=function(){this.setEnableRTL(),this.setValue(),this.tooltip.isVisible&&this.refreshTooltip(),"None"!==this.ticks.placement&&this.ul&&(this.removeElement(this.ul),this.renderScale()),this.limitsPropertyChange()},e.prototype.limitsPropertyChange=function(){this.limits.enabled?(c(this.limitBarFirst)&&"Range"!==this.type&&this.createLimitBar(),c(this.limitBarFirst)&&c(this.limitBarSecond)&&"Range"===this.type&&this.createLimitBar(),this.setLimitBar(),this.setValue()):(c(this.limitBarFirst)||A(this.limitBarFirst),c(this.limitBarSecond)||A(this.limitBarSecond))},e.prototype.getPersistData=function(){var t=["value"];return this.addOnPersist(t)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.unwireEvents(),window.removeEventListener("resize",this.onresize),P([this.sliderContainer],[Rg.sliderDisabled]),this.firstHandle.removeAttribute("aria-orientation"),"Range"===this.type&&this.secondHandle.removeAttribute("aria-orientation"),this.sliderContainer.parentNode.insertBefore(this.element,this.sliderContainer),A(this.sliderContainer),this.tooltip.isVisible&&(this.firstTooltipObj.destroy(),"Range"!==this.type||c(this.secondTooltipObj)||this.secondTooltipObj.destroy()),this.element.innerHTML=""},e.prototype.onPropertyChanged=function(t,e){for(var i=this,n=0,o=Object.keys(t);n<o.length;n++)switch(o[n]){case"cssClass":this.setCSSClass(e.cssClass);break;case"value":c(e.value)||c(t.value)||e.value.toString()!==t.value.toString()&&(this.setValue(),this.refreshTooltip(),"Range"===this.type&&(e.value[0]===t.value[0]?this.activeHandle=2:this.activeHandle=1));break;case"min":case"step":case"max":this.setMinMaxValue();break;case"tooltip":c(t.tooltip)||c(e.tooltip)||this.setTooltip();break;case"type":this.changeSliderType(e.type),this.setZindex();break;case"enableRtl":e.enableRtl!==t.enableRtl&&"Vertical"!==this.orientation&&(this.rtl=e.enableRtl,this.changeRtl());break;case"limits":this.limitsPropertyChange();break;case"orientation":this.changeOrientation();break;case"ticks":c(this.sliderContainer.querySelector("."+Rg.scale))||(A(this.ul),Array.prototype.forEach.call(this.sliderContainer.classList,function(t){t.match(/e-scale-/)&&i.sliderContainer.classList.remove(t)})),"None"!==this.ticks.placement&&(this.renderScale(),this.setZindex());break;case"locale":this.showButtons&&this.buttonTitle();break;case"showButtons":t.showButtons?(this.setButtons(),this.onResize(),this.enabled&&!this.readonly&&this.wireButtonEvt(!1)):this.firstBtn&&this.secondBtn&&(this.sliderContainer.removeChild(this.firstBtn),this.sliderContainer.removeChild(this.secondBtn),this.firstBtn=void 0,this.secondBtn=void 0);break;case"enabled":this.setEnabled();break;case"readonly":this.setReadOnly();break;case"customValue":this.setValue(),this.onResize()}},e.prototype.setReadOnly=function(){this.readonly?(this.unwireEvents(),this.sliderContainer.classList.add(Rg.readonly)):(this.wireEvents(),this.sliderContainer.classList.remove(Rg.readonly))},e.prototype.setMinMaxValue=function(){var t=this;this.setValue(),this.refreshTooltip(),c(this.sliderContainer.querySelector("."+Rg.scale))||this.ul&&(A(this.ul),Array.prototype.forEach.call(this.sliderContainer.classList,function(e){e.match(/e-scale-/)&&t.sliderContainer.classList.remove(e)})),"None"!==this.ticks.placement&&(this.renderScale(),this.setZindex())},e.prototype.setZindex=function(){this.zIndex=6,c(this.ticks)||"None"===this.ticks.placement||(this.ul.style.zIndex=this.zIndex+-7+"",this.element.style.zIndex=this.zIndex+2+""),this.isMaterial||c(this.ticks)||"Both"!==this.ticks.placement||(this.element.style.zIndex=this.zIndex+2+""),this.firstHandle.style.zIndex=this.zIndex+3+"","Range"===this.type&&(this.secondHandle.style.zIndex=this.zIndex+4+"")},e.prototype.setTooltip=function(){this.changeSliderType(this.type)},e.prototype.getModuleName=function(){return"slider"},Og([et(null)],e.prototype,"value",void 0),Og([et(null)],e.prototype,"customValues",void 0),Og([et(1)],e.prototype,"step",void 0),Og([et(0)],e.prototype,"min",void 0),Og([et(100)],e.prototype,"max",void 0),Og([et(!1)],e.prototype,"readonly",void 0),Og([et("Default")],e.prototype,"type",void 0),Og([it({},Ig)],e.prototype,"ticks",void 0),Og([it({},Ag)],e.prototype,"limits",void 0),Og([et(!0)],e.prototype,"enabled",void 0),Og([et(!1)],e.prototype,"enableRtl",void 0),Og([it({},Mg)],e.prototype,"tooltip",void 0),Og([et(!1)],e.prototype,"showButtons",void 0),Og([et(!0)],e.prototype,"enableAnimation",void 0),Og([et("Horizontal")],e.prototype,"orientation",void 0),Og([et("")],e.prototype,"cssClass",void 0),Og([st()],e.prototype,"created",void 0),Og([st()],e.prototype,"change",void 0),Og([st()],e.prototype,"changed",void 0),Og([st()],e.prototype,"renderingTicks",void 0),Og([st()],e.prototype,"renderedTicks",void 0),Og([st()],e.prototype,"tooltipChange",void 0),e=Og([at],e)}(wl),Bg=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ng=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Hg=new RegExp("^[A-Za-z0-9._%+-]{3,}@[a-zA-Z]{3,}([.]{1}[a-zA-Z]{2,5}|[.]{1}[a-zA-Z]{2,4}[.]{1}[a-zA-Z]{2,4})$"),zg=new RegExp("^((ftp|http|https)://)?www.([A-z]{2,}).([A-z]{2,})$"),jg=new RegExp("^([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$"),Vg=new RegExp("^[0-9]*$"),Fg=new RegExp("^[+]?[0-9]{9,13}$"),_g=new RegExp("^\\d{13,16}$");!function(t){t[t.Message=0]="Message",t[t.Label=1]="Label"}(dg||(dg={}));var Wg=function(t){function e(e,i){var n=t.call(this,i,e)||this;if(n.validated=[],n.errorRules=[],n.allowSubmit=!1,n.required="required",n.infoElement=null,n.inputElement=null,n.selectQuery="input:not([type=reset]):not([type=button]), select, textarea",n.defaultMessages={required:"This field is required.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateIso:"Please enter a valid date ( ISO ).",creditcard:"Please enter valid card number",number:"Please enter a valid number.",digits:"Please enter only digits.",maxLength:"Please enter no more than {0} characters.",minLength:"Please enter at least {0} characters.",rangeLength:"Please enter a value between {0} and {1} characters long.",range:"Please enter a value between {0} and {1}.",max:"Please enter a value less than or equal to {0}.",min:"Please enter a value greater than or equal to {0}.",regex:"Please enter a correct value.",tel:"Please enter a valid phone number.",pattern:"Please enter a correct pattern value.",equalTo:"Please enter the valid match text"},void 0===n.rules&&(n.rules={}),e="string"==typeof e?D(e,document):e,null!=n.element)return n.element.setAttribute("novalidate",""),n.inputElements=B(n.selectQuery,n.element),n.createHTML5Rules(),n.wireEvents(),n}return Bg(e,t),i=e,e.prototype.addRules=function(t,e){t&&(this.rules.hasOwnProperty(t)?h(this.rules[t],e,{}):this.rules[t]=e)},e.prototype.removeRules=function(t,e){if(t||e)if(this.rules[t]&&!e)delete this.rules[t];else{if(c(this.rules[t]&&e))return;for(var i=0;i<e.length;i++)delete this.rules[t][e[i]]}else this.rules={}},e.prototype.validate=function(t){var e=Object.keys(this.rules);if(t&&e.length)return this.validateRules(t),-1!==e.indexOf(t)&&0===this.errorRules.filter(function(e){return e.name===t}).length;for(var i=0,n=e;i<n.length;i++){var o=n[i];this.validateRules(o)}return 0===this.errorRules.length},e.prototype.reset=function(){this.element.reset(),this.clearForm()},e.prototype.getInputElement=function(t){return this.inputElement=D("[name="+t+"]",this.element),this.inputElement},e.prototype.destroy=function(){this.reset(),this.unwireEvents(),this.rules={};for(var e=0,i=B("."+this.errorClass+", ."+this.validClass,this.element);e<i.length;e++)i[e].remove();t.prototype.destroy.call(this)},e.prototype.onPropertyChanged=function(t,e){},e.prototype.getModuleName=function(){return"formValidator"},e.prototype.clearForm=function(){this.errorRules=[],this.validated=[];for(var t=0,e=B(this.selectQuery,this.element);t<e.length;t++){var i=e[t];i.removeAttribute("aria-invalid"),i.classList.remove(this.errorClass),i.name.length>0&&(this.getInputElement(i.name),this.getErrorElement(i.name),this.hideMessage(i.name)),i.classList.remove(this.validClass)}},e.prototype.createHTML5Rules=function(){for(var t=["required","validateHidden","regex","rangeLength","maxLength","minLength","dateIso","digits","pattern","data-val-required","type","data-validation","min","max","range","equalTo","data-val-minlength-min","data-val-equalto-other","data-val-maxlength-max","data-val-range-min","data-val-regex-pattern","data-val-length-max","data-val-creditcard","data-val-phone"],e=["hidden","email","url","date","number","tel"],i=0,n=this.inputElements;i<n.length;i++){for(var o=n[i],r={},s=0,a=t;s<a.length;s++){var l=a[s];if(null!==o.getAttribute(l))switch(l){case"required":this.defRule(o,r,l,o.required);break;case"data-validation":l=o.getAttribute(l),this.defRule(o,r,l,!0);break;case"type":-1!==e.indexOf(o.type)&&this.defRule(o,r,o.type,!0);break;case"rangeLength":case"range":this.defRule(o,r,l,JSON.parse(o.getAttribute(l)));break;case"equalTo":var h=o.getAttribute(l);this.defRule(o,r,l,h);break;default:"true"===o.getAttribute("data-val")?this.annotationRule(o,r,l,o.getAttribute(l)):this.defRule(o,r,l,o.getAttribute(l))}}0!==Object.keys(r).length&&this.addRules(o.name,r)}},e.prototype.annotationRule=function(t,e,i,n){var o=i.split("-"),r=["required","creditcard","phone","maxlength","minlength","range","regex","equalto"],s=o[o.length-1],a=o[o.length-2];if(-1!==r.indexOf(s))switch(s){case"required":this.defRule(t,e,"required",n);break;case"creditcard":this.defRule(t,e,"creditcard",n);break;case"phone":this.defRule(t,e,"tel",n)}else if(-1!==r.indexOf(a))switch(a){case"maxlength":this.defRule(t,e,"maxLength",n);break;case"minlength":this.defRule(t,e,"minLength",n);break;case"range":var l=t.getAttribute("data-val-range-min"),h=t.getAttribute("data-val-range-max");this.defRule(t,e,"range",[l,h]);break;case"equalto":var c=t.getAttribute(i).split(".");this.defRule(t,e,"equalTo",c[c.length-1]);break;case"regex":this.defRule(t,e,"regex",n)}},e.prototype.defRule=function(t,e,i,n){var o=t.getAttribute("data-"+i+"-message"),r=t.getAttribute("data-val-"+i);o?n=[n,o]:r&&(n=[n,r]),e[i]=n},e.prototype.wireEvents=function(){for(var t=0,e=this.inputElements;t<e.length;t++){var n=e[t];i.isCheckable(n)?Ma.add(n,"click",this.clickHandler,this):"SELECT"===n.tagName?Ma.add(n,"change",this.changeHandler,this):(Ma.add(n,"focusout",this.focusOutHandler,this),Ma.add(n,"keyup",this.keyUpHandler,this))}Ma.add(this.element,"submit",this.submitHandler,this),Ma.add(this.element,"reset",this.resetHandler,this)},e.prototype.unwireEvents=function(){for(var t=0,e=this.inputElements;t<e.length;t++){var i=e[t];Ma.clearEvents(i)}Ma.remove(this.element,"submit",this.submitHandler),Ma.remove(this.element,"reset",this.resetHandler)},e.prototype.focusOutHandler=function(t){this.trigger("focusout",t);var e=t.target;this.rules[e.name]&&(this.rules[e.name][this.required]||e.value.length>0?this.validate(e.name):-1===this.validated.indexOf(e.name)&&this.validated.push(e.name))},e.prototype.keyUpHandler=function(t){this.trigger("keyup",t);var e=t.target,i=[16,17,18,20,35,36,37,38,39,40,45,144,225];(9!==t.which||this.rules[e.name]&&(!this.rules[e.name]||this.rules[e.name][this.required]))&&-1!==this.validated.indexOf(e.name)&&this.rules[e.name]&&-1===i.indexOf(t.which)&&this.validate(e.name)},e.prototype.clickHandler=function(t){this.trigger("click",t);var e=t.target;"submit"!==e.type?this.validate(e.name):null!==e.getAttribute("formnovalidate")&&(this.allowSubmit=!0)},e.prototype.changeHandler=function(t){this.trigger("change",t);var e=t.target;this.validate(e.name)},e.prototype.submitHandler=function(t){this.trigger("submit",t),this.allowSubmit||this.validate()?this.allowSubmit=!1:t.preventDefault()},e.prototype.resetHandler=function(){this.clearForm()},e.prototype.validateRules=function(t){if(this.rules[t]){var e=Object.keys(this.rules[t]),i=!1,n=!1,o=e.indexOf("validateHidden"),r=e.indexOf("hidden");if(this.getInputElement(t),-1!==r&&(i=!0),-1!==o&&(n=!0),!i||i&&n){-1!==o&&e.splice(o,1),-1!==r&&e.splice(r-1,1),this.getErrorElement(t);for(var s=0,a=e;s<a.length;s++){var l=a[s],h=this.getErrorMessage(this.rules[t][l],l),c={name:t,message:h},d={inputName:t,element:this.inputElement,message:h};if(!this.isValid(t,l)&&!this.inputElement.classList.contains(this.ignore)){this.removeErrorRules(t),this.errorRules.push(c),this.inputElement.setAttribute("aria-invalid","true"),this.inputElement.setAttribute("aria-describedby",this.inputElement.id+"-info"),this.inputElement.classList.add(this.errorClass),this.inputElement.classList.remove(this.validClass),this.infoElement?this.showMessage(c):this.createErrorElement(t,c.message,this.inputElement),d.errorElement=this.infoElement,d.status="failure",this.trigger("validationComplete",d),"required"===l&&this.inputElement.setAttribute("aria-required","true");break}this.hideMessage(t),d.status="success",this.trigger("validationComplete",d)}}}},e.prototype.isValid=function(t,e){var n=this.rules[t][e],o=n instanceof Array&&"string"==typeof n[1]?n[0]:n,r=this.rules[t][e],s={value:this.inputElement.value,param:o,element:this.inputElement,formElement:this.element};return this.trigger("validationBegin",s),r&&"function"==typeof r[0]?r[0].call(this,{element:this.inputElement,value:this.inputElement.value}):i.isCheckable(this.inputElement)?"required"!==e||B("input[name="+t+"]:checked",this.element).length>0:i.checkValidator[e](s)},e.prototype.getErrorMessage=function(t,e){var i=t instanceof Array&&"string"==typeof t[1]?t[1]:this.defaultMessages[e],n=i.match(/{(\d)}/g);if(!c(n))for(var o=0;o<n.length;o++){var r=t instanceof Array?t[o]:t;i=i.replace(n[o],r)}return i},e.prototype.createErrorElement=function(t,e,i){var n=L(this.errorElement,{className:this.errorClass,innerHTML:e,attrs:{for:t}});if(this.errorOption===dg.Message&&(n.classList.remove(this.errorClass),n.classList.add("e-message"),n=L(this.errorContainer,{className:this.errorClass,innerHTML:n.outerHTML})),n.id=this.inputElement.name+"-info",this.element.querySelector('[data-valmsg-for="'+i.id+'"]'))this.element.querySelector('[data-valmsg-for="'+i.id+'"]').appendChild(n);else if(!0===i.hasAttribute("data-msg-containerid")){var o=i.getAttribute("data-msg-containerid");this.element.querySelector("#"+o).appendChild(n)}else null!=this.customPlacement?this.customPlacement.call(this,this.inputElement,n):this.inputElement.parentNode.insertBefore(n,this.inputElement.nextSibling);n.style.display="block",this.getErrorElement(t),this.validated.push(t),this.checkRequired(t)},e.prototype.getErrorElement=function(t){return this.infoElement=D(this.errorElement+"."+this.errorClass,this.inputElement.parentElement),this.infoElement||(this.infoElement=D(this.errorElement+"."+this.errorClass+'[for="'+t+'"]')),this.infoElement},e.prototype.removeErrorRules=function(t){for(var e=0;e<this.errorRules.length;e++)this.errorRules[e].name===t&&this.errorRules.splice(e,1)},e.prototype.showMessage=function(t){this.infoElement.style.display="block",this.infoElement.innerHTML=t.message,this.checkRequired(t.name)},e.prototype.hideMessage=function(t){this.infoElement&&(this.infoElement.style.display="none",this.removeErrorRules(t),this.inputElement.classList.add(this.validClass),this.inputElement.classList.remove(this.errorClass),this.inputElement.setAttribute("aria-invalid","false"))},e.prototype.checkRequired=function(t){this.rules[t][this.required]||this.inputElement.value.length||(this.infoElement.innerHTML=this.inputElement.value,this.infoElement.setAttribute("aria-invalid","false"),this.hideMessage(t))},e.isCheckable=function(t){var e=t.getAttribute("type");return e&&("checkbox"===e||"radio"===e||"submit"===e)},e.checkValidator={required:function(t){return t.value.length>0},email:function(t){return Hg.test(t.value)},url:function(t){return zg.test(t.value)},dateIso:function(t){return jg.test(t.value)},tel:function(t){return Fg.test(t.value)},creditcard:function(t){return _g.test(t.value)},number:function(t){return!isNaN(Number(t.value))&&-1===t.value.indexOf(" ")},digits:function(t){return Vg.test(t.value)},maxLength:function(t){return t.value.length<=t.param},minLength:function(t){return t.value.length>=t.param},rangeLength:function(t){var e=t.param;return t.value.length>=e[0]&&t.value.length<=e[1]},range:function(t){var e=t.param;return!isNaN(Number(t.value))&&Number(t.value)>=e[0]&&Number(t.value)<=e[1]},date:function(t){return!isNaN(new Date(t.value).getTime())},max:function(t){return isNaN(Number(t.value))?new Date(t.value).getTime()<=new Date(JSON.parse(JSON.stringify(t.param))).getTime():+t.value<=t.param},min:function(t){return isNaN(Number(t.value))?new Date(t.value).getTime()>=new Date(JSON.parse(JSON.stringify(t.param))).getTime():+t.value>=t.param},regex:function(t){return new RegExp(t.param).test(t.value)},equalTo:function(t){var e=t.formElement.querySelector("#"+t.param);return t.param=e.value,t.param===t.value}},Ng([et("e-hidden")],e.prototype,"ignore",void 0),Ng([et()],e.prototype,"rules",void 0),Ng([et("e-error")],e.prototype,"errorClass",void 0),Ng([et("e-valid")],e.prototype,"validClass",void 0),Ng([et("label")],e.prototype,"errorElement",void 0),Ng([et("div")],e.prototype,"errorContainer",void 0),Ng([et(dg.Label)],e.prototype,"errorOption",void 0),Ng([st()],e.prototype,"focusout",void 0),Ng([st()],e.prototype,"keyup",void 0),Ng([st()],e.prototype,"click",void 0),Ng([st()],e.prototype,"change",void 0),Ng([st()],e.prototype,"submit",void 0),Ng([st()],e.prototype,"validationBegin",void 0),Ng([st()],e.prototype,"validationComplete",void 0),Ng([st()],e.prototype,"customPlacement",void 0),e=i=Ng([at],e);var i}(Ba),Ug=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),qg=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Xg="e-upload-file-list",Yg="e-file-status",Gg="e-file-remove-btn",Zg="e-file-delete-btn",Kg="e-file-abort-btn",Qg="e-file-reload-btn",Jg="e-upload-progress-wrap",$g="e-upload-progress-bar",tm="e-upload-success",em="e-upload-fails",im="e-clear-icon-focus",nm="e-file-pause-btn",om=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ug(e,t),qg([et("")],e.prototype,"name",void 0),qg([et(null)],e.prototype,"size",void 0),qg([et("")],e.prototype,"type",void 0),e}(qa),rm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ug(e,t),qg([et("Browse...")],e.prototype,"browse",void 0),qg([et("Upload")],e.prototype,"upload",void 0),qg([et("Clear")],e.prototype,"clear",void 0),e}(qa),sm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ug(e,t),qg([et("")],e.prototype,"saveUrl",void 0),qg([et("")],e.prototype,"removeUrl",void 0),qg([et(0)],e.prototype,"chunkSize",void 0),qg([et(3)],e.prototype,"retryCount",void 0),qg([et(500)],e.prototype,"retryAfterDelay",void 0),e}(qa),am=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.initialAttr={accept:null,multiple:!1,disabled:!1},n.fileList=[],n.filesData=[],n.uploadedFilesData=[],n.isForm=!1,n.allTypes=!1,n.pausedData=[],n.uploadMetaData=[],n}return Ug(e,t),e.prototype.onPropertyChanged=function(t,e){for(var i=0,o=Object.keys(t);i<o.length;i++)switch(o[i]){case"allowedExtensions":this.setExtensions(this.allowedExtensions),this.clearAll();break;case"enabled":this.setControlStatus();break;case"multiple":this.setMultipleSelection();break;case"enableRtl":this.setRTL(),this.reRenderFileList();break;case"buttons":this.buttons.browse=c(this.buttons.browse)?"":this.buttons.browse,this.buttons.clear=c(this.buttons.clear)?"":this.buttons.clear,this.buttons.upload=c(this.buttons.upload)?"":this.buttons.upload,this.renderButtonTemplates();break;case"dropArea":this.unBindDropEvents(),this.setDropArea();break;case"files":this.renderPreLoadFiles();break;case"minFileSize":case"maxFileSize":case"template":case"autoUpload":this.clearAll();break;case"locale":this.l10n.setLocale(this.locale),this.setLocalizedTexts(),this.preLocaleObj=n("currentLocale",this.l10n)}},e.prototype.setLocalizedTexts=function(){c(this.template)&&("string"==typeof this.buttons.browse&&(this.browseButton.innerText="Browse..."===this.buttons.browse?this.localizedTexts("Browse"):this.buttons.browse,this.browseButton.setAttribute("title",this.browseButton.innerText),this.uploadWrapper.querySelector(".e-file-drop").innerHTML=this.localizedTexts("dropFilesHint")),this.updateFileList())},e.prototype.getKeyValue=function(t){for(var e,i=0,n=Object.keys(this.preLocaleObj);i<n.length;i++){var o=n[i];this.preLocaleObj[o]===t&&(e=o)}return e},e.prototype.updateFileList=function(){if(this.fileList.length>0&&!c(this.uploadWrapper.querySelector(".e-upload-files")))for(var t=0;t<this.fileList.length;t++)this.fileList[t].querySelector(".e-file-status").innerHTML=this.localizedTexts(this.getKeyValue(this.filesData[t].status)),this.filesData[t].status=this.localizedTexts(this.getKeyValue(this.filesData[t].status)),this.fileList[t].classList.contains(tm)?this.fileList[t].querySelector(".e-icons").setAttribute("title",this.localizedTexts("remove")):this.fileList[t].querySelector(".e-icons").setAttribute("title",this.localizedTexts("delete")),this.autoUpload||(this.uploadButton.innerText="Upload"===this.buttons.upload?this.localizedTexts("Upload"):this.buttons.upload,this.clearButton.innerText="Clear"===this.buttons.clear?this.localizedTexts("Clear"):this.buttons.clear)},e.prototype.reRenderFileList=function(){this.listParent&&(A(this.listParent),this.listParent=null,this.fileList=[],this.createFileList(this.filesData),this.actionButtons&&(this.removeActionButtons(),this.renderActionButtons(),this.checkActionButtonStatus()))},e.prototype.preRender=function(){if(this.cloneElement=this.element.cloneNode(!0),this.localeText={Browse:"Browse...",Clear:"Clear",Upload:"Upload",dropFilesHint:"Or drop files here",invalidMaxFileSize:"File size is too large",invalidMinFileSize:"File size is too small",invalidFileType:"File type is not allowed",uploadFailedMessage:"File failed to upload",uploadSuccessMessage:"File uploaded successfully",removedSuccessMessage:"File removed successfully",removedFailedMessage:"Unable to remove file",inProgress:"Uploading",readyToUploadMessage:"Ready to upload",abort:"Abort",remove:"Remove",cancel:"Cancel",delete:"Delete file",pauseUpload:"File upload paused",pause:"Pause",resume:"Resume",retry:"Retry",fileUploadCancel:"File upload canceled"},this.l10n=new Dl("uploader",this.localeText,this.locale),this.preLocaleObj=n("currentLocale",this.l10n),this.checkHTMLAttributes(),""===this.asyncSettings.saveUrl&&""===this.asyncSettings.removeUrl&&!this.autoUpload)for(var t=this.element.parentElement;t&&t!==document.documentElement;t=t.parentElement)"FORM"===t.tagName&&(this.isForm=!0,this.formElement=t,t.setAttribute("enctype","multipart/form-data"),t.setAttribute("encoding","multipart/form-data"));var e=n("ej2_instances",this.element);if("EJS-UPLOADER"===this.element.tagName){var i=L("input",{attrs:{type:"file"}}),r=0;for(r;r<this.element.attributes.length;r++)i.setAttribute(this.element.attributes[r].nodeName,this.element.attributes[r].nodeValue),i.innerHTML=this.element.innerHTML;i.hasAttribute("name")||i.setAttribute("name","UploadFiles"),this.element.appendChild(i),this.element=i,o("ej2_instances",e,this.element)}e[0].isPureReactComponent&&(c(e[0].props.name)?!c(e[0].props.id)&&c(e[0].props.name)?this.element.setAttribute("name",e[0].props.id):this.element.setAttribute("name","UploadFiles"):this.element.setAttribute("name",e[0].props.name)),c(this.element.getAttribute("name"))&&this.element.setAttribute("name",this.element.getAttribute("id")),this.element.hasAttribute("type")||this.element.setAttribute("type","file"),this.keyConfigs={previous:"shift+tab",enter:"enter",next:"tab"}},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.getModuleName=function(){return"uploader"},e.prototype.render=function(){this.renderBrowseButton(),this.initializeUpload(),this.wireEvents(),this.setMultipleSelection(),this.setExtensions(this.allowedExtensions),this.setRTL(),this.renderPreLoadFiles(),this.setControlStatus()},e.prototype.renderBrowseButton=function(){this.browseButton=L("button",{className:"e-css e-btn",attrs:{type:"button"}}),"string"==typeof this.buttons.browse?(this.browseButton.innerText="Browse..."===this.buttons.browse?this.localizedTexts("Browse"):this.buttons.browse,this.browseButton.setAttribute("title",this.browseButton.innerText)):this.browseButton.appendChild(this.buttons.browse),this.element.setAttribute("aria-label","Uploader")},e.prototype.renderActionButtons=function(){this.element.setAttribute("tabindex","-1"),this.actionButtons=L("div",{className:"e-upload-actions"}),this.uploadButton=L("button",{className:"e-file-upload-btn e-css e-btn e-flat e-primary",attrs:{type:"button",tabindex:"-1"}}),this.clearButton=L("button",{className:"e-file-clear-btn e-css e-btn e-flat",attrs:{type:"button",tabindex:"-1"}}),this.actionButtons.appendChild(this.clearButton),this.actionButtons.appendChild(this.uploadButton),this.renderButtonTemplates(),this.uploadWrapper.appendChild(this.actionButtons),this.browseButton.blur(),this.uploadButton.focus(),this.wireActionButtonEvents()},e.prototype.wireActionButtonEvents=function(){Ma.add(this.uploadButton,"click",this.uploadButtonClick,this),Ma.add(this.clearButton,"click",this.clearButtonClick,this)},e.prototype.unwireActionButtonEvents=function(){Ma.remove(this.uploadButton,"click",this.uploadButtonClick),Ma.remove(this.clearButton,"click",this.clearButtonClick)},e.prototype.removeActionButtons=function(){this.actionButtons&&(this.unwireActionButtonEvents(),A(this.actionButtons),this.actionButtons=null)},e.prototype.renderButtonTemplates=function(){if("string"==typeof this.buttons.browse?(this.browseButton.innerText="Browse..."===this.buttons.browse?this.localizedTexts("Browse"):this.buttons.browse,this.browseButton.setAttribute("title",this.browseButton.innerText)):(this.browseButton.innerHTML="",this.browseButton.appendChild(this.buttons.browse)),this.uploadButton){var t=void 0;t=c(this.buttons.upload)?"Upload":this.buttons.upload,this.buttons.upload=t,"string"==typeof this.buttons.upload?(this.uploadButton.innerText="Upload"===this.buttons.upload?this.localizedTexts("Upload"):this.buttons.upload,this.uploadButton.setAttribute("title",this.uploadButton.innerText)):(this.uploadButton.innerHTML="",this.uploadButton.appendChild(this.buttons.upload))}if(this.clearButton){var e=void 0;e=c(this.buttons.clear)?"Clear":this.buttons.clear,this.buttons.clear=e,"string"==typeof this.buttons.clear?(this.clearButton.innerText="Clear"===this.buttons.clear?this.localizedTexts("Clear"):this.buttons.clear,this.clearButton.setAttribute("title",this.clearButton.innerText)):(this.clearButton.innerHTML="",this.clearButton.appendChild(this.buttons.clear))}},e.prototype.initializeUpload=function(){this.element.setAttribute("tabindex","-1");var t=L("span",{className:"e-file-select"});this.element.parentElement.insertBefore(t,this.element),this.dropAreaWrapper=L("div",{className:"e-file-select-wrap"}),this.element.parentElement.insertBefore(this.dropAreaWrapper,this.element),t.appendChild(this.element),this.dropAreaWrapper.appendChild(this.browseButton),this.dropAreaWrapper.appendChild(t);var e=L("span",{className:"e-file-drop"});e.innerHTML=this.localizedTexts("dropFilesHint"),this.dropAreaWrapper.appendChild(e),this.uploadWrapper=L("div",{className:"e-upload",attrs:{"aria-activedescendant":"li-focused"}}),this.dropAreaWrapper.parentElement.insertBefore(this.uploadWrapper,this.dropAreaWrapper),this.uploadWrapper.appendChild(this.dropAreaWrapper),this.setDropArea()},e.prototype.renderPreLoadFiles=function(){if(!c(this.files[0].size)&&c(this.template)){var t=[].slice.call(this.files),e=[];this.multiple||(this.clearData(),t=[t[0]]);for(var i=0,n=t;i<n.length;i++){var o=n[i],r={name:o.name+"."+o.type.split(".")[o.type.split(".").length-1],rawFile:"",size:o.size,status:this.localizedTexts("uploadSuccessMessage"),type:o.type,validationMessages:{minSize:"",maxSize:""},statusCode:"2"};e.push(r),this.filesData.push(r)}this.createFileList(e),this.autoUpload||!this.listParent||this.actionButtons||this.isForm||!this.showFileList||this.renderActionButtons(),this.checkActionButtonStatus()}},e.prototype.checkActionButtonStatus=function(){if(this.actionButtons){var t=this.uploadWrapper.querySelectorAll(".e-validation-fails").length+this.uploadWrapper.querySelectorAll(".e-upload-fails:not(.e-upload-progress)").length+this.uploadWrapper.querySelectorAll("span."+tm).length+this.uploadWrapper.querySelectorAll("span.e-upload-progress").length;t>0&&t===this.uploadWrapper.querySelectorAll("li").length?this.uploadButton.setAttribute("disabled","disabled"):this.uploadButton.removeAttribute("disabled")}},e.prototype.setDropArea=function(){var t=this.dropAreaWrapper.querySelector(".e-file-drop");if(this.dropArea){this.dropZoneElement="string"!=typeof this.dropArea?this.dropArea:document.querySelector(this.dropArea);for(var e=this.element,i=!1;e.parentNode;)(e=e.parentNode)===this.dropZoneElement&&(i=!0,t.textContent=this.localizedTexts("dropFilesHint"));i||(t.textContent="")}else this.dropZoneElement=this.uploadWrapper,t.textContent=this.localizedTexts("dropFilesHint");this.bindDropEvents()},e.prototype.setMultipleSelection=function(){if(this.multiple&&!this.element.hasAttribute("multiple")){var t=document.createAttribute("multiple");this.element.setAttributeNode(t)}else this.multiple||this.element.removeAttribute("multiple")},e.prototype.checkAutoUpload=function(t){this.autoUpload?(this.upload(t),this.removeActionButtons()):this.actionButtons||this.renderActionButtons(),this.checkActionButtonStatus()},e.prototype.wireEvents=function(){Ma.add(this.browseButton,"click",this.browseButtonClick,this),Ma.add(this.element,"change",this.onSelectFiles,this),Ma.add(document,"click",this.removeFocus,this),this.keyboardModule=new Rl(this.uploadWrapper,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}),this.isForm&&Ma.add(this.formElement,"reset",this.resetForm,this)},e.prototype.unWireEvents=function(){Ma.remove(this.browseButton,"click",this.browseButtonClick),Ma.remove(this.element,"change",this.onSelectFiles),Ma.remove(document,"click",this.removeFocus),this.keyboardModule.destroy()},e.prototype.resetForm=function(){this.clearAll()},e.prototype.keyActionHandler=function(t){var e=t.target;switch(t.action){case"next":t.target===this.browseButton&&c(this.listParent)?this.browseButton.blur():t.target===this.uploadButton?this.uploadButton.blur():(this.setTabFocus(t),t.preventDefault(),t.stopPropagation(),t.target===this.clearButton&&this.uploadButton.hasAttribute("disabled")&&this.clearButton.blur());break;case"previous":t.target===this.browseButton?this.browseButton.blur():(this.setReverseFocus(t),t.preventDefault(),t.stopPropagation());break;case"enter":if(t.target===this.clearButton)this.clearButtonClick();else if(t.target===this.uploadButton)this.uploadButtonClick();else if(t.target===this.browseButton)this.browseButtonClick();else if(e.classList.contains(nm))(i=this.getCurrentMetaData(null,t)).file.statusCode="4",i.file.status=this.localizedTexts("pauseUpload"),this.abortUpload(i,!1);else if(e.classList.contains("e-file-play-btn"))this.resumeUpload(this.getCurrentMetaData(null,t),t);else if(e.classList.contains(Qg)){var i=this.getCurrentMetaData(null,t);i.file.statusCode="1",i.file.status=this.localizedTexts("readyToUploadMessage"),this.chunkUpload(i.file)}else this.removeFiles(t),e.classList.contains(Kg)||this.browseButton.focus();t.preventDefault(),t.stopPropagation()}},e.prototype.getCurrentMetaData=function(t,e){var i,n;if(c(t)){var o=this.uploadWrapper.querySelector("."+im).parentElement;i=this.filesData[this.fileList.indexOf(o)]}else i=t;for(var r=0;r<this.uploadMetaData.length;r++)this.uploadMetaData[r].file.name===i.name&&(n=this.uploadMetaData[r]);return n},e.prototype.setReverseFocus=function(t){var e=t.target;if(e===this.uploadButton)this.uploadButton.blur(),this.clearButton.focus();else if(e===this.clearButton&&this.listParent&&this.listParent.querySelector(".e-icons")){this.clearButton.blur();var i=[].slice.call(this.listParent.querySelectorAll("span.e-icons"));i[i.length-1].classList.add(im),i[i.length-1].focus()}else{var n=[].slice.call(this.listParent.querySelectorAll("span.e-icons")),o=n.indexOf(e);o>0?(this.removeFocus(),n[o-1].classList.add(im),n[o-1].focus()):(this.removeFocus(),this.browseButton.focus())}},e.prototype.setTabFocus=function(t){var e=t.target;if(e===this.clearButton){if(this.removeFocus(),this.uploadButton.hasAttribute("disabled"))return;this.uploadButton.focus()}else if(e.classList.contains("e-icons")){var i=[].slice.call(this.listParent.querySelectorAll("span.e-icons")),n=i.indexOf(e);n<i.length-1?(this.removeFocus(),i[n+1].classList.add(im),i[n+1].focus()):(this.removeFocus(),this.clearButton.focus())}else{this.browseButton.blur();var o=this.listParent.querySelectorAll("span.e-icons")[0];o.focus(),o.classList.add(im)}},e.prototype.removeFocus=function(){this.uploadWrapper&&this.listParent&&this.listParent.querySelector("."+im)&&(document.activeElement.blur(),this.listParent.querySelector("."+im).classList.remove(im))},e.prototype.browseButtonClick=function(){this.element.click()},e.prototype.uploadButtonClick=function(){this.upload(this.filesData)},e.prototype.clearButtonClick=function(){this.clearAll()},e.prototype.bindDropEvents=function(){this.dropZoneElement&&(Ma.add(this.dropZoneElement,"drop",this.dropElement,this),Ma.add(this.dropZoneElement,"dragover",this.dragHover,this),Ma.add(this.dropZoneElement,"dragleave",this.onDragLeave,this))},e.prototype.unBindDropEvents=function(){this.dropZoneElement&&(Ma.remove(this.dropZoneElement,"drop",this.dropElement),Ma.remove(this.dropZoneElement,"dragover",this.dragHover),Ma.remove(this.dropZoneElement,"dragleave",this.onDragLeave))},e.prototype.onDragLeave=function(t){this.dropZoneElement.classList.remove("e-upload-drag-hover")},e.prototype.dragHover=function(t){this.enabled&&(this.dropZoneElement.classList.add("e-upload-drag-hover"),t.preventDefault(),t.stopPropagation())},e.prototype.dropElement=function(t){this.dropZoneElement.classList.remove("e-upload-drag-hover"),this.onSelectFiles(t),t.preventDefault(),t.stopPropagation()},e.prototype.removeFiles=function(t){if(this.enabled){var e=t.target.parentElement,i=this.fileList.indexOf(e),n=this.fileList[i],o=this.filesData[i];if(t.target.classList.contains(Kg)){if(t.target.classList.contains("e-disabled"))return;if(o.statusCode="5",!c(n)){var r=n.querySelector("."+Kg);Ji({target:r,width:"20px"}),An(r)}}else this.remove(o,!1,!1,t);this.element.value="",this.checkActionButtonStatus()}},e.prototype.removeFilesData=function(t,e){if(!e){var i=this.getLiElement(t);if(!c(i)){A(i);var n=this.fileList.indexOf(i);this.fileList.splice(n,1),this.filesData.splice(n,1),0!==this.fileList.length||c(this.listParent)||(A(this.listParent),this.listParent=null,this.removeActionButtons())}}},e.prototype.removeUploadedFile=function(t,e,i,n){var o=this,r=t,s=this.element.getAttribute("name"),a=new Aa(this.asyncSettings.removeUrl,"POST",!0,null),l=new FormData;a.beforeSend=function(t){e.currentRequest=a.httpRequest,i||o.trigger("removing",e),e.cancel&&(t.cancel=!0),e.postRawFile&&!c(r.rawFile)&&""!==r.rawFile?l.append(s,r.rawFile):l.append(s,r.name),o.updateFormData(l,e.customFormData)};var h=this.getLiElement(t);if(a.onLoad=function(t){return o.removeCompleted(t,r,n),{}},a.onError=function(t){return o.removeFailed(t,r,n),{}},a.send(l),!c(h)&&!c(h.querySelector("."+Zg))){var d=h.querySelector("."+Zg);Ji({target:d,width:"20px"}),An(d)}},e.prototype.updateFormData=function(t,e){if(e.length>0&&e[0])for(var i=0;i<e.length;i++){var n=e[i];t.append(Object.keys(n)[0],Object.values(n)[0])}},e.prototype.removeCompleted=function(t,e,i){var n={e:t,operation:"remove",file:this.updateStatus(e,this.localizedTexts("removedSuccessMessage"),"2")};this.trigger("success",n),this.removeFilesData(e,i);var o=this.uploadedFilesData.indexOf(e);this.uploadedFilesData.splice(o,1),this.trigger("change",{files:this.uploadedFilesData})},e.prototype.removeFailed=function(t,e,i){var n={e:t,operation:"remove",file:this.updateStatus(e,this.localizedTexts("removedFailedMessage"),"0")};if(!i){var o=this.filesData.indexOf(e),r=this.fileList[o];if(r){var s=r.querySelector("."+Yg);r.classList.remove(tm),s.classList.remove(tm),r.classList.add(em),s.classList.add(em)}this.checkActionButtonStatus()}this.trigger("failure",n);var a=this.getLiElement(e);c(a)||c(a.querySelector("."+Zg))||(Rn(a.querySelector("."+Zg)),A(a.querySelector(".e-spinner-pane")))},e.prototype.onSelectFiles=function(t){if(this.enabled){var e,i=[];if("drop"===t.type){var n=t.dataTransfer.files;e=this.multiple?this.sortFileList(n):[n[0]]}else e=[].slice.call(t.target.files);this.multiple||(this.clearData(!0),e=[e[0]]);for(var o=0;o<e.length;o++){var r=e[o],s={name:r.name,rawFile:r,size:r.size,status:this.localizedTexts("readyToUploadMessage"),type:this.getFileType(r.name),validationMessages:this.validatedFileSize(r.size),statusCode:"1"};s.status=""!==s.validationMessages.minSize?this.localizedTexts("invalidMinFileSize"):""!==s.validationMessages.maxSize?this.localizedTexts("invalidMaxFileSize"):s.status,""===s.validationMessages.minSize&&""===s.validationMessages.maxSize||(s.statusCode="0"),i.push(s)}var a={event:t,cancel:!1,filesData:i,isModified:!1,modifiedFilesData:[],progressInterval:""};if(this.allowedExtensions.indexOf("*")>-1&&(this.allTypes=!0),"drop"!==t.type||this.allTypes||(i=this.checkExtension(i)),this.trigger("selected",a),!a.cancel&&this.showFileList){if(a.isModified&&a.modifiedFilesData.length>0){var l=this.allTypes?a.modifiedFilesData:this.checkExtension(a.modifiedFilesData);this.updateSortedFileList(l),this.filesData=l,this.isForm||this.checkAutoUpload(l)}else this.createFileList(i),this.filesData=this.filesData.concat(i),this.isForm||this.checkAutoUpload(i);c(a.progressInterval)||""===a.progressInterval||(this.progressInterval=a.progressInterval)}}},e.prototype.clearData=function(t){c(this.listParent)||(A(this.listParent),this.listParent=null),"msie"===za.info.name||t||(this.element.value=""),this.fileList=[],this.filesData=[],this.removeActionButtons()},e.prototype.updateSortedFileList=function(t){var e,i=L("div",{id:"clonewrapper"}),n=-1;if(this.listParent){for(var o=0;o<this.listParent.querySelectorAll("li").length;o++){var r=this.listParent.querySelectorAll("li")[o];i.appendChild(r.cloneNode(!0))}for(var s=0,a=e=this.listParent.querySelectorAll("li");s<a.length;s++)A(a[s]);this.removeActionButtons();var l=[].slice.call(i.childNodes);A(this.listParent),this.listParent=null,this.fileList=[],this.createParentUL();for(var h=0;h<t.length;h++){for(var c=0;c<this.filesData.length;c++)this.filesData[c].name===t[h].name&&(this.listParent.appendChild(l[c]),Ma.add(l[c].querySelector(".e-icons"),"click",this.removeFiles,this),this.fileList.push(l[c]),n=h);n!==h&&this.createFileList([t[h]])}}else this.createFileList(t)},e.prototype.checkExtension=function(t){var e=t;if(""!==this.allowedExtensions){for(var i=[],n=0,o=this.allowedExtensions.split(",");n<o.length;n++){var r=o[n];i.push(r.trim().toLocaleLowerCase())}for(var s=0;s<t.length;s++)-1===i.indexOf(("."+t[s].type).toLocaleLowerCase())&&(t[s].status=this.localizedTexts("invalidFileType"),t[s].statusCode="0")}return e},e.prototype.validatedFileSize=function(t){var e="",i="";return t<this.minFileSize?e=this.localizedTexts("invalidMinFileSize"):t>this.maxFileSize?i=this.localizedTexts("invalidMaxFileSize"):(e="",i=""),{minSize:e,maxSize:i}},e.prototype.createCustomfileList=function(t){this.createParentUL();for(var e=0,i=t;e<i.length;e++){var n=i[e],o=L("li",{className:Xg,attrs:{"data-file-name":n.name}});this.uploadTemplateFn=this.templateComplier(this.template),this.listParent.appendChild(o),I([].slice.call(this.uploadTemplateFn(n)),o),this.fileList.push(o)}},e.prototype.createParentUL=function(){c(this.listParent)&&(this.listParent=L("ul",{className:"e-upload-files"}),this.uploadWrapper.appendChild(this.listParent))},e.prototype.createFileList=function(t){if(this.createParentUL(),""===this.template||c(this.template))for(var e=0,i=t;e<i.length;e++){var n=i[e],o=L("li",{className:Xg,attrs:{"data-file-name":n.name}}),r=L("span",{className:"e-file-container"}),s=L("span",{className:"e-file-name",attrs:{title:n.name}});s.innerHTML=this.getFileNameOnly(n.name);var a=L("span",{className:"e-file-type"});if(a.innerHTML="."+this.getFileType(n.name),this.enableRtl){var l=L("span",{className:"e-rtl-container"});l.appendChild(a),l.appendChild(s),r.appendChild(l)}else r.appendChild(s),r.appendChild(a);var h=L("span",{className:"e-file-size"});h.innerHTML=this.bytesToSize(n.size),r.appendChild(h);var d=L("span",{className:Yg});r.appendChild(d),d.innerHTML=n.status,o.appendChild(r);var p=L("span",{className:" e-icons",attrs:{tabindex:"-1"}});"msie"===za.info.name&&p.classList.add("e-msie"),p.setAttribute("title",this.localizedTexts("remove")),o.appendChild(p),Ma.add(p,"click",this.removeFiles,this),"2"===n.statusCode?(d.classList.add(tm),p.classList.add(Zg),p.setAttribute("title",this.localizedTexts("delete"))):"1"!==n.statusCode&&(d.classList.remove(tm),d.classList.add("e-validation-fails")),this.autoUpload&&"1"===n.statusCode&&""!==this.asyncSettings.saveUrl&&(d.innerHTML=""),p.classList.contains(Zg)||p.classList.add(Gg),this.listParent.appendChild(o),this.fileList.push(o),this.truncateName(s)}else this.createCustomfileList(t)},e.prototype.truncateName=function(t){var e,i=t;i.offsetWidth<i.scrollWidth&&(e=i.textContent,i.dataset.tail=e.slice(e.length-10))},e.prototype.getFileType=function(t){var e,i=t.lastIndexOf(".");return i>=0&&(e=t.substring(i+1)),e||""},e.prototype.getFileNameOnly=function(t){var e=this.getFileType(t);return e=t.split("."+e)[0]},e.prototype.setInitialAttributes=function(){if(this.initialAttr.accept&&this.element.setAttribute("accept",this.initialAttr.accept),this.initialAttr.disabled&&this.element.setAttribute("disabled","disabled"),this.initialAttr.multiple){var t=document.createAttribute("multiple");this.element.setAttributeNode(t)}},e.prototype.filterfileList=function(t){for(var e=[],i=0;i<t.length;i++)this.getLiElement(t[i]).classList.contains(tm)||e.push(t[i]);return e},e.prototype.updateStatus=function(t,e,i){""===e||c(e)||""===i||c(i)||(t.status=e,t.statusCode=i);var n=this.getLiElement(t);return c(n)||c(n.querySelector("."+Yg))||""===e||c(e)||(n.querySelector("."+Yg).textContent=e),t},e.prototype.getLiElement=function(t){var e=this.filesData.indexOf(t);return this.fileList[e]},e.prototype.createProgressBar=function(t){var e=L("span",{className:Jg}),i=L("progressbar",{className:$g,attrs:{value:"0",max:"100"}}),n=L("span",{className:"e-progress-inner-wrap"});i.setAttribute("style","width: 0%");var o=L("span",{className:"e-progress-bar-text"});o.textContent="0%",n.appendChild(i),e.appendChild(n),e.appendChild(o),t.querySelector(".e-file-container").appendChild(e)},e.prototype.updateProgressbar=function(t,e){if(!isNaN(Math.round(t.loaded/t.total*100))&&!c(e.querySelector("."+$g)))if(c(this.progressInterval)||""===this.progressInterval)this.changeProgressValue(e,Math.round(t.loaded/t.total*100).toString()+"%");else{var i=Math.round(t.loaded/t.total*100)%parseInt(this.progressInterval,10);0!==i&&100!==i||this.changeProgressValue(e,Math.round(t.loaded/t.total*100).toString()+"%")}},e.prototype.changeProgressValue=function(t,e){t.querySelector("."+$g).setAttribute("style","width:"+e),t.querySelector(".e-progress-bar-text").textContent=e},e.prototype.uploadInProgress=function(t,e,i,n){var o=this,r=this.getLiElement(e);if(!c(r)||i&&!c(i)){if(!c(r)){if("5"===e.statusCode){var s={event:t,fileData:e,cancel:!1};if(this.trigger("canceling",s),s.cancel){e.statusCode="3";var a=r.querySelector("."+Kg);return void(c(r)||c(a)||(Rn(a),A(r.querySelector(".e-spinner-pane"))))}n.emitError=!1,n.httpRequest.abort();var l=new FormData;if("5"===e.statusCode){var h=this.element.getAttribute("name");l.append(h,e.name),l.append("cancel-uploading",e.name);var d=new Aa(this.asyncSettings.removeUrl,"POST",!0,null);d.onLoad=function(t){return o.removecanceledFile(t,e),{}},d.send(l)}}r.querySelectorAll("."+Jg).length>0||!r.querySelector("."+Yg)||(r.querySelector("."+Yg).classList.add("e-upload-progress"),this.createProgressBar(r),this.updateProgressBarClasses(r,"e-upload-progress"),r.querySelector("."+Yg).classList.remove(em)),this.updateProgressbar(t,r);var p=r.querySelector("."+Gg);c(p)||(p.classList.add(Kg,"e-upload-progress"),p.setAttribute("title",this.localizedTexts("abort")),p.classList.remove(Gg))}var u={e:t,operation:"upload",file:this.updateStatus(e,this.localizedTexts("inProgress"),"3")};this.trigger("progress",u)}},e.prototype.removecanceledFile=function(t,e){var i=this.getLiElement(e);if(!i.querySelector("."+Qg)&&!c(i.querySelector("."+Kg))){this.updateStatus(e,this.localizedTexts("fileUploadCancel"),"5"),this.renderFailureState(t,e,i);var n=i.querySelector("."+Gg);c(i)||(Rn(n),A(i.querySelector(".e-spinner-pane")));var o={event:t,operation:"cancel",file:e};this.trigger("success",o)}},e.prototype.renderFailureState=function(t,e,i){var n=this;this.updateProgressBarClasses(i,em),this.removeProgressbar(i,"failure"),c(i.querySelector(".e-file-status"))||i.querySelector(".e-file-status").classList.add(em);var o=i.querySelector("."+Kg);c(o)||(o.classList.remove(Kg,"e-upload-progress"),o.classList.add(Gg),o.setAttribute("title",this.localizedTexts("remove")),this.pauseButton=L("span",{className:"e-icons e-file-reload-btn",attrs:{tabindex:"-1"}}),i.insertBefore(this.pauseButton,o),this.pauseButton.setAttribute("title",this.localizedTexts("retry")),i.querySelector("."+Qg).addEventListener("click",function(t){n.reloadcanceledFile(t,e,i)},!1))},e.prototype.reloadcanceledFile=function(t,e,i){e.statusCode="1",e.status=this.localizedTexts("readyToUploadMessage"),i.querySelector("."+Yg).classList.remove(em),A(i.querySelector("."+Qg)),this.pauseButton=null,this.upload([e])},e.prototype.uploadComplete=function(t,e,i){var n=t.target;if(4===n.readyState&&n.status>=200&&n.status<=299){var o=this.getLiElement(e);if(c(o)&&(!i||c(i)))return;if(!c(o)){this.updateProgressBarClasses(o,tm),this.removeProgressbar(o,"success");var r=o.querySelector("."+Kg);c(r)||(r.classList.add(Zg),r.setAttribute("title",this.localizedTexts("delete")),r.classList.remove(Kg),r.classList.remove("e-upload-progress"))}this.raiseSuccessEvent(t,e)}else this.uploadFailed(t,e)},e.prototype.raiseSuccessEvent=function(t,e){var i={e:t,operation:"upload",file:this.updateStatus(e,this.localizedTexts("uploadSuccessMessage"),"2")};this.trigger("success",i),this.uploadedFilesData.push(e),this.trigger("change",{file:this.uploadedFilesData}),this.checkActionButtonStatus()},e.prototype.uploadFailed=function(t,e){var i=this.getLiElement(e),n={e:t,operation:"upload",file:this.updateStatus(e,this.localizedTexts("uploadFailedMessage"),"0")};c(i)||this.renderFailureState(t,e,i),this.trigger("failure",n),this.checkActionButtonStatus()},e.prototype.updateProgressBarClasses=function(t,e){var i=t.querySelector("."+$g);c(i)||i.classList.add(e)},e.prototype.removeProgressbar=function(t,e){var i=this;c(t.querySelector("."+Jg))||(this.progressAnimation=new Fa({duration:1250}),this.progressAnimation.animate(t.querySelector("."+Jg),{name:"FadeOut"}),this.progressAnimation.animate(t.querySelector(".e-progress-bar-text"),{name:"FadeOut"}),setTimeout(function(){i.animateProgressBar(t,e)},750))},e.prototype.animateProgressBar=function(t,e){"success"===e?(t.classList.add(tm),c(t.querySelector("."+Yg))||(t.querySelector("."+Yg).classList.remove("e-upload-progress"),this.progressAnimation.animate(t.querySelector("."+Yg),{name:"FadeIn"}),t.querySelector("."+Yg).classList.add(tm))):c(t.querySelector("."+Yg))||(t.querySelector("."+Yg).classList.remove("e-upload-progress"),this.progressAnimation.animate(t.querySelector("."+Yg),{name:"FadeIn"}),t.querySelector("."+Yg).classList.add(em)),t.querySelector("."+Jg)&&A(t.querySelector("."+Jg))},e.prototype.setExtensions=function(t){this.element.setAttribute("accept",t)},e.prototype.templateComplier=function(t){if(t)try{if(document.querySelectorAll(t).length)return Tt(document.querySelector(t).innerHTML.trim())}catch(e){return Tt(t)}},e.prototype.setRTL=function(){this.enableRtl?E([this.uploadWrapper],"e-rtl"):P([this.uploadWrapper],"e-rtl")},e.prototype.localizedTexts=function(t){return this.l10n.setLocale(this.locale),this.l10n.getConstant(t)},e.prototype.setControlStatus=function(){this.enabled?(this.uploadWrapper.classList.contains("e-disabled")&&this.uploadWrapper.classList.remove("e-disabled"),!c(this.browseButton)&&this.element.hasAttribute("disabled")&&(this.element.removeAttribute("disabled"),this.browseButton.removeAttribute("disabled")),!c(this.clearButton)&&this.clearButton.hasAttribute("disabled")&&this.clearButton.removeAttribute("disabled"),!c(this.uploadButton)&&this.uploadButton.hasAttribute("disabled")&&this.uploadButton.hasAttribute("disabled")):(this.uploadWrapper.classList.add("e-disabled"),this.element.setAttribute("disabled","disabled"),this.browseButton.setAttribute("disabled","disabled"),c(this.clearButton)||this.clearButton.setAttribute("disabled","disabled"),c(this.uploadButton)||this.uploadButton.setAttribute("disabled","disabled"))},e.prototype.checkHTMLAttributes=function(){this.element.hasAttribute("accept")&&(this.allowedExtensions=this.element.getAttribute("accept"),this.initialAttr.accept=this.allowedExtensions),this.element.hasAttribute("multiple")&&(this.multiple=!0,this.initialAttr.multiple=!0),this.element.hasAttribute("disabled")&&(this.enabled=!1,this.initialAttr.disabled=!0)},e.prototype.chunkUpload=function(t,e){var i=Math.min(this.asyncSettings.chunkSize,t.size),n={chunkIndex:0,blob:t.rawFile.slice(0,i),file:t,start:0,end:i,retryCount:0,request:null};this.sendRequest(t,n,e)},e.prototype.sendRequest=function(t,e,i){var n=this,o=new FormData,r=t.rawFile.slice(e.start,e.end);o.append("chunkFile",r,t.name),o.append("chunk-index",e.chunkIndex.toString());var s=Math.max(Math.ceil(t.size/this.asyncSettings.chunkSize),1);o.append("total-chunk",s.toString());var a=new Aa({url:this.asyncSettings.saveUrl,type:"POST",async:!0,contentType:null});a.onLoad=function(t){return n.chunkUploadComplete(t,e,i),{}},a.onUploadProgress=function(t){return n.chunkUploadInProgress(t,e,i),{}};var l={fileData:t,customFormData:[],cancel:!1,chunkSize:0===this.asyncSettings.chunkSize?null:this.asyncSettings.chunkSize};a.beforeSend=function(i){0===e.chunkIndex&&(l.currentRequest=a.httpRequest,n.trigger("uploading",l),l.cancel?n.eventCancelByArgs(i,l,t):n.updateFormData(o,l.customFormData))},a.onError=function(t){return n.chunkUploadFailed(t,e,i),{}},a.send(o),e.request=a},e.prototype.eventCancelByArgs=function(t,e,i){var n=this;if(t.cancel=!0,"5"!==e.fileData.statusCode){var o=this.getLiElement(e.fileData);o.querySelector("."+Yg).innerHTML=this.localizedTexts("fileUploadCancel"),o.querySelector("."+Yg).classList.add(em),e.fileData.statusCode="5",e.fileData.status=this.localizedTexts("fileUploadCancel"),this.pauseButton=L("span",{className:"e-icons e-file-reload-btn",attrs:{tabindex:"-1"}}),o.insertBefore(this.pauseButton,o.querySelector("."+Gg)),this.pauseButton.setAttribute("title",this.localizedTexts("retry")),this.pauseButton.addEventListener("click",function(t){n.reloadcanceledFile(t,i,o)},!1),this.checkActionButtonStatus()}},e.prototype.checkChunkUpload=function(){return!(this.asyncSettings.chunkSize<=0||c(this.asyncSettings.chunkSize))},e.prototype.chunkUploadComplete=function(t,e,i){var n,o=this,r=t.target;if(4===r.readyState&&r.status>=200&&r.status<300){var s=Math.max(Math.ceil(e.file.size/this.asyncSettings.chunkSize),1),a={event:t,file:e.file,chunkIndex:e.chunkIndex,totalChunk:s,chunkSize:this.asyncSettings.chunkSize};if(this.trigger("chunkSuccess",a),!c(i)&&i||(n=this.getLiElement(e.file)),this.updateMetaData(e),e.end===e.file.size&&(e.file.statusCode="3"),"5"===e.file.statusCode){var l={event:t,fileData:e.file,cancel:!1};if(this.trigger("canceling",l),l.cancel){e.file.statusCode="3";var h=n.querySelector("."+Kg);return c(n)||c(h)||(Rn(h),A(n.querySelector(".e-spinner-pane"))),void this.sendNextRequest(e)}e.request.emitError=!1,r.abort();var d=new FormData,p=this.element.getAttribute("name");d.append(p,e.file.name),d.append("cancel-uploading",e.file.name);var u=new Aa(this.asyncSettings.removeUrl,"POST",!0,null);u.onLoad=function(t){return o.removeChunkFile(t,e,i),{}},u.send(d)}else{if(s-1===e.chunkIndex&&s>e.chunkIndex){var g=this.pausedData.indexOf(e);return g>=0&&this.pausedData.splice(g,1),c(this.template)&&(c(i)||!i)&&n&&(n&&A(n.querySelector("."+nm)),this.removeChunkProgressBar(e)),void this.raiseSuccessEvent(t,e.file)}this.sendNextRequest(e)}}else this.chunkUploadFailed(t,e)},e.prototype.sendNextRequest=function(t){t.start=t.end,t.end+=this.asyncSettings.chunkSize,t.end=Math.min(t.end,t.file.size),t.chunkIndex+=1,this.sendRequest(t.file,t)},e.prototype.removeChunkFile=function(t,e,i){if(c(this.template)&&c(i)&&!i){var n=this.getLiElement(e.file),o=n.querySelector("."+Kg),r=o;this.updateStatus(e.file,this.localizedTexts("fileUploadCancel"),"5"),this.updateProgressBarClasses(n,em),this.removeProgressbar(n,"failure"),o.classList.remove(Kg),o.classList.add(Gg),o.setAttribute("title",this.localizedTexts("remove"));var s=n.querySelector("."+nm);s.classList.add(Qg),s.classList.remove(nm),s.setAttribute("title",this.localizedTexts("retry")),c(n)||c(o)||(Rn(r),A(n.querySelector(".e-spinner-pane")))}},e.prototype.pauseUpload=function(t,e,i){t.file.statusCode="4",t.file.status=this.localizedTexts("pause"),this.updateMetaData(t);var n={event:e||null,file:t.file,chunkIndex:t.chunkIndex,chunkCount:Math.round(t.file.size/this.asyncSettings.chunkSize),chunkSize:this.asyncSettings.chunkSize};this.abortUpload(t,i,n)},e.prototype.abortUpload=function(t,e,i){t.request.emitError=!1,t.request.httpRequest.abort();var n=this.getLiElement(t.file);if(c(this.template)&&(c(e)||!e)){var o=n.querySelector("."+nm);o.classList.remove(nm),o.classList.add("e-file-play-btn"),o.setAttribute("title",this.localizedTexts("resume"))}for(var r=0;r<this.pausedData.length;r++)this.pausedData[r].file.name===t.file.name&&this.pausedData.splice(r,1);this.pausedData.push(t),this.trigger("pausing",i)},e.prototype.resumeUpload=function(t,e,i){var n,o=this.getLiElement(t.file);c(o)||(n=o.querySelector(".e-file-play-btn")),c(n)||!c(i)&&i||(n.classList.remove("e-file-play-btn"),n.classList.add(nm),n.setAttribute("title",this.localizedTexts("pause"))),t.file.status=this.localizedTexts("inProgress"),t.file.statusCode="3",this.updateMetaData(t);var r={event:e||null,file:t.file,chunkIndex:t.chunkIndex,chunkCount:Math.round(t.file.size/this.asyncSettings.chunkSize),chunkSize:this.asyncSettings.chunkSize};this.trigger("resuming",r);for(var s=0;s<this.pausedData.length;s++)this.pausedData[s].end===this.pausedData[s].file.size?this.chunkUploadComplete(e,t,i):this.pausedData[s].file.name===t.file.name&&(this.pausedData[s].start=this.pausedData[s].end,this.pausedData[s].end=this.pausedData[s].end+this.asyncSettings.chunkSize,this.pausedData[s].end=Math.min(this.pausedData[s].end,this.pausedData[s].file.size),this.pausedData[s].chunkIndex=this.pausedData[s].chunkIndex+1,this.sendRequest(this.pausedData[s].file,this.pausedData[s],i))},e.prototype.updateMetaData=function(t){-1===this.uploadMetaData.indexOf(t)?this.uploadMetaData.push(t):(this.uploadMetaData.splice(this.uploadMetaData.indexOf(t),1),this.uploadMetaData.push(t))},e.prototype.removeChunkProgressBar=function(t){var e=this.getLiElement(t.file);if(!c(e)){this.updateProgressBarClasses(e,tm),this.removeProgressbar(e,"success");var i=e.querySelector("."+Kg);c(i)||(i.classList.add(Zg),i.setAttribute("title",this.localizedTexts("delete")),i.classList.remove(Kg,"e-upload-progress"))}},e.prototype.chunkUploadFailed=function(t,e,i){var n,o=this,r=Math.max(Math.ceil(e.file.size/this.asyncSettings.chunkSize),1);!c(this.template)||!c(i)&&i||(n=this.getLiElement(e.file));var s={event:t,file:e.file,chunkIndex:e.chunkIndex,totalChunk:r,chunkSize:this.asyncSettings.chunkSize};if(this.trigger("chunkFailure",s),e.retryCount<this.asyncSettings.retryCount)setTimeout(function(){o.retryRequest(n,e,i)},this.asyncSettings.retryAfterDelay);else{if(!c(n)){var a=n.querySelector("."+nm)?n.querySelector("."+nm):n.querySelector(".e-file-play-btn");c(a)||(a.classList.add(Qg),a.classList.remove(nm,"e-file-play-btn")),this.updateProgressBarClasses(n,em),this.removeProgressbar(n,"failure"),n.querySelector(".e-icons").classList.remove("e-upload-progress");var l=n.querySelector("."+Kg);l.classList.remove(Kg),c(n.querySelector("."+nm))||A(n.querySelector("."+nm)),e.start>0?(l.classList.add(Zg),l.setAttribute("title",this.localizedTexts("delete"))):(l.classList.add(Gg),l.setAttribute("title",this.localizedTexts("remove")))}e.retryCount=0;var h=e.file,d={e:t,operation:"upload",file:this.updateStatus(h,this.localizedTexts("uploadFailedMessage"),"0")};this.trigger("failure",d)}},e.prototype.retryRequest=function(t,e,i){c(this.template)&&(c(i)||!i)&&t&&this.updateProgressBarClasses(t,em),e.retryCount+=1,this.sendRequest(e.file,e)},e.prototype.checkPausePlayAction=function(t){var e=t.target,i=t.target.parentElement,n=this.fileList.indexOf(i),o=this.filesData[n],r=this.getCurrentMetaData(o);e.classList.contains(nm)?(this.pauseUpload(r,t),e.nextElementSibling.classList.add("e-disabled")):e.classList.contains("e-file-play-btn")?(this.resumeUpload(r,t),e.nextElementSibling.classList.remove("e-disabled")):e.classList.contains(Qg)&&(r.file.status===this.localizedTexts("fileUploadCancel")?this.retryUpload(r,!1):this.retryUpload(r,!0))},e.prototype.retryUpload=function(t,e){e?(t.end=t.end+this.asyncSettings.chunkSize,t.start=t.start+this.asyncSettings.chunkSize,this.sendRequest(t.file,t)):(t.file.statusCode="1",t.file.status=this.localizedTexts("readyToUploadMessage"),this.chunkUpload(t.file))},e.prototype.chunkUploadInProgress=function(t,e,i){var n=this;if("4"!==e.file.statusCode){"4"!==e.file.statusCode&&"5"!==e.file.statusCode&&(e.file.statusCode="3",e.file.status=this.localizedTexts("inProgress")),this.updateMetaData(e);var o=this.getLiElement(e.file);if(!c(o)){var r=o.querySelector("."+Qg);if(c(r)||(r.classList.add(nm),r.setAttribute("title",this.localizedTexts("pause")),r.classList.remove(Qg)),!c(o)){if(!(o.querySelectorAll("."+Jg).length>0)){var s=o.querySelector("."+Yg);c(this.template)&&(s.classList.add("e-upload-progress"),s.classList.remove(em),this.createProgressBar(o),this.updateProgressBarClasses(o,"e-upload-progress"));var a=o.querySelector("."+Gg)?o.querySelector("."+Gg):o.querySelector("."+Zg);c(a)||(a.classList.add(Kg),a.setAttribute("title",this.localizedTexts("abort")),a.classList.remove(Gg))}if(!isNaN(Math.round(t.loaded/t.total*100))&&c(this.template)&&"4"!==e.file.statusCode){var l=e.chunkIndex*this.asyncSettings.chunkSize,h=Math.min((l+t.loaded)/e.file.size*100,100);this.changeProgressValue(o,Math.round(h).toString()+"%")}0===e.chunkIndex&&this.checkActionButtonStatus()}c(o.querySelector("."+nm))&&c(this.template)&&(this.pauseButton=L("span",{className:"e-icons e-file-pause-btn",attrs:{tabindex:"-1"}}),"msie"===za.info.name&&this.pauseButton.classList.add("e-msie"),o.insertBefore(this.pauseButton,o.querySelector("."+Kg)),this.pauseButton.setAttribute("title",this.localizedTexts("pause")),this.pauseButton.addEventListener("click",function(t){n.checkPausePlayAction(t)},!1))}}},e.prototype.bytesToSize=function(t){var e=-1;if(!t)return"0.0 KB";do{t/=1024,e++}while(t>99);return e>=2&&(t*=1024,e=1),Math.max(t,0).toFixed(1)+" "+["KB","MB"][e]},e.prototype.sortFileList=function(t){for(var e=t,i=[],n=0;n<e.length;n++)i.push(e[n].name);for(var o=[],r=0,s=i.sort();r<s.length;r++)for(var a=s[r],n=0;n<e.length;n++)a===e[n].name&&o.push(e[n]);return o},e.prototype.destroy=function(){this.element.value=null,this.clearAll(),this.unWireEvents(),this.unBindDropEvents(),this.multiple&&this.element.removeAttribute("multiple"),this.enabled||this.element.removeAttribute("disabled"),this.element.removeAttribute("accept"),this.setInitialAttributes(),this.uploadWrapper.parentElement.appendChild(this.cloneElement),this.cloneElement.classList.remove("e-control","e-uploader"),A(this.uploadWrapper),this.uploadWrapper=null,t.prototype.destroy.call(this)},e.prototype.upload=function(t,e){var i=this.validateFileType(t);this.uploadFiles(i,e)},e.prototype.validateFileType=function(t){var e=[];return t instanceof Array?e=t:e.push(t),e},e.prototype.uploadFiles=function(t,e){var i=this,n=[];if(""!==this.asyncSettings.saveUrl&&!c(this.asyncSettings.saveUrl)){if(!e||c(e))if(this.multiple)n=this.filterfileList(t);else{var o=[];o.push(t[0]),n=this.filterfileList(o)}else n=t;for(var r=this.checkChunkUpload(),s=this,a=0;a<n.length;a++)!function(t){var o=new Aa(s.asyncSettings.saveUrl,"POST",!0,null),a={fileData:n[t],customFormData:[],cancel:!1},l=new FormData;if(o.beforeSend=function(e){a.currentRequest=o.httpRequest,i.trigger("uploading",a),a.cancel&&i.eventCancelByArgs(e,a,n[t]),i.updateFormData(l,a.customFormData)},"1"===n[t].statusCode){var h=s.element.getAttribute("name");l.append(h,n[t].rawFile,n[t].name),r&&n[t].size>s.asyncSettings.chunkSize?s.chunkUpload(n[t],e):(o.onLoad=function(o){return i.uploadComplete(o,n[t],e),{}},o.onUploadProgress=function(r){return i.uploadInProgress(r,n[t],e,o),{}},o.onError=function(e){return i.uploadFailed(e,n[t]),{}},o.send(l))}}(a)}},e.prototype.remove=function(t,e,i,n){var o=[];(t=c(t)?this.filesData:t)instanceof Array?o=t:o.push(t);for(var r={event:n,cancel:!1,filesData:o,customFormData:[],postRawFile:!0},s=this.asyncSettings.removeUrl,a=""!==s&&!c(s),l=0,h=o;l<h.length;l++){var d=h[l];if("2"===d.statusCode&&a)this.removeUploadedFile(d,r,i,e);else{if(i||this.trigger("removing",r),r.cancel)return;this.removeFilesData(d,e)}}},e.prototype.clearAll=function(){if(!c(this.listParent)){var t={cancel:!1,filesData:this.filesData};this.trigger("clearing",t),t.cancel||this.clearData()}},e.prototype.getFilesData=function(){return this.filesData},e.prototype.pause=function(t,e){var i=this.validateFileType(t);this.pauseUploading(i,e)},e.prototype.pauseUploading=function(t,e){for(var i=this.getFiles(t),n=0;n<i.length;n++)"3"===i[n].statusCode&&this.pauseUpload(this.getCurrentMetaData(i[n],null),null,e)},e.prototype.getFiles=function(t){var e=[];return c(t)||t instanceof Array?e=t:e.push(t),e},e.prototype.resume=function(t,e){var i=this.validateFileType(t);this.resumeFiles(i,e)},e.prototype.resumeFiles=function(t,e){for(var i=this.getFiles(t),n=0;n<i.length;n++)"4"===i[n].statusCode&&this.resumeUpload(this.getCurrentMetaData(i[n],null),null,e)},e.prototype.retry=function(t,e){var i=this.validateFileType(t);this.retryFailedFiles(i,e)},e.prototype.retryFailedFiles=function(t,e){for(var i=this.getFiles(t),n=0;n<i.length;n++)if("5"===i[n].statusCode||"0"===i[n].statusCode)if(this.asyncSettings.chunkSize>0)this.retryUpload(this.getCurrentMetaData(i[n],null),e);else{var o=this.fileList[this.filesData.indexOf(i[n])];this.reloadcanceledFile(null,i[n],o)}},e.prototype.cancel=function(t){var e=this.validateFileType(t);this.cancelUpload(e)},e.prototype.cancelUpload=function(t){for(var e=this.getFiles(t),i=0;i<e.length;i++)if("3"===e[i].statusCode){var n=this.getCurrentMetaData(e[i],null);n.file.statusCode="5",n.file.status=this.localizedTexts("fileUploadCancel"),this.updateMetaData(n);var o=this.getLiElement(e[i]);if(!c(o)&&c(this.template)){var r=o.querySelector("."+Kg);Ji({target:r,width:"20px"}),An(r)}}},qg([it({saveUrl:"",removeUrl:""},sm)],e.prototype,"asyncSettings",void 0),qg([et(!1)],e.prototype,"enableRtl",void 0),qg([et(!0)],e.prototype,"enabled",void 0),qg([et(null)],e.prototype,"template",void 0),qg([et(!0)],e.prototype,"multiple",void 0),qg([et(!0)],e.prototype,"autoUpload",void 0),qg([it({},rm)],e.prototype,"buttons",void 0),qg([et("")],e.prototype,"allowedExtensions",void 0),qg([et(0)],e.prototype,"minFileSize",void 0),qg([et(3e7)],e.prototype,"maxFileSize",void 0),qg([et(null)],e.prototype,"dropArea",void 0),qg([ot([{}],om)],e.prototype,"files",void 0),qg([et(!0)],e.prototype,"showFileList",void 0),qg([st()],e.prototype,"selected",void 0),qg([st()],e.prototype,"uploading",void 0),qg([st()],e.prototype,"success",void 0),qg([st()],e.prototype,"failure",void 0),qg([st()],e.prototype,"removing",void 0),qg([st()],e.prototype,"clearing",void 0),qg([st()],e.prototype,"progress",void 0),qg([st()],e.prototype,"change",void 0),qg([st()],e.prototype,"chunkSuccess",void 0),qg([st()],e.prototype,"chunkFailure",void 0),qg([st()],e.prototype,"canceling",void 0),qg([st()],e.prototype,"pausing",void 0),qg([st()],e.prototype,"resuming",void 0),e=qg([at],e)}(wl),lm=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),hm=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},cm="e-switch-ctrl-btn",dm="e-value-switch-btn",pm="e-hex",um="e-hsv-color",gm="e-selected-value",mm="e-mode-switch-btn",fm="e-nocolor-item",vm="e-preview-container",ym="e-selected",bm="e-tile",wm="e-to-hsv",xm={default:["#000000","#f44336","#e91e63","#9c27b0","#673ab7","#2196f3","#03a9f4","#00bcd4","#009688","#ffeb3b","#ffffff","#ffebee","#fce4ec","#f3e5f5","#ede7f6","#e3f2fd","#e1f5fe","#e0f7fa","#e0f2f1","#fffde7","#f2f2f2","#ffcdd2","#f8bbd0","#e1bee7","#d1c4e9","#bbdefb","#b3e5fc","#b2ebf2","#b2dfdb","#fff9c4","#e6e6e6","#ef9a9a","#f48fb1","#ce93d8","#b39ddb","#90caf9","#81d4fa","#80deea","#80cbc4","#fff59d","#cccccc","#e57373","#f06292","#ba68c8","#9575cd","#64b5f6","#4fc3f7","#4dd0e1","#4db6ac","#fff176","#b3b3b3","#ef5350","#ec407a","#ab47bc","#7e57c2","#42a5f5","#29b6f6","#26c6da","#26a69a","#ffee58","#999999","#e53935","#d81b60","#8e24aa","#5e35b1","#1e88e5","#039be5","#00acc1","#00897b","#fdd835","#808080","#d32f2f","#c2185b","#7b1fa2","#512da8","#1976d2","#0288d1","#0097a7","#00796b","#fbc02d","#666666","#c62828","#ad1457","#6a1b9a","#4527a0","#1565c0","#0277bd","#00838f","#00695c","#f9a825","#4d4d4d","#b71c1c","#880e4f","#4a148c","#311b92","#0d47a1","#01579b","#006064","#004d40","#f57f17"]},Sm=function(t){function e(e,i){return t.call(this,e,i)||this}return lm(e,t),e.prototype.preRender=function(){var t={Apply:"Apply",Cancel:"Cancel",ModeSwitcher:"Switch Mode"};this.l10n=new Dl("colorpicker",t,this.locale)},e.prototype.render=function(){this.initWrapper(),this.inline?this.createWidget():this.createSplitBtn()},e.prototype.initWrapper=function(){var t=L("div",{className:"e-"+this.getModuleName()+"-wrapper"});this.element.parentNode.insertBefore(t,this.element),t.appendChild(this.element),R(this.element,{tabindex:"-1",spellcheck:"false"}),this.container=L("div",{className:"e-container"}),this.getWrapper().appendChild(this.container);var e=this.value;this.element.value=e.slice(0,7),"Picker"===this.mode&&(e=this.roundValue(e)),this.setProperties({value:e},!0),this.enableRtl&&t.classList.add("e-rtl"),this.cssClass&&E([t],this.cssClass.split(" ")),this.tileRipple=pt(this.container,{selector:"."+bm}),this.ctrlBtnRipple=pt(this.container,{selector:".e-btn"})},e.prototype.getWrapper=function(){return this.element.parentElement},e.prototype.createWidget=function(){"Palette"===this.mode?(this.createPalette(),this.inline||this.firstPaletteFocus()):(this.createPicker(),this.inline||this.getDragHandler().focus());var t=this.getWrapper();(this.isPicker()&&!t.classList.contains("e-hide-value")||t.classList.contains("e-show-value"))&&this.createInput(),this.createCtrlBtn(),this.disabled||this.wireEvents(),this.inline&&this.disabled&&this.toggleDisabled(!0),za.isDevice&&this.refreshPopupPos()},e.prototype.createSplitBtn=function(){var t=this,e=L("button",{className:"e-split-colorpicker"});this.getWrapper().appendChild(e),this.splitBtn=new hg({iconCss:"e-selected-color",target:this.container,disabled:this.disabled,enableRtl:this.enableRtl,beforeOpen:this.beforeOpenFn.bind(this),open:this.onOpen.bind(this),beforeClose:this.popupClose.bind(this),click:function(e){t.trigger("change",{currentValue:{hex:t.value.slice(0,7),rgba:t.convertToRgbString(t.hexToRgb(t.value))},previousValue:{hex:null,rgba:null}})}},e);var i=L("span",{className:"e-split-preview"});D(".e-selected-color",e).appendChild(i),i.style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value));var n=this.getPopupEle();if(E([n],"e-colorpicker-popup"),this.cssClass&&E([n],this.cssClass.split(" ")),za.isDevice){var o=this.getPopupInst();o.relateTo=document.body,o.position={X:"center",Y:"center"},o.targetType="container",o.collision={X:"fit",Y:"fit"},o.offsetY=4}},e.prototype.onOpen=function(t){this.trigger("open",{element:this.container})},e.prototype.getPopupInst=function(){return w(this.getPopupEle(),Xc)},e.prototype.beforeOpenFn=function(t){var e={element:this.container,event:t.event,cancel:!1};if(this.trigger("beforeOpen",e),t.cancel=e.cancel,!e.cancel){var i=this.getPopupEle();i.style.display="block",this.createWidget(),i.style.display="",za.isDevice&&(this.modal=L("div"),this.modal.className="e-"+this.getModuleName()+" e-modal",this.modal.style.display="none",document.body.insertBefore(this.modal,i),document.body.className+=" e-colorpicker-overflow",this.modal.style.display="block")}},e.prototype.popupClose=function(t){var e={element:this.container,event:t.event,cancel:!1};this.trigger("beforeClose",e),t.cancel=e.cancel,e.cancel||(t.event&&za.isDevice&&t.event.target===this.modal?t.cancel=!0:(this.unWireEvents(),this.destroyOtherComp(),this.container.style.width="",D(".e-split-preview",this.splitBtn.element).style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value)),this.container.innerHTML="",P([this.container],["e-color-picker","e-color-palette"]),za.isDevice&&this.modal&&(P([document.body],"e-colorpicker-overflow"),this.modal.style.display="none",this.modal.outerHTML="",this.modal=null)))},e.prototype.createPalette=function(){if(V(this.container,["e-color-palette"],["e-color-picker"]),this.presetColors){var t=L("div",{className:"e-custom-palette"});this.appendElement(t);var e=Object.keys(this.presetColors);if(1===e.length)this.appendPalette(this.presetColors[e[0]],e[0],t);else for(var i=0,n=e.length;i<n;i++)this.appendPalette(this.presetColors[e[i]],e[i],t);B(".e-row",t).length>10&&E([t],"e-palette-group")}else this.appendPalette(xm.default,"default");"Palette"===this.mode&&!this.modeSwitcher&&this.noColor&&this.setNoColor();var o=parseInt(getComputedStyle(this.container).borderBottomWidth,10);this.container.style.width=b(this.container.children[0].offsetWidth+o+o),this.rgb=this.hexToRgb(this.roundValue(this.value)),this.hsv=this.rgbToHsv.apply(this,this.rgb)},e.prototype.firstPaletteFocus=function(){D("."+ym,this.container.children[0])||B(".e-palette",this.container)[0].focus()},e.prototype.appendPalette=function(t,e,i){var n=L("div",{className:"e-palette",attrs:{tabindex:"0"}});i?i.appendChild(n):this.appendElement(n);for(var o,r,s=0,a=t.length;s<a;s++)0!==s&&s%this.columns!=0||(o=L("div",{className:"e-row",attrs:{role:"row"}}),n.appendChild(o)),r=L("span",{className:bm,attrs:{role:"gridcell","aria-label":t[s],"aria-selected":"false"}}),this.trigger("beforeTileRender",{element:r,presetName:e,value:t[s]}),o.appendChild(r),this.value.slice(0,t[s].length).toLowerCase()===t[s].toLowerCase()&&(this.addTileSelection(r),n.focus()),r.style.backgroundColor=t[s]},e.prototype.setNoColor=function(){var t=B(".e-row")[0].children[0];t.classList.add(fm),this.value||(t.classList.add(ym),N(t,".e-palette").focus()),["aria-selected","aria-label"].forEach(function(e){t.removeAttribute(e)}),t.style.backgroundColor=""},e.prototype.appendElement=function(t,e){void 0===e&&(e=0);var i=this.container.children[e];i?this.container.insertBefore(t,i):this.container.appendChild(t)},e.prototype.addTileSelection=function(t){t.classList.add(ym),t.setAttribute("aria-selected","true")},e.prototype.createPicker=function(){V(this.container,["e-color-picker"],["e-color-palette"]);var t=L("div",{className:"e-hsv-container"});this.appendElement(t),t.appendChild(L("div",{className:um}));var e=L("span",{className:"e-handler",attrs:{tabindex:"0"}});t.appendChild(e),this.rgb=this.hexToRgb(this.value),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.setHsvContainerBg(),this.setHandlerPosition(),this.createSlider(),this.createDragTooltip()},e.prototype.setHsvContainerBg=function(t){void 0===t&&(t=this.hsv[0]),this.getHsvContainer().style.backgroundColor=this.convertToRgbString(this.hsvToRgb(t,100,100,1))},e.prototype.getHsvContainer=function(){return D(".e-hsv-container",this.container)},e.prototype.setHandlerPosition=function(){var t=this.getDragHandler(),e=D("."+um,this.container);this.enableRtl?t.style.left=b(e.offsetWidth*Math.abs(100-this.hsv[1])/100):t.style.left=b(e.offsetWidth*this.hsv[1]/100),t.style.top=b(e.offsetHeight*(100-this.hsv[2])/100)},e.prototype.createSlider=function(){var t=L("div",{className:"e-slider-preview"});this.appendElement(t,1),this.createPreview(t);var e=L("div",{className:"e-colorpicker-slider"});t.insertBefore(e,t.children[0]);var i=L("div",{className:"e-hue-slider"});e.appendChild(i),this.hueSlider=new Dg({value:this.hsv[0],min:0,max:359,enableRtl:this.enableRtl,enabled:!this.disabled,change:this.hueChange.bind(this)},i),i=L("div",{className:"e-opacity-slider"}),e.appendChild(i),this.opacitySlider=new Dg({value:100*this.rgb[3],min:0,max:100,enableRtl:this.enableRtl,enabled:!this.disabled,change:this.opacityChange.bind(this)},i);var n=L("div",{className:"e-opacity-empty-track"});i.appendChild(n),this.updateOpacitySliderBg()},e.prototype.updateOpacitySliderBg=function(){var t=this.enableRtl?"to left":"to right";D(".e-slider-track",this.opacitySlider.element).style.background="linear-gradient("+t+", rgba("+this.rgb.slice(0,3)+", 0) 0%, "+this.convertToRgbString(this.rgb.slice(0,3))+" 100%)"},e.prototype.hueChange=function(t){this.hsv[0]=t.value,this.setHsvContainerBg(),this.convertToOtherFormat()},e.prototype.opacityChange=function(t){var e=t.value,i=this.rgbToHex(this.rgb);this.hsv[3]=e/100,this.rgb[3]=e/100;var n=this.rgbToHex(this.rgb);this.getWrapper().classList.contains("e-hide-value")||(w(D(".e-opacity-value",this.container),fg).value=e);var o=this.convertToRgbString(this.rgb);this.updatePreview(o),this.triggerEvent(n,i,o)},e.prototype.createPreview=function(t){var e=L("div",{className:vm});t.appendChild(e);var i=L("span",{className:"e-preview e-current"});e.appendChild(i);var n=this.convertToRgbString(this.rgb);i.style.backgroundColor=n,i=L("span",{className:"e-preview e-previous"}),e.appendChild(i),i.style.backgroundColor=n},e.prototype.isPicker=function(){return!this.container.classList.contains("e-color-palette")},e.prototype.getPopupEle=function(){return this.container.parentElement},e.prototype.getNumericTextBoxModel=function(t,e,i){var n=this;return{value:t,placeholder:e,min:0,max:i,format:"###.##",showSpinButton:!1,floatLabelType:"Always",enableRtl:this.enableRtl,enabled:!this.disabled,readonly:!this.isPicker(),change:function(t){t.event&&n.inputHandler(t.event)}}},e.prototype.createInput=function(t){void 0===t&&(t=2);var e=L("div",{className:gm});this.appendElement(e,t);var i=L("div",{className:"e-input-container"});e.appendChild(i),e.appendChild(L("button",{className:"e-icons e-btn e-flat e-icon-btn "+dm+" "+wm}));var n=L("input",{className:pm,attrs:{maxlength:"7",spellcheck:"false"}});this.isPicker()||Wu.setReadonly(!0,n),i.appendChild(n),Wu.createInput({element:n,floatLabelType:"Always",properties:{placeholder:"HEX",enableRtl:this.enableRtl,enabled:!this.disabled}}),Wu.setValue(this.value.slice(0,7),n);for(var o=["rh","gs","bv"],r=0;r<3;r++)new fg(this.getNumericTextBoxModel(this.rgb[r],"RGB"[r],255),i.appendChild(L("input",{className:"e-"+o[r]+"-value"})));new fg(this.getNumericTextBoxModel(100*this.rgb[3],"A",100),i.appendChild(L("input",{className:"e-opacity-value"})))},e.prototype.createCtrlBtn=function(){if(this.modeSwitcher||this.showButtons){this.l10n.setLocale(this.locale);var t=L("div",{className:cm});if(this.container.appendChild(t),this.showButtons){var e=L("div",{className:"e-ctrl-btn"});t.appendChild(e);var i=this.l10n.getConstant("Apply");e.appendChild(L("button",{innerHTML:i,className:"e-btn e-flat e-primary e-small e-apply",attrs:{title:i}}));var n=this.l10n.getConstant("Cancel");e.appendChild(L("button",{innerHTML:n,className:"e-btn e-flat e-small e-cancel",attrs:{title:n}}))}this.modeSwitcher&&this.appendModeSwitchBtn()}},e.prototype.appendModeSwitchBtn=function(){var t=L("button",{className:"e-icons e-btn e-flat e-icon-btn "+mm,attrs:{title:this.l10n.getConstant("ModeSwitcher")}});D("."+cm,this.container).insertBefore(t,D(".e-ctrl-btn",this.container))},e.prototype.createDragTooltip=function(){var t=this,e=new id({opensOn:"Custom",showTipPointer:!1,cssClass:"e-color-picker-tooltip",beforeOpen:function(e){t.tooltipEle=e.element},animation:{open:{effect:"None"},close:{effect:"None"}}});e.appendTo(this.container),e.open(this.container),this.tooltipEle.style.zIndex=Qi(this.tooltipEle).toString(),D(".e-tip-content",this.tooltipEle).appendChild(L("div",{className:"e-tip-transparent"}))},e.prototype.getTooltipInst=function(){return w(this.container,id)},e.prototype.setTooltipOffset=function(t){this.getTooltipInst().offsetY=t},e.prototype.toggleDisabled=function(t){t?this.getWrapper().classList.add("e-disabled"):this.getWrapper().classList.remove("e-disabled"),this.showButtons&&[].slice.call(B(".e-btn",this.container)).forEach(function(e){t?R(e,{disabled:""}):e.removeAttribute("disabled")})},e.prototype.convertToRgbString=function(t){return t.length?4===t.length?"rgba("+t.join()+")":"rgb("+t.join()+")":""},e.prototype.convertToHsvString=function(t){return 4===t.length?"hsva("+t.join()+")":"hsv("+t.join()+")"},e.prototype.updateHsv=function(){this.hsv[1]=this.hsv[1]>100?100:this.hsv[1],this.hsv[2]=this.hsv[2]>100?100:this.hsv[2],this.setHandlerPosition()},e.prototype.convertToOtherFormat=function(t){void 0===t&&(t=!1);var e=this.rgbToHex(this.rgb);this.rgb=this.hsvToRgb.apply(this,this.hsv);var i=this.rgbToHex(this.rgb),n=this.convertToRgbString(this.rgb);this.updatePreview(n),this.updateInput(i),this.triggerEvent(i,e,n,t)},e.prototype.updateInput=function(t){this.getWrapper().classList.contains("e-hide-value")||(Wu.setValue(t.substr(0,7),D("."+pm,this.container)),D("."+dm,this.container).classList.contains(wm)?this.updateValue(this.rgb,!1):this.updateValue(this.hsv,!1))},e.prototype.updatePreview=function(t){this.updateOpacitySliderBg(),D(".e-tip-transparent",this.tooltipEle).style.backgroundColor=t,D("."+vm+" .e-current",this.container).style.backgroundColor=t,D("."+vm+" .e-previous",this.container).style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value))},e.prototype.getDragHandler=function(){return D(".e-handler",this.container)},e.prototype.removeTileSelection=function(){[].slice.call(B("."+ym,this.container.children[0])).forEach(function(t){t.classList.remove(ym),t.setAttribute("aria-selected","false")})},e.prototype.convertRgbToNumberArray=function(t){return t.slice(t.indexOf("(")+1,t.indexOf(")")).split(",").map(function(t,e){return 3!==e?parseInt(t,10):parseFloat(t)})},e.prototype.getValue=function(t,e){if(t||(t=this.value),e=e?e.toLowerCase():"hex","r"===t[0]){i=this.convertRgbToNumberArray(t);if("hex"===e||"hexa"===e){n=this.rgbToHex(i);return"hex"===e?n.slice(0,7):n}return"hsv"===e?this.convertToHsvString(this.rgbToHsv.apply(this,i.slice(0,3))):"hsva"===e?this.convertToHsvString(this.rgbToHsv.apply(this,i)):"null"}if("h"===t[0]){var i=this.hsvToRgb.apply(this,this.convertRgbToNumberArray(t));if("rgba"===e)return this.convertToRgbString(i);if("hex"===e||"hexa"===e){var n=this.rgbToHex(i);return"hex"===e?n.slice(0,7):n}return"rgb"===e?this.convertToRgbString(i.slice(0,3)):"null"}t=this.roundValue(t);var o=this.hexToRgb(t);return"rgb"!==e&&"hsv"!==e||(o=o.slice(0,3)),"rgba"===e||"rgb"===e?this.convertToRgbString(o):"hsva"===e||"hsv"===e?this.convertToHsvString(this.rgbToHsv.apply(this,o)):"hex"===e?t.slice(0,7):"a"===e?o[3].toString():"null"},e.prototype.toggle=function(){this.splitBtn.toggle()},e.prototype.getModuleName=function(){return"colorpicker"},e.prototype.getPersistData=function(){return this.addOnPersist(["value"])},e.prototype.wireEvents=function(){if(this.isPicker()){var t=this.getDragHandler();Ma.add(t,"keydown",this.pickerKeyDown,this),Ma.add(this.getHsvContainer(),"mousedown touchstart",this.handlerDown,this),(this.modeSwitcher||this.showButtons)&&this.addCtrlSwitchEvent(),this.getWrapper().classList.contains("e-hide-value")||this.addvalueEventHandler(),Ma.add(D(".e-previous",this.container),"click",this.previewHandler,this)}else Ma.add(this.container,"click",this.paletteClickHandler,this),Ma.add(this.container,"keydown",this.paletteKeyDown,this)},e.prototype.addCtrlSwitchEvent=function(){Ma.add(D("."+cm,this.container),"click",this.btnClickHandler,this)},e.prototype.addInputEvent=function(){Ma.add(D("."+pm,this.container),"input",this.inputHandler,this)},e.prototype.addvalueEventHandler=function(){this.addInputEvent(),Ma.add(D("."+dm,this.container),"click",this.formatSwitchHandler,this)},e.prototype.pickerKeyDown=function(t){switch(t.keyCode){case 39:this.handlerDragPosition(1,this.enableRtl?-1:1,t);break;case 37:this.handlerDragPosition(1,this.enableRtl?1:-1,t);break;case 38:this.handlerDragPosition(2,1,t);break;case 40:this.handlerDragPosition(2,-1,t);break;case 13:t.preventDefault();var e=this.rgbToHex(this.rgb);this.enterKeyHandler(e)}},e.prototype.enterKeyHandler=function(t){this.triggerChangeEvent(t),this.inline||(this.toggle(),this.splitBtn.element.focus())},e.prototype.triggerChangeEvent=function(t){var e=t.slice(0,7);this.trigger("change",{currentValue:{hex:e,rgba:this.convertToRgbString(this.rgb)},previousValue:{hex:this.value.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(this.value))}}),this.setProperties({value:t},!0),this.element.value=e||"#000000"},e.prototype.handlerDragPosition=function(t,e,i){i.preventDefault(),this.hsv[t]+=e*(i.ctrlKey?1:3),this.hsv[t]<0&&(this.hsv[t]=0),this.updateHsv(),this.convertToOtherFormat(!0)},e.prototype.handlerDown=function(t){"touchstart"!==t.type&&t.preventDefault(),"mousedown"===t.type?(this.clientX=Math.abs(t.pageX-pageXOffset),this.clientY=Math.abs(t.pageY-pageYOffset),this.setTooltipOffset(8)):(this.clientX=Math.abs(t.changedTouches[0].pageX-pageXOffset),this.clientY=Math.abs(t.changedTouches[0].pageY-pageYOffset),this.setTooltipOffset(-8)),this.setHsv(this.clientX,this.clientY),this.getDragHandler().style.transition="left .4s cubic-bezier(.25, .8, .25, 1), top .4s cubic-bezier(.25, .8, .25, 1)",this.updateHsv(),this.convertToOtherFormat(),this.getDragHandler().focus(),Ma.add(document,"mousemove touchmove",this.handlerMove,this),Ma.add(document,"mouseup touchend",this.handlerEnd,this)},e.prototype.handlerMove=function(t){"touchmove"!==t.type&&t.preventDefault();var e,i;"mousemove"===t.type?(e=Math.abs(t.pageX-pageXOffset),i=Math.abs(t.pageY-pageYOffset)):(e=Math.abs(t.changedTouches[0].pageX-pageXOffset),i=Math.abs(t.changedTouches[0].pageY-pageYOffset)),this.setHsv(e,i);var n=this.getDragHandler();parseInt(n.style.left,10),parseInt(n.style.top,10);this.updateHsv(),this.convertToOtherFormat(),this.getTooltipInst().refresh(n),this.tooltipEle.style.transform||(Math.abs(this.clientX-e)>8||Math.abs(this.clientY-i)>8)&&(D("."+um,this.container).style.cursor="pointer",n.style.transition="none",this.inline||(this.tooltipEle.style.zIndex=(parseInt(this.getPopupEle().style.zIndex,10)+1).toString()),this.tooltipEle.style.transform="rotate(45deg)",n.classList.add("e-hide-handler"))},e.prototype.setHsv=function(t,e){var i=D("."+um,this.container),n=i.getBoundingClientRect();t=this.enableRtl?t>n.right?0:Math.abs(t-n.right):t>n.left?Math.abs(t-n.left):0,e=e>n.top?Math.abs(e-n.top):0,this.hsv[2]=Math.round(10*Number(100*(i.offsetHeight-Math.max(0,Math.min(i.offsetHeight,e-i.offsetTop)))/i.offsetHeight))/10,this.hsv[1]=Math.round(10*Number(100*Math.max(0,Math.min(i.offsetWidth,t-i.offsetLeft))/i.offsetWidth))/10},e.prototype.handlerEnd=function(t){"touchend"!==t.type&&t.preventDefault(),Ma.remove(document,"mousemove touchmove",this.handlerMove),Ma.remove(document,"mouseup touchend",this.handlerEnd);var e=this.getDragHandler();D("."+um,this.container).style.cursor="",this.tooltipEle.style.transform&&(this.tooltipEle.style.transform="",e.classList.remove("e-hide-handler")),this.inline||this.showButtons||this.toggle()},e.prototype.btnClickHandler=function(t){var e=t.target;N(e,"."+mm)?(t.stopPropagation(),this.switchToPalette()):(e.classList.contains("e-apply")||e.classList.contains("e-cancel"))&&this.ctrlBtnClick(e)},e.prototype.switchToPalette=function(){this.trigger("beforeModeSwitch",{element:this.container,mode:"Palette"}),this.unWireEvents(),this.destroyOtherComp(),A(D(".e-slider-preview",this.container)),this.getWrapper().classList.contains("e-hide-value")||A(D("."+gm,this.container)),A(this.getHsvContainer()),this.createPalette(),this.firstPaletteFocus(),this.getWrapper().classList.contains("e-show-value")&&this.createInput(1),this.refreshPopupPos(),this.wireEvents()},e.prototype.refreshPopupPos=function(){if(!this.inline){var t=this.getPopupEle();t.style.left="0px",t.style.top="0px",this.getPopupInst().refreshPosition(this.splitBtn.element.parentElement)}},e.prototype.formatSwitchHandler=function(t){var e=t.target;e.classList.contains(wm)?(this.updateValue(this.hsv,!0,3,[360,100,100]),e.classList.remove(wm)):(this.updateValue(this.rgb,!0,2),e.classList.add(wm))},e.prototype.updateValue=function(t,e,i,n){for(var o,r=["e-rh-value","e-gs-value","e-bv-value"],s=0,a=r.length;s<a;s++)(o=w(D("."+r[s],this.container),fg)).value=Math.round(t[s]),e&&(o.placeholder=r[s].substr(i,1).toUpperCase(),o.max=n?n[s]:255),o.dataBind()},e.prototype.previewHandler=function(t){var e=t.target,i=this.rgbToHex(this.rgb);this.rgb=this.convertRgbToNumberArray(e.style.backgroundColor),this.rgb[3]||(this.rgb[3]=1);var n=this.rgbToHex(this.rgb),o=this.rgbToHsv.apply(this,this.rgb);o[0]!==this.hsv[0]&&(this.hueSlider.setProperties({value:o[0]},!0),this.hueSlider.refresh()),this.setHsvContainerBg(o[0]),o[3]!==this.hsv[3]&&(this.opacitySlider.setProperties({value:100*o[3]},!0),this.opacitySlider.refresh()),this.updateOpacitySliderBg(),this.hsv=o,this.setHandlerPosition(),this.updateInput(n),D("."+vm+" .e-current",this.container).style.backgroundColor=this.convertToRgbString(this.rgb),this.triggerEvent(n,i,this.convertToRgbString(this.rgb))},e.prototype.paletteClickHandler=function(t){t.preventDefault();var e=t.target;if(e.classList.contains(bm)){if(this.removeTileSelection(),this.addTileSelection(e),e.classList.contains(fm))this.noColorTile();else{var i=e.getAttribute("aria-label"),n=this.rgbToHex(this.rgb);this.rgb=this.hexToRgb(this.roundValue(i)),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.getWrapper().classList.contains("e-show-value")&&this.updateInput(i),this.triggerEvent(i,n,this.convertToRgbString(this.rgb))}this.inline||this.showButtons||this.toggle()}else N(e,"."+mm)?this.switchToPicker():e.classList.contains("e-apply")||e.classList.contains("e-cancel")?this.ctrlBtnClick(e):this.getWrapper().classList.contains("e-show-value")&&N(e,"."+dm)&&this.formatSwitchHandler(t)},e.prototype.noColorTile=function(t){void 0===t&&(t=!1);var e=this.rgbToHex(this.rgb);this.rgb=[],this.hsv=[],this.triggerEvent("",e,"",t)},e.prototype.switchToPicker=function(){var t=this.getWrapper();this.trigger("beforeModeSwitch",{element:this.container,mode:"Picker"}),this.unWireEvents(),[].slice.call(B(".e-palette",this.container)).forEach(function(t){A(t)}),t.classList.contains("e-show-value")&&A(D("."+gm,this.container)),this.container.style.width="";var e=D(".e-custom-palette",this.container);this.presetColors&&M(e),this.createPicker(),this.getDragHandler().focus(),t.classList.contains("e-hide-value")||this.createInput(),this.refreshPopupPos(),this.wireEvents()},e.prototype.ctrlBtnClick=function(t){if(t.classList.contains("e-apply")){var e=this.rgbToHex(this.rgb);this.triggerChangeEvent(e)}this.inline||(this.toggle(),this.splitBtn.element.focus())},e.prototype.paletteKeyDown=function(t){var e=t.target;if(e.classList.contains("e-palette")){var i,n,o=[].slice.call(B("."+bm,e)),r=o.filter(function(t){return t.classList.contains("e-selected")}).pop();switch(!t.altKey&&t.keyCode){case 39:t.preventDefault(),i=r?o[this.tilePosition(o,r,this.enableRtl?-1:1)]:o[this.enableRtl?o.length-1:0],this.keySelectionChanges(i);break;case 37:t.preventDefault(),i=r?o[this.tilePosition(o,r,this.enableRtl?1:-1)]:o[this.enableRtl?0:o.length-1],this.keySelectionChanges(i);break;case 38:t.preventDefault(),i=o[n=r?this.tilePosition(o,r,-this.columns):0]?o[n]:o[n-this.columns],this.keySelectionChanges(i);break;case 40:t.preventDefault(),o[n=r?this.tilePosition(o,r,this.columns):o.length-1]?i=o[n]:(n%=o.length,i=o[n+=o[o.length-1].parentElement.childElementCount]),this.keySelectionChanges(i);break;case 13:if(t.preventDefault(),r){var s=r.getAttribute("aria-label");this.enterKeyHandler(s||"")}}}},e.prototype.keySelectionChanges=function(t){if(this.removeTileSelection(),this.addTileSelection(t),t.classList.contains(fm))this.noColorTile(!0);else{var e=t.getAttribute("aria-label"),i=this.rgbToHex(this.rgb);this.rgb=this.hexToRgb(e),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.getWrapper().classList.contains("e-show-value")&&this.updateInput(e),this.triggerEvent(e,i,this.convertToRgbString(this.rgb),!0)}},e.prototype.tilePosition=function(t,e,i){var n=(t=Array.prototype.slice.call(t)).length,o=this.columns-t[n-1].parentElement.childElementCount,r=t.indexOf(e);return r+=i,r<0?r+=n+o:r%=n+o,r},e.prototype.inputHandler=function(t){var e=t.target;if(e.value.length){var i,n;switch(D(".e-float-text",e.parentElement).textContent){case"HEX":var o="";if(("#"===e.value[0]&&5!==e.value.length||"#"!==e.value[0]&&4!==e.value.length)&&(o=this.roundValue(e.value)),9!==o.length)return;n=this.rgbToHex(this.rgb),this.rgb=this.hexToRgb(o+o.substr(-2)),this.inputValueChange(this.rgbToHsv.apply(this,this.rgb),n,e.value);break;case"R":this.rgb[0]!==Number(e.value)&&(n=this.rgbToHex(this.rgb),this.rgb[0]=Number(e.value),i=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(i,n));break;case"G":this.rgb[1]!==Number(e.value)&&(n=this.rgbToHex(this.rgb),this.rgb[1]=Number(e.value),i=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(i,n));break;case"B":this.rgb[2]!==Number(e.value)&&(n=this.rgbToHex(this.rgb),this.rgb[2]=Number(e.value),i=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(i,n));break;case"H":this.hueSlider.value=Number(e.value);break;case"S":this.hsv[1]!==Number(e.value)&&(this.hsv[1]=Number(e.value),this.updateHsv(),this.convertToOtherFormat());break;case"V":this.hsv[2]!==Number(e.value)&&(this.hsv[2]=Number(e.value),this.updateHsv(),this.convertToOtherFormat());break;case"A":this.opacitySlider.value=Number(e.value)}}},e.prototype.inputValueChange=function(t,e,i){t[0]!==this.hsv[0]&&(this.hueSlider.setProperties({value:t[0]},!0),this.hueSlider.refresh(),this.setHsvContainerBg(t[0])),this.hsv=t;var n=this.rgbToHex(this.rgb);this.setHandlerPosition(),this.updateInput(i||n);var o=this.convertToRgbString(this.rgb);this.updatePreview(o),this.triggerEvent(n,e,o)},e.prototype.triggerEvent=function(t,e,i,n){void 0===n&&(n=!1);var o=t.slice(0,7),r={currentValue:{hex:o,rgba:i},previousValue:{hex:e.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(e))}};this.showButtons||n?this.trigger("select",r):(r.previousValue={hex:this.value.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(this.value))},this.trigger("change",r),this.setProperties({value:t},!0),this.element.value=o||"#000000")},e.prototype.destroy=function(){var e=this,i=this.getWrapper();t.prototype.destroy.call(this),["tabindex","spellcheck"].forEach(function(t){e.element.removeAttribute(t)}),this.inline?(this.unWireEvents(),this.destroyOtherComp()):(this.isPopupOpen()&&(this.unWireEvents(),this.destroyOtherComp()),this.splitBtn.destroy(),this.splitBtn=null),this.tileRipple(),this.tileRipple=null,this.ctrlBtnRipple(),this.ctrlBtnRipple=null,A(this.element.nextElementSibling),i.parentElement.insertBefore(this.element,i),A(i),this.container=null},e.prototype.destroyOtherComp=function(){if(this.isPicker()){this.hueSlider.destroy(),this.opacitySlider.destroy(),this.hueSlider=null,this.opacitySlider=null;var t=this.getTooltipInst();t.close(),t.destroy(),this.tooltipEle=null}},e.prototype.isPopupOpen=function(){return this.getPopupEle().classList.contains("e-popup-open")},e.prototype.unWireEvents=function(){if(this.isPicker()){var t=this.getDragHandler();Ma.remove(t,"keydown",this.pickerKeyDown),Ma.remove(this.getHsvContainer(),"mousedown touchstart",this.handlerDown),(this.modeSwitcher||this.showButtons)&&Ma.remove(D("."+cm,this.container),"click",this.btnClickHandler),this.getWrapper().classList.contains("e-hide-value")||(Ma.remove(D("."+dm,this.container),"click",this.formatSwitchHandler),Ma.remove(D("."+pm,this.container),"input",this.inputHandler)),Ma.remove(D(".e-previous",this.container),"click",this.previewHandler)}else Ma.remove(this.container,"click",this.paletteClickHandler),Ma.remove(this.container,"keydown",this.paletteKeyDown)},e.prototype.roundValue=function(t){if(!t)return"";"#"!==t[0]&&(t="#"+t);var e=t.length;if(4===e&&(t+="f",e=5),5===e){for(var i="",n=1,o=t.length;n<o;n++)i+=t.charAt(n)+t.charAt(n);t="#"+i,e=9}return 7===e&&(t+="ff"),t},e.prototype.hexToRgb=function(t){if(!t)return[];9!==(t=t.trim()).length&&(t=this.roundValue(t));var e=Number((parseInt(t.slice(-2),16)/255).toFixed(2));t=t.slice(1,7);var i=parseInt(t,16),n=[];return n.push(i>>16&255),n.push(i>>8&255),n.push(255&i),n.push(e),n},e.prototype.rgbToHsv=function(t,e,i,n){if(this.rgb&&!this.rgb.length)return[];t/=255,e/=255,i/=255;var o,r,s=Math.max(t,e,i),a=Math.min(t,e,i),l=s,h=s-a;if(r=0===s?0:h/s,s===a)o=0;else{switch(s){case t:o=(e-i)/h+(e<i?6:0);break;case e:o=(i-t)/h+2;break;case i:o=(t-e)/h+4}o/=6}var d=[Math.round(360*o),Math.round(1e3*r)/10,Math.round(1e3*l)/10];return c(n)||d.push(n),d},e.prototype.hsvToRgb=function(t,e,i,n){var o,r,s,a,l,h,d,p;if(e/=100,i/=100,0===e)return o=r=s=i,[Math.round(255*o),Math.round(255*r),Math.round(255*s),n];switch(t/=60,a=Math.floor(t),l=t-a,h=i*(1-e),d=i*(1-e*l),p=i*(1-e*(1-l)),a){case 0:o=i,r=p,s=h;break;case 1:o=d,r=i,s=h;break;case 2:o=h,r=i,s=p;break;case 3:o=h,r=d,s=i;break;case 4:o=p,r=h,s=i;break;default:o=i,r=h,s=d}var u=[Math.round(255*o),Math.round(255*r),Math.round(255*s)];return c(n)||u.push(n),u},e.prototype.rgbToHex=function(t){return t.length?"#"+this.hex(t[0])+this.hex(t[1])+this.hex(t[2])+(c(t[3])?"":0!==t[3]?(Math.round(255*t[3])+65536).toString(16).substr(-2):"00"):""},e.prototype.hex=function(t){return("0"+t.toString(16)).slice(-2)},e.prototype.changeModeSwitcherProp=function(t){var e=D("."+cm,this.container);t?e?this.appendModeSwitchBtn():(this.createCtrlBtn(),this.isPicker()&&!this.disabled&&this.addCtrlSwitchEvent()):e&&(this.showButtons?A(D("."+mm,e)):M(e))},e.prototype.changeShowBtnProps=function(t){var e=D("."+cm,this.container);t?(e&&M(e),this.createCtrlBtn(),this.isPicker()&&!this.disabled&&this.addCtrlSwitchEvent()):this.modeSwitcher?A(D(".e-ctrl-btn",e)):M(e)},e.prototype.changeValueProp=function(t){this.isPicker()?(this.rgb=this.hexToRgb(t),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.setHandlerPosition(),A(N(this.hueSlider.element,".e-slider-preview")),this.createSlider(),this.setHsvContainerBg(),this.updateOpacitySliderBg(),this.updateInput(t)):(this.removeTileSelection(),this.addTileSelection(D('span[aria-label="'+t+'"]',this.container))),this.element.value=t.slice(0,7)},e.prototype.setInputEleProps=function(t){M(D("."+gm,this.container)),this.createInput()},e.prototype.changeDisabledProp=function(t){this.isPicker()&&(this.hueSlider.enabled=!t,this.opacitySlider.enabled=!t,this.setInputEleProps(t)),t?(this.toggleDisabled(!0),this.unWireEvents()):(this.toggleDisabled(!1),this.wireEvents())},e.prototype.changeCssClassProps=function(t,e){var i=this.getWrapper(),n=this.getPopupEle();e&&P([i,n],e.split(" ")),t&&E([i,n],t.split(" "))},e.prototype.changeRtlProps=function(t){t?E([this.getWrapper()],"e-rtl"):P([this.getWrapper()],"e-rtl")},e.prototype.changePaletteProps=function(){A(this.container.children[0]),this.container.style.width="",this.createPalette()},e.prototype.onPropertyChanged=function(t,e){var i=this,n=this.getWrapper();if(!this.inline&&c(t.inline)){var o=["disabled","enableRtl"];if(this.splitBtn.setProperties(Ns(t,o)),!this.isPopupOpen())return t.value&&(D(".e-split-preview",this.splitBtn.element).style.backgroundColor=t.value),this.changeCssClassProps(t.cssClass,e.cssClass),void this.changeRtlProps(t.enableRtl)}for(var r=0,s=Object.keys(t);r<s.length;r++)switch(s[r]){case"inline":t.inline?(this.getWrapper().appendChild(this.container),this.splitBtn.destroy(),A(this.element.nextElementSibling),this.container.children.length||this.createWidget()):(this.destroyOtherComp(),this.unWireEvents(),this.container.innerHTML="",this.createSplitBtn());break;case"cssClass":this.isPicker()?(n.classList.contains("e-hide-value")&&(this.createInput(),this.addvalueEventHandler()),t.cssClass.split(" ").forEach(function(t){"e-hide-value"===t&&M(D("."+gm,i.container))})):(n.classList.contains("e-show-value")&&M(D("."+gm,this.container)),t.cssClass.split(" ").forEach(function(t){"e-show-value"===t&&(i.createInput(1),i.addInputEvent())})),this.changeCssClassProps(t.cssClass,e.cssClass);break;case"enableRtl":this.isPicker()&&(this.hueSlider.enableRtl=t.enableRtl,this.opacitySlider.enableRtl=t.enableRtl,this.setInputEleProps(t.enableRtl)),this.changeRtlProps(t.enableRtl);break;case"disabled":this.changeDisabledProp(t.disabled);break;case"value":this.changeValueProp(t.value);break;case"showButtons":this.changeShowBtnProps(t.showButtons);break;case"mode":"Picker"===t.mode?this.switchToPicker():this.switchToPalette();break;case"modeSwitcher":this.changeModeSwitcherProp(t.modeSwitcher);break;case"columns":case"presetColors":this.isPicker()||this.changePaletteProps();break;case"noColor":t.noColor?"Palette"!==this.mode||this.modeSwitcher||this.setNoColor():this.changePaletteProps()}},hm([et("#008000")],e.prototype,"value",void 0),hm([et("")],e.prototype,"cssClass",void 0),hm([et(!1)],e.prototype,"disabled",void 0),hm([et(!1)],e.prototype,"enableRtl",void 0),hm([et("Picker")],e.prototype,"mode",void 0),hm([et(!0)],e.prototype,"modeSwitcher",void 0),hm([et(null)],e.prototype,"presetColors",void 0),hm([et(!0)],e.prototype,"showButtons",void 0),hm([et(10)],e.prototype,"columns",void 0),hm([et(!1)],e.prototype,"inline",void 0),hm([et(!1)],e.prototype,"noColor",void 0),hm([et(!1)],e.prototype,"enablePersistence",void 0),hm([st()],e.prototype,"select",void 0),hm([st()],e.prototype,"change",void 0),hm([st()],e.prototype,"beforeTileRender",void 0),hm([st()],e.prototype,"beforeOpen",void 0),hm([st()],e.prototype,"open",void 0),hm([st()],e.prototype,"beforeClose",void 0),hm([st()],e.prototype,"beforeModeSwitch",void 0),e=hm([at],e)}(wl),Cm=Object.freeze({NumericTextBox:fg,regularExpressions:Cg,createMask:Hs,applyMask:zs,wireEvents:js,unwireEvents:Vs,bindClearEvent:Fs,unstrippedValue:Us,strippedValue:qs,maskInputFocusHandler:Ys,maskInputBlurHandler:Gs,maskInputDropHandler:Qs,mobileRemoveFunction:ta,setMaskValue:ua,setElementValue:ga,maskInput:ma,getVal:va,getMaskedVal:ya,MaskUndo:Lg,MaskedTextBox:kg,get Input(){return Wu},TicksData:Ig,LimitData:Ag,TooltipData:Mg,Slider:Dg,get ErrorOption(){return dg},FormValidator:Wg,FilesProp:om,ButtonsProps:rm,AsyncSettings:sm,Uploader:am,ColorPicker:Sm}),Lm=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Em=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Pm=function(t){function e(e,i){return t.call(this,e,i)||this}return Lm(e,t),e.prototype.preRender=function(){this.browser=za.info.name,this.browserCheck="mozilla"===this.browser,this.isDevice=za.isDevice;var t=this.element;this.ieCheck="edge"===this.browser||"msie"===this.browser,this.initialize(),""===t.id&&(t.id=p("hscroll"),this.uniqueId=!0),t.style.display="block",this.enableRtl&&t.classList.add("e-rtl")},e.prototype.render=function(){this.touchModule=new Vl(this.element,{scroll:this.touchHandler.bind(this)}),this.isDevice?this.element.classList.add("e-scroll-device"):(this.createNavIcon(this.element),Ma.add(this.scrollEle,"scroll",this.scrollHandler,this))},e.prototype.initialize=function(){var t=L("div",{className:"e-hscroll-content"}),e=L("div",{className:"e-hscroll-bar"});e.setAttribute("tabindex","-1");for(var i=this.element,n=0,o=[].slice.call(i.children);n<o.length;n++){var r=o[n];t.appendChild(r)}e.appendChild(t),i.appendChild(e),e.style.overflowX="hidden",this.scrollEle=e,this.scrollItems=t},e.prototype.getPersistData=function(){var t=["scrollStep"];return this.addOnPersist(t)},e.prototype.getModuleName=function(){return"hScroll"},e.prototype.destroy=function(){var e=this.element;e.style.display="",e.classList.remove("e-hscroll");for(var i=B(".e-"+e.id+"_nav.e-scroll-nav",e),n=0,o=[].slice.call(this.scrollItems.children);n<o.length;n++){var r=o[n];e.appendChild(r)}this.uniqueId&&this.element.removeAttribute("id"),A(this.scrollEle),i.length>0&&(A(i[0]),A(i[1])),Ma.remove(this.scrollEle,"scroll",this.scrollHandler),this.touchModule.destroy(),this.touchModule=null,t.prototype.destroy.call(this)},e.prototype.disable=function(t){var e=B(".e-scroll-nav:not(.e-overlay)",this.element);t?this.element.classList.add("e-overlay"):this.element.classList.remove("e-overlay"),e.forEach(function(e){e.setAttribute("tabindex",t?"-1":"0")})},e.prototype.createNavIcon=function(t){var e=t.id.concat("_nav"),i="e-"+t.id.concat("_nav e-scroll-nav e-scroll-right-nav"),n=L("div",{id:e.concat("_right"),className:i});n.setAttribute("aria-disabled","false");var o=L("div",{className:"e-nav-right-arrow e-nav-arrow e-icons"}),r="e-"+t.id.concat("_nav e-scroll-nav e-scroll-left-nav"),s=L("div",{id:e.concat("_left"),className:r+" e-overlay"});s.setAttribute("aria-disabled","true");var a=L("div",{className:"e-nav-left-arrow e-nav-arrow e-icons"});s.appendChild(a),n.appendChild(o),n.setAttribute("tabindex","0"),t.appendChild(n),t.insertBefore(s,t.firstChild),this.ieCheck&&(n.classList.add("e-ie-align"),s.classList.add("e-ie-align")),this.eventBinding([n,s])},e.prototype.onKeyPress=function(t){var e=this;if("Enter"===t.key){var i=function(){e.keyTimeout=!0,e.eleScrolling(10,t.target)};this.keyTimer=window.setTimeout(function(){i()},100)}},e.prototype.onKeyUp=function(t){"Enter"===t.key&&(this.keyTimeout?this.keyTimeout=!1:t.target.click(),clearTimeout(this.keyTimer))},e.prototype.eventBinding=function(t){var e=this;t.forEach(function(t){new Vl(t,{tapHold:e.tabHoldHandler.bind(e),tapHoldThreshold:500}),t.addEventListener("keydown",e.onKeyPress.bind(e)),t.addEventListener("keyup",e.onKeyUp.bind(e)),t.addEventListener("mouseup",e.repeatScroll.bind(e)),t.addEventListener("touchend",e.repeatScroll.bind(e)),t.addEventListener("contextmenu",function(t){t.preventDefault()}),Ma.add(t,"click",e.clickEventHandler,e)})},e.prototype.repeatScroll=function(){clearInterval(this.timeout)},e.prototype.tabHoldHandler=function(t){var e=this,i=t.originalEvent.target;i=this.contains(i,"e-scroll-nav")?i.firstElementChild:i;var n=function(){e.eleScrolling(10,i)};this.timeout=window.setInterval(function(){n()},50)},e.prototype.contains=function(t,e){return t.classList.contains(e)},e.prototype.eleScrolling=function(t,e){var i=this.scrollEle,n=this.element,o=e.classList;o.contains("e-scroll-nav")&&(o=e.querySelector(".e-nav-arrow").classList),this.contains(n,"e-rtl")&&this.browserCheck&&(t=-t);var r=i.scrollLeft;!this.contains(n,"e-rtl")||this.browserCheck||this.ieCheck?o.contains("e-nav-right-arrow")?i.scrollLeft=r+t:i.scrollLeft=r-t:o.contains("e-nav-left-arrow")?i.scrollLeft=r+t:i.scrollLeft=r-t},e.prototype.clickEventHandler=function(t){this.eleScrolling(this.scrollStep,t.target)},e.prototype.touchHandler=function(t){var e,i=this.scrollEle;e=t.distanceX,this.ieCheck&&this.contains(this.element,"e-rtl")&&(e=-e),"Left"===t.scrollDirection?i.scrollLeft=i.scrollLeft+e:"Right"===t.scrollDirection&&(i.scrollLeft=i.scrollLeft-e)},e.prototype.arrowDisabling=function(t,e){t.classList.add("e-overlay"),t.setAttribute("aria-disabled","true"),t.removeAttribute("tabindex"),clearInterval(this.timeout),e.classList.remove("e-overlay"),e.setAttribute("aria-disabled","false"),e.setAttribute("tabindex","0"),this.repeatScroll()},e.prototype.scrollHandler=function(t){var e=t.target,i=e.offsetWidth,n=this.element,o=this.element.querySelector(".e-scroll-left-nav"),r=this.element.querySelector(".e-scroll-right-nav"),s=e.scrollLeft;if(s<=0&&(s=-s),0===s)!this.contains(n,"e-rtl")||this.browserCheck||this.ieCheck?this.arrowDisabling(o,r):this.arrowDisabling(r,o);else if(Math.ceil(i+s+.1)>=e.scrollWidth)!this.contains(n,"e-rtl")||this.browserCheck||this.ieCheck?this.arrowDisabling(r,o):this.arrowDisabling(o,r);else{var a=this.element.querySelector(".e-scroll-nav.e-overlay");a&&(a.classList.remove("e-overlay"),a.setAttribute("aria-disabled","false"),a.setAttribute("tabindex","0"))}},e.prototype.onPropertyChanged=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++)switch(n[i]){case"scrollStep":break;case"enableRtl":t.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")}},Em([et(40)],e.prototype,"scrollStep",void 0),e=Em([at],e)}(wl),km=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Tm=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Om="e-toolbar-items",Im="e-toolbar-item",Am="e-toolbar-popup",Mm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return km(e,t),Tm([et("")],e.prototype,"id",void 0),Tm([et("")],e.prototype,"text",void 0),Tm([et("auto")],e.prototype,"width",void 0),Tm([et("")],e.prototype,"cssClass",void 0),Tm([et(!1)],e.prototype,"showAlwaysInPopup",void 0),Tm([et("")],e.prototype,"prefixIcon",void 0),Tm([et("")],e.prototype,"suffixIcon",void 0),Tm([et("None")],e.prototype,"overflow",void 0),Tm([et("")],e.prototype,"template",void 0),Tm([et("Button")],e.prototype,"type",void 0),Tm([et("Both")],e.prototype,"showTextOn",void 0),Tm([et(null)],e.prototype,"htmlAttributes",void 0),Tm([et("")],e.prototype,"tooltipText",void 0),Tm([et("Left")],e.prototype,"align",void 0),e}(qa),Rm=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.keyConfigs={moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",moveDown:"downarrow",popupOpen:"enter",popupClose:"escape",tab:"tab",home:"home",end:"end"},n}return km(e,t),e.prototype.destroy=function(){var e=this,i=this.element;for(t.prototype.destroy.call(this),this.unwireEvents();i.firstChild;)i.removeChild(i.firstChild);this.trgtEle&&i.appendChild(this.ctrlTem),this.clearProperty(),this.popObj=null,this.tbarAlign=null,this.remove(this.element,"e-toolpop"),i.removeAttribute("style"),["aria-disabled","aria-orientation","aria-haspopup","role"].forEach(function(t){e.element.removeAttribute(t)})},e.prototype.preRender=function(){var t={enableCollision:!0};this.trigger("beforeCreate",t),this.enableCollision=t.enableCollision,this.scrollModule=null,this.popObj=null,this.tbarItemsCol=this.items,this.popupPriCount=0,this.enableRtl&&this.add(this.element,"e-rtl")},e.prototype.wireEvents=function(){Ma.add(this.element,"click",this.clickHandler,this),window.addEventListener("resize",this.resize.bind(this)),this.keyModule=new Rl(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs}),Ma.add(this.element,"keydown",this.docKeyDown,this),this.element.setAttribute("tabIndex","0")},e.prototype.docKeyDown=function(t){if("INPUT"!==t.target.tagName){var e=!c(this.popObj)&&T(this.popObj.element)&&"Extended"!==this.overflowMode;9===t.keyCode&&!0===t.target.classList.contains("e-hor-nav")&&e&&this.popObj.hide({name:"FadeOut",duration:100}),(40===t.keyCode||38===t.keyCode||35===t.keyCode||36===t.keyCode)&&t.preventDefault()}},e.prototype.unwireEvents=function(){Ma.remove(this.element,"click",this.clickHandler),this.destroyHScroll(),this.keyModule.destroy(),Ma.remove(document,"scroll",this.docEvent),Ma.remove(this.element,"keydown",this.docKeyDown),Ma.remove(document,"click",this.docEvent)},e.prototype.clearProperty=function(){this.tbarEle=[],this.tbarAlgEle={lefts:[],centers:[],rights:[]}},e.prototype.docEvent=function(t){var e=N(t.target,".e-popup");this.popObj&&T(this.popObj.element)&&!e&&"Popup"===this.overflowMode&&this.popObj.hide({name:"FadeOut",duration:100})},e.prototype.destroyHScroll=function(){this.scrollModule&&(this.tbarAlign&&this.add(this.scrollModule.element,"e-tbar-pos"),this.scrollModule.destroy(),this.scrollModule=null)},e.prototype.destroyItems=function(){[].slice.call(this.element.querySelectorAll("."+Im)).forEach(function(t){A(t)});var t=this.element.querySelector("."+Om);this.tbarAlign&&([].slice.call(t.children).forEach(function(t){A(t)}),this.tbarAlign=!1,this.remove(t,"e-tbar-pos")),this.clearProperty()},e.prototype.destroyMode=function(){this.scrollModule&&(this.remove(this.scrollModule.element,"e-rtl"),this.destroyHScroll()),this.popObj&&this.popupRefresh(this.popObj.element,!0)},e.prototype.add=function(t,e){t.classList.add(e)},e.prototype.remove=function(t,e){t.classList.remove(e)},e.prototype.elementFocus=function(t){var e=t.firstElementChild;e?(e.focus(),this.activeEleSwitch(t)):t.focus()},e.prototype.clstElement=function(t,e){return t&&this.popObj&&T(this.popObj.element)?this.popObj.element.querySelector("."+Im):this.element===e||t?this.element.querySelector("."+Im+":not(.e-overlay ):not(.e-separator )"):N(e,"."+Im)},e.prototype.keyHandling=function(t,e,i,n,o){var r=this.popObj,s=this.element,a={name:"FadeOut",duration:100};switch(e.action){case"moveRight":s===i?this.elementFocus(t):n||this.eleFocus(t,"next");break;case"moveLeft":n||this.eleFocus(t,"previous");break;case"home":case"end":var l=void 0,h=void 0;if(t){var c=N(t,".e-popup");c?T(this.popObj.element)&&(h=c.children,l="home"===e.action?h[0]:h[h.length-1]):(h=this.element.querySelectorAll("."+Om+" ."+Im),l="home"===e.action?h[0]:h[h.length-1]),l&&this.elementFocus(l)}break;case"moveUp":case"moveDown":var d="moveUp"===e.action?"previous":"next";if(r&&N(i,".e-popup")){var p=r.element,u=p.firstElementChild;if("previous"===d&&u===t||"next"===d&&p.lastElementChild===t)return;this.eleFocus(t,d)}else"moveDown"===e.action&&r&&T(r.element)&&this.elementFocus(t);break;case"tab":if(!o&&!n){var g=t.firstElementChild;s===i&&(this.activeEle?this.activeEle.focus():(this.activeEleRemove(g),g.focus()),this.element.removeAttribute("tabindex"))}break;case"popupClose":r&&"Extended"!==this.overflowMode&&r.hide(a);break;case"popupOpen":if(!n)return;r&&!T(r.element)?(r.element.style.top=s.offsetHeight+"px",r.show({name:"FadeIn",duration:100})):r.hide(a)}},e.prototype.keyActionHandler=function(t){var e=t.target;if("INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName&&!this.element.classList.contains("e-overlay")){t.preventDefault();var i,n=e.classList.contains("e-hor-nav"),o=e.classList.contains("e-scroll-nav");((i=this.clstElement(n,e))||o)&&this.keyHandling(i,t,e,n,o)}},e.prototype.disable=function(t){var e=this.element;t?e.classList.add("e-overlay"):e.classList.remove("e-overlay"),e.setAttribute("tabindex",t?"-1":"0"),this.activeEle&&this.activeEle.setAttribute("tabindex",t?"-1":"0"),this.scrollModule&&this.scrollModule.disable(t),this.popObj&&(T(this.popObj.element)&&"Extended"!==this.overflowMode&&this.popObj.hide(),e.querySelector("#"+e.id+"_nav").setAttribute("tabindex",t?"-1":"0"))},e.prototype.eleFocus=function(t,e){var i=Object(t)[e+"ElementSibling"],n=function(t){return t.classList.contains("e-separator")||t.classList.contains("e-overlay")};if(i){var o=n(i);if(o){if(!Object(i)[e+"ElementSibling"])return;if(i=Object(i)[e+"ElementSibling"],o=n(i))return void this.eleFocus(i,e)}this.elementFocus(i)}else if(this.tbarAlign){var r=Object(t.parentElement)[e+"ElementSibling"];if(c(r)||0!==r.children.length||(r=Object(r)[e+"ElementSibling"]),!c(r)&&r.children.length>0)if("next"===e)n(s=r.querySelector("."+Im))?this.eleFocus(s,e):(s.firstElementChild.focus(),this.activeEleSwitch(s));else{var s=r.lastElementChild;n(s)?this.eleFocus(s,e):this.elementFocus(s)}}},e.prototype.clickHandler=function(t){var e=t.target,i=e.classList,n=this.element,o=!c(N(e,".e-toolbar-pop")),r=N(e,".e-hor-nav");r||(r=e),!n.children[0].classList.contains("e-hscroll")&&i.contains("e-hor-nav")&&(i=e.querySelector(".e-icons").classList),(i.contains("e-popup-up-icon")||i.contains("e-popup-down-icon"))&&this.popupClickHandler(n,r,"e-rtl");var s,a=N(t.target,"."+Im);if(!c(a)&&!a.classList.contains("e-overlay")||r.classList.contains("e-hor-nav")){a&&(s=this.items[this.tbarEle.indexOf(a)]);var l={originalEvent:t,item:s};this.trigger("clicked",l),o&&!l.cancel&&"Popup"===this.overflowMode&&this.popObj.hide({name:"FadeOut",duration:100})}},e.prototype.popupClickHandler=function(t,e,i){var n=this.popObj;T(n.element)?(e.classList.remove("e-nav-active"),n.hide({name:"FadeOut",duration:100})):(t.classList.contains(i)&&(n.enableRtl=!0,n.position={X:"left",Y:"top"}),0!==n.offsetX||t.classList.contains(i)||(n.enableRtl=!1,n.position={X:"right",Y:"top"}),n.dataBind(),n.refreshPosition(),n.element.style.top=this.element.offsetHeight+"px","Extended"===this.overflowMode&&(n.element.style.minHeight="0px"),e.classList.add("e-nav-active"),n.show({name:"FadeIn",duration:100}))},e.prototype.render=function(){this.initialize(),this.renderControl(),this.separator(),this.wireEvents()},e.prototype.initialize=function(){var t=b(this.width),e=b(this.height);"msie"===za.info.name&&"auto"===this.height&&"MultiRow"!==this.overflowMode||j(this.element,{height:e}),j(this.element,{width:t});var i={role:"toolbar","aria-disabled":"false","aria-haspopup":"false","aria-orientation":"horizontal"};R(this.element,i)},e.prototype.renderControl=function(){this.trgtEle=this.element.children.length>0?this.element.querySelector("div"):null,this.tbarAlgEle={lefts:[],centers:[],rights:[]},this.renderItems(),this.renderOverflowMode(),this.tbarAlign&&this.itemPositioning(),this.popObj&&this.popObj.element.childElementCount>1&&this.checkPopupRefresh(this.element,this.popObj.element)&&this.popupRefresh(this.popObj.element,!1)},e.prototype.initHScroll=function(t,e){!this.scrollModule&&this.checkOverflow(t,e[0])&&(this.tbarAlign&&this.element.querySelector("."+Om+" .e-toolbar-center").removeAttribute("style"),this.scrollModule=new Pm({scrollStep:50,enableRtl:this.enableRtl},e[0]),this.remove(this.scrollModule.element,"e-tbar-pos"),j(this.element,{overflow:"hidden"}))},e.prototype.itemWidthCal=function(t){var e,i=0;return[].slice.call(B("."+Im,t)).forEach(function(t){T(t)&&(e=window.getComputedStyle(t),i+=t.offsetWidth+parseFloat(e.marginRight)+parseFloat(e.marginLeft))}),i},e.prototype.checkOverflow=function(t,e){if(c(t)||c(e)||!T(t))return!1;var i=t.offsetWidth,n=e.offsetWidth;(this.tbarAlign||this.scrollModule||i===n)&&(n=this.itemWidthCal(this.scrollModule?e.querySelector(".e-hscroll-content"):e));var o=t.querySelector(".e-hor-nav"),r=t.querySelector(".e-scroll-nav");return n>i-(o?o.offsetWidth:r?2*r.offsetWidth:0)},e.prototype.refreshOverflow=function(){this.resize()},e.prototype.renderOverflowMode=function(){var t=this.element,e=t.querySelector("."+Om),i=this.popupPriCount>0;if(t&&t.children.length>0)switch(this.offsetWid=t.offsetWidth,this.remove(this.element,"e-toolpop"),"msie"===za.info.name&&"auto"===this.height&&(t.style.height=""),this.overflowMode){case"Scrollable":this.destroyHScroll(),this.initHScroll(t,t.getElementsByClassName(Om));break;case"Popup":this.add(this.element,"e-toolpop"),this.tbarAlign&&this.removePositioning(),(this.checkOverflow(t,e)||i)&&(this.createPopupEle(t,[].slice.call(B("."+Om+" ."+Im,t))),this.element.querySelector(".e-hor-nav").setAttribute("tabIndex","0")),this.tbarAlign&&(this.add(e,"e-tbar-pos"),this.itemPositioning());break;case"MultiRow":this.add(e,"e-toolbar-multirow"),"hidden"===t.style.overflow&&(t.style.overflow=""),"msie"!==za.info.name&&"auto"===t.style.height||(t.style.height="auto");break;case"Extended":this.add(this.element,"e-extended-toolbar"),(this.checkOverflow(t,e)||i)&&(this.createPopupEle(t,[].slice.call(B("."+Om+" ."+Im,t))),this.element.querySelector(".e-hor-nav").setAttribute("tabIndex","0"))}},e.prototype.separator=function(){var t,e=this.element,i=[].slice.call(e.querySelectorAll(".e-separator")),n=e.querySelector(".e-multirow-separator"),o=e.querySelector(".e-extended-separator");null!==(t="MultiRow"===this.overflowMode?n:o)&&("MultiRow"===this.overflowMode?t.classList.remove("e-multirow-separator"):"Extended"===this.overflowMode&&t.classList.remove("e-extended-separator"));for(var r=0;r<=i.length-1;r++)i[r].offsetLeft<30&&0!==i[r].offsetLeft&&("MultiRow"===this.overflowMode?i[r].classList.add("e-multirow-separator"):"Extended"===this.overflowMode&&i[r].classList.add("e-extended-separator"))},e.prototype.createPopupEle=function(t,e){var i=t.querySelector(".e-hor-nav");i||this.createPopupIcon(t),i=t.querySelector(".e-hor-nav");var n=t.offsetWidth-i.offsetWidth;this.element.classList.remove("e-rtl"),j(this.element,{direction:"initial"}),this.checkPriority(t,e,n,!0),this.enableRtl&&this.element.classList.add("e-rtl"),this.element.style.removeProperty("direction"),this.createPopup()},e.prototype.pushingPoppedEle=function(t,e,i,n,o){var r=t.element,s=B(".e-overflow-show",i),a=0,l=0;[].slice.call(B("."+Am,r.querySelector("."+Om))).forEach(function(r,h){s=B(".e-overflow-show",i),r.classList.contains("e-overflow-show")&&s.length>0?t.tbResize&&s.length>h?(i.insertBefore(r,s[h]),++l):(i.insertBefore(r,i.children[s.length]),++l):r.classList.contains("e-overflow-show")?(i.insertBefore(r,i.firstChild),++l):t.tbResize&&r.classList.contains("e-overflow-hide")&&i.children.length>0&&0===s.length?(i.insertBefore(r,i.firstChild),++l):r.classList.contains("e-overflow-hide")?e.push(r):t.tbResize?(i.insertBefore(r,i.childNodes[a+l]),++a):i.appendChild(r),r.classList.contains("e-separator")?j(r,{display:"",height:o+"px"}):j(r,{display:"",height:n+"px"})}),e.forEach(function(t){i.appendChild(t)});for(var h=B("."+Im,r.querySelector("."+Om)),c=h.length-1;c>=0;c--){var d=h[c];if(!d.classList.contains("e-separator")||"Extended"===this.overflowMode)break;j(d,{display:"none"})}},e.prototype.createPopup=function(){var t,e,i,n,o=this.element;"Extended"===this.overflowMode&&(n=o.querySelector(".e-separator:not(."+Am+" )"),i="auto"===o.style.height||""===o.style.height?null:n.offsetHeight),e=o.querySelector("."+Im+":not(.e-separator ):not(."+Am+" )"),t="auto"===o.style.height||""===o.style.height?null:e.offsetHeight;var r,s=[];if(o.querySelector("#"+o.id+"_popup.e-toolbar-pop"))r=o.querySelector("#"+o.id+"_popup.e-toolbar-pop");else{var a=L("div",{id:o.id+"_popup",className:"e-toolbar-pop e-toolbar-extended"}),l=L("div",{id:o.id+"_popup",className:"e-toolbar-pop"});r="Extended"===this.overflowMode?a:l}this.pushingPoppedEle(this,s,r,t,i),this.popupInit(o,r)},e.prototype.popupInit=function(t,e){if(this.popObj){var i=this.popObj.element;j(i,{maxHeight:"",display:"block"}),j(i,{maxHeight:i.offsetHeight+"px",display:""})}else{t.appendChild(e),j(this.element,{overflow:""});var n=new Xc(null,{relateTo:this.element,offsetY:t.offsetHeight,enableRtl:this.enableRtl,open:this.popupOpen.bind(this),close:this.popupClose,collision:{Y:this.enableCollision?"flip":"none"},position:this.enableRtl?{X:"left",Y:"top"}:{X:"right",Y:"top"}});n.appendTo(e),Ma.add(document,"scroll",this.docEvent.bind(this)),Ma.add(document,"click ",this.docEvent.bind(this)),n.element.style.maxHeight=n.element.offsetHeight+"px",n.hide(),this.popObj=n,this.element.setAttribute("aria-haspopup","true")}},e.prototype.popupOpen=function(t){var e=this.popObj,i=this.popObj.element,n=this.popObj.element.parentElement,o=n.querySelector(".e-hor-nav");j(e.element,{height:"auto",maxHeight:""}),e.element.style.maxHeight=e.element.offsetHeight+"px","Extended"===this.overflowMode&&(e.element.style.minHeight="");var r=i.offsetTop+i.offsetHeight+fi(n).top,s=o.firstElementChild;o.classList.add("e-nav-active"),V(s,["e-popup-up-icon"],["e-popup-down-icon"]);var a=c(window.scrollY)?0:window.scrollY;if(window.innerHeight+a<r&&this.element.offsetTop<i.offsetHeight){var l=i.offsetHeight-(r-window.innerHeight-a+5);e.height=l+"px";for(var h=0;h<=i.childElementCount;h++){var d=i.children[h];if(d.offsetTop+d.offsetHeight>l){l=d.offsetTop;break}}j(e.element,{maxHeight:l+"px"})}},e.prototype.popupClose=function(t){var e=this.element.parentElement.querySelector(".e-hor-nav"),i=e.firstElementChild;e.classList.remove("e-nav-active"),V(i,["e-popup-down-icon"],["e-popup-up-icon"])},e.prototype.checkPriority=function(t,e,i,n){for(var o=this.popupPriCount>0,r=i,s=0,a=0,l=0,h=function(t,e){var i=!1;return e.forEach(function(e){t.classList.contains(e)&&(i=!0)}),i},c=e.length-1;c>=0;c--){var d=parseFloat(window.getComputedStyle(e[c]).marginRight);d+=parseFloat(window.getComputedStyle(e[c]).marginLeft);var p=e[c]===this.tbarEle[0];p&&(this.tbarEleMrgn=d);var u=p?e[c].offsetWidth+d:e[c].offsetWidth;if(h(e[c],["e-popup-alone"])&&o&&(e[c].classList.add(Am),j(e[c],{display:"none",minWidth:u+"px"}),l++),e[c].offsetLeft+e[c].offsetWidth+d>i){if(e[c].classList.contains("e-separator")){if("Extended"===this.overflowMode)a===l&&h(g=e[c],["e-separator","e-ignore"])&&(e[c].classList.add(Am),l++),a++;else if("Popup"===this.overflowMode){if(s>0&&a===l){var g=e[c+a+(s-1)];h(g,["e-separator","e-ignore"])&&j(g,{display:"none"})}s++,a=0,l=0}}else a++;e[c].classList.contains("e-overflow-show")&&n?i-=e[c].offsetWidth+d:h(e[c],["e-separator","e-ignore"])?i-=e[c].offsetWidth+d:(e[c].classList.add(Am),j(e[c],{display:"none",minWidth:u+"px"}),l++)}}if(n){var m=B("."+Im+":not(."+Am+")",this.element);this.checkPriority(t,m,r,!1)}},e.prototype.createPopupIcon=function(t){var e=t.id.concat("_nav"),i="e-"+t.id.concat("_nav e-hor-nav"),n=L("div",{id:e,className:i="Extended"===this.overflowMode?i+" e-expended-nav":i});"msie"!==za.info.name&&"edge"!==za.info.name||n.classList.add("e-ie-align");var o=L("div",{className:"e-popup-down-icon e-icons"});n.appendChild(o),n.setAttribute("tabindex","0"),t.appendChild(n)},e.prototype.tbarPriRef=function(t,e,i,n,o,r,s,a){var l=a,h=this.popObj.element,d=B("."+Am+":not(.e-overflow-show)",h).length,p=function(t,e){return t.classList.contains(e)};if(0===B(".e-toolbar-item:not(.e-separator):not(.e-overflow-show)",t).length){var u=t.children[e-(e-i)-1],g=!c(u)&&p(u,"e-ignore");if(!c(u)&&p(u,"e-separator")&&!T(u)||g){u.style.display="inherit";var m=u.offsetWidth+2*parseFloat(window.getComputedStyle(u).marginRight),f=u.previousElementSibling;r+m<s||o?(t.insertBefore(n,t.children[e+l-(e-i)]),c(f)||(f.style.display="")):f.classList.contains("e-separator")&&(f.style.display="none"),u.style.display=""}else t.insertBefore(n,t.children[e+l-(e-i)])}else t.insertBefore(n,t.children[e+l-d])},e.prototype.popupRefresh=function(t,e){var i=this,n=this.element,o=n.querySelector(".e-hor-nav"),r=n.querySelector("."+Om);if(!c(o)){r.removeAttribute("style"),t.style.display="block";var s=n.offsetWidth-(o.offsetWidth+r.offsetWidth),a=0;[].slice.call(t.children).forEach(function(t){a+=i.popupEleWidth(t),j(t,{position:""})}),s+o.offsetWidth>a&&0===this.popupPriCount&&(e=!0),this.popupEleRefresh(s,t,e),t.style.display="",0===t.children.length&&o&&this.popObj&&(A(o),o=null,this.popObj.destroy(),A(this.popObj.element),this.popObj=null,n.setAttribute("aria-haspopup","false"),n.classList.remove("e-toolpop"))}},e.prototype.ignoreEleFetch=function(t,e){var i=[].slice.call(e.querySelectorAll(".e-ignore")),n=[],o=0;return i.length>0?(i.forEach(function(t){n.push([].slice.call(e.children).indexOf(t))}),n.forEach(function(e){e<=t&&o++}),o):0},e.prototype.checkPopupRefresh=function(t,e){e.style.display="block";var i=this.popupEleWidth(e.firstElementChild);e.firstElementChild.style.removeProperty("Position");var n=t.offsetWidth-t.querySelector(".e-hor-nav").offsetWidth,o=t.querySelector("."+Om).offsetWidth;return e.style.removeProperty("display"),n>i+o},e.prototype.popupEleWidth=function(t){t.style.position="absolute";var e=t.offsetWidth,i=t.querySelector(".e-tbar-btn-text");if(t.classList.contains("e-tbtn-align")||t.classList.contains("e-popup-text")){var n=t.children[0];!c(i)&&t.classList.contains("e-popup-text")?i.style.display="none":!c(i)&&t.classList.contains("e-toolbar-text")&&(i.style.display="block"),n.style.minWidth="0%",e=parseFloat(t.style.minWidth),n.style.minWidth="",c(i)||(i.style.display="")}return e},e.prototype.popupEleRefresh=function(t,e,i){for(var n,o,r=this.popupPriCount>0,s=this.tbarEle,a=this.element.querySelector("."+Om),l=0,h=this,c=0,d=[].slice.call(e.children);c<d.length&&"break"!==function(e){if(e.classList.contains("e-popup-alone")&&r&&!i)return"continue";var c=h.popupEleWidth(e);if(e===h.tbarEle[0]&&(c+=h.tbarEleMrgn),e.style.position="",!(c<t||i))return"break";if(e.style.minWidth="",e.classList.contains("e-overflow-hide")||e.classList.remove(Am),o=h.tbarEle.indexOf(e),h.tbarAlign){var d=h.items[o].align;o=h.tbarAlgEle[(d+"s").toLowerCase()].indexOf(e),s=h.tbarAlgEle[(d+"s").toLowerCase()],a=h.element.querySelector("."+Om+" .e-toolbar-"+d.toLowerCase())}var p=0;"Extended"!==h.overflowMode&&s.slice(0,o).forEach(function(e){(e.classList.contains("e-overflow-show")||e.classList.contains("e-separator"))&&(e.classList.contains("e-separator")&&(e.style.display="",t-=e.offsetWidth),p++)}),l=h.ignoreEleFetch(o,a),e.classList.contains("e-overflow-show")?(h.tbarPriRef(a,o,p,e,i,c,t,l),t-=e.offsetWidth):0===o?(a.insertBefore(e,a.firstChild),t-=e.offsetWidth):(n=B(".e-overflow-show",h.popObj.element).length,a.insertBefore(e,a.children[o+l-n]),t-=e.offsetWidth),e.style.height=""}(d[c]);c++);this.checkOverflow(this.element,this.element.getElementsByClassName(Om)[0])&&!i&&this.renderOverflowMode()},e.prototype.removePositioning=function(){var t=this.element.querySelector("."+Om);if(!c(t)&&t.classList.contains("e-tbar-pos")){this.remove(t,"e-tbar-pos");var e=[].slice.call(t.childNodes);e[1].removeAttribute("style"),e[2].removeAttribute("style")}},e.prototype.refreshPositioning=function(){var t=this.element.querySelector("."+Om);this.add(t,"e-tbar-pos"),this.itemPositioning()},e.prototype.itemPositioning=function(){var t=this.element.querySelector("."+Om);if(!c(t)&&t.classList.contains("e-tbar-pos")){var e,i=this.element.querySelector(".e-hor-nav"),n=(e=this.scrollModule?[].slice.call(t.querySelector(".e-hscroll-content").children):[].slice.call(t.childNodes))[0].offsetWidth+e[2].offsetWidth,o=this.element.offsetWidth;if(i){o-=i.offsetWidth;var r=i.offsetWidth+"px";e[2].removeAttribute("style"),this.enableRtl?e[2].style.left=r:e[2].style.right=r}if(!(o<=n)){var s=(o-n-e[1].offsetWidth)/2;e[1].removeAttribute("style");var a=e[0].offsetWidth+s+"px";this.enableRtl?e[1].style.marginRight=a:e[1].style.marginLeft=a}}},e.prototype.tbarItemAlign=function(t,e,i){var n=this;if(!t.showAlwaysInPopup||"Show"===t.overflow){var o=[];if(o.push(L("div",{className:"e-toolbar-left"})),o.push(L("div",{className:"e-toolbar-center"})),o.push(L("div",{className:"e-toolbar-right"})),0===i&&"Left"!==t.align)o.forEach(function(t){e.appendChild(t)}),this.tbarAlign=!0,this.add(e,"e-tbar-pos");else if("Left"!==t.align){var r=e.childNodes,s=o[0];[].slice.call(r).forEach(function(t){n.tbarAlgEle.lefts.push(t),s.appendChild(t)}),e.appendChild(s),e.appendChild(o[1]),e.appendChild(o[2]),this.tbarAlign=!0,this.add(e,"e-tbar-pos")}}},e.prototype.ctrlTemplate=function(){var t=this;this.ctrlTem=this.trgtEle.cloneNode(!0),this.add(this.trgtEle,Om),this.tbarEle=[],[].slice.call(this.trgtEle.children).forEach(function(e){"DIV"===e.tagName&&(t.tbarEle.push(e),e.setAttribute("aria-disabled","false"),t.add(e,Im))})},e.prototype.renderItems=function(){var t,e,i,n=this.element,o=this.items;if(n&&n.children.length>0&&(t=n.querySelector("."+Om)),null!=this.trgtEle)this.ctrlTemplate();else if(n&&o.length>0){t||(t=L("div",{className:Om}));for(var r=0;r<o.length;r++)e=this.renderSubComponent(o[r]),-1===this.tbarEle.indexOf(e)&&this.tbarEle.push(e),this.tbarAlign||this.tbarItemAlign(o[r],t,r),(i=t.querySelector(".e-toolbar-"+o[r].align.toLowerCase()))?(o[r].showAlwaysInPopup&&"Show"!==o[r].overflow||this.tbarAlgEle[(o[r].align+"s").toLowerCase()].push(e),i.appendChild(e)):t.appendChild(e);n.appendChild(t)}},e.prototype.setAttr=function(t,e){for(var i,n=Object.keys(t),o=0;o<n.length;o++)"class"===(i=n[o])?this.add(e,t[i]):e.setAttribute(i,t[i])},e.prototype.enableItems=function(t,e){var i=t,n=i.length;c(e)&&(e=!0);var o=function(t,e){t?(e.classList.remove("e-overlay"),e.setAttribute("aria-disabled","false")):(e.classList.add("e-overlay"),e.setAttribute("aria-disabled","true"))};if(n&&n>1){for(var r=0,s=[].slice.call(i);r<s.length;r++)o(e,s[r]);e?P(i,"e-overlay"):E(i,"e-overlay")}else{o(e,n&&1===n?i[0]:t)}},e.prototype.addItems=function(t,e){var i,n,o=this.element.querySelector("."+Om),r="Left";c(e)&&(e=0),t.forEach(function(t){c(t.align)||"Left"===t.align||"Left"!==r||(r=t.align)});for(var s=0,a=t;s<a.length;s++){var l=a[s];if(c(l.type)&&(l.type="Button"),i=B("."+Im,this.element),l.align=r,n=this.renderSubComponent(l),this.tbarEle.length>=e&&i.length>=0){this.destroyMode();var h="L"===l.align[0]?0:"C"===l.align[0]?1:2,d=void 0;this.tbarAlign||"Left"===r?this.tbarAlign?((d=N(i[0],"."+Om).children[h]).insertBefore(n,d.children[e]),this.tbarAlgEle[(l.align+"s").toLowerCase()].splice(e,0,n),this.refreshPositioning()):0===i.length?(i=B("."+Om,this.element))[0].appendChild(n):i[0].parentNode.insertBefore(n,i[e]):(this.tbarItemAlign(l,o,1),this.tbarAlign=!0,(d=N(i[0],"."+Om).children[h]).appendChild(n),this.tbarAlgEle[(l.align+"s").toLowerCase()].push(n),this.refreshPositioning()),this.items.splice(e,0,l),this.tbarEle.splice(e,0,n),e++,this.offsetWid=o.offsetWidth}}o.style.width="",this.renderOverflowMode()},e.prototype.removeItems=function(t){var e,i=t,n=[].slice.call(B("."+Im,this.element));if("number"==typeof i)e=parseInt(t.toString(),10),this.removeItemByIndex(e,n);else if(i&&i.length>1)for(var o=0,r=[].slice.call(i);o<r.length;o++){s=r[o];e=this.tbarEle.indexOf(s),this.removeItemByIndex(e,n),n=B("."+Im,this.element)}else{var s=i&&i.length&&1===i.length?i[0]:t;e=n.indexOf(s),this.removeItemByIndex(e,n)}this.resize()},e.prototype.removeItemByIndex=function(t,e){if(this.tbarEle[t]&&e[t]){var i=this.tbarEle.indexOf(e[t]);if(this.tbarAlign){var n=void 0;n=this.tbarAlgEle[(this.items[i].align+"s").toLowerCase()].indexOf(this.tbarEle[i]),this.tbarAlgEle[(this.items[i].align+"s").toLowerCase()].splice(n,1)}A(e[t]),this.items.splice(i,1),this.tbarEle.splice(i,1)}},e.prototype.templateRender=function(t,e,i){var n,o=i.type,r=t;if("object"==typeof t&&(n="function"==typeof r.appendTo),"string"!=typeof t&&n){if("Input"===o){var s=L("input");i.id?s.id=i.id:s.id=p("tbr-ipt"),e.appendChild(s),r.appendTo(s)}}else{var a=void 0,l=t;l="string"==typeof t?t.trim():t;try{if(document.querySelectorAll(l).length){var h=(s=document.querySelector(l)).outerHTML.trim();a=Tt(h),A(s),i.template=h}}catch(t){a=Tt(l)}var d=void 0;c(a)||(d=a({},this,"template")),!c(d)&&d.length>0&&[].slice.call(d).forEach(function(t){c(t.tagName)||(t.style.display=""),e.appendChild(t)})}this.add(e,"e-template"),this.tbarEle.push(e)},e.prototype.buttonRendering=function(t,e){var i=L("button",{className:"e-tbar-btn"});i.setAttribute("type","button");var n,o,r=t.text;t.id?i.id=t.id:i.id=p("e-tbr-btn");var s=L("div",{className:"e-tbar-btn-text"});return r?(s.innerHTML=r,i.appendChild(s),i.classList.add("e-tbtn-txt")):this.add(e,"e-tbtn-align"),(t.prefixIcon||t.suffixIcon)&&(t.prefixIcon&&t.suffixIcon||t.prefixIcon?(n=t.prefixIcon+" e-icons",o="Left"):(n=t.suffixIcon+" e-icons",o="Right")),new kc({iconCss:n,iconPosition:o},i),t.width&&j(i,{width:b(t.width)}),i},e.prototype.renderSubComponent=function(t){var e,i;if((e=L("div",{className:Im})).setAttribute("aria-disabled","false"),this.tbarEle||(this.tbarEle=[]),t.htmlAttributes&&this.setAttr(t.htmlAttributes,e),t.tooltipText&&e.setAttribute("title",t.tooltipText),t.cssClass&&(e.className=e.className+" "+t.cssClass),t.template)this.templateRender(t.template,e,t);else switch(t.type){case"Button":(i=this.buttonRendering(t,e)).setAttribute("tabindex","-1"),e.appendChild(i),e.addEventListener("click",this.itemClick.bind(this));break;case"Separator":this.add(e,"e-separator")}if(t.showTextOn){var n=t.showTextOn;"Toolbar"===n?(this.add(e,"e-toolbar-text"),this.add(e,"e-tbtn-align")):"Overflow"===n&&this.add(e,"e-popup-text")}if(t.overflow){var o=t.overflow;"Show"===o?this.add(e,"e-overflow-show"):"Hide"===o&&(e.classList.contains("e-separator")||this.add(e,"e-overflow-hide"))}return"Show"!==t.overflow&&t.showAlwaysInPopup&&!e.classList.contains("e-separator")&&(this.add(e,"e-popup-alone"),this.popupPriCount++),e},e.prototype.itemClick=function(t){this.activeEleSwitch(t.currentTarget)},e.prototype.activeEleSwitch=function(t){this.activeEleRemove(t.firstElementChild),this.activeEle.focus()},e.prototype.activeEleRemove=function(t){c(this.activeEle)||this.activeEle.setAttribute("tabindex","-1"),this.activeEle=t,c(this.trgtEle)&&!t.parentElement.classList.contains("e-template")?t.removeAttribute("tabindex"):this.activeEle.setAttribute("tabindex","0")},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.getModuleName=function(){return"toolbar"},e.prototype.itemsRerender=function(t){this.items=this.tbarItemsCol,this.destroyMode(),this.destroyItems(),this.items=t,this.tbarItemsCol=this.items,this.renderItems(),this.renderOverflowMode()},e.prototype.resize=function(){var t=this.element;this.tbResize=!0,this.tbarAlign&&this.itemPositioning(),this.popObj&&"Popup"===this.overflowMode&&this.popObj.hide();var e=this.checkOverflow(t,t.getElementsByClassName(Om)[0]);e||this.destroyHScroll(),e&&this.scrollModule&&this.offsetWid===t.offsetWidth||((this.offsetWid>t.offsetWidth||e)&&this.renderOverflowMode(),this.popObj&&(this.tbarAlign&&this.removePositioning(),this.popupRefresh(this.popObj.element,!1),this.tbarAlign&&this.refreshPositioning()),this.offsetWid=t.offsetWidth,this.tbResize=!1,this.separator())},e.prototype.onPropertyChanged=function(t,e){for(var i=this.element,n=0,o=Object.keys(t);n<o.length;n++)switch(o[n]){case"items":if(t.items instanceof Array&&e.items instanceof Array)this.itemsRerender(t.items);else for(var r=Object.keys(t.items),s=0;s<r.length;s++){var a=parseInt(Object.keys(t.items)[s],10),l=Object.keys(t.items[a])[0],h=(Object(e.items[a])[l],Object(t.items[a])[l]);if(this.tbarAlign||"align"===l){this.refresh();break}var d="showAlwaysInPopup"===l&&!h,p="overflow"===l&&0!==this.popupPriCount;(d||this.items[a].showAlwaysInPopup&&p)&&--this.popupPriCount,this.destroyMode(),A([].slice.call(B("."+Om+" ."+Im,i))[a]),this.tbarEle.splice(a,1),this.addItems([this.items[a]],a),this.items.splice(a,1),this.items[a].template&&this.tbarEle.splice(this.items.length,1)}break;case"width":var u=i.offsetWidth;j(i,{width:b(t.width)}),this.renderOverflowMode(),this.popObj&&u<i.offsetWidth&&this.popupRefresh(this.popObj.element,!1);break;case"height":j(this.element,{height:b(t.height)});break;case"overflowMode":this.destroyMode(),this.renderOverflowMode(),this.enableRtl&&this.add(i,"e-rtl"),this.refreshOverflow();break;case"enableRtl":t.enableRtl?this.add(i,"e-rtl"):this.remove(i,"e-rtl"),c(this.scrollModule)||(t.enableRtl?this.add(this.scrollModule.element,"e-rtl"):this.remove(this.scrollModule.element,"e-rtl")),c(this.popObj)||(t.enableRtl?this.add(this.popObj.element,"e-rtl"):this.remove(this.popObj.element,"e-rtl")),this.tbarAlign&&this.itemPositioning()}},e.prototype.hideItem=function(t,e){if(this.tbarEle[t]){var i=[].slice.call(B("."+Im,this.element));!0===e?i[t].classList.add("e-hidden"):i[t].classList.remove("e-hidden"),this.refreshOverflow()}},Tm([ot([],Mm)],e.prototype,"items",void 0),Tm([et("auto")],e.prototype,"width",void 0),Tm([et("auto")],e.prototype,"height",void 0),Tm([et("Scrollable")],e.prototype,"overflowMode",void 0),Tm([et(!1)],e.prototype,"enableRtl",void 0),Tm([st()],e.prototype,"clicked",void 0),Tm([st()],e.prototype,"created",void 0),Tm([st()],e.prototype,"destroyed",void 0),Tm([st()],e.prototype,"beforeCreate",void 0),e=Tm([at],e)}(wl),Dm=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Bm=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Nm="e-acrdn-item",Hm="e-acrdn-header",zm="e-acrdn-panel",jm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Dm(e,t),Bm([et("SlideDown")],e.prototype,"effect",void 0),Bm([et(400)],e.prototype,"duration",void 0),Bm([et("linear")],e.prototype,"easing",void 0),e}(qa),Vm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Dm(e,t),Bm([it({effect:"SlideUp",duration:400,easing:"linear"},jm)],e.prototype,"collapse",void 0),Bm([it({effect:"SlideDown",duration:400,easing:"linear"},jm)],e.prototype,"expand",void 0),e}(qa),Fm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Dm(e,t),Bm([et(void 0)],e.prototype,"content",void 0),Bm([et(void 0)],e.prototype,"header",void 0),Bm([et(void 0)],e.prototype,"cssClass",void 0),Bm([et(void 0)],e.prototype,"iconCss",void 0),Bm([et(!1)],e.prototype,"expanded",void 0),e}(qa),_m=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.keyConfigs={moveUp:"uparrow",moveDown:"downarrow",enter:"enter",space:"space",home:"home",end:"end"},n}return Dm(e,t),e.prototype.destroy=function(){var e=this,i=this.element;for(t.prototype.destroy.call(this),this.unwireEvents(),this.isDestroy=!0,this.templateEle.forEach(function(t){document.body.appendChild(e.element.querySelector(t)).style.display="none"});i.firstChild;)i.removeChild(i.firstChild);if(this.trgtEle)for(;this.ctrlTem.firstChild;)i.appendChild(this.ctrlTem.firstChild);i.removeAttribute("style"),["aria-disabled","aria-multiselectable","role"].forEach(function(t){e.element.removeAttribute(t)})},e.prototype.preRender=function(){var t=N(this.element,"."+zm);this.isNested=!1,this.templateEle=[],this.isDestroy||(this.isDestroy=!1),c(t)?this.element.classList.add("e-acrdn-root"):(t.classList.add("e-nested"),this.isNested=!0),this.enableRtl&&this.add(this.element,"e-rtl"),this.enablePersistence&&!c(this.expandedItems)||(this.expandedItems=[])},e.prototype.add=function(t,e){t.classList.add(e)},e.prototype.remove=function(t,e){t.classList.remove(e)},e.prototype.render=function(){this.initialize(),this.renderControl(),this.wireEvents()},e.prototype.initialize=function(){var t=b(this.width),e=b(this.height);j(this.element,{width:t,height:e});var i={"aria-disabled":"false",role:"presentation","aria-multiselectable":"true"};this.expandedItems.length>0&&(this.initExpand=this.expandedItems),R(this.element,i),"Single"===this.expandMode&&this.element.setAttribute("aria-multiselectable","false")},e.prototype.renderControl=function(){this.trgtEle=this.element.children.length>0?D("div",this.element):null,this.renderItems(),this.initItemExpand()},e.prototype.unwireEvents=function(){Ma.remove(this.element,"click",this.clickHandler),c(this.keyModule)||this.keyModule.destroy()},e.prototype.wireEvents=function(){Ma.add(this.element,"click",this.clickHandler,this),this.isNested||this.isDestroy||pt(this.element,{selector:"."+Hm}),this.isNested||(this.keyModule=new Rl(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}))},e.prototype.focusIn=function(t){t.target.parentElement.classList.add("e-item-focus")},e.prototype.focusOut=function(t){t.target.parentElement.classList.remove("e-item-focus")},e.prototype.ctrlTemplate=function(){var t=this;this.ctrlTem=this.element.cloneNode(!0);var e,i=this.element.children;E(i,[Nm]),[].slice.call(i).forEach(function(n){if(n.id=p("acrdn_item"),n.children.length>0){t.add(n.children[0],Hm);var o=n.children[0];R(o,{tabindex:"0",role:"heading","aria-level":i.length.toString()}),o.id=p("acrdn_header"),Ma.add(o,"focus",t.focusIn,t),Ma.add(o,"blur",t.focusOut,t);var r=o.firstElementChild;r&&r.classList.add("e-acrdn-header-content"),(e=n.children[1])&&(e.id=p("acrdn_panel"),o.setAttribute("aria-controls",e.id),e.style.display="",n.classList.add("e-select"),n.children[0].appendChild(t.toggleIconGenerate()),V(e,[zm,"e-content-hide"],[]),R(e,{"aria-labelledby":o.id,"aria-hidden":"true"}),(e=e.firstElementChild)&&(e.classList.add("e-acrdn-content"),e.style.display=""))}})},e.prototype.toggleIconGenerate=function(){var t=L("div",{className:"e-toggle-icon"}),e=L("span",{className:"e-tgl-collapse-icon e-icons"});return t.appendChild(e),t},e.prototype.initItemExpand=function(){var t=this.initExpand.length;if(0!==t)if("Single"===this.expandMode)this.expandItem(!0,this.initExpand[t-1]);else for(var e=0;e<t;e++)this.expandItem(!0,this.initExpand[e])},e.prototype.renderItems=function(){var t,e=this,i=this.element;c(this.initExpand)&&(this.initExpand=[]);var n=this.items;c(this.trgtEle)?i&&n.length>0&&n.forEach(function(n,o){t=e.renderInnerItem(n,o),i.appendChild(t),t.childElementCount>0&&(Ma.add(t.querySelector("."+Hm),"focus",e.focusIn,e),Ma.add(t.querySelector("."+Hm),"blur",e.focusOut,e))}):this.ctrlTemplate()},e.prototype.clickHandler=function(t){var e,i,n=this,o=t.target,r={};if(N(o,".e-accordion")===this.element){o.classList.add("e-target");var s=N(o,"."+Nm),a=N(o,"."+Hm),l=N(o,"."+zm);s&&(c(a)||c(l))&&(a=s.children[0],l=s.children[1]),a&&(i=D(".e-toggle-icon",a));var h;l&&(h=N(l,"."+Nm));var d=[];e=this.getIndexByItem(s),h&&(r.item=this.items[this.getIndexByItem(h)]),r.originalEvent=t,!(!c(i)&&c(this.trgtEle)&&s.childElementCount<=1)||!c(l)&&c(D(".e-acrdn-header .e-toggle-icon",h))||(s.appendChild(this.contentRendering(e)),this.ariaAttrUpdate(s)),this.trigger("clicked",r);var p=l&&!c(D(".e-target",l));if(p=p&&(c(D(".e-accordion",l))||!(N(o,".e-accordion")===this.element)),o.classList.remove("e-target"),!(o.classList.contains(zm)||o.classList.contains("e-acrdn-content")||p)){[].slice.call(this.element.children).forEach(function(t){t.classList.contains("e-active")&&d.push(t)});var u=[].slice.call(this.element.querySelectorAll(".e-acrdn-item [e-animate]"));if(u.length>0)for(var g=0,m=u;g<m.length;g++){var f=m[g];d.push(f.parentElement)}var v=-1!==d.indexOf(h)&&"true"===l.getAttribute("e-animate"),y=!1;if(!c(s)&&!c(a)){var b=D("."+zm,s),w=N(s,".e-acrdn-root").querySelector(".e-expand-state");if(c(b))return;y=w===s,!T(b)||v&&!h.classList.contains("e-selected")?(d.length>0&&"Single"===this.expandMode&&!v&&d.forEach(function(t){n.collapse(D("."+zm,t)),t.classList.remove("e-expand-state")}),this.expand(b)):this.collapse(b),c(w)||y||w.classList.remove("e-expand-state")}}}},e.prototype.eleMoveFocus=function(t,e,i){var n,o=N(i,"."+Nm);i===e?n=("moveUp"===t?i.lastElementChild:i).querySelector("."+Hm):i.classList.contains(Hm)&&(o="moveUp"===t?o.previousElementSibling:o.nextElementSibling)&&(n=D("."+Hm,o)),n&&n.focus()},e.prototype.keyActionHandler=function(t){var e=t.target;if("INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName){t.preventDefault();var i,n=this.element;switch(t.action){case"moveUp":case"moveDown":this.eleMoveFocus(t.action,n,e);break;case"space":case"enter":!c(i=e.nextElementSibling)&&i.classList.contains(zm)?"true"!==i.getAttribute("e-animate")&&e.click():e.click();break;case"home":case"end":("home"===t.action?n.firstElementChild.children[0]:n.lastElementChild.children[0]).focus()}}},e.prototype.headerEleGenerate=function(){var t=L("div",{className:Hm,id:p("acrdn_header")});return R(t,{tabindex:"0",role:"heading","aria-expanded":"false","aria-selected":"false","aria-disabled":"false","aria-level":this.items.length.toString()}),t},e.prototype.renderInnerItem=function(t,e){var i;if(i=L("div",{className:Nm}),i.id=p("acrdn_item"),t.header){var n=this.headerEleGenerate(),o=L("div",{className:"e-acrdn-header-content"});n.appendChild(o),n.appendChild(this.fetchElement(o,t.header,e,!0)),i.appendChild(n)}var r=D("."+Hm,i);if(!t.expanded||c(e)||this.enablePersistence||-1===this.initExpand.indexOf(e)&&this.initExpand.push(e),t.cssClass&&i.classList.add(t.cssClass),t.iconCss){var s=L("div",{className:"e-acrdn-header-icon"}),a=L("span",{className:t.iconCss+" e-icons"});s.appendChild(a),c(r)?((r=this.headerEleGenerate()).appendChild(s),i.appendChild(r)):r.insertBefore(s,r.childNodes[0])}if(t.content){var l=this.toggleIconGenerate();c(r)&&(r=this.headerEleGenerate(),i.appendChild(r)),r.appendChild(l),this.add(i,"e-select")}return i},e.prototype.fetchElement=function(t,e,i,n){var o,r;try{if(document.querySelectorAll(e).length){var s=document.querySelector(e);r=s.outerHTML.trim(),t.appendChild(s),s.style.display=""}}catch(t){o=Tt(e)}var a;return c(o)||(a=o()),c(a)||!(a.length>0)||c(a[0].tagName)&&1===a.length?0===t.childElementCount&&(t.innerHTML=e):[].slice.call(a).forEach(function(e){c(e.tagName)||(e.style.display=""),t.appendChild(e)}),c(r)||this.templateEle.push(e),t},e.prototype.ariaAttrUpdate=function(t){var e=D("."+Hm,t),i=D("."+zm,t);e.setAttribute("aria-controls",i.id),i.setAttribute("aria-labelledby",e.id)},e.prototype.contentRendering=function(t){var e=this.items[t].content,i=L("div",{className:zm+" e-content-hide",id:p("acrdn_panel")});R(i,{"aria-hidden":"true"});var n=L("div",{className:"e-acrdn-content"});return i.appendChild(this.fetchElement(n,e,t,!1)),i},e.prototype.expand=function(t){var e,i=N(t,"."+Nm);if(!(c(t)||T(t)&&"true"!==t.getAttribute("e-animate")||i.classList.contains("e-overlay"))){var n=N(i,".e-acrdn-root").querySelector(".e-expand-state"),o={name:this.animation.expand.effect,duration:this.animation.expand.duration,timingFunction:this.animation.expand.easing},r=D(".e-toggle-icon",i).firstElementChild;e={element:i,item:this.items[this.getIndexByItem(i)],isExpanded:!0};var s=o.name;if(this.trigger("expanding",e),!e.cancel){if(r.classList.add("e-toggle-animation"),this.expandedItemsPush(i),c(n)||n.classList.remove("e-expand-state"),i.classList.add("e-expand-state"),"None"===o.name)return this.expandProgress("begin",r,t,i,e),void this.expandProgress("end",r,t,i,e);this.expandAnimation(s,r,t,i,o,e)}}},e.prototype.expandAnimation=function(t,e,i,n,o,r){var s,a,l=this;"SlideDown"===t?(o.begin=function(){l.expandProgress("begin",e,i,n,r),i.style.position="absolute",s=n.offsetHeight,a=i.offsetHeight,i.style.maxHeight=i.offsetHeight+"px",n.style.maxHeight=""},o.progress=function(){n.style.minHeight=s+i.offsetHeight+"px"},o.end=function(){j(i,{position:"",maxHeight:""}),n.style.minHeight="",l.expandProgress("end",e,i,n,r)}):(o.begin=function(){l.expandProgress("begin",e,i,n,r)},o.end=function(){l.expandProgress("end",e,i,n,r)}),new Fa(o).animate(i)},e.prototype.expandProgress=function(t,e,i,n,o){this.remove(i,"e-content-hide"),this.add(n,"e-selected"),this.add(e,"e-expand-icon"),"end"===t&&(this.add(n,"e-active"),i.setAttribute("aria-hidden","false"),R(i.previousElementSibling,{"aria-selected":"true","aria-expanded":"true"}),e.classList.remove("e-toggle-animation"),this.trigger("expanded",o))},e.prototype.expandedItemsPush=function(t){var e=this.getIndexByItem(t);-1===this.expandedItems.indexOf(e)&&this.expandedItems.push(e)},e.prototype.getIndexByItem=function(t){return[].slice.call(this.element.children).indexOf(t)},e.prototype.expandedItemsPop=function(t){var e=this.getIndexByItem(t);this.expandedItems.splice(this.expandedItems.indexOf(e),1)},e.prototype.collapse=function(t){var e,i=N(t,"."+Nm);if(!c(t)&&T(t)&&!i.classList.contains("e-overlay")){var n={name:this.animation.collapse.effect,duration:this.animation.collapse.duration,timingFunction:this.animation.collapse.easing},o=D(".e-toggle-icon",i).firstElementChild;e={element:i,item:this.items[this.getIndexByItem(i)],isExpanded:!1};var r=n.name;if(this.trigger("expanding",e),!e.cancel){if(this.expandedItemsPop(i),i.classList.add("e-expand-state"),o.classList.add("e-toggle-animation"),"None"===n.name)return this.collapseProgress("begin",o,t,i,e),void this.collapseProgress("end",o,t,i,e);this.collapseAnimation(r,t,i,o,n,e)}}},e.prototype.collapseAnimation=function(t,e,i,n,o,r){var s,a,l,h,c=this;"SlideUp"===t?(o.begin=function(){l=i.offsetHeight,i.style.minHeight=l+"px",e.style.position="absolute",s=i.offsetHeight,a=e.offsetHeight,e.style.maxHeight=a+"px",c.collapseProgress("begin",n,e,i,r)},o.progress=function(){(h=s-(a-e.offsetHeight))<l&&(i.style.minHeight=h+"px")},o.end=function(){e.style.display="none",c.collapseProgress("end",n,e,i,r),i.style.minHeight="",j(e,{position:"",maxHeight:"",display:""})}):(o.begin=function(){c.collapseProgress("begin",n,e,i,r)},o.end=function(){c.collapseProgress("end",n,e,i,r)}),new Fa(o).animate(e)},e.prototype.collapseProgress=function(t,e,i,n,o){this.remove(e,"e-expand-icon"),this.remove(n,"e-selected"),"end"===t&&(this.add(i,"e-content-hide"),e.classList.remove("e-toggle-animation"),this.remove(n,"e-active"),i.setAttribute("aria-hidden","true"),R(i.previousElementSibling,{"aria-selected":"false","aria-expanded":"false"}),this.trigger("expanded",o))},e.prototype.getModuleName=function(){return"accordion"},e.prototype.itemAttribUpdate=function(){var t=[].slice.call(this.element.children),e=this.items.length;t.forEach(function(t){D("."+Hm,t).setAttribute("aria-level",""+e)})},e.prototype.addItem=function(t,e){var i=this.element;if(c(e)&&(e=this.items.length),i.childElementCount>=e){this.items.splice(e,0,t);var n=this.renderInnerItem(t,e);i.childElementCount===e?i.appendChild(n):i.insertBefore(n,i.children[e]),Ma.add(n.querySelector("."+Hm),"focus",this.focusIn,this),Ma.add(n.querySelector("."+Hm),"blur",this.focusOut,this),this.itemAttribUpdate()}this.expandedItems=[],this.expandedItemRefresh(i),t.expanded&&this.expandItem(!0,e)},e.prototype.expandedItemRefresh=function(t){var e=this;[].slice.call(t.children).forEach(function(t){t.classList.contains("e-selected")&&e.expandedItemsPush(t)})},e.prototype.removeItem=function(t){var e=this.element.children[t];c(e)||(A(e),this.items.splice(t,1),this.itemAttribUpdate(),this.expandedItems=[],this.expandedItemRefresh(this.element))},e.prototype.select=function(t){var e=this.element.children[t];c(e)||c(D("."+Hm,e))||e.children[0].focus()},e.prototype.hideItem=function(t,e){var i=this.element.children[t];c(i)||(c(e)&&(e=!0),e?this.add(i,"e-hide"):this.remove(i,"e-hide"))},e.prototype.enableItem=function(t,e){var i=this.element.children[t];if(!c(i)){var n=i.firstElementChild;e?(this.remove(i,"e-overlay"),R(n,{tabindex:"0","aria-disabled":"false"}),n.focus()):(i.classList.contains("e-active")&&(this.expandItem(!1,t),this.eleMoveFocus("movedown",this.element,n)),this.add(i,"e-overlay"),n.setAttribute("aria-disabled","true"),n.removeAttribute("tabindex"))}},e.prototype.expandItem=function(t,e){var i=this,n=this.element;if(c(e))if("Single"===this.expandMode&&t){var o=n.children[n.childElementCount-1];this.itemExpand(t,o,this.getIndexByItem(o))}else[].slice.call(this.element.children).forEach(function(e){i.itemExpand(t,e,i.getIndexByItem(e))});else{if(c(o=this.element.children[e])||!o.classList.contains("e-select")||o.classList.contains("e-active")&&t)return;"Single"===this.expandMode&&this.expandItem(!1),this.itemExpand(t,o,e)}},e.prototype.itemExpand=function(t,e,i){var n=e.children[1];if(!e.classList.contains("e-overlay")){if(c(n)&&t)n=this.contentRendering(i),e.appendChild(n),this.ariaAttrUpdate(e);else if(c(n))return;t?this.expand(n):this.collapse(n)}},e.prototype.destroyItems=function(){[].slice.call(this.element.querySelectorAll("."+Nm)).forEach(function(t){A(t)})},e.prototype.updateItem=function(t,e){if(!c(t)){var i=this.items[e];this.items.splice(e,1),A(t),this.addItem(i,e)}},e.prototype.getPersistData=function(){var t=["expandedItems"];return this.addOnPersist(t)},e.prototype.onPropertyChanged=function(t,e){for(var i=this.element,n=0,o=Object.keys(t);n<o.length;n++)switch(o[n]){case"items":if(t.items instanceof Array&&e.items instanceof Array)this.destroyItems(),this.renderItems(),this.initItemExpand();else for(var r=Object.keys(t.items),s=0;s<r.length;s++){var a=parseInt(Object.keys(t.items)[s],10),l=Object.keys(t.items[a])[0],h=B("."+Nm,this.element)[a],d=Object(e.items[a])[l],p=Object(t.items[a])[l];"header"!==l&&"iconCss"!==l&&"expanded"!==l||this.updateItem(h,a),"cssClass"!==l||c(h)||(h.classList.remove(d),h.classList.add(p)),"content"!==l||c(h)||2!==h.children.length||(h.classList.contains("e-selected")&&this.expandItem(!1,a),A(h.querySelector("."+zm)))}break;case"enableRtl":t.enableRtl?this.add(i,"e-rtl"):this.remove(i,"e-rtl");break;case"height":j(this.element,{height:b(t.height)});break;case"width":j(this.element,{width:b(t.width)});break;case"expandMode":"Single"===t.expandMode?(this.element.setAttribute("aria-multiselectable","false"),this.expandedItems.length>1&&this.expandItem(!1)):this.element.setAttribute("aria-multiselectable","true")}},Bm([ot([],Fm)],e.prototype,"items",void 0),Bm([et("100%")],e.prototype,"width",void 0),Bm([et("auto")],e.prototype,"height",void 0),Bm([et("Multiple")],e.prototype,"expandMode",void 0),Bm([it({},Vm)],e.prototype,"animation",void 0),Bm([st()],e.prototype,"clicked",void 0),Bm([st()],e.prototype,"expanding",void 0),Bm([st()],e.prototype,"expanded",void 0),Bm([st()],e.prototype,"created",void 0),Bm([st()],e.prototype,"destroyed",void 0),e=Bm([at],e)}(wl),Wm=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Um=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},qm="e-focused",Xm="e-menu-header",Ym="e-selected",Gm="e-contextmenu-wrapper",Zm="e-menu-hide",Km=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Wm(e,t),Um([et("")],e.prototype,"iconCss",void 0),Um([et("")],e.prototype,"id",void 0),Um([et(!1)],e.prototype,"separator",void 0),Um([ot([],e)],e.prototype,"items",void 0),Um([et("")],e.prototype,"text",void 0),Um([et("")],e.prototype,"url",void 0),e}(qa),Qm=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.animation=new Fa({}),n.navIdx=[],n.isTapHold=!1,n}return Wm(e,t),e.prototype.preRender=function(){if("EJS-CONTEXTMENU"===this.element.tagName){this.element.style.display="none",this.element.classList.remove("e-"+this.getModuleName()),this.element.classList.remove("e-control");var t=n("ej2_instances",this.element),e=L("ul");this.ngElement=this.element,this.element=e,this.element.classList.add("e-control"),this.element.classList.add("e-"+this.getModuleName()),o("ej2_instances",t,this.element),this.element.id||(this.element.id=p(this.getModuleName()))}},e.prototype.render=function(){this.initWrapper(),this.renderItems(),this.wireEvents()},e.prototype.initWrapper=function(){var t=this.getWrapper();t||(t=L("div",{className:Gm}),document.body.appendChild(t)),this.cssClass&&t.classList.add(this.cssClass),this.enableRtl&&t.classList.add("e-rtl"),R(this.element,{role:"menu",tabindex:"0"}),t.appendChild(this.element),this.element.style.zIndex=Qi(this.element).toString()},e.prototype.renderItems=function(){this.items.length||(this.items=Dh.createJsonFromElement(this.element),this.element.innerHTML="");var t=this.createItems(this.items);I(Array.prototype.slice.call(t.children),this.element),this.element.classList.add("e-menu-parent")},e.prototype.wireEvents=function(){var t=this.getWrapper();if(this.target){for(var e=void 0,i=B(this.target),n=0,o=i.length;n<o;n++)e=i[n],za.isIos?new Vl(e,{tapHold:this.touchHandler.bind(this)}):Ma.add(e,"contextmenu",this.cmenuHandler,this);this.targetElement=e;for(var r=0,s=Ki(this.targetElement);r<s.length;r++){var a=s[r];Ma.add(a,"scroll",this.scrollHandler,this)}}za.isDevice||(Ma.add(t,"mouseover",this.moverHandler,this),Ma.add(document,"mousedown",this.mouseDownHandler,this)),this.delegateClickHandler=this.clickHandler.bind(this),Ma.add(document,"click",this.delegateClickHandler,this),new Rl(t,{keyAction:this.keyBoardHandler.bind(this),keyConfigs:{downarrow:"downarrow",uparrow:"uparrow",enter:"enter",leftarrow:"leftarrow",rightarrow:"rightarrow",escape:"escape"}}),pt(t,{selector:".e-menu-item"})},e.prototype.mouseDownHandler=function(t){N(t.target,"."+Gm)!==this.getWrapper()&&this.closeMenu(this.navIdx.length,t)},e.prototype.keyBoardHandler=function(t){switch(t.preventDefault(),t.action){case"downarrow":case"uparrow":this.upDownKeyHandler(t);break;case"rightarrow":this.rightEnterKeyHandler(t);break;case"leftarrow":this.leftEscKeyHandler(t);break;case"enter":this.rightEnterKeyHandler(t);break;case"escape":this.leftEscKeyHandler(t)}},e.prototype.upDownKeyHandler=function(t){var e=this.getWrapper().children[this.navIdx.length],i="downarrow"===t.action?0:e.childElementCount-1,n=i,o=this.getLIByClass(e,qm);o&&(n=this.getIdx(e,o),o.classList.remove(qm),"downarrow"===t.action?n++:n--,n===("downarrow"===t.action?e.childElementCount:-1)&&(n=i));var r=e.children[n];n=this.isValidLI(r,n,t.action),e.children[n].classList.add(qm),e.children[n].focus()},e.prototype.isValidLI=function(t,e,i){var n=this.getWrapper().children[this.navIdx.length];return(t.classList.contains("e-separator")||t.classList.contains("e-disabled")||t.classList.contains(Zm))&&("downarrow"===i||"rightarrow"===i?e++:e--),((t=n.children[e]).classList.contains("e-separator")||t.classList.contains("e-disabled")||t.classList.contains(Zm))&&(e=this.isValidLI(t,e,i)),e},e.prototype.rightEnterKeyHandler=function(t){var e,i=this.getWrapper(),n=i.children[this.navIdx.length],o=this.getLIByClass(n,qm);if(o){var r=this.getIdx(n,o),s=this.navIdx.concat(r),a=void 0,l=this.getItem(s);l.items.length?(this.navIdx.push(r),this.openMenu(o,l,null,null,t),o.classList.remove(qm),o.classList.add(Ym),"enter"===t.action&&(e={element:o,item:l},this.trigger("select",e)),o.focus(),n=i.children[this.navIdx.length],a=this.isValidLI(n.children[0],0,t.action),n.children[a].classList.add(qm),n.children[a].focus()):"enter"===t.action&&(o.classList.remove(qm),o.classList.add(Ym),e={element:o,item:l},this.trigger("select",e),this.closeMenu(null,t))}},e.prototype.leftEscKeyHandler=function(t){if(this.navIdx.length){var e=this.getWrapper();this.closeMenu(this.navIdx.length,t);var i=e.children[this.navIdx.length],n=this.getLIByClass(i,Ym);n&&(n.setAttribute("aria-expanded","false"),n.classList.remove(Ym),n.classList.add(qm),n.focus())}else"escape"===t.action&&this.closeMenu(null,t)},e.prototype.scrollHandler=function(t){this.closeMenu(null,t)},e.prototype.touchHandler=function(t){this.isTapHold=!0,this.cmenuHandler(t.originalEvent)},e.prototype.cmenuHandler=function(t){t.preventDefault(),this.closeMenu(null,t),this.canOpen(t.target)&&(t.changedTouches?this.openMenu(null,null,t.changedTouches[0].pageY+1,t.changedTouches[0].pageX+1,t):this.openMenu(null,null,t.pageY+1,t.pageX+1,t))},e.prototype.close=function(){this.closeMenu()},e.prototype.closeMenu=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=null),this.isMenuVisible())for(var i=void 0,n=void 0,o=void 0,r=void 0,s=void 0,a=this.getWrapper(),l=a.childElementCount;l>t;l--)o=(n=this.navIdx.length?this.getItem(this.navIdx):null)?n.items:this.items,s={element:i=a.children[l-1],parentItem:n,items:o,event:e,cancel:!1},this.trigger("beforeClose",s),s.cancel||(this.toggleAnimation(i,!1),this.navIdx.length=t?t-1:t,r={element:i,parentItem:n,items:o},this.trigger("onClose",r))},e.prototype.isMenuVisible=function(){return this.navIdx.length>0||this.element.classList.contains("e-contextmenu")&&T(this.element).valueOf()},e.prototype.canOpen=function(t){var e=!0;if(this.filter){e=!1;for(var i=this.filter.split(" "),n=0,o=t.classList.length;n<o;n++)if(i.indexOf(t.classList[n])>-1){e=!0;break}}return e},e.prototype.open=function(t,e){this.openMenu(null,null,t,e)},e.prototype.openMenu=function(t,e,i,n,o){void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=null);var r,s=this.getWrapper();if(t){if(r=this.createItems(e.items),za.isDevice){s.lastChild.style.display="none";var a={text:e.text,iconCss:"e-icons e-previous"},l=new Km(this.items[0],null,a,!0),h=this.createItems([l]).children[0];h.classList.add(Xm),r.insertBefore(h,r.children[0])}r.style.zIndex=this.element.style.zIndex,s.appendChild(r)}else r=this.element;this.getIndex(t?t.id:null,!0);var c={element:r,items:t?e.items:this.items,parentItem:e,event:o,cancel:!1};this.trigger("beforeOpen",c),c.cancel?this.navIdx.pop():(this.setPosition(t,r,i,n),this.toggleAnimation(r))},e.prototype.setPosition=function(t,e,i,n){if(this.toggleVisiblity(e),e===this.element)(r=Oi(e,null,n,i)).indexOf("right")>-1&&(n-=e.offsetWidth),r.indexOf("bottom")>-1&&(i=(o=Ti(e,null,{X:!1,Y:!0},{top:i,left:n})).top-20),(r=Oi(e,null,n,i)).indexOf("left")>-1&&(n=(o=Ti(e,null,{X:!0,Y:!1},{top:i,left:n})).left);else if(za.isDevice)i=Number(this.element.style.top.replace("px","")),n=Number(this.element.style.left.replace("px",""));else{var o=fi(t,this.enableRtl?"left":"right","top");i=o.top,n=o.left;var r=Oi(e,null,this.enableRtl?n-e.offsetWidth:n,i),s=r.indexOf("left")>-1||r.indexOf("right")>-1;s&&(n=(o=fi(t,this.enableRtl?"right":"left","top")).left),(this.enableRtl||s)&&(n=this.enableRtl&&s?n:n-e.offsetWidth),r.indexOf("bottom")>-1&&(i=(o=Ti(e,null,{X:!1,Y:!0},{top:i,left:n})).top)}this.toggleVisiblity(e,!1),e.style.top=i+"px",e.style.left=n+"px"},e.prototype.toggleVisiblity=function(t,e){void 0===e&&(e=!0),t.style.visibility=e?"hidden":"",t.style.display=e?"block":"none"},e.prototype.createItems=function(t){var e=this,i=this.hasField(t,"iconCss"),n={showIcon:i,moduleName:"menu",itemCreating:function(t){t.curData.id||(t.curData.id=p("menuitem")),t.curData.htmlAttributes={role:"menuitem",tabindex:"-1"}},itemCreated:function(t){if(t.curData.separator&&(t.item.classList.add("e-separator"),t.item.removeAttribute("role")),!i||t.curData.iconCss||t.curData.separator||t.item.classList.add("e-blankicon"),t.curData.items&&t.curData.items.length){var n=L("span",{className:"e-icons e-caret"});t.item.appendChild(n),t.item.setAttribute("aria-haspopup","true"),t.item.setAttribute("aria-expanded","false"),t.item.removeAttribute("role"),t.item.classList.add("e-menu-caret-icon")}var o={item:t.curData,element:t.item};e.trigger("beforeItemRender",o)}},o=Dh.createList(this.toRawObject(t.slice()),n,!0);return o.setAttribute("tabindex","0"),o},e.prototype.toRawObject=function(t){for(var e,i=[],n=0,o=t.length;n<o;n++)e=t[n].properties,i.push(e);return i},e.prototype.moverHandler=function(t){var e=this.getWrapper(),i=t.target,n=this.getLI(i);if(n&&N(n,"."+Gm)){var o=D("."+qm,e);o&&o.classList.remove(qm),n.classList.add(qm),this.showItemOnClick||this.clickHandler(t)}},e.prototype.hasField=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i][e])return!0;return!1},e.prototype.getWrapper=function(){return N(this.element,"."+Gm)},e.prototype.clickHandler=function(t){if(this.isTapHold)this.isTapHold=!1;else{var e=this.getWrapper(),i=t.target,n=this.getLI(i),o=n?N(n,"."+Gm):null,r=n&&o&&e.firstElementChild.id===o.firstElementChild.id;if(r&&"click"===t.type&&!n.classList.contains(Xm)){this.setLISelected(n);var s=this.getIndex(n.id,!0),a={element:n,item:m=this.getItem(s)};this.trigger("select",a)}if(r&&("mouseover"===t.type||za.isDevice||this.showItemOnClick)){var l=void 0;if(n.classList.contains(Xm))l=e.children[this.navIdx.length-1],this.toggleAnimation(l),(u=this.getLIByClass(l,Ym))&&u.classList.remove(Ym),A(n.parentNode),this.navIdx.pop();else if(!n.classList.contains("e-separator")){var h=!0,c=n.parentNode,d=this.getIdx(c,n);if(!za.isDevice){var p=this.getIdx(e,c);if(this.navIdx[p]===d&&(h=!1),p!==this.navIdx.length&&("mouseover"!==t.type||h)){var u=this.getLIByClass(c,Ym);u&&u.classList.remove(Ym),this.closeMenu(p+1,t)}}if(h){var g=this.navIdx.concat(d),m=this.getItem(g);m.items.length?("mouseover"===t.type&&this.setLISelected(n),n.setAttribute("aria-expanded","true"),this.navIdx.push(d),this.openMenu(n,m,null,null,t)):"mouseover"!==t.type&&this.closeMenu(null,t)}}}else"UL"===i.tagName&&i.parentElement===e||n&&n.querySelector(".e-caret")||this.closeMenu(null,t)}},e.prototype.setLISelected=function(t){var e=this.getLIByClass(t.parentElement,Ym);e&&e.classList.remove(Ym),t.classList.remove(qm),t.classList.add(Ym)},e.prototype.getLIByClass=function(t,e){for(var i=0,n=t.children.length;i<n;i++)if(t.children[i].classList.contains(e))return t.children[i];return null},e.prototype.getItem=function(t){var e=(t=t.slice()).pop();return this.getItems(t)[e]},e.prototype.getItems=function(t){for(var e=this.items,i=0;i<t.length;i++)e=e[t[i]].items;return e},e.prototype.getIdx=function(t,e,i){void 0===i&&(i=!0);var n=Array.prototype.indexOf.call(t.children,e);return i&&t.children[0].classList.contains(Xm)&&n--,n},e.prototype.getLI=function(t){return"LI"===t.tagName?t:N(t,"li")},e.prototype.onPropertyChanged=function(t,e){for(var i=this.getWrapper(),n=0,o=Object.keys(t);n<o.length;n++)switch(o[n]){case"cssClass":e.cssClass&&i.classList.remove(e.cssClass),t.cssClass&&i.classList.add(t.cssClass);break;case"enableRtl":i.classList.toggle("e-rtl");break;case"filter":this.closeMenu(),this.filter=t.filter;break;case"showItemOnClick":this.unWireEvents(),this.showItemOnClick=t.showItemOnClick,this.wireEvents();break;case"target":this.unWireEvents(),this.target=t.target,this.wireEvents();break;case"items":for(var r=void 0,s=void 0,a=void 0,l=Object.keys(t.items),h=0;h<l.length;h++)(s=this.getChangedItemIndex(t,[],Number(l[h]))).length<=this.getWrapper().children.length&&(r=s.pop(),a=this.getItems(s),this.insertAfter([a[r]],a[r].text),this.removeItem(a,s,r)),s.length=0}},e.prototype.getChangedItemIndex=function(t,e,i){e.push(i);var n=Object.keys(t.items[i]).pop();if("items"===n){var o=t.items[i];this.getChangedItemIndex(o,e,Number(Object.keys(o.items).pop()))}else"isParentArray"===n&&e.length>1&&e.pop();return e},e.prototype.removeItem=function(t,e,i){t.splice(i,1);var n=this.getWrapper().children;e.length<n.length&&A(n[e.length].children[i])},e.prototype.unWireEvents=function(){var t=this.getWrapper();if(this.target){for(var e=void 0,i=void 0,n=B(this.target),o=0,r=n.length;o<r;o++)e=n[o],za.isIos?(i=w(e,Vl))&&i.destroy():Ma.remove(e,"contextmenu",this.cmenuHandler);for(var s=0,a=Ki(this.targetElement);s<a.length;s++){var l=a[s];Ma.remove(l,"scroll",this.scrollHandler)}}za.isDevice||(Ma.remove(t,"mouseover",this.moverHandler),Ma.remove(document,"mousedown",this.mouseDownHandler)),Ma.remove(document,"click",this.delegateClickHandler);var h=w(t,Rl);h&&h.destroy()},e.prototype.toggleAnimation=function(t,e){var i=this;void 0===e&&(e=!0),"None"!==this.animationSettings.effect&&e?this.animation.animate(t,{name:this.animationSettings.effect,duration:this.animationSettings.duration,timingFunction:this.animationSettings.easing,begin:function(t){t.element.style.display="block",t.element.style.maxHeight=t.element.getBoundingClientRect().height+"px"},end:function(t){i.end(t.element,e)}}):this.end(t,e)},e.prototype.end=function(t,e){if(e){t.style.display="block",t.style.maxHeight="";var i=this.navIdx.length?this.getItem(this.navIdx):null,n={element:t,parentItem:i,items:i?i.items:this.items};if(this.trigger("onOpen",n),t.querySelector("."+qm))t.querySelector("."+qm).focus();else{var o=void 0;(o=this.getWrapper().children[this.getIdx(this.getWrapper(),t)-1])?o.querySelector("."+Ym).focus():this.element.focus()}}else if(t===this.element){var r=this.getLIByClass(this.element,qm);r&&r.classList.remove(qm);var s=this.getLIByClass(this.element,Ym);s&&s.classList.remove(Ym),t.style.display="none"}else A(t)},e.prototype.getPersistData=function(){return""},e.prototype.getModuleName=function(){return"contextmenu"},e.prototype.getIndex=function(t,e,i,n,o){void 0===i&&(i=this.items),void 0===n&&(n=[]),void 0===o&&(o=!1);for(var r,s=0,a=i.length;s<a;s++){if(r=i[s],(e?r.id:r.text)===t){n.push(s);break}if(r.items.length){if(-1!==(n=this.getIndex(t,e,r.items,n,!0))[n.length-1]){n.unshift(s);break}s!==a-1&&n.pop()}else s===a-1&&n.push(-1)}return o||-1!==n[0]?n:[]},e.prototype.enableItems=function(t,e,i){void 0===e&&(e=!0);for(var n,o,r,s=this.getWrapper(),a=0;a<t.length;a++)o=(r=this.getIndex(t[a],i)).pop(),(n=s.children[r.length])&&(e?za.isDevice&&!n.classList.contains("e-contextmenu")?n.children[o+1].classList.remove("e-disabled"):n.children[o].classList.remove("e-disabled"):za.isDevice&&!n.classList.contains("e-contextmenu")?n.children[o+1].classList.add("e-disabled"):n.children[o].classList.add("e-disabled"))},e.prototype.showItems=function(t,e){this.showHideItems(t,!1,e)},e.prototype.hideItems=function(t,e){this.showHideItems(t,!0,e)},e.prototype.showHideItems=function(t,e,i){for(var n,o,r,s=this.getWrapper(),a=0;a<t.length;a++)o=(r=this.getIndex(t[a],i)).pop(),(n=s.children[r.length])&&(e?za.isDevice&&!n.classList.contains("e-contextmenu")?n.children[o+1].classList.add(Zm):n.children[o].classList.add(Zm):za.isDevice&&!n.classList.contains("e-contextmenu")?n.children[o+1].classList.remove(Zm):n.children[o].classList.remove(Zm))},e.prototype.removeItems=function(t,e){for(var i,n,o,r=0;r<t.length;r++)i=(n=this.getIndex(t[r],e)).pop(),o=this.getItems(n),this.removeItem(o,n,i)},e.prototype.insertAfter=function(t,e,i){this.insertItems(t,e,i)},e.prototype.insertBefore=function(t,e,i){this.insertItems(t,e,i,!1)},e.prototype.insertItems=function(t,e,i,n){void 0===n&&(n=!0);for(var o,r,s,a,l,h=0;h<t.length;h++){r=(s=this.getIndex(e,i)).pop(),a=this.getItems(s),l=new Km(a[0],"items",t[h],!0),a.splice(n?r+1:r,0,l);var c=this.getWrapper().children;s.length<c.length&&(r=n?r+1:r,this.hasField(a,"iconCss"),o=this.createItems(a).children[r],c[s.length].insertBefore(o,c[s.length].children[r]))}},e.prototype.destroy=function(){var e=this,i=this.getWrapper();i&&(t.prototype.destroy.call(this),this.unWireEvents(),this.ngElement?this.ngElement.style.display="block":(this.closeMenu(),this.element.innerHTML="",["top","left","display","z-index"].forEach(function(t){e.element.style.removeProperty(t)}),["role","tabindex","class","style"].forEach(function(t){-1!==["class","style"].indexOf(t)&&e.element.getAttribute(t)||e.element.removeAttribute(t)}),i.parentNode.insertBefore(this.element,i)),A(i))},Um([et("")],e.prototype,"cssClass",void 0),Um([et("")],e.prototype,"filter",void 0),Um([et(!1)],e.prototype,"showItemOnClick",void 0),Um([ot([],Km)],e.prototype,"items",void 0),Um([et("")],e.prototype,"target",void 0),Um([et({duration:400,easing:"ease",effect:"SlideDown"})],e.prototype,"animationSettings",void 0),Um([st()],e.prototype,"beforeItemRender",void 0),Um([st()],e.prototype,"beforeOpen",void 0),Um([st()],e.prototype,"onOpen",void 0),Um([st()],e.prototype,"beforeClose",void 0),Um([st()],e.prototype,"onClose",void 0),Um([st()],e.prototype,"select",void 0),e=Um([at],e)}(wl),Jm=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),$m=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},tf="e-tab-header",ef="e-toolbar-items",nf="e-toolbar-item",of="e-toolbar-popup",rf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Jm(e,t),$m([et("SlideLeftIn")],e.prototype,"effect",void 0),$m([et(600)],e.prototype,"duration",void 0),$m([et("ease")],e.prototype,"easing",void 0),e}(qa),sf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Jm(e,t),$m([it({effect:"SlideLeftIn",duration:600,easing:"ease"},rf)],e.prototype,"previous",void 0),$m([it({effect:"SlideRightIn",duration:600,easing:"ease"},rf)],e.prototype,"next",void 0),e}(qa),af=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Jm(e,t),$m([et("")],e.prototype,"text",void 0),$m([et("")],e.prototype,"iconCss",void 0),$m([et("left")],e.prototype,"iconPosition",void 0),e}(qa),lf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Jm(e,t),$m([it({},af)],e.prototype,"header",void 0),$m([et("")],e.prototype,"content",void 0),$m([et("")],e.prototype,"cssClass",void 0),$m([et(!1)],e.prototype,"disabled",void 0),e}(qa),hf=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.prevIndex=0,n.show={name:"SlideDown",duration:100},n.hide={name:"SlideUp",duration:100},n.animateOptions={},n.animObj=new Fa(n.animateOptions),n.maxHeight=0,n.title="Close",n.keyConfigs={tab:"tab",home:"home",end:"end",enter:"enter",space:"space",delete:"delete",moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",moveDown:"downarrow"},n}return Jm(e,t),e.prototype.destroy=function(){var e=this;if(c(this.tbObj)||this.tbObj.destroy(),this.unWireEvents(),["role","aria-disabled","aria-activedescendant","tabindex","aria-orientation"].forEach(function(t){e.element.removeAttribute(t)}),this.expTemplateContent(),this.isTemplate){var i=D(".e-tab > .e-content",this.element);this.element.classList.remove("e-template"),c(i)||(i.innerHTML=this.cnt)}else this.element.innerHTML="";t.prototype.destroy.call(this),this.trigger("destroyed")},e.prototype.preRender=function(){var t=N(this.element,".e-content");this.isNested=!1,this.isPopup=!1,this.initRender=!0,this.isSwipeed=!1,this.templateEle=[],c(t)||(t.parentElement.classList.add("e-nested"),this.isNested=!0);var e=za.info.name,i="msie"===e?"e-ie":"edge"===e?"e-edge":"safari"===e?"e-safari":"";j(this.element,{width:b(this.width),height:b(this.height)}),this.setCssClass(this.element,this.cssClass,!0),R(this.element,{role:"tablist","aria-disabled":"false","aria-activedescendant":""}),this.setCssClass(this.element,i,!0)},e.prototype.render=function(){this.renderContainer(),this.wireEvents(),this.initRender=!1},e.prototype.renderContainer=function(){var t=this.element;if(this.items.length>0&&0===t.children.length)t.appendChild(L("div",{className:"e-content"})),this.setOrientation(this.headerPlacement,L("div",{className:tf})),this.isTemplate=!1;else if(this.element.children.length>0){this.isTemplate=!0,t.classList.add("e-template");var e=t.querySelector(".e-tab-header");e&&"Bottom"===this.headerPlacement&&this.setOrientation(this.headerPlacement,e)}if(!c(D(".e-tab-header",this.element))&&!c(D(".e-content",this.element))){if(this.renderHeader(),this.tbItems=D(".e-tab-header ."+ef,this.element),c(this.tbItems)||pt(this.tbItems,{selector:".e-tab-wrap"}),this.renderContent(),B("."+nf,this.element).length>0){this.tbItems=D(".e-tab-header ."+ef,this.element),this.bdrLine=L("div",{className:"e-indicator e-hidden e-ignore"});var i=D(".e-hscroll-content",this.tbItems);c(i)?this.tbItems.insertBefore(this.bdrLine,this.tbItems.firstChild):i.insertBefore(this.bdrLine,i.firstChild),this.setContentHeight(!0),this.select(this.selectedItem)}this.setRTL(this.enableRtl)}},e.prototype.renderHeader=function(){var t=this,e=[];if(this.hdrEle=D(".e-tab-header",this.element),this.btnCls=L("span",{className:"e-icons e-close-icon",attrs:{title:this.title}}).outerHTML,this.isTemplate){for(var i=this.hdrEle.children.length,n=[],o=0;o<i;o++)n.push(this.hdrEle.children.item(o).innerHTML);i>0&&(this.hdrEle.innerHTML="",this.hdrEle.appendChild(L("div",{className:"e-items"})),n.forEach(function(e,i){var n={className:"e-item",id:"e-item_"+i,attrs:{role:"tab","aria-controls":"e-content_"+i,"aria-selected":"false"}},o=L("div",{className:"e-tab-wrap",innerHTML:L("div",{className:"e-text-wrap",innerHTML:L("span",{className:"e-tab-text",innerHTML:e,attrs:{role:"presentation"}}).outerHTML+t.btnCls}).outerHTML,attrs:{tabIndex:"-1"}});D(".e-items",t.element).appendChild(L("div",n)),B(".e-item",t.element)[i].appendChild(o)}))}else e=this.parseObject(this.items,0);this.tbObj=new Rm({width:"100%",overflowMode:this.overflowMode,items:0!==e.length?e:[],clicked:this.clickHandler.bind(this)}),this.tbObj.appendTo(this.hdrEle),R(this.element,{"aria-orientation":"horizontal"}),this.setCloseButton(this.showCloseButton),this.setProperties({headerPlacement:this.element.children.item(0).classList.contains(tf)?"Top":"Bottom"},!0)},e.prototype.renderContent=function(){this.cntEle=D(".e-content",this.element);var t=B("."+nf,this.element);if(this.isTemplate){this.cnt=this.cntEle.children.length>0?this.cntEle.innerHTML:"";for(var e=this.cntEle.children,i=0;i<t.length;i++)e.length-1>=i&&(e.item(i).className+="e-item",R(e.item(i),{role:"tabpanel","aria-labelledby":"e-item_"+i}),e.item(i).id="e-content_"+i)}},e.prototype.parseObject=function(t,e){var i=this,n="",o=B("."+nf,this.element).length,r=[];return t.forEach(function(t,s){var a=c(t.header.iconPosition)?"":t.header.iconPosition,l=c(t.header.iconCss)?"":t.header.iconCss,h=t.header.text,d=0===o?s:!0===i.isReplace?s+e:o+s,p=t.disabled?" e-disable e-overlay":"",u=h instanceof Object?h.outerHTML:h,g=!c(u)&&""!==u,m=g?L("div",{className:"e-tab-text",innerHTML:u,attrs:{role:"presentation"}}).outerHTML:"",f=L("span",{className:"e-icons e-tab-icon e-icon-"+a+" "+l}).outerHTML;if(""!==h&&void 0!==h||""!==l){n=""!==h&&void 0!==h&&""!==l?"left"===a||"top"===a?f+""+m:m+""+f:""===l?m:f;var v=t.disabled?{}:{tabIndex:"-1"},y={htmlAttributes:{id:"e-item_"+d,role:"tab","aria-selected":"false"},template:L("div",{className:"e-tab-wrap",innerHTML:L("div",{className:"e-text-wrap",innerHTML:n+""+i.btnCls}).outerHTML,attrs:v}).outerHTML};y.cssClass=t.cssClass+" "+p+" "+(""!==l?"e-i"+a:"")+" "+(g?"":"e-icon"),"top"!==a&&"bottom"!==a||i.element.classList.add("e-vertical-icon"),r.push(y)}}),r},e.prototype.removeActiveClass=function(t){var e=B(":root .e-tab-header .e-toolbar-item.e-active",this.element)[0];if("Bottom"===this.headerPlacement&&(e=B(":root .e-tab-header .e-toolbar-item.e-active",this.element.children[1])[0]),!c(e)){e.classList.remove("e-active");var i=this.extIndex(e.id);this.findEle(D(".e-content",this.element).children,"e-content_"+i)}},e.prototype.checkPopupOverflow=function(t){this.tbPop=D(".e-toolbar-pop",this.element);var e=D(".e-hor-nav",this.element),i=D("."+ef,this.element);return(this.enableRtl&&e.offsetLeft+e.offsetWidth>i.offsetLeft||!this.enableRtl&&e.offsetLeft<i.offsetWidth)&&(t.classList.add(of),this.tbPop.insertBefore(t.cloneNode(!0),B("."+of,this.tbPop)[0]),t.outerHTML=""),!0},e.prototype.popupHandler=function(t){var e=t.querySelector(".e-ripple-element");c(e)||(e.outerHTML="",t.querySelector(".e-tab-wrap").classList.remove("e-ripple")),this.tbItem=B(".e-toolbar-items ."+nf,this.hdrEle);var i=this.tbItem[this.tbItem.length-1];if(0!==this.tbItem.length){if(t.classList.remove(of),this.tbItems.appendChild(t.cloneNode(!0)),this.actEleId=t.id,t.outerHTML="",this.checkPopupOverflow(i)){var n=this.tbItems.lastChild.previousElementSibling;this.checkPopupOverflow(n)}this.isPopup=!0}return B("."+nf,this.tbItems).length-1},e.prototype.setCloseButton=function(t){var e=D(".e-tab-header",this.element);!0===t?e.classList.add("e-close-show"):e.classList.remove("e-close-show"),this.tbObj.refreshOverflow(),this.refreshActElePosition()},e.prototype.prevCtnAnimation=function(t,e){this.enableRtl||this.element.classList.contains("e-rtl");return this.isPopup||t<=e?"SlideLeftIn"===this.animation.previous.effect?{name:"SlideLeftOut",duration:this.animation.previous.duration,timingFunction:this.animation.previous.easing}:null:"SlideRightIn"===this.animation.next.effect?{name:"SlideRightOut",duration:this.animation.next.duration,timingFunction:this.animation.next.easing}:null},e.prototype.triggerPrevAnimation=function(t,e){var i=this,n=this.prevCtnAnimation(e,this.selectedItem);c(n)?t.classList.remove("e-active"):(n.begin=function(){j(t,{position:"absolute"}),t.classList.add("e-progress"),t.classList.add("e-view")},n.end=function(){t.style.display="none",t.classList.remove("e-active"),t.classList.remove("e-progress"),t.classList.remove("e-view"),j(t,{display:"",position:""}),0!==t.childElementCount||i.isTemplate||A(t)},new Fa(n).animate(t))},e.prototype.triggerAnimation=function(t,e){var i,n=this,o=this.prevIndex;[].slice.call(this.element.querySelector(".e-content").children).forEach(function(t){t.id===n.prevActiveEle&&(i=t)});var r=this.tbItem[o],s=this.extIndex(this.tbItem[this.selectedItem].id),a=this.getTrgContent(this.cntEle,s);if(c(i)&&!c(r)){var l=this.extIndex(r.id);i=this.getTrgContent(this.cntEle,l)}if(this.initRender||!1===e||this.animation==={}||c(this.animation))return void(i&&i!==a&&i.classList.remove("e-active"));var h,d=D(".e-content",this.element);if(this.prevIndex>this.selectedItem&&!this.isPopup){var p=this.animation.previous.effect;h={name:"None"===p?"":"SlideLeftIn"!==p?p:"SlideLeftIn",duration:this.animation.previous.duration,timingFunction:this.animation.previous.easing}}else if(this.isPopup||this.prevIndex<this.selectedItem||this.prevIndex===this.selectedItem){var u=this.animation.next.effect;h={name:"None"===u?"":"SlideRightIn"!==u?u:"SlideRightIn",duration:this.animation.next.duration,timingFunction:this.animation.next.easing}}h.progress=function(){d.classList.add("e-progress"),n.setActiveBorder()},h.end=function(){d.classList.remove("e-progress"),a.classList.add("e-active")},this.initRender||this.triggerPrevAnimation(i,o),this.prevActiveEle=a.id,this.isPopup=!1,""===h.name?a.classList.add("e-active"):new Fa(h).animate(a)},e.prototype.keyPressed=function(t){var e=N(t,".e-tab-header ."+nf),i=this.getEleIndex(e);!c(this.popEle)&&t.classList.contains("e-hor-nav")?this.popEle.classList.contains("e-popup-open")?this.popObj.hide(this.hide):this.popObj.show(this.show):t.classList.contains("e-scroll-nav")?t.click():c(e)||!1!==e.classList.contains("e-active")||(this.select(i),c(this.popEle)||this.popObj.hide(this.hide))},e.prototype.getEleIndex=function(t){return Array.prototype.indexOf.call(B(".e-tab-header ."+nf,this.element),t)},e.prototype.extIndex=function(t){return t.replace("e-item_","")},e.prototype.expTemplateContent=function(){var t=this;this.templateEle.forEach(function(e){c(t.element.querySelector(e))||(document.body.appendChild(t.element.querySelector(e)).style.display="none")})},e.prototype.templateCompile=function(t,e){var i=L("div"),n=Tt(e),o=n();!c(n)&&o.length>0&&([].slice.call(o).forEach(function(t){i.appendChild(t)}),t.appendChild(i))},e.prototype.getContent=function(t,e,i){var n,o=this.items[Number(e)].content;if("string"==typeof o||c(o.innerHTML))if("."===o[0]||"#"===o[0])if(document.querySelectorAll(o).length){var r=document.querySelector(o);n=r.outerHTML.trim(),"clone"===i?t.appendChild(r.cloneNode(!0)):(t.appendChild(r),r.style.display="")}else this.templateCompile(t,o);else this.templateCompile(t,o);else t.appendChild(o);c(n)||-1===this.templateEle.indexOf(o.toString())&&this.templateEle.push(o.toString())},e.prototype.getTrgContent=function(t,e){return this.element.classList.contains("e-nested")?D(".e-nested> .e-content > #e-content_"+e,this.element):this.findEle(t.children,"e-content_"+e)},e.prototype.findEle=function(t,e){for(var i,n=0;n<t.length;n++)if(t[n].id===e){i=t[n];break}return i},e.prototype.setOrientation=function(t,e){"Bottom"===t?this.element.appendChild(e):this.element.insertBefore(e,D(".e-content",this.element))},e.prototype.setCssClass=function(t,e,i){if(""!==e)for(var n=e.split(" "),o=0;o<n.length;o++)i?t.classList.add(n[o]):t.classList.remove(n[o])},e.prototype.setContentHeight=function(t){if(!c(this.cntEle)){var e=D(".e-tab-header",this.element);if("None"===this.heightAdjustMode){if("auto"===this.height)return;j(this.cntEle,{height:this.element.offsetHeight-e.offsetHeight+"px"})}else if("Fill"===this.heightAdjustMode)j(this.element,{height:"100%"}),j(this.cntEle,{height:"auto"});else if("Auto"===this.heightAdjustMode){var i=B(".e-content > .e-item",this.element);if(!0===this.isTemplate)for(o=0;o<i.length;o++)i[o].setAttribute("style","display:block; visibility: visible"),this.maxHeight=Math.max(this.maxHeight,this.getHeight(i[o])),i[o].style.removeProperty("display"),i[o].style.removeProperty("visibility");else{this.cntEle=D(".e-content",this.element),!0===t&&this.cntEle.appendChild(L("div",{id:"e-content_0",className:"e-item e-active",attrs:{role:"tabpanel","aria-labelledby":"e-item_0"}}));for(var n=this.cntEle.children.item(0),o=0;o<this.items.length;o++)this.getContent(n,o,"clone"),this.maxHeight=Math.max(this.maxHeight,this.getHeight(n)),n.innerHTML="";this.templateEle=[],this.getContent(n,0,"render"),n.classList.remove("e-active")}j(this.cntEle,{height:this.maxHeight+"px"})}else j(this.cntEle,{height:"auto"})}},e.prototype.getHeight=function(t){var e=window.getComputedStyle(t);return t.offsetHeight+parseFloat(e.getPropertyValue("padding-top"))+parseFloat(e.getPropertyValue("padding-bottom"))+parseFloat(e.getPropertyValue("margin-top"))+parseFloat(e.getPropertyValue("margin-bottom"))},e.prototype.setActiveBorder=function(){var t=D(".e-toolbar-item.e-active",this.element);if("Bottom"===this.headerPlacement&&(t=D(".e-toolbar-item.e-active",this.element.children[1])),null!==t){var e=N(t,".e-tab");if(this.element===e){var i=D(".e-tab-header .e-toolbar-items .e-hscroll-content",this.element.children[0]);this.tbItems=D(".e-tab-header ."+ef,this.element);var n=D(".e-tab-header .e-indicator",this.element);"Bottom"===this.headerPlacement&&(i=D(".e-tab-header .e-toolbar-items .e-hscroll-content",this.element.children[1]));var o=c(i)?this.tbItems.offsetWidth:i.offsetWidth;0!==o?j(n,{left:t.offsetLeft+"px",right:o-(t.offsetLeft+t.offsetWidth)+"px"}):j(n,{left:"auto",right:"auto"}),c(this.bdrLine)||this.bdrLine.classList.remove("e-hidden")}}},e.prototype.setActive=function(t){this.tbItem=B(".e-tab-header ."+nf,this.element);var e=this.tbItem[t];if(t>=0&&this.setProperties({selectedItem:t},!0),!(t<0||isNaN(t)||0===this.tbItem.length)){if(e.classList.contains("e-active"))return void this.setActiveBorder();if(!this.isTemplate){var i=this.tbItem[this.prevIndex];c(i)||i.removeAttribute("aria-controls"),R(e,{"aria-controls":"e-content_"+t})}var n=e.id;this.removeActiveClass(n),e.classList.add("e-active"),e.setAttribute("aria-selected","true");var o=Number(this.extIndex(n));if(R(this.element,{"aria-activedescendant":n}),this.isTemplate){if(D(".e-content",this.element).children.length>0){var r=this.findEle(D(".e-content",this.element).children,"e-content_"+o);c(r)||r.classList.add("e-active"),this.triggerAnimation(n,this.enableAnimation)}}else{this.cntEle=D(".e-tab > .e-content",this.element);var s=this.getTrgContent(this.cntEle,this.extIndex(n));if(c(s)){this.cntEle.appendChild(L("div",{id:"e-content_"+this.extIndex(n),className:"e-item e-active",attrs:{role:"tabpanel","aria-labelledby":"e-item_"+this.extIndex(n)}}));var a=this.getTrgContent(this.cntEle,this.extIndex(n));this.getContent(a,Number(this.extIndex(n)),"render")}else s.classList.add("e-active");this.triggerAnimation(n,this.enableAnimation)}this.setActiveBorder();var l=D(".e-tab-header #"+n,this.element);this.refreshItemVisibility(l),l.firstChild.focus();var h={previousItem:this.prevItem,previousIndex:this.prevIndex,selectedItem:e,selectedIndex:t,isSwiped:this.isSwipeed};this.trigger("selected",h)}},e.prototype.setItems=function(t){this.isReplace=!0,this.tbItems=D(".e-tab-header ."+ef,this.element),this.tbObj.items=this.parseObject(t,0),this.tbObj.dataBind(),this.isReplace=!1},e.prototype.setRTL=function(t){this.tbObj.enableRtl=t,this.tbObj.dataBind(),this.setCssClass(this.element,"e-rtl",t),this.refreshActiveBorder()},e.prototype.refreshActiveBorder=function(){c(this.bdrLine)||this.bdrLine.classList.add("e-hidden"),this.setActiveBorder()},e.prototype.wireEvents=function(){window.addEventListener("resize",this.refreshActElePosition.bind(this)),Ma.add(this.element,"mouseover",this.hoverHandler,this),Ma.add(this.element,"keydown",this.spaceKeyDown,this),c(this.cntEle)||(this.touchModule=new Vl(this.cntEle,{swipe:this.swipeHandler.bind(this)})),this.keyModule=new Rl(this.element,{keyAction:this.keyHandler.bind(this),keyConfigs:this.keyConfigs}),this.tabKeyModule=new Rl(this.element,{keyAction:this.keyHandler.bind(this),keyConfigs:{openPopup:"shift+f10",tab:"tab",shiftTab:"shift+tab"},eventName:"keydown"})},e.prototype.unWireEvents=function(){this.keyModule.destroy(),this.tabKeyModule.destroy(),c(this.cntEle)||this.touchModule.destroy(),window.removeEventListener("resize",this.refreshActElePosition.bind(this)),this.element.removeEventListener("mouseover",this.hoverHandler.bind(this))},e.prototype.clickHandler=function(t){this.element.classList.remove("e-focused");var e=t.originalEvent.target,i=N(e,"."+nf),n=this.getEleIndex(i);e.classList.contains("e-close-icon")?this.removeTab(n):(this.isPopup=!1,c(i)||n===this.selectedItem||this.select(n))},e.prototype.swipeHandler=function(t){if(!(t.velocity<3&&c(t.originalEvent.changedTouches))){if(this.isSwipeed=!0,"Right"===t.swipeDirection&&0!==this.selectedItem){for(var e=this.selectedItem-1;e>=0;e--)if(!this.tbItem[e].classList.contains("e-hidden")){this.select(e);break}}else if("Left"===t.swipeDirection&&this.selectedItem!==B("."+nf,this.element).length-1)for(var i=this.selectedItem+1;i<this.tbItem.length;i++)if(!this.tbItem[i].classList.contains("e-hidden")){this.select(i);break}this.isSwipeed=!1}},e.prototype.spaceKeyDown=function(t){(32===t.keyCode&&32===t.which||35===t.keyCode&&35===t.which)&&(c(N(t.target,".e-tab-header"))||t.preventDefault())},e.prototype.keyHandler=function(t){if(!this.element.classList.contains("e-disable")){this.element.classList.add("e-focused");var e=t.target,i=D(".e-tab-header .e-active",this.element);B(".e-toolbar-item:not(.e-toolbar-popup)",this.element);switch(this.popEle=D(".e-toolbar-pop",this.element),c(this.popEle)||(this.popObj=this.popEle.ej2_instances[0]),t.action){case"space":case"enter":if(e.parentElement.classList.contains("e-disable"))return;if("enter"===t.action&&e.classList.contains("e-hor-nav"))break;this.keyPressed(e);break;case"tab":case"shiftTab":e.classList.contains("e-tab-wrap")&&!1===N(e,"."+nf).classList.contains("e-active")&&e.setAttribute("tabindex","-1"),this.popObj&&T(this.popObj.element)&&this.popObj.hide(this.hide),i.children.item(0).setAttribute("tabindex","0");break;case"moveLeft":case"moveRight":var n=N(document.activeElement,"."+nf);c(n)||this.refreshItemVisibility(n);break;case"openPopup":t.preventDefault(),!c(this.popEle)&&this.popEle.classList.contains("e-popup-close")&&this.popObj.show(this.show);break;case"delete":var o=N(e,"."+nf);if(!0===this.showCloseButton&&!c(o)){var r=o.nextSibling;!c(r)&&r.classList.contains(nf)&&r.firstChild.focus(),this.removeTab(this.getEleIndex(o))}this.setActiveBorder()}}},e.prototype.refreshActElePosition=function(){var t=D(".e-toolbar-item.e-toolbar-popup.e-active",this.element);c(t)||this.select(this.getEleIndex(t)),this.refreshActiveBorder()},e.prototype.refreshItemVisibility=function(t){if(!c(D(".e-hscroll-content",this.tbItems))){var e=D(".e-hscroll-bar",this.tbItems),i=e.scrollLeft,n=i+e.offsetWidth,o=t.offsetLeft,r=t.offsetWidth,s=t.offsetLeft+t.offsetWidth;if(i<o&&n<s){a=n-o;e.scrollLeft=i+(r-a)}else if(i>o&&n>s){var a=s-i;e.scrollLeft=i-(r-a)}}},e.prototype.hoverHandler=function(t){var e=t.target;!c(e.classList)&&e.classList.contains("e-close-icon")&&e.setAttribute("title",new Dl("tab",{closeButtonTitle:this.title},this.locale).getConstant("closeButtonTitle"))},e.prototype.enableTab=function(t,e){var i=B("."+nf,this.element)[t];c(i)||(!0===e?(i.classList.remove("e-disable","e-overlay"),i.firstChild.setAttribute("tabindex","-1")):(i.classList.add("e-disable","e-overlay"),i.firstChild.removeAttribute("tabindex"),i.classList.contains("e-active")&&this.select(t+1)),i.setAttribute("aria-disabled",!0===e?"false":"true"))},e.prototype.addTab=function(t,e){var i=this;if(this.trigger("adding",{addedItems:t}),c(e)&&(e=B("."+nf).length-1),!(!0===this.isTemplate||B("."+nf).length<e||e<0||isNaN(e))){this.bdrLine.classList.add("e-hidden"),this.tbItems=D(".e-tab-header ."+ef,this.element);var n=this.parseObject(t,e);t.forEach(function(t,n){!0===i.isReplace?(A(D(".e-toolbar-items #e-item_"+e,i.element)),i.items.splice(e+n,0,t)):i.items.push(t)}),this.tbObj.addItems(n,e),this.trigger("added",{addedItems:t}),this.selectedItem===e?this.select(e):this.setActiveBorder()}},e.prototype.removeTab=function(t){var e=B("."+nf,this.element)[t],i={removedItem:e,removedIndex:t};if(this.trigger("removing",i),!c(e)){this.tbObj.removeItems(t),this.refreshActiveBorder();var n=this.extIndex(e.id),o=this.findEle(D(".e-content",this.element).children,"e-content_"+n);c(o)||(o.outerHTML="");var r={removedItem:e,removedIndex:t};this.trigger("removed",r),e.classList.contains("e-active")&&(t=t>B(".e-toolbar-item:not(.e-toolbar-popup)",this.element).length-1?t-1:t,this.enableAnimation=!1,this.selectedItem=t,this.select(t)),0===B("."+nf,this.element).length&&(this.hdrEle.style.display="none"),this.enableAnimation=!0}},e.prototype.hideTab=function(t,e){var i=B("."+nf,this.element)[t];if(!c(i)){if(c(e)&&(e=!0),this.bdrLine.classList.add("e-hidden"),!0===e){if(i.classList.add("e-hidden"),i.classList.contains("e-active"))if(0!==t)for(var n=t-1;n>=0;n--){if(!this.tbItem[n].classList.contains("e-hidden")){this.select(n);break}if(0===n)for(o=t+1;o<this.tbItem.length;o++)if(!this.tbItem[o].classList.contains("e-hidden")){this.select(o);break}}else for(var o=t+1;o<this.tbItem.length;o++)if(!this.tbItem[o].classList.contains("e-hidden")){this.select(o);break}}else i.classList.remove("e-hidden");this.setActiveBorder(),i.setAttribute("aria-hidden",""+e)}},e.prototype.select=function(t){this.tbItems=D(".e-tab-header ."+ef,this.element),this.tbItem=B(".e-tab-header ."+nf,this.element),this.prevItem=this.tbItem[this.prevIndex],c(this.prevItem)||this.prevItem.classList.contains("e-disable")||this.prevItem.children.item(0).setAttribute("tabindex","-1");var e={previousItem:this.prevItem,previousIndex:this.prevIndex,selectedItem:this.tbItem[this.selectedItem],selectedIndex:this.selectedItem,isSwiped:this.isSwipeed};if(this.trigger("selecting",e),!e.cancel)if("number"==typeof t){if(!c(this.tbItem[t])&&this.tbItem[t].classList.contains("e-disable"))for(i=t+1;i<this.items.length;i++){if(!1===this.items[i].disabled){t=i;break}t=0}if(this.tbItem.length>t&&t>=0&&!isNaN(t)){if(this.tbItem[this.selectedItem].classList.contains("e-hidden")){for(var i=this.selectedItem;i>=0;i--)if(!this.tbItem[i].classList.contains("e-hidden")){this.prevIndex=i;break}}else this.prevIndex=this.selectedItem;this.tbItem[t].classList.contains(of)?this.setActive(this.popupHandler(this.tbItem[t])):this.setActive(t)}else this.setActive(0)}else t instanceof HTMLElement&&this.setActive(this.getEleIndex(t))},e.prototype.disable=function(t){this.setCssClass(this.element,"e-disable",t),this.element.setAttribute("aria-disabled",""+t)},e.prototype.getPersistData=function(){return this.addOnPersist(["selectedItem","actEleId"])},e.prototype.getModuleName=function(){return"tab"},e.prototype.onPropertyChanged=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++)switch(n[i]){case"width":j(this.element,{width:b(t.width)});break;case"height":j(this.element,{height:b(t.height)}),this.setContentHeight(!1);break;case"cssClass":this.setCssClass(this.element,t.cssClass,!0);break;case"items":if(t.items instanceof Array&&e.items instanceof Array)c(this.tbObj)?(this.renderContainer(),c(this.cntEle)||(this.touchModule=new Vl(this.cntEle,{swipe:this.swipeHandler.bind(this)}))):(this.setItems(t.items),this.templateEle.length>0&&this.expTemplateContent(),this.templateEle=[],D(".e-tab > .e-content",this.element).innerHTML="",this.select(this.selectedItem));else for(var o=Object.keys(t.items),r=0;r<o.length;r++){var s=parseInt(Object.keys(t.items)[r],10),a=Object.keys(t.items[s])[0],l=Object(e.items[s])[a],h=Object(t.items[s])[a],d=D(".e-toolbar-items #e-item_"+s,this.element),p=D(".e-content #e-content_"+s,this.element);if("header"===a){var u=[];u.push(this.items[s]),this.items.splice(s,1),this.tbObj.items.splice(s,1),this.isReplace=!0,this.addTab(u,s),this.isReplace=!1}if("content"===a&&!c(p))if(("string"==typeof h||c(h.innerHTML))&&("."===h[0]||"#"===h[0])&&h.length){var g=document.querySelector(h);p.appendChild(g),g.style.display=""}else""===h&&"#"===l[0]?(document.body.appendChild(this.element.querySelector(l)).style.display="none",p.innerHTML=h):p.innerHTML=h;"cssClass"===a&&(c(d)||(d.classList.remove(l),d.classList.add(h)),c(p)||(p.classList.remove(l),p.classList.add(h))),"disabled"===a&&this.enableTab(s,!0!==h)}break;case"showCloseButton":this.setCloseButton(t.showCloseButton);break;case"selectedItem":this.selectedItem=e.selectedItem,this.select(t.selectedItem);break;case"headerPlacement":var m=D(".e-tab-header",this.element);this.setOrientation(t.headerPlacement,m),this.select(this.selectedItem);break;case"enableRtl":this.setRTL(t.enableRtl);break;case"overflowMode":this.tbObj.overflowMode=t.overflowMode,this.tbObj.dataBind(),this.refreshActElePosition();break;case"heightAdjustMode":this.setContentHeight(!1),this.select(this.selectedItem)}},$m([ot([],lf)],e.prototype,"items",void 0),$m([et("100%")],e.prototype,"width",void 0),$m([et("auto")],e.prototype,"height",void 0),$m([et("")],e.prototype,"cssClass",void 0),$m([et(0)],e.prototype,"selectedItem",void 0),$m([et("Top")],e.prototype,"headerPlacement",void 0),$m([et("Content")],e.prototype,"heightAdjustMode",void 0),$m([et("Scrollable")],e.prototype,"overflowMode",void 0),$m([et(!1)],e.prototype,"enableRtl",void 0),$m([et(!1)],e.prototype,"enablePersistence",void 0),$m([et(!1)],e.prototype,"showCloseButton",void 0),$m([it({},sf)],e.prototype,"animation",void 0),$m([st()],e.prototype,"created",void 0),$m([st()],e.prototype,"adding",void 0),$m([st()],e.prototype,"added",void 0),$m([st()],e.prototype,"selecting",void 0),$m([st()],e.prototype,"selected",void 0),$m([st()],e.prototype,"removing",void 0),$m([st()],e.prototype,"removed",void 0),$m([st()],e.prototype,"destroyed",void 0),e=$m([at],e)}(wl),cf=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),df=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},pf="e-treeview",uf="e-icon-collapsible",gf="e-icon-expandable",mf="e-list-item",ff="e-list-text",vf="e-list-parent",yf="e-hover",bf="e-active",wf="e-icons-spinner",xf="e-process",Sf="e-text-content",Cf="e-sibling",Lf="e-drop-next",Ef="e-check",Pf="e-checkbox-wrapper",kf="e-node-focus",Tf={treeRole:"tree",itemRole:"treeitem",listRole:"group",itemText:"",wrapperRole:""},Of=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return cf(e,t),df([et("child")],e.prototype,"child",void 0),df([et([])],e.prototype,"dataSource",void 0),df([et("expanded")],e.prototype,"expanded",void 0),df([et("hasChildren")],e.prototype,"hasChildren",void 0),df([et("htmlAttributes")],e.prototype,"htmlAttributes",void 0),df([et("iconCss")],e.prototype,"iconCss",void 0),df([et("id")],e.prototype,"id",void 0),df([et("imageUrl")],e.prototype,"imageUrl",void 0),df([et("isChecked")],e.prototype,"isChecked",void 0),df([et("parentID")],e.prototype,"parentID",void 0),df([et(null)],e.prototype,"query",void 0),df([et("selected")],e.prototype,"selected",void 0),df([et(null)],e.prototype,"tableName",void 0),df([et("text")],e.prototype,"text",void 0),df([et("tooltip")],e.prototype,"tooltip",void 0),df([et("navigateUrl")],e.prototype,"navigateUrl",void 0),e}(qa),If=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return cf(e,t),df([et("SlideDown")],e.prototype,"effect",void 0),df([et(400)],e.prototype,"duration",void 0),df([et("linear")],e.prototype,"easing",void 0),e}(qa),Af=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return cf(e,t),df([it({effect:"SlideUp",duration:400,easing:"linear"},If)],e.prototype,"collapse",void 0),df([it({effect:"SlideDown",duration:400,easing:"linear"},If)],e.prototype,"expand",void 0),e}(qa),Mf=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.mouseDownStatus=!1,n}return cf(e,t),i=e,e.prototype.getModuleName=function(){return"treeview"},e.prototype.preRender=function(){var t=this;this.checkActionNodes=[],this.dragStartAction=!1,this.isAnimate=!1,this.keyConfigs={escape:"escape",end:"end",enter:"enter",f2:"f2",home:"home",moveDown:"downarrow",moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",ctrlDown:"ctrl+downarrow",ctrlUp:"ctrl+uparrow",ctrlEnter:"ctrl+enter",ctrlHome:"ctrl+home",ctrlEnd:"ctrl+end",ctrlA:"ctrl+A",shiftDown:"shift+downarrow",shiftUp:"shift+uparrow",shiftEnter:"shift+enter",shiftHome:"shift+home",shiftEnd:"shift+end",csDown:"ctrl+shift+downarrow",csUp:"ctrl+shift+uparrow",csEnter:"ctrl+shift+enter",csHome:"ctrl+shift+home",csEnd:"ctrl+shift+end",space:"space"},this.listBaseOption={expandCollapse:!0,showIcon:!0,expandIconClass:gf,ariaAttributes:Tf,expandIconPosition:"Left",itemCreated:function(e){t.beforeNodeCreate(e)}},this.updateListProp(this.fields),this.aniObj=new Fa({}),this.treeList=[],this.isLoaded=!1,this.setTouchClass(),c(this.selectedNodes)&&this.setProperties({selectedNodes:[]},!0),c(this.checkedNodes)&&this.setProperties({checkedNodes:[]},!0)},e.prototype.getPersistData=function(){var t=["selectedNodes","checkedNodes"];return this.addOnPersist(t)},e.prototype.render=function(){this.isAnimate=!0,this.initialize(),this.setDataBinding(),this.setExpandOnType(),this.setRipple(),this.wireEditingEvents(this.allowEditing),this.setDragAndDrop(this.allowDragAndDrop),this.wireEvents()},e.prototype.initialize=function(){this.element.setAttribute("role","tree"),this.element.setAttribute("tabindex","0"),this.element.setAttribute("aria-activedescendant",this.element.id+"_active"),this.setCssClass(null,this.cssClass),this.setEnableRtl(),this.setFullRow(this.fullRowSelect),this.nodeTemplateFn=this.templateComplier(this.nodeTemplate)},e.prototype.setEnableRtl=function(){this.enableRtl?E([this.element],"e-rtl"):P([this.element],"e-rtl")},e.prototype.setRipple=function(){var t={selector:".e-fullrow,.e-text-content",ignore:"."+Sf+" > .e-icons,.e-input-group,.e-input, ."+Pf};this.rippleFn=pt(this.element,t);var e={selector:"."+Sf+" > .e-icons",isCenterRipple:!0};this.rippleIconFn=pt(this.element,e)},e.prototype.setFullRow=function(t){t?E([this.element],"e-fullrow-wrap"):P([this.element],"e-fullrow-wrap")},e.prototype.setMultiSelect=function(t){var e=D("."+vf,this.element);t?e.setAttribute("aria-multiselectable","true"):e.removeAttribute("aria-multiselectable")},e.prototype.templateComplier=function(t){if(t)try{if(document.querySelectorAll(t).length)return Tt(document.querySelector(t).innerHTML.trim())}catch(e){return Tt(t)}},e.prototype.setDataBinding=function(){var t=this;this.treeList.push("false"),this.fields.dataSource instanceof zu?this.fields.dataSource.executeQuery(this.getQuery(this.fields)).then(function(e){t.treeList.pop(),t.treeData=e.result,t.isNumberTypeId=t.getType(),t.setRootData(),t.renderItems(!0),0!==t.treeList.length||t.isLoaded||t.finalize()}):(this.treeList.pop(),c(this.fields.dataSource)?this.rootData=this.treeData=[]:(this.treeData=this.fields.dataSource,this.setRootData()),this.renderItems(!1)),0!==this.treeList.length||this.isLoaded||this.finalize()},e.prototype.getQuery=function(t,e){void 0===e&&(e=null);var i,n=[];if(t.query)i=t.query.clone();else{i=new Lu;for(var o=this.getActualProperties(t),r=0,s=Object.keys(o);r<s.length;r++){var a=s[r];"dataSource"!==a&&"tableName"!==a&&"child"!==a&&t[a]&&-1===n.indexOf(t[a])&&n.push(t[a])}i.select(n),o.hasOwnProperty("tableName")&&i.from(t.tableName)}return Dh.addSorting(this.sortOrder,t.text,i),c(e)||c(t.parentID)||i.where(t.parentID,"equal",this.isNumberTypeId?parseFloat(e):e),i},e.prototype.getType=function(){return!!this.treeData[0]&&"number"==typeof n(this.fields.id,this.treeData[0])},e.prototype.setRootData=function(){if(this.dataType=this.getDataType(this.treeData,this.fields),1===this.dataType){this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID);var t=this.getChildNodes(this.treeData,void 0,!0);c(t)?this.rootData=[]:this.rootData=t}else this.rootData=this.treeData},e.prototype.renderItems=function(t){this.listBaseOption.ariaAttributes.level=1,this.ulElement=Dh.createList(t?this.rootData:this.getSortedData(this.rootData),this.listBaseOption),this.element.appendChild(this.ulElement),this.finalizeNode(this.element)},e.prototype.beforeNodeCreate=function(t){if(this.showCheckBox){var e=ui(!0,{cssClass:this.touchClass}),i=D("div.e-icons",t.item),o=t.item.getAttribute("data-uid");t.item.childNodes[0].insertBefore(e,t.item.childNodes[0].childNodes[c(i)?0:1]);var r=n(t.fields.isChecked,t.curData);this.checkedNodes.indexOf(o)>-1?(D(".e-frame",e).classList.add(Ef),e.setAttribute("aria-checked","true"),this.addCheck(t.item)):c(r)||"true"!==r.toString()?e.setAttribute("aria-checked","false"):(D(".e-frame",e).classList.add(Ef),e.setAttribute("aria-checked","true"),this.addCheck(t.item));var s=D(".e-frame",e);Ma.add(s,"mousedown",this.frameMouseHandler,this),Ma.add(s,"mouseup",this.frameMouseHandler,this)}this.fullRowSelect&&this.createFullRow(t.item),this.allowMultiSelection&&!t.item.classList.contains("e-selected")&&t.item.setAttribute("aria-selected","false");var a=t.fields;if(this.addActionClass(t,a.selected,"e-selected"),this.addActionClass(t,a.expanded,"e-expanded"),!c(this.nodeTemplateFn)){var l=t.item.querySelector("."+ff);l.innerHTML="",I(this.nodeTemplateFn(t.curData),l)}var h={node:t.item,nodeData:t.curData,text:t.text};this.trigger("drawNode",h)},e.prototype.frameMouseHandler=function(t){gi(t,D(".e-ripple-container",t.target.parentElement))},e.prototype.addActionClass=function(t,e,i){var o=n(e,t.curData);c(o)||"false"===o.toString()||t.item.classList.add(i)},e.prototype.getDataType=function(t,e){if(this.fields.dataSource instanceof zu){for(i=0;i<t.length;i++)if("string"==typeof e.child&&c(n(e.child,t[i])))return 1;return 2}for(var i=0,o=t.length;i<o;i++){if("string"==typeof e.child&&!c(n(e.child,t[i])))return 2;if(!c(n(e.parentID,t[i]))||!c(n(e.hasChildren,t[i])))return 1}return 1},e.prototype.getGroupedData=function(t,e){for(var i=(new Lu).group(e),n=Dh.getDataSource(t,i),o=[],r=0;r<n.length;r++){var s=n[r].items;o.push(s)}return o},e.prototype.getSortedData=function(t){return t&&"None"!==this.sortOrder&&(t=Dh.getDataSource(t,Dh.addSorting(this.sortOrder,this.fields.text))),t},e.prototype.finalizeNode=function(t){for(var e=B(".e-list-img",t),i=0;i<e.length;i++)e[i].setAttribute("alt","e-list-img");if(this.isLoaded){for(var n=B(".e-selected",t),o=0;o<n.length;o++){this.selectNode(n[o],null);break}P(n,"e-selected")}for(var r=B(".e-list-item:not(.e-expanded)",t),s=0;s<r.length;s++){var a=D("div.e-icons",r[s]);a&&a.classList.contains(gf)&&(r[s].setAttribute("aria-expanded","false"),E([r[s]],"e-node-collapsed"))}for(var l=B(".e-expanded",t),o=0;o<l.length;o++)this.renderChildNodes(l[o]);P(l,"e-expanded"),this.updateList(),this.isLoaded&&this.updateCheckedProp()},e.prototype.updateCheckedProp=function(){var t=this;if(this.showCheckBox){var e=[].concat([],this.checkedNodes);this.checkedNodes.forEach(function(i,n){c(t.element.querySelector('[data-uid="'+i+'"]'))&&(e=e.filter(function(t){return t!==i}))}),this.setProperties({checkedNodes:e},!0)}},e.prototype.ensureParentCheckState=function(t){if(!c(t)){if(t.classList.contains(pf))return;var e=t;t.classList.contains(mf)&&(e=D("."+vf,t));var i=B(".e-check",e),n=B("."+mf,e),o=t.getElementsByClassName(Pf)[0];n.length===i.length?this.changeState(o,"check",null,!0,!0):i.length>0?this.changeState(o,"indeterminate",null,!0,!0):0===i.length&&this.changeState(o,"uncheck",null,!0,!0);var r=N(t,"."+vf);if(!c(r)){var s=N(r,"."+mf);this.ensureParentCheckState(s)}}},e.prototype.ensureChildCheckState=function(t,e){if(!c(t)){var i=D("."+vf,t),o=void 0;if(!c(i)){o=B("."+Pf,i);for(var r=t.getElementsByClassName("e-frame")[0].classList.contains(Ef),s=void 0,a=0;a<o.length;a++){if(c(this.currentLoadData)||c(n(this.fields.isChecked,this.currentLoadData[a]))){var l=o[a].getElementsByClassName("e-frame")[0].classList.contains(Ef);s=!this.isLoaded&&l?"check":r?"check":"uncheck"}else s=n(this.fields.isChecked,this.currentLoadData[a])?"check":"uncheck";this.changeState(o[a],s,e,!0,!0)}}}},e.prototype.doCheckBoxAction=function(t,e){if(c(t))for(var i=B("."+Pf,this.element),n=0;n<i.length;n++)this.changeState(i[n],e?"check":"uncheck");else for(var o=0,r=t.length;o<r;o++){var s=this.getElement(t[o]);if(!c(s)){var a=D(".e-list-parent ."+Pf,s);this.validateCheckNode(a,!e,s,null)}}},e.prototype.changeState=function(t,e,i,n,o){var r,s,a=N(t,"."+mf);if(n||(this.checkActionNodes=[],s=this.getCheckEvent(a,e,i),this.trigger("nodeChecking",s),!s.cancel)){var l=t.getElementsByClassName("e-frame")[0];if("check"!==e||l.classList.contains(Ef)?"uncheck"===e&&(l.classList.contains(Ef)||l.classList.contains("e-stop"))?(P([l],[Ef,"e-stop"]),this.removeCheck(a),r="false"):"indeterminate"!==e||l.classList.contains("e-stop")||(l.classList.remove(Ef),l.classList.add("e-stop"),this.removeCheck(a),r="mixed"):(l.classList.remove("e-stop"),l.classList.add(Ef),this.addCheck(a),r="true"),r="check"===e?"true":"uncheck"===e?"false":r,c(r)||t.setAttribute("aria-checked",r),o){var h=[].concat([],this.checkActionNodes);s=this.getCheckEvent(a,e,i),d(n)&&(s.data=h)}n||c(r)||(t.setAttribute("aria-checked",r),s.data[0].checked=r,this.trigger("nodeChecked",s),this.checkActionNodes=[])}},e.prototype.addCheck=function(t){var e=t.getAttribute("data-uid");c(e)||-1!==this.checkedNodes.indexOf(e)||this.checkedNodes.push(e)},e.prototype.removeCheck=function(t){var e=this.checkedNodes.indexOf(t.getAttribute("data-uid"));e>-1&&this.checkedNodes.splice(e,1)},e.prototype.getCheckEvent=function(t,e,i){this.checkActionNodes.push(this.getNodeData(t));var n=this.checkActionNodes;return{action:e,cancel:!1,isInteracted:!c(i),node:t,data:n}},e.prototype.finalize=function(){D("."+vf,this.element).setAttribute("role",Tf.treeRole),this.setMultiSelect(this.allowMultiSelection);var t=D("."+mf,this.element);t&&(E([t],kf),this.updateIdAttr(null,t)),this.doSelectionAction(),this.updateCheckedProp(),this.isLoaded=!0,this.isAnimate=!1;var e={data:this.treeData};this.trigger("dataBound",e)},e.prototype.doSelectionAction=function(){var t=B(".e-selected",this.element),e=this.selectedNodes;if(e.length>0){this.setProperties({selectedNodes:[]},!0);for(var i=0;i<e.length;i++){var n=D('[data-uid="'+e[i]+'"]',this.element);if(this.selectNode(n,null,!0),!this.allowMultiSelection)break}}else this.selectGivenNodes(t);P(t,"e-selected")},e.prototype.selectGivenNodes=function(t){for(var e=0;e<t.length&&(t[e].classList.contains("e-disable")||this.selectNode(t[e],null,!0),this.allowMultiSelection);e++);},e.prototype.clickHandler=function(t){var e=t.originalEvent.target;if(Ma.remove(this.element,"contextmenu",this.preventContextMenu),e&&!this.dragStartAction){var i=e.classList,n=N(e,"."+mf);if(n){if(this.removeHover(),this.setFocusElement(n),this.showCheckBox&&!n.classList.contains("e-disable")){var o=N(e,"."+Pf);if(!c(o)){var r=D(".e-frame",o);return this.validateCheckNode(o,r.classList.contains(Ef),n,t.originalEvent),void this.triggerClickEvent(t.originalEvent,n)}}i.contains(gf)?this.expandAction(n,e,t):i.contains(uf)?this.collapseNode(n,e,t):i.contains(vf)||i.contains(mf)||this.toggleSelect(n,t.originalEvent,!1),this.triggerClickEvent(t.originalEvent,n)}}},e.prototype.nodeCheckingEvent=function(t,e,i){var n=N(t,"."+mf);this.checkActionNodes=[];var o=e?"false":"true";c(o)||t.setAttribute("aria-checked",o);var r=this.getCheckEvent(n,e?"uncheck":"check",i);return this.trigger("nodeChecking",r),r},e.prototype.nodeCheckedEvent=function(t,e,i){N(t,"."+mf);var n=this.getCheckEvent(t,e?"uncheck":"check",i);n.data=n.data.splice(0,n.data.length-1),this.trigger("nodeChecked",n)},e.prototype.triggerClickEvent=function(t,e){var i={event:t,node:e};this.trigger("nodeClicked",i)},e.prototype.expandNode=function(t,e){var i=this;e.classList.contains(wf)&&this.hideSpinner(e),P([e],gf),E([e],uf);var n=0,o=0,r=this,s=D("."+vf,t),a=t;this.setHeight(a,s),this.isAnimate?this.expandedNode(a,s,e):this.aniObj.animate(s,{name:this.animation.expand.effect,duration:this.animation.expand.duration,timingFunction:this.animation.expand.easing,begin:function(e){a.style.overflow="hidden",n=a.offsetHeight,o=D("."+Sf,t).offsetHeight},progress:function(t){t.element.style.display="block",r.animateHeight(t,n,o)},end:function(t){t.element.style.display="block",i.expandedNode(a,s,e)}})},e.prototype.expandedNode=function(t,e,i){e.style.display="block",t.style.display="block",t.style.overflow="",t.style.height="",P([i],xf),t.setAttribute("aria-expanded","true"),P([t],"e-node-collapsed"),this.isLoaded&&this.expandArgs&&(this.expandArgs=this.getExpandEvent(t,null),this.trigger("nodeExpanded",this.expandArgs))},e.prototype.collapseNode=function(t,e,i){var n=this;if(!e.classList.contains(xf)){E([e],xf);var o;if(this.isLoaded&&(o=this.getExpandEvent(t,i),this.trigger("nodeCollapsing",o),o.cancel))return void P([e],xf);P([e],uf),E([e],gf);var r=0,s=0,a=this,l=D("."+vf,t),h=t;E([t],"e-node-collapsed"),this.aniObj.animate(l,{name:this.animation.collapse.effect,duration:this.animation.collapse.duration,timingFunction:this.animation.collapse.easing,begin:function(e){h.style.overflow="hidden",r=D("."+Sf,t).offsetHeight,s=h.offsetHeight},progress:function(t){a.animateHeight(t,r,s)},end:function(i){h.style.overflow="",i.element.style.display="none",h.style.height="",P([e],xf),t.setAttribute("aria-expanded","false"),n.isLoaded&&n.trigger("nodeCollapsed",o)}})}},e.prototype.setHeight=function(t,e){e.style.display="block",e.style.visibility="hidden",t.style.height=t.offsetHeight+"px",e.style.display="none",e.style.visibility=""},e.prototype.animateHeight=function(t,e,i){var n=(i-e)*((t.duration-t.timeStamp)/t.duration)+e;t.element.parentElement.style.height=n+"px"},e.prototype.renderChildNodes=function(t,e){var i=this,n=D("div.e-icons",t);if(!c(n)){this.showSpinner(n);var r;if(this.fields.dataSource instanceof zu){var s=this.parents(t,"."+vf).length,a=this.getChildFields(this.fields,s,1);if(c(a)||c(a.dataSource))return A(n),void t.removeAttribute("aria-expanded");this.treeList.push("false"),a.dataSource.executeQuery(this.getQuery(a,t.getAttribute("data-uid"))).then(function(s){if(i.treeList.pop(),r=s.result,i.currentLoadData=r,c(r)||0===r.length)A(n),t.removeAttribute("aria-expanded");else{i.updateListProp(a);var l=t.getAttribute("data-uid"),h=i.getNodeObject(l);o("child",r,h),i.listBaseOption.ariaAttributes.level=parseFloat(t.getAttribute("aria-level"))+1,t.appendChild(Dh.createList(r,i.listBaseOption)),i.expandNode(t,n),i.ensureCheckNode(t),i.finalizeNode(t),i.renderSubChild(t,e)}0!==i.treeList.length||i.isLoaded||i.finalize()})}else{if(r=this.getChildNodes(this.treeData,t.getAttribute("data-uid")),this.currentLoadData=r,c(r)||0===r.length)return A(n),void t.removeAttribute("aria-expanded");this.listBaseOption.ariaAttributes.level=parseFloat(t.getAttribute("aria-level"))+1,t.appendChild(Dh.createList(this.getSortedData(r),this.listBaseOption)),this.expandNode(t,n),this.ensureCheckNode(t),this.finalizeNode(t),this.renderSubChild(t,e)}}},e.prototype.ensureCheckNode=function(t){this.showCheckBox&&(this.ensureChildCheckState(t),this.ensureParentCheckState(t)),this.currentLoadData=null},e.prototype.getFields=function(t,e,i){return e===i?t:this.getFields(this.getChildMapper(t),e,i+1)},e.prototype.getChildFields=function(t,e,i){return e===i?this.getChildMapper(t):this.getChildFields(this.getChildMapper(t),e,i+1)},e.prototype.getChildMapper=function(t){return"string"==typeof t.child||c(t.child)?t:t.child},e.prototype.getChildNodes=function(t,e,i){void 0===i&&(i=!1);var o;if(c(t))return o;if(1===this.dataType)return this.getChildGroup(this.groupedData,e,i);if("string"==typeof this.fields.child)for(var r=0,s=t.length;r<s;r++){var a=n(this.fields.id,t[r]);if(a&&a.toString()===e)return n(this.fields.child,t[r]);if(!c(n(this.fields.child,t[r]))&&void 0!==(o=this.getChildNodes(n(this.fields.child,t[r]),e)))break}return o},e.prototype.getChildGroup=function(t,e,i){if(!c(t))for(var o=0,r=t.length;o<r;o++){if(c(t[o][0])||c(n(this.fields.parentID,t[o][0])))return i?t[o]:[];if(n(this.fields.parentID,t[o][0]).toString()===e)return t[o]}},e.prototype.renderSubChild=function(t,e){if(e)for(var i=B("."+gf,t),n=0,o=i.length;n<o;n++){var r=N(i[n],"."+mf);this.expandArgs=this.getExpandEvent(r,null),this.trigger("nodeExpanding",this.expandArgs),this.renderChildNodes(r,e)}},e.prototype.toggleSelect=function(t,e,i){t.classList.contains("e-disable")||(this.allowMultiSelection&&(e&&e.ctrlKey||i)&&this.isActive(t)?this.unselectNode(t,e):this.selectNode(t,e,i))},e.prototype.isActive=function(t){return!!t.classList.contains(bf)},e.prototype.selectNode=function(t,e,i){if(c(t)||!this.allowMultiSelection&&this.isActive(t)&&!c(e))return void this.setFocusElement(t);var n;if(!this.isLoaded||(n=this.getSelectEvent(t,"select",e),this.trigger("nodeSelecting",n),!n.cancel)){if(this.allowMultiSelection&&(i||e&&(!e||e.ctrlKey))||this.removeSelectAll(),this.allowMultiSelection&&e&&e.shiftKey){this.startNode||(this.startNode=t);var o=this.liList.indexOf(this.startNode),r=this.liList.indexOf(t);if(o>r){var s=o;o=r,r=s}for(var a=o;a<=r;a++){var l=this.liList[a];T(l)&&!l.classList.contains("e-disable")&&this.addSelect(l)}}else this.startNode=t,this.addSelect(t);this.setFocusElement(t),this.isLoaded&&this.trigger("nodeSelected",n)}},e.prototype.unselectNode=function(t,e){var i;this.isLoaded&&(i=this.getSelectEvent(t,"un-select",e),this.trigger("nodeSelecting",i),i.cancel)||(this.removeSelect(t),this.setFocusElement(t),this.isLoaded&&this.trigger("nodeSelected",i))},e.prototype.setFocusElement=function(t){if(!c(t)){var e=this.getFocusedNode();e&&P([e],kf),E([t],kf),this.updateIdAttr(e,t)}},e.prototype.addSelect=function(t){t.setAttribute("aria-selected","true"),E([t],bf);var e=t.getAttribute("data-uid");c(e)||-1!==this.selectedNodes.indexOf(e)||this.selectedNodes.push(e)},e.prototype.removeSelect=function(t){this.allowMultiSelection?t.setAttribute("aria-selected","false"):t.removeAttribute("aria-selected"),P([t],bf);var e=this.selectedNodes.indexOf(t.getAttribute("data-uid"));e>-1&&this.selectedNodes.splice(e,1)},e.prototype.removeSelectAll=function(){for(var t=this.element.querySelectorAll(".e-active"),e=0,i=t;e<i.length;e++){var n=i[e];this.allowMultiSelection?n.setAttribute("aria-selected","false"):n.removeAttribute("aria-selected")}P(t,bf),this.setProperties({selectedNodes:[]},!0)},e.prototype.getSelectEvent=function(t,e,i){var n=this.getNodeData(t);return{action:e,cancel:!1,isInteracted:!c(i),node:t,nodeData:n}},e.prototype.setExpandOnType=function(){this.expandOnType="Auto"===this.expandOn?za.isDevice?"Click":"DblClick":this.expandOn},e.prototype.expandHandler=function(t){var e=t.originalEvent.target;!e||e.classList.contains("e-input")||e.classList.contains(pf)||e.classList.contains(vf)||e.classList.contains(mf)||e.classList.contains("e-icons")||this.showCheckBox&&N(e,"."+Pf)||this.expandCollapseAction(N(e,"."+mf),t)},e.prototype.expandCollapseAction=function(t,e){var i=D("div.e-icons",t);i&&!i.classList.contains(xf)&&(i.classList.contains(gf)?this.expandAction(t,i,e):this.collapseNode(t,i,e))},e.prototype.expandAction=function(t,e,i,n){if(!e.classList.contains(xf)){if(E([e],xf),this.isLoaded&&(this.expandArgs=this.getExpandEvent(t,i),this.trigger("nodeExpanding",this.expandArgs),this.expandArgs.cancel))return void P([e],xf);var o=D("."+vf,t);o&&"UL"===o.nodeName?this.expandNode(t,e):this.renderChildNodes(t,n)}},e.prototype.keyActionHandler=function(t){var e=t.target,i=this.getFocusedNode();if(e&&e.classList.contains("e-input")){var n=e;return void("enter"===t.action?(n.blur(),this.element.focus(),E([i],yf)):"escape"===t.action&&(n.value=this.oldText,n.blur(),this.element.focus(),E([i],yf)))}t.preventDefault();var o={cancel:!1,event:t,node:i};if(this.trigger("keyPress",o),!o.cancel)switch(t.action){case"space":this.showCheckBox&&this.checkNode(t);break;case"moveRight":this.openNode(!this.enableRtl,t);break;case"moveLeft":this.openNode(!!this.enableRtl,t);break;case"shiftDown":this.shiftKeySelect(!0,t);break;case"moveDown":case"ctrlDown":case"csDown":this.navigateNode(!0);break;case"shiftUp":this.shiftKeySelect(!1,t);break;case"moveUp":case"ctrlUp":case"csUp":this.navigateNode(!1);break;case"home":case"shiftHome":case"ctrlHome":case"csHome":this.navigateRootNode(!0);break;case"end":case"shiftEnd":case"ctrlEnd":case"csEnd":this.navigateRootNode(!1);break;case"enter":case"ctrlEnter":case"shiftEnter":case"csEnter":this.toggleSelect(i,t);break;case"f2":this.allowEditing&&!i.classList.contains("e-disable")&&this.createTextbox(i,t);break;case"ctrlA":if(this.allowMultiSelection){var r=B(".e-list-item:not(.e-active)",this.element);this.selectGivenNodes(r)}}},e.prototype.navigateToFocus=function(t){var e=this.getFocusedNode().querySelector("."+Sf),i=e.getBoundingClientRect(),n=this.getScrollParent(this.element);if(!c(n)){var o=n.getBoundingClientRect();i.bottom>o.bottom?n.scrollTop+=i.bottom-o.bottom:i.top<o.top&&(n.scrollTop-=o.top-i.top)}this.isVisibleInViewport(e)||e.scrollIntoView(t)},e.prototype.isVisibleInViewport=function(t){var e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)},e.prototype.getScrollParent=function(t){return c(t)?null:t.scrollHeight>t.clientHeight?t:this.getScrollParent(t.parentElement)},e.prototype.shiftKeySelect=function(t,e){if(this.allowMultiSelection){var i=this.getFocusedNode(),n=t?this.getNextNode(i):this.getPrevNode(i);this.removeHover(),this.setFocusElement(n),this.toggleSelect(n,e,!1),this.navigateToFocus(!t)}else this.navigateNode(t)},e.prototype.checkNode=function(t){var e=this.getFocusedNode(),i=D("."+Pf,e),n=D(" .e-frame",i).classList.contains(Ef);e.classList.contains("e-disable")||this.validateCheckNode(i,n,e,t)},e.prototype.validateCheckNode=function(t,e,i,n){this.nodeCheckingEvent(t,e,n).cancel||(this.changeState(t,e?"uncheck":"check",n,!0),this.ensureChildCheckState(i),this.ensureParentCheckState(N(N(i,"."+vf),"."+mf)),this.nodeCheckedEvent(t,e,n))},e.prototype.openNode=function(t,e){var i=this.getFocusedNode(),n=D("div.e-icons",i);if(t){if(!n)return;n.classList.contains(gf)?this.expandAction(i,n,e):this.focusNextNode(i,!0)}else if(n&&n.classList.contains(uf))this.collapseNode(i,n,e);else{var o=N(N(i,"."+vf),"."+mf);if(!o)return;o.classList.contains("e-disable")||(this.setFocus(i,o),this.navigateToFocus(!0))}},e.prototype.navigateNode=function(t){var e=this.getFocusedNode();this.focusNextNode(e,t)},e.prototype.navigateRootNode=function(t){var e=this.getFocusedNode(),i=t?this.getRootNode():this.getEndNode();i.classList.contains("e-disable")||(this.setFocus(e,i),this.navigateToFocus(t))},e.prototype.getFocusedNode=function(){var t=D(".e-list-item."+kf,this.element);return c(t)?D("."+mf,this.element):t},e.prototype.focusNextNode=function(t,e){var i=e?this.getNextNode(t):this.getPrevNode(t);if(this.setFocus(t,i),this.navigateToFocus(!e),i.classList.contains("e-disable")){var n=i.lastChild;null==i.previousSibling&&i.classList.contains("e-level-1")?this.focusNextNode(i,!0):null==i.nextSibling&&i.classList.contains("e-node-collapsed")?this.focusNextNode(i,!1):null==i.nextSibling&&n.classList.contains("e-text-content")?this.focusNextNode(i,!1):this.focusNextNode(i,e)}},e.prototype.getNextNode=function(t){var e,i=this.liList.indexOf(t);do{if(i++,e=this.liList[i],c(e))return t}while(!T(e));return e},e.prototype.getPrevNode=function(t){var e,i=this.liList.indexOf(t);do{if(i--,e=this.liList[i],c(e))return t}while(!T(e));return e},e.prototype.getRootNode=function(){var t,e=0;do{t=this.liList[e],e++}while(!T(t));return t},e.prototype.getEndNode=function(){var t,e=this.liList.length-1;do{t=this.liList[e],e--}while(!T(t));return t},e.prototype.setFocus=function(t,e){P([t],[yf,kf]),e.classList.contains("e-disable")||(E([e],[yf,kf]),this.updateIdAttr(t,e))},e.prototype.updateIdAttr=function(t,e){this.element.removeAttribute("aria-activedescendant"),t&&t.removeAttribute("id"),e.setAttribute("id",this.element.id+"_active"),this.element.setAttribute("aria-activedescendant",this.element.id+"_active")},e.prototype.focusIn=function(){this.mouseDownStatus||E([this.getFocusedNode()],yf),this.mouseDownStatus=!1},e.prototype.focusOut=function(){P([this.getFocusedNode()],yf)},e.prototype.onMouseOver=function(t){var e=t.target,i=e.classList,n=N(e,"."+mf);if(!n||i.contains(vf)||i.contains(mf))return void this.removeHover();n&&!n.classList.contains("e-disable")&&this.setHover(n)},e.prototype.setHover=function(t){t.classList.contains(yf)||(this.removeHover(),E([t],yf))},e.prototype.onMouseLeave=function(t){this.removeHover()},e.prototype.removeHover=function(){var t=B("."+yf,this.element);t&&t.length&&P(t,yf)},e.prototype.getNodeData=function(t,e){if(!c(t)&&t.classList.contains(mf)&&N(t,".e-control").classList.contains(pf)){var i=t.getAttribute("data-uid"),n=this.getText(t,e),o=N(t.parentNode,"."+mf),r=o?o.getAttribute("data-uid"):null,s=t.classList.contains(bf),a="true"===t.getAttribute("aria-expanded"),l=null;return this.showCheckBox&&(l=D("."+Pf,t).getAttribute("aria-checked")),{id:i,text:n,parentID:r,selected:s,expanded:a,isChecked:l}}return{id:"",text:"",parentID:"",selected:"",expanded:"",isChecked:""}},e.prototype.getText=function(t,e){if(e){var i=this.getNodeObject(t.getAttribute("data-uid")),o=parseFloat(t.getAttribute("aria-level"));return n(this.getFields(this.fields,o,1).text,i)}return D("."+ff,t).textContent},e.prototype.getExpandEvent=function(t,e){var i=this.getNodeData(t);return{cancel:!1,isInteracted:!c(e),node:t,nodeData:i,event:e}},e.prototype.reRenderNodes=function(){this.element.innerHTML="",this.setTouchClass(),this.setProperties({selectedNodes:[],checkedNodes:[]},!0),this.isLoaded=!1,this.setDataBinding()},e.prototype.setCssClass=function(t,e){c(t)||""===t||P([this.element],t.split(" ")),c(e)||""===e||E([this.element],e.split(" "))},e.prototype.editingHandler=function(t){var e=t.target;if(!(!e||e.classList.contains(pf)||e.classList.contains(vf)||e.classList.contains(mf)||e.classList.contains("e-icons")||e.classList.contains("e-input")||e.classList.contains("e-input-group"))){var i=N(e,"."+mf);this.createTextbox(i,t)}},e.prototype.createTextbox=function(t,e){var i=D(".e-tree-input",this.element);i&&i.blur();var n=D("."+ff,t);this.updateOldText(t);var o=L("input",{className:"e-tree-input",attrs:{value:this.oldText}}),r=this.getEditEvent(t,null,o.outerHTML);if(this.trigger("nodeEditing",r),!r.cancel){var s="width:"+(n.offsetWidth+5)+"px";E([t],"e-editing"),n.innerHTML=r.innerHtml;var a=D(".e-tree-input",n);this.inputObj=Wu.createInput({element:a,properties:{enableRtl:this.enableRtl}}),this.inputObj.container.setAttribute("style",s),a.focus();var l=a;l.setSelectionRange(0,l.value.length),this.wireInputEvents(a)}},e.prototype.updateOldText=function(t){var e=t.getAttribute("data-uid");this.editData=this.getNodeObject(e);var i=parseFloat(t.getAttribute("aria-level"));this.editFields=this.getFields(this.fields,i,1),this.oldText=n(this.editFields.text,this.editData)},e.prototype.inputFocusOut=function(t){if(D(".e-tree-input",this.element)){var e=t.target,i=e.value,n=N(e,"."+ff),o=N(e,"."+mf);A(this.inputObj.container),this.appendNewText(o,n,i,!0)}},e.prototype.appendNewText=function(t,e,i,n){var r=this.getEditEvent(t,i,null);this.trigger("nodeEdited",r),i=r.cancel?r.oldText:r.newText;var s=o(this.editFields.text,i,this.editData);c(this.nodeTemplateFn)?e.innerHTML=i:(e.innerHTML="",I(this.nodeTemplateFn(s),e)),n&&(P([t],"e-editing"),e.focus())},e.prototype.getElement=function(t){return c(t)?null:"string"==typeof t?this.element.querySelector('[data-uid="'+t+'"]'):"object"==typeof t?t:null},e.prototype.getEditEvent=function(t,e,i){return{cancel:!1,newText:e,node:t,nodeData:this.getNodeData(t),oldText:this.oldText,innerHtml:i}},e.prototype.getNodeObject=function(t){if(!c(t)){if(1!==this.dataType)return this.getChildNodeObject(this.treeData,this.fields,t);for(var e=0,i=this.treeData.length;e<i;e++){var o=n(this.fields.id,this.treeData[e]);if(!c(this.treeData[e])&&!c(o)&&o.toString()===t)return this.treeData[e]}}},e.prototype.getChildNodeObject=function(t,e,i){var o;if(c(t))return o;for(var r=0,s=t.length;r<s;r++){var a=n(e.id,t[r]);if(t[r]&&a&&a.toString()===i)return t[r];if("string"!=typeof e.child||c(n(e.child,t[r]))){if(this.fields.dataSource instanceof zu&&!c(n("child",t[r]))){if(void 0!==(o=this.getChildNodeObject(n("child",t[r]),this.getChildMapper(e),i)))break}}else{var l=n(e.child,t[r]);if(void 0!==(o=this.getChildNodeObject(l,this.getChildMapper(e),i)))break}}return o},e.prototype.setDragAndDrop=function(t){t?this.initializeDrag():this.destroyDrag()},e.prototype.initializeDrag=function(){var t,e=this;this.dragObj=new Pl(this.element,{enableTailMode:!0,enableAutoScroll:!0,dragTarget:"."+Sf,helper:function(i){e.dragTarget=i.sender.target;var n=N(e.dragTarget,"."+pf),o=N(e.dragTarget,"."+Sf);if(e.dragLi=N(e.dragTarget,"."+mf),e.fullRowSelect&&!o&&e.dragTarget.classList.contains("e-fullrow")&&(o=e.dragTarget.nextElementSibling),!e.dragTarget||!i.element.isSameNode(n)||!o||e.dragTarget.classList.contains(pf)||e.dragTarget.classList.contains(vf)||e.dragTarget.classList.contains(mf)||e.dragLi.classList.contains("e-disable"))return!1;var r=o.cloneNode(!0);if(c(D("div.e-icons",r))){var s=L("div",{className:"e-icons "+gf});r.insertBefore(s,r.children[0])}var a="e-drag-item e-treeview "+e.cssClass+" "+(e.enableRtl?"e-rtl":"");(t=L("div",{className:a})).appendChild(r);var l=e.selectedNodes.length;if(l>1&&e.allowMultiSelection&&e.dragLi.classList.contains(bf)){var h=L("span",{className:"e-drop-count",innerHTML:""+l});t.appendChild(h)}return document.body.appendChild(t),document.body.style.cursor="",e.dragData=e.getNodeData(e.dragLi),t},dragStart:function(i){E([e.element],"e-dragging");var n=e.getDragEvent(i.event,e,null,i.target);n.draggedNode.classList.contains("e-editing")?n.cancel=!0:e.trigger("nodeDragStart",n),n.cancel?(A(t),P([e.element],"e-dragging"),e.dragStartAction=!1):e.dragStartAction=!0},drag:function(i){e.dragObj.setProperties({cursorAt:{top:!c(i.event.targetTouches)||za.isDevice?60:-20}}),e.dragAction(i,t)},dragStop:function(t){P([e.element],"e-dragging"),e.removeVirtualEle();var i=t.target,n=N(i,".e-droppable");i&&n&&!i.classList.contains(pf)||(A(t.helper),document.body.style.cursor="");var o=e.getDragEvent(t.event,e,i,i);e.trigger("nodeDragStop",o),o.cancel&&(t.helper.parentNode&&A(t.helper),document.body.style.cursor=""),e.dragStartAction=!1}}),this.dropObj=new Ol(this.element,{out:function(t){c(t)||t.target.classList.contains(Cf)||(document.body.style.cursor="not-allowed")},over:function(t){document.body.style.cursor=""},drop:function(t){e.dropAction(t)}})},e.prototype.dragAction=function(t,e){var i=N(t.target,".e-droppable"),n=N(t.target,"."+Sf),o=D("div.e-icons",e);P([o],["e-drop-in",Lf,"e-drop-out","e-no-drop"]),this.removeVirtualEle(),document.body.style.cursor="";var r=t.target.classList;if(this.fullRowSelect&&!n&&!c(r)&&r.contains("e-fullrow")&&(n=t.target.nextElementSibling),i){var s=N(t.target,"."+mf);if(!i.classList.contains(pf)||n&&!s.isSameNode(this.dragLi)&&!this.isDescendant(this.dragLi,s))if(s&&t&&t.event.offsetY<7){E([o],Lf);var a=L("div",{className:Cf}),l=this.fullRowSelect?1:0;s.insertBefore(a,s.children[l])}else if(s&&t&&t.target.offsetHeight>0&&t.event.offsetY>t.target.offsetHeight-10){E([o],Lf);var a=L("div",{className:Cf}),l=this.fullRowSelect?2:1;s.insertBefore(a,s.children[l])}else E([o],"e-drop-in");else"LI"!==t.target.nodeName||s.isSameNode(this.dragLi)||this.isDescendant(this.dragLi,s)?t.target.classList.contains(Cf)?E([o],Lf):E([o],"e-drop-out"):(E([o],Lf),this.renderVirtualEle(t))}else E([o],"e-no-drop"),document.body.style.cursor="not-allowed";this.trigger("nodeDragging",this.getDragEvent(t.event,this,t.target,t.target))},e.prototype.dropAction=function(t){for(var e,n=t.event.offsetY,o=t.target,r=t.dragData.draggable,s=0;s<r.ej2_instances.length;s++)if(r.ej2_instances[s]instanceof i){e=r.ej2_instances[s];break}if(e&&e.dragTarget){var a=N(e.dragTarget,"."+mf),l=N(o,"."+mf);if(A(t.droppedElement),document.body.style.cursor="",!l||l.isSameNode(a)||this.isDescendant(a,l))return;if(e.allowMultiSelection&&(a.classList.contains(bf)||n<7||t.target.offsetHeight>0&&n>t.target.offsetHeight-10))for(var h=B(".e-active",e.element),s=0;s<h.length;s++)l.isSameNode(h[s])||this.isDescendant(h[s],l)||this.appendNode(o,h[s],l,t,e,n);else this.appendNode(o,a,l,t,e,n)}this.trigger("nodeDropped",this.getDragEvent(t.event,e,o,t.target,t.dragData.draggedElement))},e.prototype.appendNode=function(t,e,i,n,o,r){e.classList.contains("e-disable")||i.classList.contains("e-disable")||("LI"===t.nodeName?this.dropAsSiblingNode(e,i,n,o):this.dropAsChildNode(e,i,o,null,n,r))},e.prototype.dropAsSiblingNode=function(t,e,i,n){var o,r=N(e,"."+vf),s=N(t,"."+vf),a=N(s,"."+mf);i.target.offsetHeight>0&&i.event.offsetY>i.target.offsetHeight-2?o=!1:i.event.offsetY<2&&(o=!0),r.insertBefore(t,o?i.target:i.target.nextElementSibling),this.updateElement(s,a),this.updateAriaLevel(t),n.element.id===this.element.id?this.updateList():(n.updateInstance(),this.updateInstance())},e.prototype.dropAsChildNode=function(t,e,i,n,o,r){var s=N(t,"."+vf),a=N(s,"."+mf),l=N(e,"."+vf);if(o&&r<7)l.insertBefore(t,e);else if(o&&o.target.offsetHeight>0&&r>o.target.offsetHeight-10)l.insertBefore(t,e.nextElementSibling);else{var h=this.expandParent(e);h.insertBefore(t,h.childNodes[n])}this.updateElement(s,a),this.updateAriaLevel(t),i.element.id===this.element.id?this.updateList():(i.updateInstance(),this.updateInstance())},e.prototype.expandParent=function(t){var e=D("div.e-icons",t);e&&e.classList.contains(gf)&&this.expandAction(t,e,null);var i=D("."+vf,t);return c(i)&&(this.trigger("nodeExpanding",this.getExpandEvent(t,null)),c(e)&&Dh.generateIcon(t,uf,this.listBaseOption),P([D("div.e-icons",t)],gf),i=Dh.generateUL([],null,this.listBaseOption),t.appendChild(i),t.setAttribute("aria-expanded","true"),P([t],"e-node-collapsed"),this.trigger("nodeExpanded",this.getExpandEvent(t,null))),i},e.prototype.updateElement=function(t,e){if(e&&0===t.childElementCount){var i=D("div.e-icons",e);A(t),A(i),e.removeAttribute("aria-expanded")}},e.prototype.updateAriaLevel=function(t){var e=this.parents(t,"."+vf).length;t.setAttribute("aria-level",""+e),this.updateChildAriaLevel(D("."+vf,t),e+1)},e.prototype.updateChildAriaLevel=function(t,e){if(!c(t))for(var i=t.childNodes,n=0,o=i.length;n<o;n++){var r=i[n];r.setAttribute("aria-level",""+e),this.updateChildAriaLevel(D("."+vf,r),e+1)}},e.prototype.renderVirtualEle=function(t){var e;t.event.offsetY>t.target.offsetHeight-2?e=!1:t.event.offsetY<2&&(e=!0);var i=L("div",{className:Cf}),n=this.fullRowSelect?e?1:2:e?0:1;t.target.insertBefore(i,t.target.children[n])},e.prototype.removeVirtualEle=function(){var t=D("."+Cf);t&&A(t)},e.prototype.destroyDrag=function(){this.dragObj&&this.dropObj&&(this.dragObj.destroy(),this.dropObj.destroy())},e.prototype.getDragEvent=function(t,e,i,n,o){var r=i?N(i,"."+mf):null,s=r?this.getNodeData(r):null;return{cancel:!1,event:t,draggedNode:e?e.dragLi:o,draggedNodeData:e?e.dragData:null,droppedNode:r,droppedNodeData:s,target:n}},e.prototype.addFullRow=function(t){var e=this.liList.length;if(t)for(i=0;i<e;i++)this.createFullRow(this.liList[i]);else for(var i=0;i<e;i++)A(D(".e-fullrow",this.liList[i]))},e.prototype.createFullRow=function(t){var e=L("div",{className:"e-fullrow"});t.insertBefore(e,t.childNodes[0])},e.prototype.addMultiSelect=function(t){if(t)for(var e=0,i=n=B('.e-list-item:not([aria-selected="true"])',this.element);e<i.length;e++)(s=i[e]).setAttribute("aria-selected","false");else for(var n=B('.e-list-item[aria-selected="false"]',this.element),o=0,r=n;o<r.length;o++){var s=r[o];s.removeAttribute("aria-selected")}},e.prototype.collapseByLevel=function(t,e,i){if(e>0&&!c(t))for(var n=this.getVisibleNodes(i,t.childNodes),o=0,r=n.length;o<r;o++){var s=n[o],a=D("."+uf,D("."+Sf,s));c(a)||this.collapseNode(s,a,null),this.collapseByLevel(D("."+vf,s),e-1,i)}},e.prototype.collapseAllNodes=function(t){for(var e=this.getVisibleNodes(t,B("."+uf,this.element)),i=0,n=e.length;i<n;i++){var o=e[i],r=N(o,"."+mf);this.collapseNode(r,o,null)}},e.prototype.expandByLevel=function(t,e,i){if(e>0&&!c(t))for(var n=this.getVisibleNodes(i,t.childNodes),o=0,r=n.length;o<r;o++){var s=n[o],a=D("."+gf,D("."+Sf,s));c(a)||this.expandAction(s,a,null),this.expandByLevel(D("."+vf,s),e-1,i)}},e.prototype.expandAllNodes=function(t){for(var e=this.getVisibleNodes(t,B("."+gf,this.element)),i=0,n=e.length;i<n;i++){var o=e[i],r=N(o,"."+mf);this.expandAction(r,o,null,!0)}},e.prototype.getVisibleNodes=function(t,e){var i=Array.prototype.slice.call(e);if(t)for(var n=0;n<i.length;n++)T(i[n])||(i.splice(n,1),n--);return i},e.prototype.removeNode=function(t){var e=N(t,"."+vf),i=N(e,"."+mf);A(t),this.updateElement(e,i),this.updateInstance()},e.prototype.updateInstance=function(){this.updateList(),this.updateSelectedNodes()},e.prototype.updateList=function(){this.liList=Array.prototype.slice.call(B("."+mf,this.element))},e.prototype.updateSelectedNodes=function(){this.setProperties({selectedNodes:[]},!0);var t=B(".e-active",this.element);this.selectGivenNodes(t)},e.prototype.doGivenAction=function(t,e,i){for(var n=0,o=t.length;n<o;n++){var r=this.getElement(t[n]);if(!c(r)){var s=D("."+e,D("."+Sf,r));c(s)||(i?this.expandAction(r,s,null):this.collapseNode(r,s,null))}}},e.prototype.addGivenNodes=function(t,e,i,n){var o=e?parseFloat(e.getAttribute("aria-level"))+1:1;n&&this.updateMapper(o);for(var r=Dh.createListItemFromJson(t,this.listBaseOption,o),s=e?this.expandParent(e):D("."+vf,this.element),a=s.childNodes[i],l=0;l<r.length;l++)s.insertBefore(r[l],a);this.finalizeNode(s)},e.prototype.updateMapper=function(t){var e=1===t?this.fields:this.getChildFields(this.fields,t-1,1);this.updateListProp(e)},e.prototype.updateListProp=function(t){var e=this.getActualProperties(t);this.listBaseOption.fields=e,this.listBaseOption.fields.url=e.hasOwnProperty("navigateUrl")?e.navigateUrl:"navigateUrl"},e.prototype.doDisableAction=function(t){for(var e=0,i=t.length;e<i;e++){var n=this.getElement(t[e]);c(n)||(n.setAttribute("aria-disabled","true"),E([n],"e-disable"))}},e.prototype.doEnableAction=function(t){for(var e=0,i=t.length;e<i;e++){var n=this.getElement(t[e]);c(n)||(n.removeAttribute("aria-disabled"),P([n],"e-disable"))}},e.prototype.setTouchClass=function(){var t=N(this.element,".e-bigger");this.touchClass=c(t)?"":"e-small"},e.prototype.wireInputEvents=function(t){Ma.add(t,"blur",this.inputFocusOut,this)},e.prototype.wireEditingEvents=function(t){if(t){var e=this;this.touchEditObj=new Vl(this.element,{tap:function(t){2===t.tapCount&&(t.originalEvent.preventDefault(),e.editingHandler(t.originalEvent))}})}else this.touchEditObj&&this.touchEditObj.destroy()},e.prototype.wireClickEvent=function(t){if(t){var e=this;this.touchClickObj=new Vl(this.element,{tap:function(t){e.clickHandler(t)}})}else this.touchClickObj&&this.touchClickObj.destroy()},e.prototype.wireExpandOnEvent=function(t){var e=this;if(t){var i=this;this.touchExpandObj=new Vl(this.element,{tap:function(t){("Click"===e.expandOnType||"DblClick"===e.expandOnType&&2===t.tapCount)&&i.expandHandler(t)}})}else this.touchExpandObj&&this.touchExpandObj.destroy()},e.prototype.mouseDownHandler=function(t){this.mouseDownStatus=!0,(t.shiftKey||t.ctrlKey)&&t.preventDefault(),t.ctrlKey&&this.allowMultiSelection&&Ma.add(this.element,"contextmenu",this.preventContextMenu,this)},e.prototype.preventContextMenu=function(t){t.preventDefault()},e.prototype.wireEvents=function(){Ma.add(this.element,"mousedown",this.mouseDownHandler,this),this.wireClickEvent(!0),this.wireExpandOnEvent(!0),Ma.add(this.element,"focus",this.focusIn,this),Ma.add(this.element,"blur",this.focusOut,this),Ma.add(this.element,"mouseover",this.onMouseOver,this),Ma.add(this.element,"mouseout",this.onMouseLeave,this),this.keyboardModule=new Rl(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})},e.prototype.unWireEvents=function(){Ma.remove(this.element,"mousedown",this.mouseDownHandler),this.wireClickEvent(!1),this.wireExpandOnEvent(!1),Ma.remove(this.element,"focus",this.focusIn),Ma.remove(this.element,"blur",this.focusOut),Ma.remove(this.element,"mouseover",this.onMouseOver),Ma.remove(this.element,"mouseout",this.onMouseLeave),this.keyboardModule.destroy()},e.prototype.parents=function(t,e){for(var i=[],n=t.parentNode;!c(n);)F(n,e)&&i.push(n),n=n.parentNode;return i},e.prototype.isDescendant=function(t,e){for(var i=e.parentNode;!c(i);){if(i===t)return!0;i=i.parentNode}return!1},e.prototype.showSpinner=function(t){E([t],wf),Ji({target:t,width:za.isDevice?16:14}),An(t)},e.prototype.hideSpinner=function(t){Rn(t),t.innerHTML="",P([t],wf)},e.prototype.setCheckedNodes=function(t){t=JSON.parse(JSON.stringify(t)),this.uncheckAll(this.checkedNodes),t.length>0&&this.checkAll(t)},e.prototype.onPropertyChanged=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++)switch(n[i]){case"allowDragAndDrop":this.setDragAndDrop(this.allowDragAndDrop);break;case"allowEditing":this.wireEditingEvents(this.allowEditing);break;case"allowMultiSelection":if(this.selectedNodes.length>1){var o=this.getElement(this.selectedNodes[0]);this.isLoaded=!1,this.removeSelectAll(),this.selectNode(o,null),this.isLoaded=!0}this.setMultiSelect(this.allowMultiSelection),this.addMultiSelect(this.allowMultiSelection);break;case"checkedNodes":this.showCheckBox&&(this.checkedNodes=e.checkedNodes,this.setCheckedNodes(t.checkedNodes));break;case"cssClass":this.setCssClass(e.cssClass,t.cssClass);break;case"enableRtl":this.setEnableRtl();break;case"expandOn":this.wireExpandOnEvent(!1),this.setExpandOnType(),this.wireExpandOnEvent(!0);break;case"fields":this.updateListProp(this.fields),this.reRenderNodes();break;case"fullRowSelect":this.setFullRow(this.fullRowSelect),this.addFullRow(this.fullRowSelect);break;case"nodeTemplate":this.nodeTemplateFn=this.templateComplier(this.nodeTemplate),this.reRenderNodes();break;case"selectedNodes":this.removeSelectAll(),this.setProperties({selectedNodes:t.selectedNodes},!0),this.doSelectionAction();break;case"showCheckBox":case"sortOrder":this.reRenderNodes()}},e.prototype.destroy=function(){this.element.removeAttribute("aria-activedescendant"),this.element.removeAttribute("tabindex"),this.unWireEvents(),this.wireEditingEvents(!1),this.rippleFn(),this.rippleIconFn(),this.setCssClass(this.cssClass,null),this.setDragAndDrop(!1),this.setFullRow(!1),this.element.innerHTML="",t.prototype.destroy.call(this)},e.prototype.addNodes=function(t,e,i){if(!c(t)){var o=this.getElement(e);if(t=this.getSortedData(t),this.fields.dataSource instanceof zu)this.addGivenNodes(t,o,i,!0);else if(2===this.dataType)this.addGivenNodes(t,o,i);else if(o)this.addGivenNodes(t,o,i);else for(var r=0;r<t.length;r++){var s=n(this.fields.parentID,t[r]);o=s?this.getElement(s.toString()):s,this.addGivenNodes([t[r]],o,i)}}},e.prototype.beginEdit=function(t){var e=this.getElement(t);c(e)||this.createTextbox(e,null)},e.prototype.checkAll=function(t){this.showCheckBox&&this.doCheckBoxAction(t,!0)},e.prototype.collapseAll=function(t,e,i){c(t)?e>0?this.collapseByLevel(D("."+vf,this.element),e,i):this.collapseAllNodes(i):this.doGivenAction(t,uf,!1)},e.prototype.disableNodes=function(t){c(t)||this.doDisableAction(t)},e.prototype.enableNodes=function(t){c(t)||this.doEnableAction(t)},e.prototype.ensureVisible=function(t){var e=this.getElement(t);if(!c(e)){var i=this.parents(e,"."+mf);this.expandAll(i),setTimeout(function(){e.scrollIntoView(!0)},450)}},e.prototype.expandAll=function(t,e,i){c(t)?e>0?this.expandByLevel(D("."+vf,this.element),e,i):this.expandAllNodes(i):this.doGivenAction(t,gf,!0)},e.prototype.getNode=function(t){var e=this.getElement(t);return this.getNodeData(e,!0)},e.prototype.moveNodes=function(t,e,i){var n=this.getElement(e);if(!c(n))for(var o=0;o<t.length;o++){var r=this.getElement(t[o]);c(r)||n.isSameNode(r)||this.isDescendant(r,n)||this.dropAsChildNode(r,n,this,i)}},e.prototype.removeNodes=function(t){if(!c(t))for(var e=0,i=t.length;e<i;e++){var n=this.getElement(t[e]);c(n)||this.removeNode(n)}},e.prototype.updateNode=function(t,e){if(!c(t)&&!c(e)&&this.allowEditing){var i=this.getElement(t);if(!c(i)){var n=D("."+ff,i);this.updateOldText(i);var o=this.getEditEvent(i,null,null);this.trigger("nodeEditing",o),o.cancel||this.appendNewText(i,n,e,!1)}}},e.prototype.uncheckAll=function(t){this.showCheckBox&&this.doCheckBoxAction(t,!1)},df([et(!1)],e.prototype,"allowDragAndDrop",void 0),df([et(!1)],e.prototype,"allowEditing",void 0),df([et(!1)],e.prototype,"allowMultiSelection",void 0),df([it({},Af)],e.prototype,"animation",void 0),df([et()],e.prototype,"checkedNodes",void 0),df([et("")],e.prototype,"cssClass",void 0),df([et(!1)],e.prototype,"enablePersistence",void 0),df([et(!1)],e.prototype,"enableRtl",void 0),df([et("Auto")],e.prototype,"expandOn",void 0),df([it({},Of)],e.prototype,"fields",void 0),df([et(!0)],e.prototype,"fullRowSelect",void 0),df([et()],e.prototype,"nodeTemplate",void 0),df([et()],e.prototype,"selectedNodes",void 0),df([et("None")],e.prototype,"sortOrder",void 0),df([et(!1)],e.prototype,"showCheckBox",void 0),df([st()],e.prototype,"created",void 0),df([st()],e.prototype,"dataBound",void 0),df([st()],e.prototype,"drawNode",void 0),df([st()],e.prototype,"destroyed",void 0),df([st()],e.prototype,"keyPress",void 0),df([st()],e.prototype,"nodeChecked",void 0),df([st()],e.prototype,"nodeChecking",void 0),df([st()],e.prototype,"nodeClicked",void 0),df([st()],e.prototype,"nodeCollapsed",void 0),df([st()],e.prototype,"nodeCollapsing",void 0),df([st()],e.prototype,"nodeDragging",void 0),df([st()],e.prototype,"nodeDragStart",void 0),df([st()],e.prototype,"nodeDragStop",void 0),df([st()],e.prototype,"nodeDropped",void 0),df([st()],e.prototype,"nodeEdited",void 0),df([st()],e.prototype,"nodeEditing",void 0),df([st()],e.prototype,"nodeExpanded",void 0),df([st()],e.prototype,"nodeExpanding",void 0),df([st()],e.prototype,"nodeSelected",void 0),df([st()],e.prototype,"nodeSelecting",void 0),e=i=df([at],e);var i}(wl),Rf=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Df=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Bf="e-open",Nf="e-right",Hf="e-left",zf="e-over",jf="e-push",Vf="e-sidebar-context",Ff=function(t){function e(e,i){return t.call(this,e,i)||this}return Rf(e,t),e.prototype.preRender=function(){this.setWidth()},e.prototype.render=function(){this.initialize(),this.wireEvents()},e.prototype.initialize=function(){this.setTarget(),this.addClass(),this.setZindex(),this.enableDock&&this.setDock(),this.isOpen?this.show():this.setMediaQuery(),this.setType(this.type),this.setCloseOnDocumentClick(),this.setEnableRTL()},e.prototype.setEnableRTL=function(){this.enableRtl?E([this.element],"e-rtl"):P([this.element],"e-rtl")},e.prototype.setTarget=function(){"string"==typeof this.target&&this.setProperties({target:document.querySelector(this.target)},!0),this.target&&(this.target.insertAdjacentElement("afterbegin",this.element),E([this.element],"e-sidebar-absolute"),E([this.target],Vf))},e.prototype.setCloseOnDocumentClick=function(){this.closeOnDocumentClick?Ma.add(document,"mousedown touchstart",this.documentclickHandler,this):Ma.remove(document,"mousedown touchstart",this.documentclickHandler)},e.prototype.setWidth=function(){this.enableDock&&"Left"===this.position?j(this.element,{width:this.setDimension(this.dockSize)}):this.enableDock&&"Right"===this.position?j(this.element,{width:this.setDimension(this.dockSize)}):this.enableDock||j(this.element,{width:this.setDimension(this.width)})},e.prototype.setDimension=function(t){return t="number"==typeof t?b(t):"string"==typeof t?t.match(/px|%|em/)?t:b(t):"100%"},e.prototype.setZindex=function(){j(this.element,{"z-index":""+this.zIndex})},e.prototype.addClass=function(){var t=document.querySelector(".e-main-content");c(t||this.element.nextElementSibling)||E([t||this.element.nextElementSibling],["e-content-animation"]),this.enableDock||"Auto"===this.type||E([this.element],["e-visibility"]),P([this.element],[Bf,"e-close",Nf,Hf,"e-slide",jf,zf]),this.element.classList.add("e-sidebar"),E([this.element],"Right"===this.position?Nf:Hf),"Auto"!==this.type||za.isDevice||this.enableDock?E([this.element],"e-close"):E([this.element],Bf)},e.prototype.destroyBackDrop=function(){var t=document.querySelector(".e-main-content")||this.element.nextElementSibling;this.target&&this.showBackdrop&&t?P([t],"e-backdrop"):this.showBackdrop&&this.modal&&(this.modal.style.display="none",this.modal.outerHTML="",this.modal=null)},e.prototype.hide=function(){var t={model:this,element:this.element,cancel:!1};if(this.trigger("close",t),!t.cancel){if(this.element.classList.contains("e-close"))return;if(this.element.classList.contains(Bf)){var e={name:"change",element:this.element};this.trigger("change",e)}E([this.element],"e-close"),P([this.element],Bf),this.enableDock?j(this.element,{width:b(this.dockSize)}):j(this.element,{width:b(this.width)}),this.setDock(),this.setType(this.type);var i=document.querySelector(".e-main-content")||this.element.nextElementSibling;!this.enableDock&&i&&(i.style.transform="translateX(0px)","Left"===this.position?i.style.marginLeft="0px":i.style.marginRight="0px"),this.destroyBackDrop(),this.setCloseOnDocumentClick(),this.setAnimation(),"Slide"===this.type&&document.body.classList.remove("e-sidebar-overflow"),this.setProperties({isOpen:!1},!0)}},e.prototype.show=function(){var t={model:this,element:this.element,cancel:!1};if(this.trigger("open",t),!t.cancel){if(P([this.element],"e-visibility"),this.element.classList.contains(Bf))return;if(this.element.classList.contains("e-close")){var e={name:"change",element:this.element};this.trigger("change",e)}E([this.element],[Bf,"e-transition"]),j(this.element,{transform:""}),P([this.element],"e-close"),j(this.element,{width:b(this.width)});this.element.getBoundingClientRect().width;this.setType(this.type),this.createBackDrop(),this.setCloseOnDocumentClick(),this.setAnimation(),"Slide"===this.type&&document.body.classList.add("e-sidebar-overflow"),this.setProperties({isOpen:!0},!0)}},e.prototype.setAnimation=function(){this.animate?P([this.element],"e-disable-animation"):E([this.element],"e-disable-animation")},e.prototype.setDock=function(){this.enableDock&&"Left"===this.position&&!this.getState()?j(this.element,{transform:"translateX(-100%) translateX("+this.setDimension(this.dockSize)+")"}):this.enableDock&&"Right"===this.position&&!this.getState()&&j(this.element,{transform:"translateX(100%) translateX(-"+this.setDimension(this.dockSize)+")"}),this.element.classList.contains("e-close")&&this.enableDock&&j(this.element,{width:this.setDimension(this.dockSize)})},e.prototype.createBackDrop=function(){this.target&&this.showBackdrop?E([document.querySelector(".e-main-content")||this.element.nextElementSibling],"e-backdrop"):this.showBackdrop&&!this.modal&&this.getState()&&(this.modal=L("div"),this.modal.className="e-sidebar-overlay",this.modal.style.display="block",document.body.appendChild(this.modal))},e.prototype.getPersistData=function(){return this.addOnPersist(["type","position","isOpen"])},e.prototype.getModuleName=function(){return"sidebar"},e.prototype.toggle=function(t){this.element.classList.contains(Bf)?this.hide():this.show()},e.prototype.getState=function(){return!!this.element.classList.contains(Bf)},e.prototype.setMediaQuery=function(){this.mediaQuery&&this.mediaQuery.matches?this.show():this.mediaQuery&&this.getState()&&this.hide()},e.prototype.resize=function(t){"Auto"===this.type&&(za.isDevice?E([this.element],zf):E([this.element],jf)),this.setMediaQuery()},e.prototype.documentclickHandler=function(t){N(t.target,".e-control.e-sidebar")||this.hide()},e.prototype.enableGestureHandler=function(t){"Left"===this.position&&"Right"===t.swipeDirection&&t.startX<=20&&t.distanceX>=50&&t.velocity>=.5?this.show():"Left"===this.position&&"Left"===t.swipeDirection?this.hide():"Right"===this.position&&"Right"===t.swipeDirection?this.hide():"Right"===this.position&&"Left"===t.swipeDirection&&window.innerWidth-t.startX<=20&&t.distanceX>=50&&t.velocity>=.5&&this.show()},e.prototype.setEnableGestures=function(){this.enableGestures?(this.mainContentEle=new Vl(document.body,{swipe:this.enableGestureHandler.bind(this)}),this.sidebarEle=new Vl(this.element,{swipe:this.enableGestureHandler.bind(this)})):this.mainContentEle&&this.sidebarEle&&(this.mainContentEle.destroy(),this.sidebarEle.destroy())},e.prototype.wireEvents=function(){this.setEnableGestures(),window.addEventListener("resize",this.resize.bind(this))},e.prototype.unWireEvents=function(){window.removeEventListener("resize",this.resize.bind(this)),Ma.remove(document,"mousedown touchstart",this.documentclickHandler),this.mainContentEle&&this.mainContentEle.destroy(),this.sidebarEle&&this.sidebarEle.destroy()},e.prototype.onPropertyChanged=function(e,i){for(var n=document.querySelector(".e-main-content")||this.element.nextElementSibling,o=0,r=Object.keys(e);o<r.length;o++)switch(r[o]){case"isOpen":this.isOpen?this.show():this.hide();break;case"width":this.setWidth(),this.getState()||this.setDock();break;case"animate":this.setAnimation();break;case"type":P([this.element],["e-visibility"]),this.addClass(),this.setType(this.type);break;case"position":this.element.style.transform="",this.setDock(),n&&("Left"===this.position?n.style.marginRight="0px":n.style.marginLeft="0px"),"Right"===this.position?(P([this.element],Hf),E([this.element],Nf)):(P([this.element],Nf),E([this.element],Hf)),this.setType(this.type);break;case"showBackdrop":this.showBackdrop?this.createBackDrop():this.modal&&(this.modal.style.display="none",this.modal.outerHTML="",this.modal=null);break;case"target":"string"==typeof this.target&&this.setProperties({target:document.querySelector(this.target)},!0),c(this.target)?(P([this.element],"e-sidebar-absolute"),P([i.target],Vf),j(n,{"margin-left":0,"margin-right":0}),document.body.insertAdjacentElement("afterbegin",this.element)):t.prototype.refresh.call(this);break;case"closeOnDocumentClick":this.setCloseOnDocumentClick();break;case"enableDock":this.getState()||this.setDock();break;case"zIndex":this.setZindex();break;case"mediaQuery":this.setMediaQuery();break;case"enableGestures":this.setEnableGestures();break;case"enableRtl":this.setEnableRTL()}},e.prototype.setType=function(t){var e=this.element.getBoundingClientRect().width;this.setZindex(),this.enableDock&&E([this.element],"e-dock");var i=document.querySelector(".e-main-content")||this.element.nextElementSibling;i&&(i.style.transform="translateX(0px)",za.isDevice||"Auto"===this.type||("Left"===this.position?i.style.marginLeft="0px":i.style.marginRight="0px"));var n=(this.position,e+"px"),o="Left"===this.position?e:-e;switch(P([this.element],[jf,zf,"e-slide"]),t){case"Push":E([this.element],[jf]),i&&(this.enableDock||this.element.classList.contains(Bf))&&("Left"===this.position?i.style.marginLeft=n:i.style.marginRight=n);break;case"Slide":E([this.element],["e-slide"]),i&&(this.enableDock||this.element.classList.contains(Bf))&&(i.style.transform="translateX("+o+"px)");break;case"Over":E([this.element],[zf]),this.enableDock&&this.element.classList.contains("e-close")&&i&&("Left"===this.position?i.style.marginLeft=n:i.style.marginRight=n);break;case"Auto":E([this.element],["e-transition"]),za.isDevice?i&&this.enableDock&&!this.getState()?("Left"===this.position?i.style.marginLeft=n:i.style.marginRight=n,E([this.element],jf)):E([this.element],zf):(E([this.element],jf),i&&(this.enableDock||this.element.classList.contains(Bf))&&("Left"===this.position?i.style.marginLeft=n:i.style.marginRight=n),this.setProperties({isOpen:!0},!0)),this.createBackDrop()}},e.prototype.destroy=function(){t.prototype.destroy.call(this),P([this.element],[Bf,"e-close",jf,"e-slide",zf,Hf,Nf,"e-transition"]),this.target&&(P([this.element],"e-sidebar-absolute"),P([this.target],Vf)),this.destroyBackDrop(),this.element.style.width="",this.element.style.zIndex="",this.element.style.transform="";var e=document.querySelector(".e-main-content")||this.element.nextElementSibling;c(e)||(e.style.margin="",e.style.transform=""),this.unWireEvents()},Df([et("auto")],e.prototype,"dockSize",void 0),Df([et(null)],e.prototype,"mediaQuery",void 0),Df([et(!1)],e.prototype,"enableDock",void 0),Df([et(!0)],e.prototype,"enableGestures",void 0),Df([et(!1)],e.prototype,"isOpen",void 0),Df([et(!1)],e.prototype,"enableRtl",void 0),Df([et(!0)],e.prototype,"animate",void 0),Df([et("auto")],e.prototype,"height",void 0),Df([et(!1)],e.prototype,"closeOnDocumentClick",void 0),Df([et("Left")],e.prototype,"position",void 0),Df([et(null)],e.prototype,"target",void 0),Df([et(!1)],e.prototype,"showBackdrop",void 0),Df([et("Auto")],e.prototype,"type",void 0),Df([et("auto")],e.prototype,"width",void 0),Df([et(1e3)],e.prototype,"zIndex",void 0),Df([st()],e.prototype,"created",void 0),Df([st()],e.prototype,"close",void 0),Df([st()],e.prototype,"open",void 0),Df([st()],e.prototype,"change",void 0),Df([st()],e.prototype,"destroyed",void 0),e=Df([at],e)}(wl),_f=Object.freeze({HScroll:Pm,Item:Mm,Toolbar:Rm,AccordionActionSettings:jm,AccordionAnimationSettings:Vm,AccordionItem:Fm,Accordion:_m,MenuItem:Km,ContextMenu:Qm,TabActionSettings:rf,TabAnimationSettings:sf,Header:af,TabItem:lf,Tab:hf,FieldsSettings:Of,ActionSettings:If,NodeAnimationSettings:Af,TreeView:Mf,Sidebar:Ff}),Wf={content:".e-diagramcontent",copy:"e-copy",paste:"e-paste",undo:"e-undo",redo:"e-redo",cut:"e-cut",selectAll:"e-selectall",grouping:"e-grouping",group:"e-group",unGroup:"e-ungroup",bringToFront:"e-bringfront",sendToBack:"e-sendback",moveForward:"e-bringforward",sendBackward:"e-sendbackward",order:"e-order"},Uf=function(){function t(t,e){this.defaultItems={},this.disableItems=[],this.hiddenItems=[],this.localeText=this.setLocaleKey(),this.parent=t,this.serviceLocator=e,this.addEventListener()}return t.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on("initial-load",this.render,this)},t.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("initial-load",this.render)},t.prototype.render=function(){this.l10n=this.serviceLocator.getService("localization"),this.element=L("ul",{id:this.parent.element.id+"_contextMenu"}),this.parent.element.appendChild(this.element);var t="#"+this.parent.element.id;this.contextMenu=new Qm({items:this.getMenuItems(),enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,locale:this.parent.locale,target:t,select:this.contextMenuItemClick.bind(this),beforeOpen:this.contextMenuBeforeOpen.bind(this),onOpen:this.contextMenuOpen.bind(this),onClose:this.contextMenuOnClose.bind(this),cssClass:"e-diagram-menu"}),this.contextMenu.appendTo(this.element)},t.prototype.getMenuItems=function(){var t=[],e=[],i=[];if(!this.parent.contextMenuSettings.showCustomMenuOnly){for(var n=0,o=this.getDefaultItems();n<o.length;n++){var r=o[n];-1!==r.toLocaleLowerCase().indexOf("group")?"grouping"!==r.toLocaleLowerCase()&&i.push(this.buildDefaultItems(r)):-1!==r.toLocaleLowerCase().indexOf("order")?"order"!==r.toLocaleLowerCase()&&e.push(this.buildDefaultItems(r)):t.push(this.buildDefaultItems(r))}if(i.length>0&&((s=this.buildDefaultItems("grouping")).items=i,t.push(s)),e.length>0){var s=this.buildDefaultItems("order");s.items=e,t.push(s)}}if(this.parent.contextMenuSettings.items)for(var a=0,l=this.parent.contextMenuSettings.items;a<l.length;a++){var h=l[a];t.push(h)}return t},t.prototype.contextMenuOpen=function(){this.isOpen=!0},t.prototype.contextMenuItemClick=function(t){switch(this.getKeyFromId(t.item.id)){case"cut":this.parent.cut();break;case"copy":this.parent.copy();break;case"undo":this.parent.undo();break;case"redo":this.parent.redo();break;case"paste":this.parent.paste();break;case"selectAll":this.parent.selectAll();break;case"group":this.parent.group();break;case"unGroup":this.parent.unGroup();break;case"bringToFrontOrder":this.parent.bringToFront();break;case"moveForwardOrder":this.parent.moveForward();break;case"sendToBackOrder":this.parent.sendToBack();break;case"sendBackwardOrder":this.parent.sendBackward()}document.getElementById(this.parent.element.id+"content").focus(),this.parent.trigger("contextMenuClick",t)},t.prototype.contextMenuOnClose=function(t){t.items.length>0&&t.items[0].parentObj instanceof Qm&&this.updateItemStatus()},t.prototype.getLocaleText=function(t){return this.l10n.getConstant(this.localeText[t])},t.prototype.updateItemStatus=function(){this.contextMenu.showItems(this.hiddenItems,!0),this.contextMenu.enableItems(this.disableItems,!1,!0),this.hiddenItems=[],this.disableItems=[],this.isOpen=!1},t.prototype.ensureItems=function(t,e){var i=this.getKeyFromId(t.id);this.defaultItems[i];-1!==this.getDefaultItems().indexOf(i)&&t.target&&e&&!this.ensureTarget(t)&&this.hiddenItems.push(t.id)},t.prototype.contextMenuBeforeOpen=function(t){var e=t;e.hiddenItems=[];for(var i=0,n=t.items;i<n.length;i++){var o=n[i];if(this.ensureItems(o,t.event),o.items.length)for(var r=0,s=o.items;r<s.length;r++){var a=s[r];this.ensureItems(a,t.event)}}this.eventArgs=t.event,this.parent.trigger("contextMenuOpen",e),e.items.length===e.hiddenItems.length?(e.cancel=!0,e.hiddenItems=[]):(this.hiddenItems=this.hiddenItems.concat(e.hiddenItems),this.contextMenu.enableItems(this.disableItems,!1,!0),this.contextMenu.hideItems(this.hiddenItems,!0))},t.prototype.ensureTarget=function(t){var e=this.parent.selectedItems.nodes.length+this.parent.selectedItems.connectors.length,i=!1;switch(this.getKeyFromId(t.id)){case"undo":i=!(!this.parent.historyList||!this.parent.historyList.canUndo);break;case"redo":i=!(!this.parent.historyList||!this.parent.historyList.canRedo);break;case"paste":i=!!this.parent.commandHandler.clipboardData.clipObject;break;case"selectAll":i=!!(this.parent.nodes.length+this.parent.connectors.length);break;case"grouping":i=!!(e>1||this.parent.selectedItems.nodes[0]&&this.parent.selectedItems.nodes[0].children&&this.parent.selectedItems.nodes[0].children.length>1);break;case"group":i=e>1;break;case"unGroup":i=!!(this.parent.selectedItems.nodes[0]&&this.parent.selectedItems.nodes[0].children&&this.parent.selectedItems.nodes[0].children.length>1);break;case"cut":case"copy":case"order":case"bringToFrontOrder":case"moveForwardOrder":case"sendToBackOrder":case"sendBackwardOrder":i=!!e}return i},t.prototype.destroy=function(){this.contextMenu.destroy(),M(this.element),this.removeEventListener()},t.prototype.getModuleName=function(){return"contextMenu"},t.prototype.generateID=function(t){return this.parent.element.id+"_contextMenu_"+t},t.prototype.getKeyFromId=function(t){return t.replace(this.parent.element.id+"_contextMenu_","")},t.prototype.buildDefaultItems=function(t){var e;switch(t){case"copy":e={target:Wf.content,iconCss:Wf.copy};break;case"cut":e={target:Wf.content,iconCss:Wf.cut};break;case"paste":e={target:Wf.content,iconCss:Wf.paste};break;case"undo":e={target:Wf.content,iconCss:Wf.undo};break;case"redo":e={target:Wf.content,iconCss:Wf.redo};break;case"grouping":e={target:Wf.content};break;case"group":e={target:Wf.content,iconCss:Wf.group};break;case"unGroup":e={target:Wf.content,iconCss:Wf.unGroup};break;case"order":e={target:Wf.content,iconCss:Wf.order};break;case"bringToFrontOrder":e={target:Wf.content,iconCss:Wf.bringToFront};break;case"moveForwardOrder":e={target:Wf.content,iconCss:Wf.moveForward};break;case"sendToBackOrder":e={target:Wf.content,iconCss:Wf.sendToBack};break;case"sendBackwardOrder":e={target:Wf.content,iconCss:Wf.sendBackward};break;case"selectAll":e={target:Wf.content}}return this.defaultItems[t]={text:this.getLocaleText(t),id:this.generateID(t),target:e.target,iconCss:e.iconCss?"e-icons "+e.iconCss:""},this.defaultItems[t]},t.prototype.getDefaultItems=function(){return["copy","cut","paste","undo","redo","selectAll","grouping","group","unGroup","order","bringToFrontOrder","moveForwardOrder","sendToBackOrder","sendBackwardOrder"]},t.prototype.setLocaleKey=function(){return{copy:"Copy",cut:"Cut",paste:"Paste",undo:"Undo",redo:"Redo",selectAll:"SelectAll",grouping:"Grouping",group:"Group",unGroup:"UnGroup",order:"Order",bringToFrontOrder:"BringToFront",moveForwardOrder:"MoveForward",sendToBackOrder:"SendToBack",sendBackwardOrder:"SendBackward"}},t}(),qf=function(){function t(){this.annotationObjects={}}return Object.defineProperty(t.prototype,"textAnnotationConnectors",{get:function(){for(var t=[],e=0,i=Object.keys(this.annotationObjects);e<i.length;e++)for(var n=i[e],o=this.annotationObjects[n],r=0,s=Object.keys(o);r<s.length;r++){var a=s[r];t.push(o[a].connector)}return t},enumerable:!0,configurable:!0}),t.prototype.getTextAnnotationConn=function(t){var e=[];if("Bpmn"===t.shape.type&&0!==t.shape.annotations.length)for(var i=this.annotationObjects[t.id],n=0,o=Object.keys(i);n<o.length;n++){var r=o[n];e.push(i[r].connector)}return e},t.prototype.getSize=function(t,e){var i=new nh(t.width,t.height);if(void 0===i.width||void 0===i.height){if(e instanceof Hh||(i.width=i.width||50,i.height=i.height||50),e.actualSize.width&&e.actualSize.height)return e.actualSize;e.measure(new nh),i.width=i.width||e.desiredSize.width,i.height=i.height||e.desiredSize.height,void 0!==t.maxWidth&&(i.width=Math.min(i.width,t.maxWidth)),void 0!==t.maxHeight&&(i.height=Math.min(i.height,t.maxHeight)),void 0!==t.minWidth&&(i.width=Math.max(i.width,t.minWidth)),void 0!==t.minHeight&&(i.height=Math.max(i.height,t.minHeight))}return i},t.prototype.initBPMNContent=function(t,e,i){var n=e.shape;if("Event"===n.shape&&(t=this.getBPMNEventShape(e,n.event)),"Gateway"===n.shape&&(t=this.getBPMNGatewayShape(e)),"DataObject"===n.shape&&(t=this.getBPMNDataObjectShape(e)),"Message"!==n.shape&&"DataSource"!==n.shape||(t=this.getBPMNShapes(e)),"Activity"===n.shape&&(t=this.getBPMNActivityShape(e)),n.annotations.length>0)for(var o=0;o<n.annotations.length&&n.annotations[o].text;o++)t.children.push(this.getBPMNTextAnnotation(e,i,n.annotations[o],t));return t.style.strokeDashArray="2 2 6 2",t},t.prototype.getBPMNShapes=function(t){var e=new Hh;this.setStyle(e,t),0!=(t.constraints&fh.Shadow)&&(e.shadow=t.shadow);var i=wa(t.shape.shape);return e.data=i,e.id=t.id+"_"+t.shape.shape,void 0!==t.width&&void 0!==t.height&&(e.width=t.width,e.height=t.height),e},t.prototype.getBPMNGatewayShape=function(t){var e=new sc,i=new Hh;i.id=t.id+"_0_gateway",i.offsetX=t.offsetX,i.offsetY=t.offsetY,i.data="M 40 20 L 20 40 L 0 20 L 20 0 L 40 20 Z",this.setStyle(i,t);var n=new Hh;n.id=t.id+"_1_gatewayType",n.style.opacity=t.style.opacity,n.horizontalAlignment="Center",n.verticalAlignment="Center",n.relativeMode="Object";var o,r=t.shape.gateway;o=Sa(r.type),"EventBased"===r.type||"ExclusiveEventBased"===r.type||"ParallelEventBased"===r.type?n.style.fill="white":n.style.fill="black",n.data=o,e.style.fill="transparent",e.style.strokeColor="transparent",e.style.strokeWidth=0,e.children=[i,n];var s=this.getSize(t,i);return this.setSizeForBPMNGateway(t.shape.gateway,e,s.width,s.height),e},t.prototype.getBPMNDataObjectShape=function(t){var e=new sc,i=t.shape.dataObject,n=new Hh;n.id=t.id+"_0_dataobj",n.data="M29.904,5 L7.853,5 L7.853,45 L42.147,45 L42.147,17.242,L29.932,5,L29.932,17.242,L42.147,17.242";var o=this.getSize(t,n);n.width=o.width,n.height=o.height,this.setStyle(n,t);var r=new Hh;r.id=t.id+"_1_type",r.width=25,r.height=20,r.margin.left=5,r.margin.top=5,r.data="M 3 9.4 l 6 0 v 2.4 l 3.6 -4 L 9 4 v 2.5 H 3 V 9.4 Z",r.style.opacity=t.style.opacity;var s=new Hh;switch(s.id=t.id+"_2_collection",s.width=7.5,s.height=15,s.style.fill="black",s.visible=!0,s.horizontalAlignment="Center",s.verticalAlignment="Bottom",s.relativeMode="Object",s.style.opacity=t.style.opacity,s.data="M 0 0 L 0.1 0 L 0.1 2 L 0 2 Z M 0.4 0 L 0.6 0 L 0.6 2 L0.4 2 Z M 0.9 0 L 1 0 L 1 2 L 0.9 2 Z",i.type){case"None":r.visible=!1;break;case"Input":r.style.fill="white";break;case"Output":r.style.fill="black"}return!1===i.collection&&(s.visible=!1),e.style.fill="transparent",e.style.strokeColor="transparent",e.style.strokeWidth=0,e.children=[n,r,s],e},t.prototype.getBPMNTaskShape=function(t){var e=t.shape.activity.task,i=new sc,n=new Bh;n.cornerRadius=10;var o=this.getSize(t,n);n.id=t.id+"_0_task",n.width=o.width,n.height=o.height,this.setStyle(n,t),void 0!==e.call&&!0===e.call&&(n.style.strokeWidth=4),i.width=o.width,i.height=o.height;var r,s=this.getTaskChildCount(t),a=12*s,l=o.width/2-a;r=1===s?l+8:l+8*(s-1);var h,c=new Hh;"Receive"===e.type||"Send"===e.type?(c.width=18,c.height=16):(c.width=20,c.height=20),c.id=t.id+"_1_tasktType",c.margin.left=5,c.margin.top=5,h=Ca(e.type),c.data=h,c.style.fill="transparent",c.style.opacity=t.style.opacity,i.style.fill="transparent",i.style.strokeColor="transparent",i.style.strokeWidth=0,i.children=[n,c];var d,p=e.loop,u=new Hh;d=La(p),u.data=d,u.style.fill="black",u.visible="None"!==p,1===s&&(r=l+9),u.margin.left=r,!0===u.visible&&(r+=20),u.width=12,u.height=12,u.margin.bottom=5,u.id=t.id+"_2_loop",u.horizontalAlignment="Left",u.verticalAlignment="Bottom",u.setOffsetWithRespectToBounds(0,1,"Fraction"),u.relativeMode="Point",u.style.fill="transparent",c.style.opacity=t.style.opacity,i.children.push(u);var g=new Hh;return g=this.getBPMNCompensationShape(t,g),!0===e.compensation?g.visible=!0:g.visible=!1,1===s&&(r=l+9),g.margin.left=r-3,r+=18,i.children.push(g),i},t.prototype.getBPMNEventShape=function(t,e,i,n){var o,r,s,a,l=new sc;n=n||t.id;var h="M164.1884,84.6909000000001C156.2414,84.6909000000001,149.7764,78.2259000000001,149.7764,70.2769000000001C149.7764,62.3279000000001,156.2414,55.8629000000001,164.1884,55.8629000000001C172.1354,55.8629000000001,178.6024,62.3279000000001,178.6024,70.2769000000001C178.6024,78.2259000000001,172.1354,84.6909000000001,164.1884,84.6909000000001",c=t.shape.event;if("Event"===t.shape.shape&&(o=c.event,r=c.trigger),s=e.width,a=e.height,i)s=s||20,a=a||20;else if(void 0===e.width||void 0===e.height){var d=new Hh;d.data=h;var p=this.getSize(t,d);s=p.width,a=p.height}var u=t.shape.activity;if("Activity"===t.shape.shape){u.subProcess;o=e.event,r=e.trigger}var g=new Hh;g.data=h,g.id=n+"_0_event",g.width=s,g.height=a,g.horizontalAlignment="Center",g.verticalAlignment="Center",g.relativeMode="Object",this.setStyle(g,t);var m=new Hh;m.data=h,m.id=n+"_1_event",m.horizontalAlignment="Center",m.verticalAlignment="Center",m.relativeMode="Object",m.style.strokeColor=t.style.strokeColor,m.style.opacity=t.style.opacity;var f=new Hh,v=xa(r);switch(f.data=v,f.id=n+"_2_trigger",f.horizontalAlignment="Center",f.verticalAlignment="Center",f.relativeMode="Object",f.style.strokeColor=t.style.strokeColor,f.style.opacity=t.style.opacity,o){case"Start":m.visible=!1;break;case"NonInterruptingStart":g.style.strokeDashArray="2 3",m.visible=!1;break;case"Intermediate":g.style.fill="white",g.style.gradient=null;break;case"NonInterruptingIntermediate":g.style.fill="white",g.style.gradient=null,g.style.strokeDashArray="2 3",m.style.strokeDashArray="2 3";break;case"ThrowingIntermediate":case"End":g.style.fill="End"!==o?"white":"black",g.style.gradient=null,f.style.fill="black",f.style.strokeColor=t.style.fill}return l.style.fill="transparent",l.style.strokeColor="transparent",l.style.strokeWidth=0,l.children=[g,m,f],this.setSizeForBPMNEvents(c,l,s,a),l},t.prototype.setEventVisibility=function(t,e){var i=t.shape.event.event,n=e[0],o=e[1];e[2];switch(i){case"Start":o.visible=!1;break;case"NonInterruptingStart":n.style.strokeDashArray="2 3",o.visible=!1}},t.prototype.setSubProcessVisibility=function(t){if(t.shape.activity.subProcess){var e=t.shape.activity.subProcess,i=e.events.length,n="Transaction"===t.shape.activity.subProcess.type?2:0,o=t.wrapper.children[0].children[0];if(!1===e.adhoc&&(o.children[3+n+i].visible=!1),!1===e.compensation&&(o.children[4+n+i].visible=!1),i>0)for(var r=0;r<i;r++)this.setEventVisibility(t,o.children[2+r].children)}},t.prototype.getBPMNSubProcessShape=function(t){var e,i,n,o=new sc,r=new Hh,s=(new sc,new Hh),a=t.shape.activity,l=a.subProcess,h=this.getSubprocessChildCount(t),c=new Bh;c.id=t.id+"_0_Subprocess",c.style.fill="transparent",c.cornerRadius=10;var d=this.getSize(t,c);c.width=d.width,c.height=d.height,o.children=[c],"Transaction"===a.subProcess.type&&this.getBPMNSubProcessTransaction(t,t.shape,o);var p=12*h,u=d.width/2;n=1===h?u-6:u-p/2-4*(h-1)/2,this.setStyle(c,t),0!=(t.constraints&fh.Shadow)&&(o.shadow=t.shadow);var g=new Hh;if(g.id=t.id+"_0_collapsed",g.width=12,g.height=12,g.style.fill="black",g.margin.bottom=5,g.horizontalAlignment="Left",g.verticalAlignment="Bottom",g.setOffsetWithRespectToBounds(0,1,"Fraction"),g.relativeMode="Point",g.data=wa("collapsedShape"),g.margin.left=n,!0!==l.collapsed||l.processes?g.visible=!1:g.visible=!0,!0===g.visible&&(n+=18),o.children.push(g),"Event"===l.type){c.style.strokeWidth=1,c.style.strokeDashArray="2 2",e=l.events;for(var m=0;m<e.length;m++)i=e[m],this.getBPMNSubEvent(i,t,o)}s=this.getBPMNSubProcessLoopShape(t),1===h&&(n=u+8),s.margin.left=n,!0===s.visible&&(n+=16),o.children.push(s),c.id=t.id+"_boundary","Default"===l.boundary&&(c.style.strokeWidth=1,c.style.strokeDashArray="1 0"),"Call"===l.boundary&&(c.style.strokeWidth=4,c.style.strokeDashArray="1 0"),"Event"===l.boundary&&(c.style.strokeWidth=1,c.style.strokeDashArray="2 2"),r=this.getBPMNAdhocShape(t,r,l),1===h&&(n=u+8),r.margin.left=n,!0===r.visible&&(n+=16),o.children.push(r);var f=new Hh;return!0===l.compensation?f.visible=!0:f.visible=!1,f=this.getBPMNCompensationShape(t,f),1===h&&(n=u+8),f.margin.left=n,!0===f.visible&&(n+=16),o.children.push(f),o.style.strokeColor="transparent",o.style.strokeWidth=0,o.style.fill="transparent",o},t.prototype.getBPMNSubEvent=function(t,e,i,n){i.children=i.children||[];var o;o=this.getBPMNEventShape(e,t,!0,n),this.getBPMNSubprocessEvent(e,o,t),o.id=n||e.id+"_subprocessEvents",o.width=t.width||20,o.height=t.height||20,o.setOffsetWithRespectToBounds(t.offset.x,t.offset.y,"Fraction"),o.relativeMode="Point",o.margin=t.margin,o.horizontalAlignment=t.horizontalAlignment,o.verticalAlignment=t.verticalAlignment,o.style.fill="transparent",o.style.strokeColor="transparent",o.style.strokeWidth=0,i.children.push(o)},t.prototype.getBPMNSubProcessTransaction=function(t,e,i){var n=i.children[0].width,o=i.children[0].height,r=new Bh;r.margin={left:3,right:0,top:3,bottom:0},r.id=t.id+"_0_Subprocess_innnerRect",r.cornerRadius=10,r.width=n-6,r.height=o-6,i.children.push(r);var s=new sc;s.id=t.id+"_transaction_events";var a=e.activity.subProcess.transaction;this.getBPMNSubEvent(a.success,t,s,t.id+"_success"),this.getBPMNSubEvent(a.cancel,t,s,t.id+"_cancel"),this.getBPMNSubEvent(a.failure,t,s,t.id+"_failure"),this.updateDiagramContainerVisibility(s.children[0],a.success.visible),this.updateDiagramContainerVisibility(s.children[1],a.cancel.visible),this.updateDiagramContainerVisibility(s.children[2],a.failure.visible),s.float=!0,s.width=n,s.height=o,s.style.fill=s.style.strokeColor="transparent",i.children.push(s)},t.prototype.getBPMNSubProcessLoopShape=function(t){var e,i,n=t.shape.activity,o=new Hh;return e=n.subProcess.loop,i=La(e),o.visible="None"!==e,o.id=t.id+"_loop",o.data=i,o.style.fill="black",o.width=12,o.height=12,o.horizontalAlignment="Left",o.verticalAlignment="Bottom",o.setOffsetWithRespectToBounds(0,1,"Fraction"),o.relativeMode="Point",o.margin.bottom=5,o.style.fill="transparent",o},t.prototype.drag=function(t,e,i,n){var o=n.nameTable[t.processId];t.margin.top+i>=0&&n.nodePropertyChange(t,{},{margin:{top:t.margin.top+i}}),t.margin.left+e>=0&&n.nodePropertyChange(t,{},{margin:{left:t.margin.left+e}});var r=this.getChildrenBound(o,t.id,n);this.updateSubProcessess(r,t,n),o.wrapper.measure(new nh(void 0,void 0)),o.wrapper.arrange(o.wrapper.desiredSize),n.refreshCanvasLayers(),n.updateSelector(),this.updateDocks(t,n)},t.prototype.dropBPMNchild=function(t,e,i){if(e&&"Bpmn"===e.shape.type){var n=i.nameTable[t.id].shape.activity.subProcess;if(i.currentSymbol&&"Bpmn"===t.shape.type&&!n.collapsed)return void(e.processId=t.id);if(n.processes=n.processes||[],n.processes&&-1===n.processes.indexOf(e.id)&&!n.collapsed){n.processes.push(e.id);var o=ie(e),r=i.nameTable[e.id].wrapper,s=i.nameTable[t.id].wrapper;r.margin.top=r.offsetY-r.actualSize.height/2-(t.offsetY-t.actualSize.height/2),r.margin.left=r.offsetX-r.actualSize.width/2-(t.offsetX-t.actualSize.width/2),r.margin.top=r.margin.top<0?0:r.margin.top,r.margin.left=r.margin.left<0?0:r.margin.left,i.nameTable[e.id].processId=t.id,s.children.push(i.nameTable[e.id].wrapper);var a=this.getChildrenBound(t,e.id,i);this.updateSubProcessess(a,e,i),s.measure(new nh(void 0,void 0)),s.arrange(s.desiredSize),i.refreshCanvasLayers(),i.updateSelector();for(var l=[],h=(l=l.concat(e.outEdges,e.inEdges)).length-1;h>=0;h--)i.remove(i.nameTable[l[h]]);var c={type:"PositionChanged",undoObject:{nodes:[o]},redoObject:{nodes:[ie(e)]},category:"Internal"};i.addHistoryEntry(c),"SVG"===i.mode&&e.zIndex<t.zIndex&&i.updateProcesses(e),this.updateDocks(e,i)}}},t.prototype.updateDocks=function(t,e){if("Bpmn"===t.shape.type&&t.shape.activity.subProcess.processes&&!t.shape.activity.subProcess.collapsed)for(var i=0,n=t.shape.activity.subProcess.processes;i<n.length;i++){var o=n[i],r=e.nameTable[o];r&&(e.updateConnectorEdges(r),r.wrapper.measure(new nh(r.wrapper.width,r.wrapper.height)),r.wrapper.arrange(r.wrapper.desiredSize),r.shape.activity.subProcess.processes&&r.shape.activity.subProcess.processes.length&&this.updateDocks(r,e))}},t.prototype.removeBpmnProcesses=function(t,e){var i=e.nameTable[t.processId];if("Bpmn"===t.shape.type&&t.shape.activity.subProcess.processes&&t.shape.activity.subProcess.processes.length>0)for(var n=(o=t.shape.activity.subProcess.processes).length-1;n>=0;n--)e.remove(e.nameTable[o[n]]);if(i){e.removeDependentConnector(t);var o=i.shape.activity.subProcess.processes;this.removeChildFromBPMN(i.wrapper,t.id);var r=o.indexOf(t.id);o.splice(r,1)}},t.prototype.removeChildFromBPMN=function(t,e){for(var i=0,n=t.children;i<n.length;i++){var o=n[i];o.id===e?t.children.splice(t.children.indexOf(o),1):o.children&&this.removeChildFromBPMN(o,e)}},t.prototype.removeProcess=function(t,e){var i=e.nameTable[t];if(i){var n=e.nameTable[i.processId];if(n&&"Bpmn"===n.shape.type){var o=n.shape.activity.subProcess.processes;e.removeDependentConnector(i),this.removeChildFromBPMN(n.wrapper,t);var r=o.indexOf(t);o.splice(r,1),i.processId="",e.refreshDiagramLayer(),e.updateSelector()}}},t.prototype.addProcess=function(t,e,i){var n;t.id=t.id||te(),n=t.id;var o=i.nameTable[n];o||i.add(t),t.processId=e;var r=i.nameTable[e],s=r.shape.activity.subProcess;if(o&&r&&"Bpmn"===r.shape.type&&"Bpmn"===o.shape.type&&s.processes&&!s.collapsed){o.processId=e;var a=r.shape.activity.subProcess.processes;a.indexOf(n)<0&&a.push(n),r.wrapper.children.push(o.wrapper),r.wrapper.measure(new nh),r.wrapper.arrange(r.wrapper.desiredSize),i.bpmnModule.updateDocks(r,i),i.refreshDiagramLayer(),"SVG"===i.mode&&o.shape&&o.shape.activity&&!o.shape.activity.subProcess.processes&&Ae(e+"_groupElement").appendChild(Ae(t.id+"_groupElement"))}},t.prototype.getChildrenBound=function(t,e,i){var n,o=t.shape.activity.subProcess.processes;if(o&&o.length)for(var r=0,s=o;r<s.length;r++){var a=s[r];e!==a&&(n=n?i.nameTable[a].wrapper.bounds.uniteRect(n):i.nameTable[a].wrapper.bounds)}return n||i.nameTable[e].wrapper.bounds},t.prototype.updateSubProcessess=function(t,e,i){var n,o,r,s,a=i.nameTable[e.processId],l={x:.5,y:.5};a.wrapper.bounds.left+e.margin.left+e.width>a.wrapper.bounds.right&&(r=!0),a.wrapper.bounds.top+e.margin.top+e.height>a.wrapper.bounds.bottom&&(s=!0),r&&(l.x=0),s&&(l.y=0);var h=a.wrapper.actualSize;r&&(n=(e.wrapper.margin.left+e.wrapper.bounds.width)/h.width),s&&(o=(e.wrapper.margin.top+e.wrapper.bounds.height)/h.height),(n>0||o>0)&&i.commandHandler.scale(i.nameTable[e.processId],n||1,o||1,l)},t.prototype.getBPMNCompensationShape=function(t,e){return e.id=t.id+"_0_compensation",e.width=12,e.height=12,e.margin.bottom=5,e.style.fill="transparent",e.horizontalAlignment="Left",e.verticalAlignment="Bottom",e.relativeMode="Object",e.data="M 22.462 18.754 l -6.79 3.92 l 6.79 3.92 V 22.89 l 6.415 3.705 v -7.841 l -6.415 3.705 V 18.754 Z M 28.331 19.701 v 5.947 l -5.149 -2.973 L 28.331 19.701 Z M 21.916 25.647 l -5.15 -2.973 l 5.15 -2.973 V 25.647 Z M 22.275 12.674 c -5.513 0 -9.999 4.486 -9.999 9.999 c 0 5.514 4.486 10.001 9.999 10.001 c 5.514 0 9.999 -4.486 9.999 -10.001 C 32.274 17.16 27.789 12.674 22.275 12.674 Z M 22.275 32.127  c -5.212 0 -9.453 -4.241 -9.453 -9.454 c 0 -5.212 4.241 -9.453 9.453 -9.453 c 5.212 0 9.453 4.241 9.453 9.453 C 31.728 27.887 27.487 32.127 22.275 32.127 Z",e},t.prototype.getBPMNActivityShape=function(t){var e,i=new sc,n=t.shape.activity,o=n.activity,r=n.subProcess;n.activity;return"Task"===o&&(e=this.getBPMNTaskShape(t)),"SubProcess"===o&&r&&(e=this.getBPMNSubProcessShape(t)),i.children=[e],i.style.fill="transparent",i.style.strokeColor="transparent",i.style.strokeWidth=0,i},t.prototype.getBPMNSubprocessEvent=function(t,e,i){var n,o;if(0!==i.annotations.length)for(s=0;s<i.annotations.length;s++){var r=i.annotations[s];(n=t.initAnnotationWrapper(r)).width=i.width,n.height=i.height,e.children.push(n)}if(0!==i.ports.length)for(var s=0;s<i.ports.length;s++){var a=i.ports[s];o=t.initPortWrapper(a),e.children.push(o)}},t.prototype.getBPMNAdhocShape=function(t,e,i){return e.id=t.id+"_0_adhoc",e.width=12,e.height=8,e.style.fill="black",e.margin.bottom=5,e.horizontalAlignment="Left",e.verticalAlignment="Bottom",e.relativeMode="Object",e.data="M 49.832 76.811 v -2.906 c 0 0 0.466 -1.469 1.931 -1.5 c 1.465 -0.031 2.331 1.219 2.897 1.688 s 1.06 0.75 1.526 0.75 c 0.466 0 1.548 -0.521 1.682 -1.208 s 0.083 3.083 0.083 3.083 s -0.76 0.969 -1.859 0.969 c -1.066 0 -1.865 -0.625 -2.464 -1.438 s -1.359 -0.998 -2.064 -0.906 C 50.598 75.467 49.832 76.811 49.832 76.811 Z",i&&!0===i.adhoc?e.visible=!0:e.visible=!1,e},t.prototype.getBPMNTextAnnotation=function(t,e,i,n){i.id=i.id||te();var o=new sc,r=new Hh,s=new Fh;r.id=t.id+"_"+i.id+"_path",r.width=i.width,r.height=i.height,r.relativeMode="Object",s.id=t.id+"_"+i.id+"_text",s.content=i.text;var a=t.style;s.style={fontSize:a.fontSize,italic:a.italic,gradient:null,opacity:a.opacity,bold:a.bold,textWrapping:a.textWrapping,color:a.color,fill:"white",fontFamily:a.fontFamily,whiteSpace:a.whiteSpace,textOverflow:"Wrap",strokeColor:"none",strokeWidth:0,strokeDashArray:a.strokeDashArray,textAlign:a.textAlign,textDecoration:a.textDecoration},s.horizontalAlignment="Center",s.verticalAlignment="Center",s.relativeMode="Object",s.margin={left:5,right:5,top:5,bottom:5},o.offsetX=t.offsetX+i.length*Math.cos(i.angle*(Math.PI/180)),o.offsetY=t.offsetY+i.length*Math.sin(i.angle*(Math.PI/180)),o.float=!0,o.transform=wh.Self,o.id=t.id+"_textannotation_"+i.id,o.style.strokeColor="transparent",o.margin={left:10,right:10,top:10,bottom:10},o.relativeMode="Object",o.rotateAngle=0,o.children=[r,s];var l=new gp(t.shape,"annotations",{id:o.id,shape:{type:"Bpmn",shape:"TextAnnotation"}},!0);l.ports=[{id:r.id+"_port",shape:"Square",offset:{x:0,y:.5}}],l.offsetX=o.offsetX,l.offsetY=o.offsetY,l.wrapper=o,o.children.push(l.initPortWrapper(l.ports[0]));var h=new ah(0,0,0,0);void 0!==t.width&&void 0!==t.height&&(h=new ah(t.offsetX-t.width/2,t.offsetY-t.height/2,t.width,t.height)),this.setAnnotationPath(h,o,{x:l.offsetX,y:l.offsetY},l,i.length,i.angle);var c={id:t.id+"_"+i.id+"_connector",constraints:gh.Default&~gh.DragTargetEnd,sourceID:t.id,targetID:o.id,targetDecorator:{shape:"None"}},d=new Vd(t.shape,"annotations",c,!0);d.targetPortID=l.ports[0].id,d.init(e),d.wrapper.float=!1,d.wrapper.transform=wh.Self,n.children.push(d.wrapper),d.zIndex=1e4;var p=this.annotationObjects[t.id];p||(p={}),p[i.id]||(p[i.id]={});return p[i.id].node=l,p[i.id].connector=d,this.annotationObjects[t.id]=p,e.initObject(l,void 0,!1),l.zIndex=1e4,o},t.prototype.getTextAnnotationWrapper=function(t,e){if(t&&"Bpmn"===t.shape.type){if("TextAnnotation"===t.shape.shape)return t.wrapper.children[1];if(this.annotationObjects[t.id]&&this.annotationObjects[t.id][e]){var i=this.annotationObjects[t.id][e].node;return this.getTextAnnotationWrapper(i,e)}}return null},t.prototype.addAnnotation=function(t,e,i){var n=t.wrapper.children[0],o=t.shape,r=new pp(o,"annotations",e,!0);return o.annotations.push(r),n.children.push(this.getBPMNTextAnnotation(t,i,e,n)),t.wrapper.measure(new nh),t.wrapper.arrange(t.wrapper.desiredSize),this.annotationObjects[t.id][e.id].connector},t.prototype.clearAnnotations=function(t,e){var i=t.shape;if(i.annotations.length)for(var n=0,o=i.annotations;n<o.length;n++){var r=o[n];this.removeAnnotationObjects(t,r,e)}delete this.annotationObjects[t.id]},t.prototype.checkAndRemoveAnnotations=function(t,e){if("Bpmn"===t.shape.type)if("TextAnnotation"===t.shape.shape)for(var i=t.id.split("_"),n=i[i.length-1],o=i[i.length-3],r=e.nameTable[o],s=r.shape,a=0,l=s.annotations;a<l.length;a++){var h=l[a];if(h.id===n&&-1!==s.annotations.indexOf(h))return e.removeDependentConnector(t),this.removeAnnotationObjects(r,h,e),!0}else t.shape.annotations&&t.shape.annotations.length&&this.clearAnnotations(t,e);return!1},t.prototype.removeAnnotationObjects=function(t,e,i){var n=t.shape,o=n.annotations.indexOf(e);if(-1!==o){n.annotations.splice(o,1);var r=this.annotationObjects[t.id];if(r&&r[e.id]){var s=r[e.id].node,a=r[e.id].connector;i.removeElements(s),i.removeElements(a);var l=t.wrapper.children[0];o=l.children.indexOf(s.wrapper),l.children.splice(o,1),o=l.children.indexOf(a.wrapper),l.children.splice(o,1),i.removeFromAQuad(s),i.removeFromAQuad(a),delete i.nameTable[s.id],delete i.nameTable[a.id],delete r[e.id]}}},t.prototype.setAnnotationPath=function(t,e,i,n,o,r){var s=this.getAnnotationPathAngle(i,t),a="",l=e.children[0],h=e.children[2],c=e.children[1];l.horizontalAlignment="Stretch",l.verticalAlignment="Stretch",c.margin.left=c.margin.right=5,c.margin.top=c.margin.bottom=5;var d,p;0===s?(a="M10,20 L0,20 L0,0 L10,0",l.width=10,l.horizontalAlignment="Left",h.setOffsetWithRespectToBounds(0,.5,"Fraction"),c.margin.top=c.margin.bottom=10,d=t.middleRight,p={X1:t.right,Y1:t.top,X2:t.right,Y2:t.bottom}):180===s?(a="M0,0 L10,0 L10,20 L0,20",l.width=10,l.horizontalAlignment="Right",h.setOffsetWithRespectToBounds(1,.5,"Fraction"),c.margin.top=c.margin.bottom=10,d=t.middleLeft,p={X1:t.left,Y1:t.top,X2:t.left,Y2:t.bottom}):90===s?(a="M20,10 L20,0 L0,0 L0,10",l.height=10,l.verticalAlignment="Top",h.setOffsetWithRespectToBounds(.5,0,"Fraction"),c.margin.left=c.margin.right=10,d=t.bottomCenter,p={X1:t.right,Y1:t.bottom,X2:t.left,Y2:t.bottom}):(a="M0,0 L0,10 L20,10 L20,0",l.height=10,l.verticalAlignment="Bottom",h.setOffsetWithRespectToBounds(.5,1,"Fraction"),c.margin.left=c.margin.right=10,d=t.topCenter,p={X1:t.right,Y1:t.top,X2:t.left,Y2:t.top});var u=t.center;d=Co(p,[u,sh.transform(i,r,Math.max(t.width,t.height))],!1,u),l.data=a,void 0!==o&&void 0!==r&&(d=sh.transform(d,r,o),e.offsetX=n.offsetX=d.x,e.offsetY=n.offsetY=d.y)},t.prototype.isBpmnTextAnnotation=function(t,e){if(this.annotationObjects){var i=t.parentId,n=t.id,o=e.nameTable[i];return o&&"Bpmn"===o.shape.type&&this.annotationObjects[i]&&this.annotationObjects[i][n]?o:null}return null},t.prototype.updateTextAnnotationContent=function(t,e,i,n){var o=e.parentId,r=e.id;if(this.annotationObjects[o]&&this.annotationObjects[o][r])for(var s=0,a=t.shape.annotations;s<a.length;s++){var l=a[s];if(l.id===r){l.text=i;var h=this.annotationObjects[o][r].node.wrapper.children[1];h.content=i,h.visible=!0,t.wrapper.measure(new nh),t.wrapper.arrange(t.wrapper.desiredSize)}}},t.prototype.updateQuad=function(t,e){var i,n=t.shape.annotations;if(n&&n.length>0)for(var o=0;o<n.length;o++)i=this.annotationObjects[t.id][n[o].id].node,e.updateQuad(i)},t.prototype.updateTextAnnotationProp=function(t,e,i){if("Bpmn"===t.shape.type){var n=t.shape.annotations;if(n&&n.length>0)for(var o=0;o<t.wrapper.children[0].children.length;o++)for(var r=0;r<n.length;r++){var s=t.wrapper.children[0].children[o].id.split("_");if(s[s.length-1]===n[r].id){var a=this.annotationObjects[t.id][n[r].id].node,l=this.annotationObjects[t.id][n[r].id].connector,h=(Zo(l.targetPoint,t.wrapper.bounds,t.wrapper.bounds,!1),l.sourcePoint);h={x:l.sourcePoint.x+t.offsetX-e.offsetX,y:l.sourcePoint.y+t.offsetY-e.offsetY},h=sh.transform(h,n[r].angle,n[r].length),t.wrapper.children[0].children[o].offsetX=a.offsetX=h.x,t.wrapper.children[0].children[o].offsetY=a.offsetY=h.y,i.updateQuad(a)}}}},t.prototype.findInteractableObject=function(t,e){if(t.targetID){var i=e.nameTable[t.targetID];if("Bpmn"===i.shape.type&&"TextAnnotation"===i.shape.shape)return i}return t},t.prototype.canAdd=function(t){return!t.shape||"Bpmn"!==t.shape.type||"TextAnnotation"!==t.shape.shape},t.prototype.getSubprocessChildCount=function(t){var e,i=0,n=t.shape.activity.subProcess;return void 0!==(e=n.loop)&&"None"!==e&&i++,void 0!==n.compensation&&!0===n.compensation&&i++,void 0!==n.collapsed&&!0===n.collapsed&&i++,void 0!==n.adhoc&&!0===n.adhoc&&i++,i},t.prototype.getTaskChildCount=function(t){var e=0,i=t.shape.activity.task;return void 0!==i.compensation&&!0===i.compensation&&e++,void 0!==i.loop&&"None"!==i.loop&&e++,e},t.prototype.setStyle=function(t,e){t.style.fill=e.style.fill,t.style.strokeColor=e.style.strokeColor,t.style.strokeWidth=e.style.strokeWidth,t.style.strokeDashArray=e.style.strokeDashArray,t.style.opacity=e.style.opacity,t.style.gradient=e.style.gradient,0!=(e.constraints&fh.Shadow)&&(t.shadow=e.shadow)},t.prototype.updateBPMN=function(t,e,i,n){var o=t.shape||{},r=i.wrapper.children[0],s=i.shape.shape,a=void 0!==t.width||void 0!==t.height;if("Gateway"===o.shape&&o.gateway)i.wrapper.children[0]=this.getBPMNGatewayShape(i);else if("DataObject"===o.shape&&o.dataObject)i.wrapper.children[0]=this.getBPMNDataObjectShape(i);else if("Activity"===o.shape&&o.activity)i.wrapper.children[0]=this.getBPMNActivityShape(i);else if("Event"===o.shape&&o.event){var l=o.event;i.wrapper.children[0]=this.getBPMNEventShape(i,l)}else"Message"===o.shape||"DataSource"===o.shape?i.wrapper.children[0]=this.getBPMNShapes(i):void 0!==o.gateway||"Gateway"===s&&a?this.updateBPMNGateway(i,t):void 0!==o.dataObject||"DataObject"===s&&a?this.updateBPMNDataObject(i,t,e):void 0!==o.activity||"Activity"===s&&a?this.updateBPMNActivity(i,t,e,n):(void 0!==o.event||"Event"===s&&a)&&this.updateBPMNEvent(i,t,e);t.style&&cs(t.style,r instanceof ic?"Activity"===i.shape.shape?r.children[0].children[0]:r.children[0]:r)},t.prototype.updateBPMNGateway=function(t,e){var i=t.shape,n=t.wrapper.children[0];if(i){cs(t.style,n.children[0]);var o=Sa(i.gateway.type);n.children[1].data=o}void 0===e.width&&void 0===e.height||this.setSizeForBPMNGateway(t.shape.gateway,n,e.width||t.width,e.height||t.height)},t.prototype.updateBPMNDataObject=function(t,e,i){var n=e.shape,o=t.wrapper.children[0];if(n){var r=o.children[1],s=o.children[2];if(void 0!==e.style&&(cs(e.style,o.children[0]),r.style.opacity=t.style.opacity,s.style.opacity=t.style.opacity),n.dataObject){switch(n.dataObject.type){case"None":r.visible=!1;break;case"Input":r.style.fill="white";break;case"Output":r.style.fill="black"}"None"===i.shape.dataObject.type&&(r.visible=!0),void 0!==e.shape.dataObject.collection&&(s.visible=n.dataObject.collection)}}void 0===e.width&&void 0===e.height||this.setSizeForBPMNDataObjects(t.shape.dataObject,o,e.width||t.width,e.height||t.height)},t.prototype.getEvent=function(t,e,i,n,o,r){switch(i){case"Start":o.visible=!1,n.style.strokeDashArray="",r.style.fill="white",r.style.strokeColor="black",n.style.fill="white";break;case"NonInterruptingStart":n.style.strokeDashArray="2 3",r.style.fill="white",n.style.fill="white",r.style.strokeColor="black",o.visible=!1;break;case"Intermediate":n.style.strokeDashArray="",n.style.fill="white",o.style.strokeDashArray="",n.style.gradient=null,r.style.fill="white",r.style.strokeColor="black",this.updateEventVisibility(e,o);break;case"NonInterruptingIntermediate":n.style.fill="white",n.style.gradient=null,r.style.fill="white",r.style.strokeColor="black",n.style.strokeDashArray="2 3",o.style.strokeDashArray="2 3",this.updateEventVisibility(e,o);break;case"ThrowingIntermediate":case"End":n.style.fill="End"!==i?"white":"black",n.style.strokeDashArray="",o.style.strokeDashArray="",n.style.gradient=null,r.style.fill="black",this.updateEventVisibility(e,o),r.style.strokeColor=t.style.fill}},t.prototype.updateEventVisibility=function(t,e){t.shape.activity&&t.shape.activity.subProcess&&t.shape.activity.subProcess.events&&void 0!==t.shape.activity.subProcess.events[0]&&void 0!==t.shape.activity.subProcess.events[0].event?"NonInterruptingStart"!==t.shape.activity.subProcess.events[0].event&&"Start"!==t.shape.activity.subProcess.events[0].event||(e.visible=!0):void 0!==t.shape.event&&("NonInterruptingStart"!==t.shape.event.event&&"Start"!==t.shape.event.event||(e.visible=!0))},t.prototype.updateBPMNEvent=function(t,e,i){var n=e.shape,o=t.wrapper.children[0];if(n){var r,s=o.children[0],a=o.children[1],l=o.children[2],h=void 0;void 0!==e.style&&(cs(t.style,o.children[0]),void 0===e.style.opacity&&void 0===e.style.strokeColor||(a.style.opacity=t.style.opacity,a.style.strokeColor=t.style.strokeColor)),r=n.event.event,h=n.event.trigger,void 0!==r&&this.getEvent(t,i,r,s,a,l),void 0!==h&&this.updateBPMNEventTrigger(t,e)}void 0===e.width&&void 0===e.height||this.setSizeForBPMNEvents(t.shape.event,o,e.width||t.width,e.height||t.height)},t.prototype.updateBPMNEventTrigger=function(t,e){var i=t.shape,n=t.wrapper.children[0].children[2];!e.style||void 0===e.style.strokeColor&&void 0===e.style.opacity||cs(t.style,n);var o=xa(i.event.trigger);i.event.trigger&&(n.height=.8*n.height),n.data=o},t.prototype.updateBPMNActivity=function(t,e,i,n){var o=e.shape,r=t.wrapper.children[0],s=this.getSize(t,r.children[0].children[0]);if(o){var a=i.shape.activity.activity,l=t.shape.activity.activity;if("SubProcess"!==a&&"Task"!==a||"SubProcess"!==l&&"Task"!==l){if("Task"===l&&void 0!==o.activity.task){this.updateBPMNActivityTask(t,e);var h=this.getTaskChildCount(t),c=void 0,d=12*h,p=s.width/2-d;c=1===h?p+8:p+8*(h-1),void 0!==o.activity.task.loop&&this.updateBPMNActivityTaskLoop(t,e,c,h,p,2)}"SubProcess"===l&&void 0!==o.activity.subProcess&&this.updateBPMNActivitySubProcess(t,e,i,n)}else n.removeElements(t),t.wrapper.children[0]=this.getBPMNActivityShape(t);this.setSizeForBPMNActivity(t.shape.activity,r,e.width||s.width,e.height||s.height,t)}void 0===e.width&&void 0===e.height||this.setSizeForBPMNActivity(t.shape.activity,r,e.width||s.width,e.height||s.height,t)},t.prototype.updateBPMNActivityTask=function(t,e){var i=e.shape,n=t.wrapper.children[0].children[0],o=i.activity.task;if("Receive"===o.type||"Send"===o.type?n.children[1].height=14:n.children[1].height=20,void 0!==o.type){var r=Ca(o.type);n.children[1].data=r}void 0!==i.activity.task.call&&(!1!==i.activity.task.call?n.children[0].style.strokeWidth=4:n.children[0].style.strokeWidth=1),void 0!==i.activity.task.compensation&&(!0===i.activity.task.compensation?n.children[3].visible=!0:n.children[3].visible=!1)},t.prototype.updateBPMNActivityTaskLoop=function(t,e,i,n,o,r){var s,a,l=e.shape,h=t.wrapper.children[0].children[0],c=l.activity,d=0;if(void 0!==c.subProcess){var p=c.subProcess;d="Transaction"===c.subProcess.type?2:0,a=La(s=p.loop),h.children[2+d].data=a,h.children[2+d].visible="None"!==s}else void 0!==c.task&&void 0!==c.task.loop&&(a=La(c.task.loop),h.children[2].data=a,h.children[2].visible="None"!==c.task.loop);this.updateChildMargin(h,n,o,i,r+d)},t.prototype.updateChildMargin=function(t,e,i,n,o){if(1===e)for(r=o;r<t.children.length;r++)2!==r&&!0===t.children[r].visible&&(t.children[r].margin.left=n,n=i+8);else{n=i+8*(e-1);for(var r=o;r<t.children.length;r++)2!==r&&!0===t.children[r].visible&&(t.children[r].margin.left=n,n+=20)}},t.prototype.updateBPMNActivitySubProcess=function(t,e,i,n){var o,r=e.shape,s=t.wrapper.children[0],a=this.getSize(t,s.children[0].children[0]),l=r.activity.subProcess,h=this.getSubprocessChildCount(t),c=12*h,d=a.width/2-c;o=1===h?d+8:d+8*(h-1),cs(t.style,s.children[0].children[0]),void 0!==l.events&&this.updateBPMNSubProcessEvent(t,e,i,n),void 0!==l.adhoc&&this.updateBPMNSubProcessAdhoc(t,i,l,o,h,d),void 0!==l.boundary&&this.updateBPMNSubProcessBoundary(t,l),void 0!==l.collapsed&&this.updateBPMNSubProcessCollapsed(t,i,l,o,h,d,n),void 0!==l.compensation&&this.updateBPMNSubProcessCompensation(t,i,l,o,h,d),void 0!==l.loop&&this.updateBPMNSubProcessLoop(t,i,l,o,h,d),void 0!==l.transaction&&this.updateBPMNSubProcessTransaction(t,e,i,n)},t.prototype.updateBPMNSubProcessEvent=function(t,e,i,n){for(var o=e.shape,r=t.wrapper.children[0],s=r.children[0],a=(r.children[0].children.length,o.activity.subProcess),l=0,h=Object.keys(a.events);l<h.length;l++){var c=h[l],d=Number(c),p=s.children[d+2],u=t.shape.activity.subProcess.events[d];this.updateBPMNSubEvent(t,a.events[d],u,p,e,i,n)}},t.prototype.updateBPMNSubEvent=function(t,e,i,n,o,r,s){var a,l,h=t.wrapper.children[0],c=o.shape,d=n.children[0],p=n.children[1],u=n.children[2];if(o.style&&(void 0===o.style.strokeColor&&void 0===o.style.opacity||(h.children[0].children[1].style.strokeColor=o.style.strokeColor,h.children[0].children[1].style.opacity=o.style.opacity)),void 0!==c.activity.subProcess&&(a=e.event,l=e.trigger),void 0!==a&&this.getEvent(o,r,a,d,p,u),void 0!==l){o.style&&cs(o.style,h.children[0]);var g=xa(l);n.children[2].data=g}if(void 0===e.height&&void 0===e.width||this.getEventSize(e,n),void 0!==e.id&&(n.id=e.id),void 0!==e.margin&&(n.margin=e.margin),void 0!==e.horizontalAlignment&&(n.horizontalAlignment=e.horizontalAlignment),void 0!==e.verticalAlignment&&(n.verticalAlignment=e.verticalAlignment),void 0!==e.offset&&(n.setOffsetWithRespectToBounds(i.offset.x,i.offset.y,"Fraction"),n.relativeMode="Point"),void 0!==e.annotations){var m=void 0,f=h.children[0].children[2];n.children[3]&&n.children.length>3&&(m=n.children[3],s.updateAnnotation(e.annotations[0],m,f))}if(void 0!==e.ports){var v=void 0,y=h.children[0].children[2];n.children[4]&&n.children.length>4&&(v=n.children[4],s.updatePort(e.ports[0],v,y))}void 0!==e.visible&&this.updateDiagramContainerVisibility(n,e.visible)},t.prototype.updateBPMNSubProcessTransaction=function(t,e,i,n){var o,r=e.shape.activity.subProcess.transaction,s=t.wrapper.children[0].children[0].children[2];void 0!==r.success&&(o=t.shape.activity.subProcess.transaction.success,this.updateBPMNSubEvent(t,r.success,o,s.children[0],e,i,n)),void 0!==r.cancel&&(o=t.shape.activity.subProcess.transaction.cancel,this.updateBPMNSubEvent(t,r.cancel,o,s.children[1],e,i,n)),void 0!==r.failure&&(o=t.shape.activity.subProcess.transaction.failure,this.updateBPMNSubEvent(t,r.failure,o,s.children[2],e,i,n));for(var a=0,l=t.outEdges;a<l.length;a++){var h=l[a],c=n.nameTable[h];switch(c.sourcePortID){case"success":r.success&&void 0!==r.success.visible&&n.connectorPropertyChange(c,{},{sourcePortID:"success"});break;case"cancel":r.cancel&&void 0!==r.cancel.visible&&n.connectorPropertyChange(c,{},{sourcePortID:"cancel"});break;case"failure":r.failure&&void 0!==r.failure.visible&&n.connectorPropertyChange(c,{},{sourcePortID:"failure"})}}},t.prototype.getEventSize=function(t,e){void 0!==t.height&&(e.height=t.height,e.children[0].height=t.height,e.children[1].height=.85*t.height,e.children[2].height=.54*t.height),void 0!==t.width&&(e.width=t.width,e.children[0].width=t.width,e.children[1].width=.85*t.width,e.children[2].width=.54*t.width)},t.prototype.updateBPMNSubProcessAdhoc=function(t,e,i,n,o,r){t.shape;var s=t.wrapper.children[0].children[0],a="Transaction"===t.shape.activity.subProcess.type?2:0;!1===i.adhoc?s.children[3+a].visible=!1:s.children[3+a].visible=!0,this.updateChildMargin(s,o,r,n,3+a)},t.prototype.updateBPMNSubProcessBoundary=function(t,e){t.shape;var i=t.wrapper.children[0].children[0].children[0];"Default"===e.boundary&&(i.style.strokeWidth=1,i.style.strokeDashArray="1 0"),"Call"===e.boundary&&(i.style.strokeWidth=4,i.style.strokeDashArray="1 0"),"Event"===e.boundary&&(i.style.strokeWidth=1,i.style.strokeDashArray="2 2")},t.prototype.updateElementVisibility=function(t,e,i){if(t.shape.activity.subProcess.processes&&t.shape.activity.subProcess.processes.length>0)for(var n=t.shape.activity.subProcess.processes,o=n.length-1;o>=0;o--){var r=i.nameTable[n[o]];r.visible=e,i.updateElementVisibility(r.wrapper,r,e),e&&("Event"===r.shape.shape&&this.setEventVisibility(r,r.wrapper.children[0].children),"SubProcess"===r.shape.activity.activity&&this.setSubProcessVisibility(r));for(var s=r.inEdges.concat(r.outEdges),a=s.length-1;a>=0;a--){var l=i.nameTable[s[a]];l.visible=e,i.updateElementVisibility(l.wrapper,l,e)}}e&&("Event"===t.shape.shape&&this.setEventVisibility(t,t.wrapper.children[0].children),"SubProcess"===t.shape.activity.activity&&this.setSubProcessVisibility(t),"Task"===t.shape.activity.activity&&"Activity"===t.shape.shape&&"None"===t.shape.activity.subProcess.loop&&(t.wrapper.children[0].children[0].children[3].visible=!1))},t.prototype.updateBPMNSubProcessCollapsed=function(t,e,i,n,o,r,s){var a=t.shape.activity.subProcess.events.length,l=t.wrapper.children[0].children[0],h="Transaction"===t.shape.activity.subProcess.type?3:1;!1===i.collapsed?(this.updateElementVisibility(t,!0,s),l.children[h+a].visible=!1):(this.updateElementVisibility(t,!1,s),l.children[h+a].visible=!0),this.updateChildMargin(l,o,r,n,3+a)},t.prototype.updateBPMNSubProcessCompensation=function(t,e,i,n,o,r){var s=t.wrapper.children[0].children[0],a="Transaction"===t.shape.activity.subProcess.type?2:0;!1===i.compensation?s.children[4+a].visible=!1:s.children[4+a].visible=!0,this.updateChildMargin(s,o,r,n,4+a)},t.prototype.updateBPMNSubProcessLoop=function(t,e,i,n,o,r){this.updateBPMNActivityTaskLoop(t,t,n,o,r,1)},t.prototype.updateBPMNConnector=function(t,e,i,n){var o=i.shape;return void 0!==o.sequence&&(t=this.getSequence(t,e,i,n)),void 0!==o.association&&(t=this.getAssociation(t,e,i,n)),void 0!==o.message&&(t=this.getMessage(t,e,i,n)),t},t.prototype.getSequence=function(t,e,i,n){if("Normal"===i.shape.sequence&&(n.connectorPropertyChange(t,e,{type:"Straight",targetDecorator:{shape:"Arrow",style:{fill:"black"}}}),t.wrapper.children[3].visible=!1),"Default"===i.shape.sequence){n.connectorPropertyChange(t,e,{type:"Straight",targetDecorator:{shape:"Arrow",style:{fill:"black"}},sourceDecorator:{shape:"None"}});var o=new Hh,r=(new Hh,void 0);o=t.getSegmentElement(t,o);for(var s=t.intermediatePoints,a=0;a<s.length-1;a++)length+=t.distance(s[a],s[a+1]),r=t.findPath(s[a],s[a+1]);t.wrapper.children[3].data=r[0],t.wrapper.children[3].id=t.id+"_"+i.shape.sequence,t.wrapper.children[3].offsetX=r[1].x,t.wrapper.children[3].offsetY=r[1].y,t.wrapper.children[3].rotateAngle=45,t.wrapper.children[3].transform=wh.Self}return"Conditional"===i.shape.sequence&&(n.connectorPropertyChange(t,e,{type:"Straight",targetDecorator:{shape:"Arrow",style:{fill:"black"}},sourceDecorator:{shape:"Diamond",width:20,height:10,style:{fill:"white"}}}),t.wrapper.children[3].visible=!1),t},t.prototype.getAssociation=function(t,e,i,n){return"Default"===i.shape.association&&n.connectorPropertyChange(t,e,{type:"Straight",style:{strokeDashArray:"None"},targetDecorator:{shape:"Arrow",style:{fill:"black"}},sourceDecorator:{shape:"None"}}),"Directional"===i.shape.association&&n.connectorPropertyChange(t,e,{type:"Straight",style:{strokeDashArray:"2 2"},targetDecorator:{shape:"Arrow",style:{fill:"black"}},sourceDecorator:{shape:"None"}}),"BiDirectional"===i.shape.association&&n.connectorPropertyChange(t,e,{type:"Straight",style:{strokeDashArray:"2 2"},targetDecorator:{shape:"Arrow",style:{fill:"black"}},sourceDecorator:{shape:"Arrow",width:5,height:10,style:{fill:"white"}}}),t},t.prototype.getMessage=function(t,e,i,n){var o,r;if("Default"===e.shape.message){if(void 0!==i.shape.message){if("InitiatingMessage"===i.shape.message||"NonInitiatingMessage"===i.shape.message){var s=new Hh;s=t.getSegmentElement(t,s);for(var a=t.intermediatePoints,l=0;l<a.length-1;l++){length+=t.distance(a[l],a[l+1]);var h=.5*length;length>=h&&(o=vo(a[l],a[l+1]),r=sh.transform(a[l],o,h))}}t.wrapper.children[3].id=t.id+"_"+i.shape.message,t.wrapper.children[3].width=25,t.wrapper.children[3].height=15,t.wrapper.children[3].data="M0,0 L19.8,12.8 L40,0 L0, 0 L0, 25.5 L40, 25.5 L 40, 0",t.wrapper.children[3].horizontalAlignment="Center",t.wrapper.children[3].verticalAlignment="Center",t.wrapper.children[3].transform=wh.Self,t.wrapper.children[3].style.fill="NonInitiatingMessage"===i.shape.message?"lightgrey":"white",t.wrapper.children[3].offsetX=r.x,t.wrapper.children[3].offsetY=r.y}}else"NonInitiatingMessage"===e.shape.message&&"InitiatingMessage"===e.shape.message||("Default"!==i.shape.message?t.wrapper.children[3].style.fill="NonInitiatingMessage"===i.shape.message?"lightgrey":"white":t.wrapper.children[3].visible=!1);return t},t.prototype.setSizeForBPMNEvents=function(t,e,i,n){e.children[0].width=i,e.children[0].height=n;var o=e.children[1];o.width=.85*i,o.height=.85*n;var r=e.children[2];"Message"===t.trigger?(r.width=.54*i,r.height=.4*n):(r.width=.5*i,r.height=.5*n)},t.prototype.updateAnnotationDrag=function(t,e,i,n){var o=t.id.split("_");if("textannotation"===o[1])for(var r=void 0,s=0;s<t.inEdges.length;s++){var a=e.nameTable[t.inEdges[s]];a&&(r=e.nameTable[a.sourceID]);var l={x:t.offsetX+i,y:t.offsetY+n},h=a.sourcePoint,c=sh.findLength(l,h),d=sh.findAngle(h,l);if(r.shape.annotations)for(var p=0;p<r.shape.annotations.length;p++)if(r.shape.annotations[p].id===o[o.length-1])return r.shape.annotations[p].length=c,r.shape.annotations[p].angle=d,this.setAnnotationPath(r.wrapper.bounds,t.wrapper,l,t),!1}return!!t.processId&&(this.drag(t,i,n,e),!0)},t.prototype.getAnnotationPathAngle=function(t,e){var i=0;switch(Zo(t,e,e,!1)){case"Right":i=0;break;case"Left":i=180;break;case"Bottom":i=90;break;case"Top":i=270}return i},t.prototype.setSizeForBPMNGateway=function(t,e,i,n){e.children[0].width=i,e.children[0].height=n,e.children[1].width=.45*i,e.children[1].height=.45*n},t.prototype.setSizeForBPMNDataObjects=function(t,e,i,n){e.children[0].width=i,e.children[0].height=n},t.prototype.setSizeForBPMNActivity=function(t,e,i,n,o){e.children[0].width=i,e.children[0].height=n,e.children[0].children[0].width=i,e.children[0].children[0].height=n,"Transaction"===t.subProcess.type&&(e.children[0].children[1].width=Math.max(i-6,1),e.children[0].children[1].height=Math.max(n-6,1),e.children[0].children[2].width=i,e.children[0].children[2].height=n);var r,s,a=new Bh,l=this.getSize(o,a),h=12*(s="Task"===t.activity?this.getTaskChildCount(o):this.getSubprocessChildCount(o)),c=(i||l.width)/2;r=1===s?c-6:c-h/2-4*(s-1)/2;for(var d=0;d<e.children[0].children.length;d++)e.children[0].children[d].visible&&(e.children[0].children[d].id.indexOf("_loop")>-1||e.children[0].children[d].id.indexOf("_0_compensation")>-1||e.children[0].children[d].id.indexOf("_0_adhoc")>-1||e.children[0].children[d].id.indexOf("_0_collapsed")>-1)&&(e.children[0].children[d].margin.left=r,r+=e.children[0].children[d].actualSize.width+4)},t.prototype.updateDiagramContainerVisibility=function(t,e){if(t instanceof ic)for(var i=0;i<t.children.length;i++)this.updateDiagramContainerVisibility(t.children[i],e);t.visible=e},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"Bpmn"},t}(),Xf={Event:"M80.5,12.5 C80.5,19.127417 62.59139,24.5 40.5,24.5 C18.40861,24.5 0.5,19.127417 0.5,12.5C0.5,5.872583 18.40861,0.5 40.5,0.5 C62.59139,0.5 80.5,5.872583 80.5,12.5 z",Message:"M0,0L19.8,12.8L40,0L0,0L0,25.5L40,25.5L40,0z",DataSource:"M 0 10.6 c 0 5.9 16.8 10.6 37.5 10.6 S 75 16.4 75 10.6 v 0 v 68.9 v -0.1 C 75 85.3 58.2 90 37.5 90 S 0 85.3 0 79.4 l 0 0.1 V 56 V 40.6 L 0 10.6 C 0 4.7 16.8 0 37.5 0 S 75 4.7 75 10.6 S 58.2 21.2 37.5 21.2S 0 16.5 0 10.6 l 0 6.7 v -0.2 c 0 5.9 16.8 10.6 37.5 10.6 S 75 22.9 75 17.1 v 6.8 v -0.1 c 0 5.9 -16.8 10.6 -37.5 10.6 S 0 29.6 0 23.8",SubProcess:"M100,100 h200 a20,20 0 0 1 20,20 v200 a20,20 0 0 1 -20,20 h-200 a20,20 0 0 1 -20,-20 v-200 a20,20 0 0 1 20,-20 z",collapsedShape:"M 8.13789 15 H 0 V 0 H 8.13789 V 15 Z M 0.625991 13.75 H 7.51189 V 1.25 H 0.625991 V 13.75 Z M 2.18095 7.03125 L 5.95631 7.03125 L 5.95631 7.46875 L 2.18095 7.46875 Z M 3.8342 3.73 L 4.30369 3.73 L 4.30369 11.2687 L 3.8342 11.2687 Z"},Yf={Message:"M0,0 L19.8,12.8 L40,0 L0, 0 L0, 25.5 L40, 25.5 L 40, 0",Timer:"M40,20c0,8.654-5.496,16.024-13.189,18.81C24.685,39.58,22.392,40,20,40C8.954,40,0,31.046,0,20S8.954,0,20,0S40,8.954,40,20z M20,0 L20,2.583 L20,5.283 M10.027,2.681L11.659,5.507 L12.669,7.257 M2.731,9.989 L6.014,11.885 L7.307,12.631 M0.067,19.967 L2.667,19.967 L5.35,19.967M2.748,29.939 L5.731,28.217 L7.323,27.298 M10.056,37.236 L11.292,35.095 L12.698,32.66 M20.033,39.9 L20.033,36.417 L20.033,34.617M30.006,37.219 L28.893,35.292 L27.364,32.643 M37.302,29.911 L34.608,28.355 L32.727,27.269M39.967,19.933 L37.417,19.933 L34.683,19.933 M37.286,9.961 L34.583,11.521 L32.71,12.602 M29.977,2.664 L28.653,4.957 L27.336,7.24 M22.104,8.5 L19.688,20 L24.75,20 L31.604,20 L24.75,20 L19.688,20z",Error:"M 23.77 18.527 l -7.107 27.396 l 8.507 -17.247 L 36.94 40.073 l 6.394 -25.997 l -8.497 15.754 L 23.77 18.527 Z",Escalation:"M 30.001 8.098 L 11.842 43.543 l 18.159 -18.882 l 18.162 18.882 L 30.001 8.098 Z ",Cancel:"M 3.5 16 L 0 12.6 L 4.6 8 L 0 3.5 L 3.4 0 L 8 4.6 l 4.5 -4.5 L 16 3.5 L 11.5 8 l 4.5 4.5 l -3.4 3.5 L 8 11.4 L 3.5 16 Z",Compensation:"M 25.7086 0 L 0 25 L 25.7086 50 V 26.3752 L 50 50 V 0 L 25.7086 23.6248 V 0 Z ",Conditional:"M 0 0 H 16 V 16 H 0 z M 1.14 3.2 H 14.85 M 1.14 6.4 H 14.85 M 1.14 9.6 H 14.85 M 1.14 12.8 H 14.85",Link:"M 32.014 19.258 v 5.992 H 9.373 v 9.504 h 22.641 v 5.988 L 50.622 30 L 32.014 19.258 Z",Signal:"M 50 50 H 0 L 25.0025 0 L 50 50 Z",Terminate:"M 25 50 C 11.21 50 0 38.79 0 25 C 0 11.21 11.21 0 25 0 C 38.78 0 50 11.21 50 25 C 50 38.79 38.78 50 25 50",Multiple:"M 17.784 48.889 H 42.21 l 7.548 -23.23 L 29.997 11.303 L 10.236 25.658 L 17.784 48.889 Z",Parallel:"M 27.276 49.986 h 5.58 v -17.15 h 17.146 V 27.17 h -17.15 l 0.004 -17.15 h -5.58 l -0.004 17.15 H 9.994 v 5.666 h 17.278 L 27.276 49.986 Z"},Gf={None:"",Exclusive:"M 11.196 29.009 l 6.36 -9.712 l -5.764 -8.899 h 4.393 l 3.732 5.979 l 3.656 -5.979 h 4.354 l -5.789 9.039l 6.36 9.572 h -4.532 l -4.126 -6.437 l -4.139 6.437 H 11.196 Z",Inclusive:"M 20.323 31.333 c -6.625 0 -12.015 -5.39 -12.015 -12.015 s 5.39 -12.015 12.015 -12.015 s 12.016 5.39 12.016 12.015 S 26.948 31.333 20.323 31.333 Z M 20.323 9.303 c -5.522 0 -10.015 4.493 -10.015 10.015 s 4.492 10.015 10.015 10.015 s 10.016 -4.493 10.016 -10.015 S 25.846 9.303 20.323 9.303 Z",Parallel:"M 18.394 29.542 v -8.833 H 9.626 v -3.691 h 8.768 V 8.251 h 3.734 v 8.767 h 8.768 v 3.691 h -8.768 v 8.833 H 18.394 Z",Complex:"M29.198,19.063L23.089,19.063L27.794,14.358L26.38,12.944L21.223,18.101L21.223,10.443L19.223,10.443L19.223,17.976L14.022,12.776L12.608,14.19L17.48,19.063L10.365,19.063L10.365,21.063L18.261,21.063L12.392,26.932L13.806,28.346L19.223,22.929L19.223,30.225L21.223,30.225L21.223,22.805L25.925,27.507L27.339,26.093L22.309,21.063L29.198,21.063z",EventBased:"M 20.322 29.874 c -5.444 0 -9.873 -4.43 -9.873 -9.874 s 4.429 -9.874 9.873 -9.874 s 9.874 4.429 9.874 9.874 S 25.767 29.874 20.322 29.874 Z M 20.322 32.891 c -7.107 0 -12.89 -5.783 -12.89 -12.891 c 0 -7.107 5.782 -12.89 12.89 -12.89 c 7.108 0 12.891 5.783 12.891 12.89 C 33.213 27.108 27.431 32.891 20.322 32.891 Z M 24.191 25.386 h -7.984 l -2.469 -7.595 l 6.461 -4.693 l 6.461 4.693 L 24.191 25.386 Z",ExclusiveEventBased:"M 30 15 C 30 23.28 23.28 30 15 30 S 0 23.28 0 15 S 6.72 0 15 0 S 30 6.72 30 15 z M 15 5 L 5 12.5 L 8 22.5 H 22 L 25 12.5 z",ParallelEventBased:"M 35 17.5 C 35 27.16 27.16 35 17.5 35 S 0 27.16 0 17.5 S 7.84 0 17.5 0 S 35 7.84 35 17.5 z M 14.58 5.83 V 14.58 H 5.83 V 20.42 H 14.58 V 29.17 H 20.42 V 20.42 H 29.17 V 14.58 H 20.42 V 5.83 z"},Zf={None:"",Service:"M 32.699 20.187 v -4.005 h -3.32 c -0.125 -0.43 -0.292 -0.83 -0.488 -1.21 l 2.373 -2.375 l -2.833 -2.83 l -2.333 2.333 c -0.44 -0.253 -0.9 -0.448 -1.387 -0.595 v -3.32 h -4.003 v 3.32 c -0.46 0.137 -0.890.322 -1.3 0.537 l -2.285 -2.275 l -2.833 2.83 l 2.285 2.278 c -0.235 0.42 -0.41 0.847 -0.547 1.307 h -3.33 v 4.005 h 3.33 c 0.148 0.488 0.343 0.955 0.588 1.395 l -2.325 2.325 l 2.822 2.832 l 2.373 -2.382 c 0.392 0.205 0.792 0.37 1.212 0.497 v 3.33 h 4.003 v -3.33 c 0.46 -0.138 0.89 -0.323 1.3 -0.547 l 2.43 2.432 l 2.822 -2.832 l -2.42 -2.422 c 0.222 -0.41 0.4 -0.85 0.535-1.297 H 32.699 Z M 22.699 21.987 c -2.1 0 -3.803 -1.703 -3.803 -3.803 c 0 -2.1 1.703 -3.803 3.803 -3.803 c 2.1 0 3.803 1.703 3.803 3.803 C 26.502 20.285 24.8 21.987 22.699 21.987 Z",Receive:"M 12.217 12.134 v 13.334 h 20 V 12.134 H 12.217 Z M 30.44 13.007 l -8.223 5.35 l -8.223 -5.35 H 30.44 Z M 13.09 24.594 V 13.459 l 9.127 5.94 l 9.127 -5.94 v 11.135 H 13.09 Z",Send:"M 45.7256 3.16055 L 25 23.4017 L 4.27442 3.16055 H 45.7256 Z M 47.8963 46.8413 H 2.10375 V 4.80813 L 25 27.1709 L 47.8963 4.80813 V 46.8413 Z",InstantiatingReceive:"M 16.306 17.39 v 8.79 h 13.198 v -8.79 H 16.306 Z M 28.375 17.946 l -5.47 3.558 l -5.47 -3.558 H 28.375 Z M 28.948 25.625 H 16.861 v -7.389 l 6.043 3.931 l 6.043 -3.931 V 25.625 Z M 22.905 11.785c -5.514 0 -9.999 4.486 -9.999 10 c 0 5.514 4.485 10 9.999 10 s 9.999 -4.486 9.999 -10 C 32.904 16.272 28.419 11.785 22.905 11.785 Z M 22.905 31.239 c -5.212 0 -9.453 -4.241 -9.453 -9.454c 0 -5.212 4.241 -9.453 9.453 -9.453 s 9.452 4.241 9.452 9.453 C 32.357 26.998 28.117 31.239 22.905 31.239 Z",Manual:"M 13.183 15.325 h 2.911 c 0.105 0 0.207 -0.043 0.281 -0.117 c 0.078 -0.074 0.117 -0.176 0.117 -0.281c 0 -0.753 0.718 -1.362 1.596 -1.362 h 2.579 c -0.117 0.227 -0.191 0.48 -0.195 0.757 c 0 0.433 0.168 0.851 0.46 1.144 c 0.008 0.004 0.015 0.011 0.019 0.015 c -0.289 0.285 -0.475 0.691 -0.479 1.148 c 0 0.433 0.168 0.846 0.46 1.139 c 0.011 0.012 0.023 0.02 0.035 0.032 c -0.301 0.281 -0.491 0.694 -0.495 1.155 c 0 0.432 0.168 0.847 0.46 1.143c 0.265 0.266 0.612 0.414 0.975 0.414 h 0.839 c 0.027 0.004 0.051 0.012 0.074 0.012 h 8.443 c 0.352 0 0.636 0.344 0.636 0.761 c 0 0.414 -0.285 0.753 -0.636 0.753 h -6.687 c -0.019 0 -0.035 -0.008 -0.051 -0.008h -2.27 c -0.121 -0.835 -0.667 -1.187 -1.795 -1.187 h -2.158 c -0.223 0 -0.402 0.18 -0.402 0.403c 0 0.219 0.179 0.398 0.402 0.398 h 2.158 c 0.972 0 1.019 0.203 1.019 0.784 c 0 0.219 0.179 0.399 0.402 0.399 c 0.008 0 0.016 -0.004 0.027 -0.004 c 0.028 0.004 0.055 0.016 0.082 0.016 h 2.56 c 0.34 0.015 0.616 0.343 0.616 0.752c 0 0.418 -0.285 0.757 -0.636 0.761 h -0.004 h -6.442 c -0.878 0 -1.595 -0.639 -1.595 -1.427 v -0.683 c 0 -0.109 -0.043 -0.211 -0.114 -0.285 c -0.078 -0.074 -0.179 -0.117 -0.285 -0.117 h -0.004 l -2.989 0.027 c -0.223 0 -0.398 0.184 -0.398 0.402 c 0 0.219 0.179 0.395 0.398 0.395 h 0.004 l 2.591 -0.02 v 0.282 c 0 1.229 1.073 2.223 2.391 2.223 h 3.895 c 0.004 0 0.007 0.004 0.011 0.004 h 2.536 c 0.792 0 1.436 -0.698 1.436 -1.561 c 0 -0.273 -0.07 -0.53 -0.188 -0.752 h 5.49 c 0.792 0 1.436 -0.695 1.436 -1.553 c 0 -0.858 -0.644 -1.557 -1.436 -1.557h -3.566 c 0.121 -0.226 0.199 -0.487 0.199 -0.768 c 0 -0.468 -0.195 -0.882 -0.495 -1.167c 0.301 -0.285 0.495 -0.698 0.495 -1.163 c 0 -0.456 -0.191 -0.866 -0.483 -1.152 c 0.293 -0.285 0.483 -0.694 0.483 -1.151c 0 -0.858 -0.647 -1.557 -1.439 -1.557 h -8.373 c -1.167 0 -2.142 0.757 -2.352 1.76 l -2.548 -0.004 c -0.219 0 -0.399 0.18 -0.399 0.403 C 12.784 15.145 12.964 15.325 13.183 15.325 L 13.183 15.325 Z M 21.907 19.707 c -0.191 0 -0.328 -0.094 -0.41 -0.176 c -0.144 -0.145 -0.226 -0.355 -0.226 -0.577 c 0.003 -0.418 0.289 -0.753 0.643 -0.753 h 4.468 c 0.008 0 0.015 -0.004 0.027 -0.008 h 0.051 c 0.351 0 0.636 0.344 0.636 0.761 c 0 0.414 -0.286 0.753 -0.636 0.753 H 21.907 Z M 27.097 16.629 c 0 0.414 -0.286 0.753 -0.64 0.753 h -4.464 c -0.004 0 -0.004 0 -0.004 0 h -0.082c -0.191 0 -0.328 -0.098 -0.414 -0.18 c -0.14 -0.145 -0.222 -0.352 -0.222 -0.573 c 0 -0.413 0.285 -0.749 0.631 -0.753h 3.434 c 0 0 0 0 0.004 0 h 1.116 c 0.008 0 0.012 -0.004 0.02 -0.004 C 26.819 15.887 27.097 16.215 27.097 16.629L 27.097 16.629 Z M 27.097 14.322 c 0 0.41 -0.278 0.737 -0.62 0.749 c -0.008 0 -0.012 0 -0.016 0 h -3.637 c -0.008 0 -0.015 0.004 -0.023 0.004 h -0.886 c -0.004 0 -0.008 0 -0.012 0 c -0.187 0 -0.324 -0.094 -0.406 -0.176c -0.144 -0.144 -0.226 -0.355 -0.226 -0.577 c 0.003 -0.414 0.293 -0.753 0.643 -0.753 h 4.468 c 0.008 0 0.015 -0.004 0.027 -0.004 h 0.051 C 26.811 13.565 27.097 13.905 27.097 14.322 L 27.097 14.322 Z M 27.097 14.322",BusinessRule:"M 32.844 13.245 h -0.089 v 0 H 13.764 v -0.015 h -1.009 v 16.989 h 0.095 v 0.011 h 19.716 v -0.011 h 0.278 V 13.245 Z M 31.844 14.229 v 4.185 h -18.08 v -4.185 H 31.844 Z M 18.168 25.306 v 3.938 h -4.404 v -3.938 H 18.168 Z M 13.764 24.322 v -4.923 h 4.404 v 4.923 H 13.764 Z M 19.177 25.306 h 12.667 v 3.938 H 19.177 V 25.306 Z M 19.177 24.322v -4.923 h 12.667 v 4.923 H 19.177 Z",User:"M 21.762 21.935 c 2.584 0 4.687 -2.561 4.687 -5.703 c 0 -3.147 -2.103 -5.703 -4.687 -5.703 c -1.279 0 -2.475 0.61-3.363 1.721 c -0.855 1.071 -1.327 2.484 -1.324 3.983 C 17.075 19.374 19.178 21.935 21.762 21.935 L 21.762 21.935 ZM 21.762 11.779 c 1.894 0 3.436 1.995 3.436 4.452 c 0 2.453 -1.541 4.452 -3.436 4.452 c -1.895 0 -3.44 -1.999 -3.44 -4.452C 18.323 13.774 19.864 11.779 21.762 11.779 L 21.762 11.779 Z M 25.699 21.309 c -0.348 0 -0.626 0.277 -0.626 0.626 c 0 0.344 0.277 0.622 0.626 0.622 c 2.136 0 3.875 1.74 3.875 3.879 c 0 0.272 -0.227 0.498 -0.501 0.498 H 14.447 c -0.274 0 -0.497 -0.223 -0.497 -0.498 c 0 -2.139 1.736 -3.879 3.872 -3.879 c 0.344 0 0.625 -0.277 0.625 -0.622 c 0 -0.348 -0.28 -0.626-0.625 -0.626 c -2.826 0 -5.124 2.297 -5.124 5.126 c 0 0.965 0.784 1.749 1.748 1.749 h 14.626 c 0.964 0 1.748 -0.7841.748 -1.749 C 30.822 23.606 28.524 21.309 25.699 21.309 L 25.699 21.309 Z M 22.217 9.832 c 0.448 -0.263 0.924 -0.396 1.419 -0.396 c 1.895 0 3.436 1.995 3.436 4.452 c 0 0.439 -0.048 0.873 -0.143 1.284 c -0.08 0.336 0.128 0.672 0.464 0.751 c 0.048 0.012 0.098 0.019 0.143 0.019 c 0.284 0 0.541 -0.195 0.608 -0.483 c 0.119 -0.506 0.18 -1.034 0.18 -1.571c 0 -3.147 -2.102 -5.703 -4.687 -5.703 c -0.711 0 -1.419 0.198 -2.054 0.573 c -0.296 0.174 -0.397 0.559 -0.219 0.855C 21.536 9.911 21.921 10.009 22.217 9.832 L 22.217 9.832 Z M 27.697 18.81 c -0.345 0 -0.626 0.277 -0.626 0.622 c 0 0.348 0.281 0.626 0.626 0.626 c 2.137 0 3.75 1.782 3.75 3.918 c 0 0.07 -0.013 0.141 -0.043 0.205 c -0.14 0.314 0.0030.684 0.318 0.823 c 0.082 0.037 0.167 0.055 0.253 0.055 c 0.241 0 0.466 -0.141 0.57 -0.373 c 0.101 -0.226 0.153 -0.464 0.153-0.714 C 32.699 21.15 30.523 18.81 27.697 18.81 L 27.697 18.81 Z M 27.697 18.81",Script:"M 22.453 15.04 c 0 0 -1.194 -3.741 2.548 -3.774 c 0 0 2.497 0.126 1.766 4.321 c -0.008 0.043 -0.015 0.086 -0.024 0.13c -0.806 4.323 -2.516 8.42 -3.193 10.581 h 3.904 c 0 0 0.983 4.581 -2.549 4.968 H 13.292 c 0 0 -3.097 -1.42 -1.517 -5.323 l 3 -10.839 H 11.84 c 0 0 -1.129 -2.902 1.709 -3.806 l 11.425 -0.032 l -0.73 0.355 l -1.193 1.726 L 22.453 15.04 Z M 22.409 12.597 c 0 0 -0.242 0.483 -0.278 0.98 h -9.098 c 0 0 -0.06 -0.871 0.714 -1.041 L 22.409 12.597 Z M 26.341 27.734c 0 0 -0.13 2.678 -2.226 1.871 c 0 0 -0.823 -0.565 -0.758 -1.855 L 26.341 27.734 Z M 22.905 15.008 c 0 0 0.653 -0.258 0.709-1.501 c 0 0 0.145 -1.144 1.483 -0.693 c 0 0 0.808 0.355 0.259 2.404 c 0 0 -2.226 8.5 -3.032 10.339 c 0 0 -1.064 2.646 0.096 4.226 h -8.581 c 0 0 -1.806 -0.452 -0.741 -3.613 c 0 0 2.935 -9.549 3.193 -11.162 L 22.905 15.008 Z"},Kf={None:"",Standard:"M 52.002 73.379 c -2.494 -2.536 -6.55 -2.534 -9.043 0 c -1.208 1.228 -1.874 2.861 -1.874 4.598 c 0 1.225 0.337 2.395 0.957 3.411 l -1.167 1.186 l 2.071 0.458 l 2.071 0.458 l -0.45 -2.106 l -0.45 -2.106 l -1.292 1.314c -1.119 -2.065 -0.842 -4.709 0.877 -6.458 c 2.084 -2.119 5.475 -2.117 7.557 0 c 2.083 2.119 2.083 5.565 0 7.685c -0.976 0.992 -2.272 1.557 -3.65 1.59 l 0.025 1.068 c 1.65 -0.041 3.2 -0.716 4.368 -1.903 c 1.208 -1.228 1.874 -2.861 1.874 -4.597 C 53.875 76.24 53.209 74.607 52.002 73.379 Z",ParallelMultiInstance:"M 51.5,69.5 L52.5,69.5 L52.5,84.5 L51.5 84.5 Z M 46.5,69.5 L47.5,69.5 L47.5,84.5 L46.5 84.5 Z M 41.5,69.5 L42.5,69.5 L42.5,84.5 L41.5 84.5 Z  ",SequenceMultiInstance:"M 40.375,71.5 L 55.375,71.5 L 55.375,72.5 L 40.375,72.5 Z M 40.375,76.5 L 55.375,76.5 L 55.375,77.5 L 40.375,77.5 Z M 40.375,76.5 L 55.375,76.5 L 55.375,77.5 L 40.375,77.5 Z M 40.375,81.5 L 55.375,81.5L 55.375,82.5 L 40.375,82.5 Z"},Qf=function(){function t(){}return t.prototype.updateBridging=function(t,e){var i,n=[];if(t.bridges=[],ar(t,e)){var o=this.getPoints(t);i=ah.toBounds(o);for(var r=t.bridgeSpace,s=e.bridgeDirection,a=-1,l=e.connectors,h=0;h<l.length;h++){var c=l[h];if(t&&c&&t.id!==c.id){var d=this.getPoints(c),p=ah.toBounds(d);if(this.intersectsRect(i,p)){var u=this.intersect(o,d,!1,s,!0);if(u.length>0)for(var g=0;g<u.length;g++){var m=0,f=0,v=0,y=this.getLengthAtFractionPoint(t,u[g]);if(-1!==y.pointIndex){m=y.lengthFractionIndex,y.fullLength,f=y.segmentIndex,v=y.pointIndex;var b=this.getPointAtLength(m-r/2,o),w=this.getPointAtLength(m+r/2,o);this.isEmptyPoint(w)&&(w=b);var x=void 0,S=void 0;x=t.sourcePoint,S="Straight"===t.type?t.targetPoint:t.intermediatePoints[v];var C=this.angleCalculation(x,S);if(n.length){var L=void 0;L=t.sourcePoint;var E=Math.abs(this.lengthCalculation(L,w)),P=0,k=-1;a=-1;for(var T=0;T<n[f].bridges.length;T++){a++;var O=n[f].bridges[T];if(P=Math.abs(this.lengthCalculation(L,O.endPoint)),E<P){k=a;break}}if(k>=0){I=void 0;(I=this.createSegment(b,w,C,s,v,t,e)).target=c.id,n[f].bridges.splice(k,0,I),n[f].bridges.join(),n[f].bridgeStartPoint.splice(k,0,b),n[f].bridgeStartPoint.join(),n[f].segmentIndex=f}else{var I=void 0;(I=this.createSegment(b,w,C,s,v,t,e)).target=c.id,n[f].bridges.push(I),n[f].bridgeStartPoint.push(b),n[f].segmentIndex=f}}else if(!isNaN(b.x)&&!isNaN(b.y)&&!this.isEmptyPoint(w)){var A=void 0,M={bridges:[],bridgeStartPoint:[],segmentIndex:f};(A=this.createSegment(b,w,C,s,v,t,e)).target=c.id;var R=[],D=[];R.push(b),D.push(w),n[f]=M,n[f].bridges.push(A),n[f].bridgeStartPoint=R,n[f].segmentIndex=f}}}}}}0!==n.length&&this.firstBridge(n,t,r)}},t.prototype.firstBridge=function(t,e,i){for(var n=0;n<t.length;n++){for(var o=t[n],r=1;r<o.bridges.length;r++)if(sh.findLength(o.bridges[r].endPoint,o.bridges[r-1].endPoint)<i){o.bridges[r-1].endPoint=o.bridges[r].endPoint;var s=o.bridges[r-1],a=this.createBridgeSegment(s.startPoint,s.endPoint,s.angle,i,s.sweep);o.bridges[r-1].path=a,o.bridges.splice(r,1),o.bridgeStartPoint.splice(r,1),r--}e.sourcePoint;for(var l=0;l<o.bridges.length;l++)(s=o.bridges[l]).endPoint,e.bridges.push(s)}},t.prototype.createSegment=function(t,e,i,n,o,r,s){var a,l,h={angle:0,endPoint:{x:0,y:0},target:"",path:"",segmentPointIndex:-1,startPoint:{x:0,y:0},sweep:1,rendered:!1};return l=this.sweepDirection(i,n,r,s),a=this.createBridgeSegment(t,e,i,r.bridgeSpace,l),h.path=a,h.startPoint=t,h.endPoint=e,h.angle=i,h.segmentPointIndex=o,h.sweep=l,h},t.prototype.createBridgeSegment=function(t,e,i,n,o){return"A "+n/2+" "+n/2+" "+i+" , 1 "+o+" "+e.x+","+e.y},t.prototype.sweepDirection=function(t,e,i,n){var o,r=Math.abs(t);switch(e){case"Top":case"Bottom":o=1,r>=0&&r<=90&&(o=0);break;case"Left":case"Right":o=1,t<0&&t>=-180&&(o=0)}return"Right"!==e&&"Bottom"!==e||(o=0===o?1:0),o},t.prototype.getPointAtLength=function(t,e){for(var i,n=0,o={x:0,y:0},r=0;r<e.length;r++){var s=e[r];if(i){var a=this.lengthCalculation(i,s);if(n+a>t){var l=t-n,h=sh.findAngle(i,s),c=l*Math.cos(h*Math.PI/180),d=l*Math.sin(h*Math.PI/180);o={x:i.x+c,y:i.y+d};break}n+=a,i=s}else i=s}return o},t.prototype.getPoints=function(t){var e=[];if(t.intermediatePoints&&("Straight"===t.type||"Orthogonal"===t.type))for(var i=0;i<t.intermediatePoints.length;i++)e.push(t.intermediatePoints[i]);return e},t.prototype.intersectsRect=function(t,e){return e.x<t.x+t.width&&t.x<e.x+e.width&&e.y<t.y+t.height&&t.y<e.y+e.height},t.prototype.intersect=function(t,e,i,n,o){i&&e.length>=2&&(e.splice(0,1),e.splice(0,1));for(var r=[],s=0;s<t.length-1;s++){var a=this.inter1(t[s],t[s+1],e,o,n);if(a.length>0)for(var l=0;l<a.length;l++)r.push(a[l]);i&&e.length>=1&&e.splice(0,1)}return r},t.prototype.inter1=function(t,e,i,n,o){for(var r=[],s=0;s<i.length-1;s++){var a=this.intersect2(t,e,i[s],i[s+1]);if(!this.isEmptyPoint(a)){var l=this.angleCalculation(t,e),h=this.angleCalculation(i[s],i[s+1]);switch(l=this.checkForHorizontalLine(l),h=this.checkForHorizontalLine(h),o){case"Left":case"Right":l>h&&r.push(a);break;case"Top":case"Bottom":l<h&&r.push(a)}l===h&&n&&r.push(a)}}return r},t.prototype.checkForHorizontalLine=function(t){var e=Math.abs(t);return e>90?180-e:e},t.prototype.intersect2=function(t,e,i,n){var o={x:0,y:0},r=Kr(this.getLineSegment(t.x,t.y,e.x,e.y),this.getLineSegment(i.x,i.y,n.x,n.y));return r.enabled?r.intersectPt:o},t.prototype.getLineSegment=function(t,e,i,n){return{X1:Number(t)||0,Y1:Number(e)||0,X2:Number(i)||0,Y2:Number(n)||0}},t.prototype.isEmptyPoint=function(t){return 0===t.x&&0===t.y},t.prototype.getLengthAtFractionPoint=function(t,e){for(var i=100,n=-1,o=0,r=-1,s=0,a=0,l=t.sourcePoint,h=l,c=[],d=0;d<t.intermediatePoints.length;d++){var p=t.intermediatePoints[d];c.push(p)}for(var u=0;u<c.length;u++){var g=c[u],m=this.getSlope(g,l,e,t);m<i&&(i=m,a=o+this.lengthCalculation(e,h),r=s,n=u),o+=sh.findLength(g,l),l=g,h=g}return s++,{lengthFractionIndex:a,fullLength:o,segmentIndex:r,pointIndex:n}},t.prototype.getSlope=function(t,e,i,n){var o=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y),s=(i.y-t.y)/(e.y-t.y),a=(i.x-t.x)/(e.x-t.x);if(!isFinite(s)||!isFinite(a)||isNaN(s)||isNaN(a)){if(t.x===e.x){if(t.y===e.y)return 1e4;if(t.y>i.y&&i.y>e.y||t.y<i.y&&i.y<e.y)return Math.abs(t.x-i.x)}else if(t.y===e.y&&(t.x>i.x&&i.x>e.x||t.x<i.x&&i.x<e.x))return Math.abs(t.y-i.y)}else if((t.x>=i.x&&i.x>=e.x||t.x<=i.x&&i.x<=e.x||o<3)&&(t.y>=i.y&&i.y>=e.y||t.y<=i.y&&i.y<=e.y||r<3))return Math.abs(s-a);return 1e4},t.prototype.angleCalculation=function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.atan2(n,i)*(180/Math.PI)},t.prototype.lengthCalculation=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"Bridging"},t}(),Jf=function(){function t(t){this.line=[],this.diagram=t}return t.prototype.canSnap=function(){return 0!=(this.diagram.snapSettings.constraints&(ph.SnapToObject|ph.SnapToLines))},t.prototype.snapPoint=function(t,e,i,n,o,r,s){var a=this.diagram.snapSettings,l={x:0,y:0},h=ee(e.wrapper),c={snapped:!1,offset:0},d={snapped:!1,offset:0};if(this.diagram.snapSettings.constraints&ph.SnapToObject){var p=void 0;(p=document.createElementNS("http://www.w3.org/2000/svg","g")).setAttribute("id","_SnappingLines"),p.setAttribute("shapeRendering","crispEdges"),Me(this.diagram.element.id).appendChild(p),this.snapObject(t,e,p,c,d,o,r===s)}var u=h.x+o.x,g=h.y+o.y,m=h.x+h.width+o.x,f=h.y+h.height+o.y,v=a.verticalGridlines.scaledIntervals,y=this.round(m,v,1),b=this.round(u,v,1);v=a.horizontalGridlines.scaledIntervals;var w=this.round(g,v,1),x=this.round(f,v,1),S=h.x+h.width,C=h.y+h.height;return c.snapped?this.diagram.snapSettings.constraints&ph.SnapToObject?l.x=c.offset:l.x=s.x-r.x:this.diagram.snapSettings.constraints&ph.SnapToVerticalLines?Math.abs(o.x)>=1&&(i?Math.abs(y-S)>Math.abs(b-h.x)?l.x+=b-h.x:l.x+=y-S:Math.abs(y-S)<Math.abs(b-h.x)?l.x+=y-S:l.x+=b-h.x):l.x=s.x-r.x,d.snapped?l.y=d.offset:this.diagram.snapSettings.constraints&ph.SnapToHorizontalLines?Math.abs(o.y)>=1&&(n?Math.abs(x-C)>Math.abs(w-h.y)?l.y+=w-h.y:l.y+=x-C:Math.abs(x-C)<Math.abs(w-h.y)?l.y+=x-C:l.y+=w-h.y):l.y=s.y-r.y,l},t.prototype.round=function(t,e,i){i=i>1?Math.pow(2,Math.floor(Math.log(i)/Math.log(2))):Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)));var n=0,o=0;for(o=0;o<e.length;o++)n+=e[o];var r=t%(n/=i),s=Math.floor(Math.abs(t)/n)*n;if(s!==t)if(t>=0)for(o=0;o<e.length;o++){if(r<=e[o]/i)return s+(r<e[o]/(2*i)?0:e[o]/i);s+=e[o]/i,r-=e[o]/i}else for(s*=-1,o=e.length-1;o>=0;o--){if(Math.abs(r)<=e[o]/i)return s-(Math.abs(r)<e[o]/(2*i)?0:e[o]/i);s-=e[o]/i,r+=e[o]/i}return t},t.prototype.snapObject=function(t,e,i,n,o,r,s){var a,l,h,c=null,d=this.diagram.scroller,p=this.diagram.snapSettings,u=[],g=[],m=[],f=[],v=ee(e.wrapper),y=t.scroller.currentZoom,b=-d.horizontalOffset,w=-d.verticalOffset,x=p.snapObjectDistance/y,S=new ah(0,0,d.viewPortWidth,d.viewPortHeight),C=new ah(b/y,v.y-x-5,S.width/y,v.height+2*x+10),L=new ah(v.x-x-5,w/y,v.width+2*x+10,S.height/y);S=new ah(b/y,w/y,S.width/y,S.height/y);var E,P,k,T=this.findNodes(t.spatialSearch,e,L,S),O=t.nameTable;for(E=0;E<T.length;E++)P=T[E],this.canBeTarget(t,P)&&(this.diagram.nameTable[P.id]instanceof Vd||!this.canConsider(O,e,P)||((k=P.bounds).height+k.y<r.y+v.y?m.push({obj:P,distance:Math.abs(v.y+r.y-k.y-k.height)}):k.y>v.y+r.y+v.height&&f.push({obj:P,distance:Math.abs(v.y+r.y+v.height-k.y)}),(null==c||c>Math.abs(k.y-v.y-r.y))&&(Math.abs(k.x+k.width/2-(v.x+v.width/2+r.x))<=x?(l=this.createSnapObject(k,v,"centerX"),c=Math.abs(k.y-v.y)):Math.abs(k.x+k.width-(v.x+v.width+r.x))<=x?(l=this.createSnapObject(k,v,"right"),c=Math.abs(k.y-v.y)):Math.abs(k.x-(v.x+r.x))<=x?(l=this.createSnapObject(k,v,"left"),c=Math.abs(k.y-v.y)):Math.abs(k.x-(v.x+v.width+r.x))<=x?(l=this.createSnapObject(k,v,"rightLeft"),c=Math.abs(k.y-v.y)):Math.abs(k.x+k.width-(v.x+r.x))<=x&&(l=this.createSnapObject(k,v,"leftRight"),c=Math.abs(k.y-v.y)))));T=this.findNodes(t.spatialSearch,e,C,S);for(var I=0;I<T.length;I++)P=T[I],this.canBeTarget(t,P)&&(this.diagram.nameTable[P.id]instanceof Vd||!this.canConsider(O,e,P)||((k=P.bounds).x+k.width<v.x+r.x&&(u[u.length]={obj:P,distance:Math.abs(v.x+r.x-k.x-k.width)}),k.x>v.x+r.x+v.width&&(g[g.length]={obj:P,distance:Math.abs(v.x+r.x+v.width-k.x)}),(null==a||a>Math.abs(k.x-v.x-r.x))&&(Math.abs(k.y+k.height/2-(v.y+v.height/2+r.y))<=x?(h=this.createSnapObject(k,v,"centerY"),a=Math.abs(k.x-v.x)):Math.abs(k.y-v.y-r.y)<=x?(h=this.createSnapObject(k,v,"top"),a=Math.abs(k.x-v.x)):Math.abs(k.y+k.height-(v.y+v.height+r.y))<=x?(h=this.createSnapObject(k,v,"bottom"),a=Math.abs(k.x-v.x)):Math.abs(k.y+k.height-v.y-r.y)<=x?(h=this.createSnapObject(k,v,"topBottom"),a=Math.abs(k.x-v.x)):Math.abs(k.y-(v.y+v.height+r.y))<=x&&(h=this.createSnapObject(k,v,"bottomTop"),a=Math.abs(k.x-v.x)))));this.createGuidelines(t,l,h,i,n,o,s),n.snapped||this.createHSpacingLines(t,i,e,u,g,n,o,s,r,x),o.snapped||this.createVSpacingLines(t,i,e,m,f,n,o,s,r,x)},t.prototype.snapConnectorEnd=function(t){var e=this.diagram.snapSettings;return e.constraints&ph.SnapToLines&&(t.x=this.round(t.x,e.verticalGridlines.scaledIntervals,1),t.y=this.round(t.y,e.horizontalGridlines.scaledIntervals,1)),t},t.prototype.canBeTarget=function(t,e){return e=this.diagram.nameTable[e.id],!Rs(this.diagram,e,!1)},t.prototype.snapSize=function(t,e,i,n,o,r,s,a){var l,h,c,d,p=this.diagram.snapSettings,u=this.diagram.scroller,g=ee(s.wrapper),m=t.nameTable,f=[],v=[],y=t.scroller.currentZoom,b=-u.horizontalOffset,w=-u.verticalOffset,x=p.snapObjectDistance/y,S=new ah(0,0,u.viewPortWidth,u.viewPortHeight),C=new ah(b/y,(g.y-5)/y,S.width/y,(g.height+10)/y),L=new ah((g.x-5)/y,w/y,(g.width+10)/y,S.height/y);S=new ah(b/y,w/y,S.width/y,S.height/y);var E,P,k,T=[],O=this.findNodes(t.spatialSearch,s,L,S,T);for(E=0;E<O.length;E++)P=O[E],!this.canConsider(m,s,P)||this.diagram.nameTable[P.id]instanceof Vd||(k=P.bounds,(null==l||l>Math.abs(k.y-g.y))&&(e.left?Math.abs(g.x+o-k.x)<=x?(c=this.createSnapObject(k,g,"left"),l=Math.abs(k.y-g.y)):Math.abs(g.x+o-k.x-k.width)<=x&&(c=this.createSnapObject(k,g,"leftRight"),l=Math.abs(k.y-g.y)):e.right&&(Math.abs(g.x+o+g.width-k.x-k.width)<=x?(c=this.createSnapObject(k,g,"right"),l=Math.abs(k.y-g.y)):Math.abs(g.x+o+g.width-k.x)<=x&&(c=this.createSnapObject(k,g,"rightLeft"),l=Math.abs(k.y-g.y)))));O=this.findNodes(t.spatialSearch,s,C,S);for(var I=0;I<O.length;I++){var A=O[I];if(this.canConsider(m,s,A)&&!(this.diagram.nameTable[A.id]instanceof Vd)){var M=A.bounds;(null==h||h>Math.abs(M.x-g.x))&&(i.top?Math.abs(g.y+r-M.y)<=x?(d=this.createSnapObject(M,g,"top"),h=Math.abs(M.x-g.x)):Math.abs(g.y+r-M.y-M.height)<=x&&(d=this.createSnapObject(M,g,"topBottom"),h=Math.abs(M.x-g.x)):i.bottom&&(Math.abs(g.y+g.height+r-M.y-M.height)<=x?(d=this.createSnapObject(M,g,"bottom"),h=Math.abs(M.x-g.x)):Math.abs(g.y+g.height+r-M.y)<=x&&(d=this.createSnapObject(M,g,"bottomTop"),h=Math.abs(M.x-g.x))))}}for(E=0;E<T.length;E++)if(P=T[E],this.canConsider(m,s,P)){var R=P.bounds,D=e.left?-o:o,B=Math.abs(g.width+D-R.width),N=void 0;B<=x&&(N=e.left?-R.width+g.width:R.width-g.width,f[f.length]={source:P,difference:B,offset:N}),D=i.top?-r:r;var H=Math.abs(g.height+D-R.height);H<=x&&(N=i.top?-R.height+g.height:R.height-g.height,v[v.length]={source:P,difference:H,offset:N})}if(!t.getTool)this.createGuidelines(t,c,d,n,e,i,a);!e.snapped&&f.length>0&&(e.left||e.right)&&this.addSameWidthLines(t,n,f,e,a,s),!i.snapped&&v.length>0&&(i.top||i.bottom)&&this.addSameHeightLines(t,n,v,i,a,s)},t.prototype.snapTop=function(t,e,i,n,o,r,s,a){var l=o;e.top=!0;var h;t.left=t.right=!1;if(this.diagram.snapSettings.constraints&ph.SnapToObject&&!r.rotateAngle&&(h=a.y-a.height*r.pivot.y+o-(r.offsetY-r.height*r.pivot.y),this.snapSize(this.diagram,t,e,i,n,h,this.diagram.selectedItems,s)),e.snapped)l=o-h+e.offset;else if(this.diagram.snapSettings.constraints&ph.SnapToHorizontalLines){var c=a.y-a.height*r.pivot.y,d=c+o;l=this.round(d,this.diagram.snapSettings.horizontalGridlines.scaledIntervals,1)-c}return l},t.prototype.snapRight=function(t,e,i,n,o,r,s,a){var l,h=n;t.right=!0,e.top=e.bottom=!1;if(this.diagram.snapSettings.constraints&ph.SnapToObject&&!r.rotateAngle&&(l=a.x+a.width*(1-r.pivot.x)+n-(r.offsetX+r.width*(1-r.pivot.x)),this.snapSize(this.diagram,t,e,i,l,o,this.diagram.selectedItems,s)),t.snapped)h=n-l+t.offset;else if(this.diagram.snapSettings.constraints&ph.SnapToVerticalLines){var c=a.x+a.width*(1-r.pivot.x),d=c+n;h=this.round(d,this.diagram.snapSettings.verticalGridlines.scaledIntervals,1)-c}return h},t.prototype.snapLeft=function(t,e,i,n,o,r,s,a){var l=n,h=0;t.left=!0,e.top=e.bottom=!1;if(this.diagram.snapSettings.constraints&ph.SnapToObject&&!r.rotateAngle&&(h=a.x-a.width*r.pivot.x+n-(r.offsetX-r.width*r.pivot.x),this.snapSize(this.diagram,t,e,i,h,o,this.diagram.selectedItems,s)),t.snapped)l=n-h+t.offset;else if(this.diagram.snapSettings.constraints&ph.SnapToVerticalLines){var c=a.x-a.width*r.pivot.x,d=c+n;l=this.round(d,this.diagram.snapSettings.horizontalGridlines.scaledIntervals,1)-c}return l},t.prototype.snapBottom=function(t,e,i,n,o,r,s,a){var l=o;e.bottom=!0,t.left=t.right=!1;var h=0;this.diagram.snapSettings.constraints&ph.SnapToObject&&!r.rotateAngle&&(h=a.y+a.height*(1-r.pivot.y)+o-(r.offsetY+r.height*(1-r.pivot.y)),this.snapSize(this.diagram,t,e,i,n,h,this.diagram.selectedItems,s));ee(r.wrapper);if(e.snapped)l=o-h+e.offset;else if(this.diagram.snapSettings.constraints&ph.SnapToHorizontalLines){var c=a.y+a.height*(1-r.pivot.y),d=c+o;l=this.round(d,this.diagram.snapSettings.horizontalGridlines.scaledIntervals,1)-c}return l},t.prototype.createGuidelines=function(t,e,i,n,o,r,s){return e&&(o.offset=e.offsetX,o.snapped=!0,s||(e.type,this.renderAlignmentLines(e.start,e.end,n,t.scroller.transform))),i&&(r.offset=i.offsetY,r.snapped=!0,s||(i.type,this.renderAlignmentLines(i.start,i.end,n,t.scroller.transform))),n},t.prototype.renderAlignmentLines=function(t,e,i,n){t={x:(t.x+n.tx)*n.scale,y:(t.y+n.ty)*n.scale},e={x:(e.x+n.tx)*n.scale,y:(e.y+n.ty)*n.scale};var o={stroke:"#07EDE1",strokeWidth:1,startPoint:{x:t.x,y:t.y},endPoint:{x:e.x,y:e.y},fill:"#07EDE1",dashArray:"",width:1,x:0,y:0,height:0,angle:0,pivotX:0,pivotY:0,visible:!0,opacity:1,id:te()},r=0;for(this.line.push(o),r=0;r<this.line.length;r++)this.diagram.diagramRenderer.drawLine(i,this.line.pop())},t.prototype.createHSpacingLines=function(t,e,i,n,o,r,s,a,l,h){var c=0;this.sortByDistance(n,"distance",!0),this.sortByDistance(o,"distance",!0);var d,p,u,g,m=[],f=ee(i.wrapper);if(n.length>0&&(m[m.length]=n[0],c=(d=n[0].obj.bounds).y,n.length>1?(u=n[1].obj.bounds,g=d.x-u.x-u.width,Math.abs(g-n[0].distance)<=h?c=this.findEquallySpacedNodesAtLeft(n,g,c,m):g=n[0].distance):g=n[0].distance),this.sortByDistance(m,"distance"),m[m.length]={obj:i,distance:0},c=f.y<c||!c?f.y:c,o.length>0){var v=void 0;if(p=o[0].obj.bounds,c=p.y<c?p.y:c,o.length>1&&(v=(u=o[1].obj.bounds).x-p.x-p.width),n.length>0)if(Math.abs(o[0].distance-n[0].distance)<=h){var y=Math.abs(o[0].distance-n[0].distance)/2;o[0].distance<n[0].distance?g-=y:g+=y,m[m.length]=o[0]}else 1===n.length&&(d=void 0,m.splice(0,1),m[m.length]=o[0],g=v);else g=v,m[m.length]=o[0];o.length>1&&p.x+p.width<u.x&&(c=this.findEquallySpacedNodesAtRight(o,v,c,m,h))}if(m.length>2){this.addHSpacingLines(t,e,m,a,c);var b=0;a&&(b=l.x),d?r.offset=g-Math.abs(f.x+b-d.x-d.width)+b:p&&(r.offset=Math.abs(f.x+f.width+b-p.x)-g+b),r.snapped=!0}},t.prototype.createVSpacingLines=function(t,e,i,n,o,r,s,a,l,h){var c=0;this.sortByDistance(n,"distance",!0),this.sortByDistance(o,"distance",!0);var d,p,u,g,m=[],f=ee(i.wrapper);n.length>0&&(m[m.length]=n[0],c=(d=n[0].obj.bounds).x+d.width,n.length>1?(u=n[1].obj.bounds,g=d.y-u.y-u.height,Math.abs(g-n[0].distance)<=h?c=this.findEquallySpacedNodesAtTop(n,g,c,m):g=n[0].distance):g=n[0].distance),this.sortByDistance(m,"distance"),m[m.length]={obj:i,distance:0},c=f.x+f.width>c||!c?f.x+f.width:c;var v;if(o.length>0){if(p=o[0].obj.bounds,c=p.x+p.width>c?p.x+p.width:c,o.length>1&&(v=(u=o[1].obj.bounds).y-p.y-p.height),n.length>0)if(Math.abs(o[0].distance-n[0].distance)<=h){var y=Math.abs(o[0].distance-n[0].distance)/2;o[0].distance<n[0].distance?g-=y:g+=y,m[m.length]=o[0]}else 1===n.length&&(d=void 0,m.splice(0,1),m[m.length]=o[0],g=v);else g=v,m[m.length]=o[0];o.length>1&&u.y>p.y+p.height&&(c=this.findEquallySpacedNodesAtBottom(o,v,c,m,h))}if(m.length>2){this.addVSpacingLines(t,e,m,a,c);var b=0;a&&(b=l.y),d?s.offset=g-Math.abs(f.y+b-d.y-d.height)+b:p&&(s.offset=Math.abs(f.y+f.height+b-p.y)-g+b),s.snapped=!0}},t.prototype.addHSpacingLines=function(t,e,i,n,o){var r,s,a;if(!n)for(r=0;r<i.length-1;r++){var l=i[r].obj instanceof Ud?ee(i[r].obj.wrapper):i[r].obj.bounds,h=i[r+1].obj instanceof Ud?ee(i[r+1].obj.wrapper):i[r+1].obj.bounds;s={x:l.x+l.width,y:o-15},a={x:h.x,y:o-15},this.renderSpacingLines(s,a,e,Me(this.diagram.element.id),t.scroller.transform)}},t.prototype.addVSpacingLines=function(t,e,i,n,o){var r,s;if(!n)for(var a=0;a<i.length-1;a++){var l=i[a].obj instanceof Ud?ee(i[a].obj.wrapper):i[a].obj.bounds,h=i[a+1].obj instanceof Ud?ee(i[a+1].obj.wrapper):i[a+1].obj.bounds;r={x:o+15,y:l.y+l.height},s={x:o+15,y:h.y},this.renderSpacingLines(r,s,e,Me(this.diagram.element.id),t.scroller.transform)}},t.prototype.addSameWidthLines=function(t,e,i,n,o,r){this.sortByDistance(i,"offset");var s,a,l=ee(r.wrapper),h=i[0],c=h.source.bounds,d=[];d.push(i[0]);var p;for(p=1;p<i.length;p++)i[p].source.bounds.width===c.width&&d.push(i[p]);if(!o)for(s={x:l.x+h.offset,y:l.y-15},a={x:l.x+l.width+h.offset,y:l.y-15},this.renderSpacingLines(s,a,e,Me(this.diagram.element.id),t.scroller.transform),p=0;p<d.length;p++)s={x:(l=d[p].source.bounds).x,y:l.y-15},a={x:l.x+l.width,y:l.y-15},this.renderSpacingLines(s,a,e,Me(this.diagram.element.id),t.scroller.transform);n.offset=h.offset,n.snapped=!0},t.prototype.addSameHeightLines=function(t,e,i,n,o,r){this.sortByDistance(i,"offset");var s,a,l=ee(r.wrapper),h=i[0],c=h.source.bounds,d=[];d.push(i[0]);var p;for(p=0;p<i.length;p++)i[p].source.bounds.height===c.height&&d.push(i[p]);if(!o)for(s={x:l.x+l.width+15,y:l.y+h.offset},a={x:l.x+l.width+15,y:l.y+h.offset+l.height},this.renderSpacingLines(s,a,e,Me(this.diagram.element.id),t.scroller.transform),p=0;p<d.length;p++)s={x:(l=d[p].source.bounds).x+l.width+15,y:l.y},a={x:l.x+l.width+15,y:l.y+l.height},this.renderSpacingLines(s,a,e,Me(this.diagram.element.id),t.scroller.transform);n.offset=h.offset,n.snapped=!0},t.prototype.renderSpacingLines=function(t,e,i,n,o){var r,s,a=new Hh,l={};t={x:(t.x+o.tx)*o.scale,y:(t.y+o.ty)*o.scale},e={x:(e.x+o.tx)*o.scale,y:(e.y+o.ty)*o.scale},t.x===e.x?(r="M"+(t.x-5)+" "+(t.y+5)+"L"+t.x+" "+t.y+"L"+(t.x+5)+" "+(t.y+5)+"zM"+(e.x-5)+" "+(e.y-5)+" L"+e.x+" "+e.y+" L"+(e.x+5)+" "+(e.y-5)+"z",s={startPoint:{x:t.x-8,y:t.y-1},endPoint:{x:t.x+8,y:t.y-1},stroke:"#07EDE1",strokeWidth:1,fill:"#07EDE1",dashArray:"",width:1,x:0,y:0,height:0,angle:0,pivotX:0,pivotY:0,visible:!0,opacity:1,id:te()},a.data=r,l.data=a.data,l.angle=0,l.pivotX=0,l.pivotY=0,l.x=0,l.y=0,l.height=0,l.width=1,l.id=te(),this.diagram.diagramRenderer.drawPath(i,l),this.line.push(s),this.diagram.diagramRenderer.drawLine(i,this.line.pop()),s={startPoint:{x:e.x-8,y:e.y+1},endPoint:{x:e.x+8,y:e.y+1},stroke:"#07EDE1",strokeWidth:1,fill:"#07EDE1",dashArray:"",width:1,x:0,y:0,height:0,angle:0,pivotX:0,pivotY:0,visible:!0,opacity:1,id:Me(this.diagram.element.id).id+"spacing"},this.line.push(s),this.diagram.diagramRenderer.drawLine(i,this.line.pop())):(r="M"+(t.x+5)+" "+(t.y+5)+" L"+t.x+" "+t.y+" L"+(t.x+5)+" "+(t.y-5)+"zM"+(e.x-5)+" "+(e.y-5)+" L"+e.x+" "+e.y+" L"+(e.x-5)+" "+(e.y+5)+"z",a.data=r,l.data=r,l.angle=0,l.pivotX=0,l.pivotY=0,l.x=0,l.y=0,l.height=0,l.width=1,l.id=te(),this.diagram.diagramRenderer.drawPath(i,l),s={visible:!0,opacity:1,id:te(),startPoint:{x:t.x-1,y:t.y-8},endPoint:{x:t.x-1,y:t.y+8},stroke:"#07EDE1",strokeWidth:1,fill:"#07EDE1",dashArray:"0",width:1,x:0,y:0,height:0,angle:0,pivotX:0,pivotY:0},this.line.push(s),this.diagram.diagramRenderer.drawLine(i,this.line.pop()),s={width:1,x:0,y:0,height:0,angle:0,pivotX:0,pivotY:0,visible:!0,opacity:1,id:te(),startPoint:{x:e.x+1,y:e.y-8},endPoint:{x:e.x+1,y:e.y+8},stroke:"#07EDE1",strokeWidth:1,fill:"#07EDE1",dashArray:"0"},this.line.push(s),this.diagram.diagramRenderer.drawLine(i,this.line.pop())),s={startPoint:{x:t.x,y:t.y},endPoint:{x:e.x,y:e.y},stroke:"#07EDE1",strokeWidth:1,fill:"#07EDE1",dashArray:"0",width:1,x:0,y:0,height:0,angle:0,pivotX:0,pivotY:0,visible:!0,opacity:1,id:te()},this.line.push(s),this.diagram.diagramRenderer.drawLine(i,this.line.pop())},t.prototype.createSnapObject=function(t,e,i){var n;switch(i){case"left":n={start:{x:t.x,y:Math.min(t.y,e.y)},end:{x:t.x,y:Math.max(t.y+t.height,e.y+e.height)},offsetX:t.x-e.x,offsetY:0,type:"sideAlign"};break;case"right":n={type:"sideAlign",start:{x:t.x+t.width,y:Math.min(t.y,e.y)},offsetX:t.x+t.width-e.x-e.width,offsetY:0,end:{x:t.x+t.width,y:Math.max(t.y+t.height,e.y+e.height)}};break;case"top":n={offsetY:t.y-e.y,offsetX:0,type:"sideAlign",start:{x:Math.min(t.x,e.x),y:t.y},end:{x:Math.max(t.x+t.width,e.x+e.width),y:t.y}};break;case"bottom":n={type:"sideAlign",offsetY:t.y+t.height-e.y-e.height,offsetX:0,end:{x:Math.max(t.x+t.width,e.x+e.width),y:t.y+t.height},start:{x:Math.min(t.x,e.x),y:t.y+t.height}};break;case"topBottom":n={start:{x:Math.min(t.x,e.x),y:t.y+t.height},end:{x:Math.max(t.x+t.width,e.x+e.width),y:t.y+t.height},offsetY:t.y+t.height-e.y,offsetX:0,type:"sideAlign"};break;case"bottomTop":n={start:{x:Math.min(t.x,e.x),y:t.y},end:{x:Math.max(t.x+t.width,e.x+e.width),y:t.y},offsetY:t.y-e.y-e.height,offsetX:0,type:"sideAlign"};break;case"leftRight":n={start:{x:t.x+t.width,y:Math.min(t.y,e.y)},end:{x:t.x+t.width,y:Math.max(t.y+t.height,e.y+e.height)},offsetX:t.x+t.width-e.x,offsetY:0,type:"sideAlign"};break;case"rightLeft":n={start:{x:t.x,y:Math.min(t.y,e.y)},end:{x:t.x,y:Math.max(t.y+t.height,e.y+e.height)},offsetX:t.x-e.x-e.width,offsetY:0,type:"sideAlign"};break;case"centerX":n={start:{x:t.x+t.width/2,y:Math.min(t.y,e.y)},end:{x:t.x+t.width/2,y:Math.max(t.y+t.height,e.y+e.height)},offsetX:t.x+t.width/2-(e.x+e.width/2),offsetY:0,type:"centerAlign"};break;case"centerY":n={start:{x:Math.min(t.x,e.x),y:t.y+t.height/2},end:{x:Math.max(t.x+t.width,e.x+e.width),y:t.y+t.height/2},offsetY:t.y+t.height/2-(e.y+e.height/2),offsetX:0,type:"centerAlign"}}return n},t.prototype.snapAngle=function(t,e){var i=this.diagram.snapSettings.snapAngle,n=e%(i||0);return n>=i/2?e+i-n:e-n},t.prototype.canConsider=function(t,e,i){return!this.diagram.selectedItems.nodes.length||this.diagram.selectedItems.nodes[0].id!==i.id},t.prototype.findNodes=function(t,e,i,n,o){for(var r,s,a=[],l=t.findQuads(o?n:i),h=0;h<l.length;h++){var c=l[h];if(c.objects.length>0)for(var d=0;d<c.objects.length;d++)r=c.objects[d],this.diagram.nameTable[r.id]instanceof Vd||!r.visible||(s=ee(r),-1===a.indexOf(r)&&this.intersectsRect(i,s)&&a.push(r),o&&o.indexOf(r)&&this.intersectsRect(n,s)&&o.push(r))}return a},t.prototype.intersectsRect=function(t,e){return e.x<t.x+t.width&&t.x<e.x+e.width&&e.y<t.y+t.height&&t.y<e.y+e.height},t.prototype.removeGuidelines=function(t){var e=Me(this.diagram.element.id).getElementById("_SnappingLines"),i=Me(this.diagram.element.id).getElementById("pivotLine");e&&e.parentNode.removeChild(e),i&&i.parentNode.removeChild(i)},t.prototype.sortByDistance=function(t,e,i){var n,o,r;if(i)for(n=0;n<t.length;n++)for(o=n+1;o<t.length;o++)t[n][e]>t[o][e]&&(r=t[n],t[n]=t[o],t[o]=r);else for(n=0;n<t.length;n++)for(o=n+1;o<t.length;o++)t[n][e]<t[o][e]&&(r=t[n],t[n]=t[o],t[o]=r)},t.prototype.findEquallySpacedNodesAtLeft=function(t,e,i,n){var o,r,s,a;for(a=1;a<t.length&&(o=t[a-1].obj.bounds,r=t[a].obj.bounds,s=o.x-r.x-r.width,Math.abs(s-e)<=1);a++)n[n.length]=t[a],r.y<i&&(i=r.y);return i},t.prototype.findEquallySpacedNodesAtRight=function(t,e,i,n,o){var r,s,a,l,h=t[0].distance;if(Math.abs(e-h)<=o)for(var c=0;c<t.length-1&&(r=t[c].obj,s=t[c+1].obj.bounds,a=r.bounds,l=s.x-a.x-a.width,Math.abs(l-e)<=1);c++)n[n.length]=t[c+1],a.y<i&&(i=a.y);return i},t.prototype.findEquallySpacedNodesAtTop=function(t,e,i,n){for(var o,r,s,a=1;a<t.length&&(o=t[a-1].obj.bounds,r=t[a].obj.bounds,s=o.y-r.y-r.height,Math.abs(s-e)<=1);a++)n[n.length]=t[a],r.x+r.width>i&&(i=r.x+r.width);return i},t.prototype.findEquallySpacedNodesAtBottom=function(t,e,i,n,o){var r,s,a,l,h=t[0].distance;if(Math.abs(e-h)<=o)for(var c=0;c<t.length-1&&(r=t[c].obj,s=t[c+1].obj.bounds,a=r.bounds,l=s.y-a.y-a.height,Math.abs(l-e)<=1);c++)n[n.length]=t[c+1],a.x+a.width>i&&(i=a.x+a.width);return i},t.prototype.getLayer=function(){var t;return this.diagram.snapSettings.constraints&ph.SnapToObject&&((t=document.createElementNS("http://www.w3.org/2000/svg","g")).setAttribute("id","_SnappingLines"),t.setAttribute("shapeRendering","crispEdges"),Me(this.diagram.element.id).appendChild(t)),t},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"Snapping"},t}(),$f=function(){function t(){this.groupUndo=!1,this.childTable=[]}return t.prototype.initHistory=function(t){t.historyList={canRedo:!1,canUndo:!1,currentEntry:null,push:t.addHistoryEntry.bind(t),undo:Function,redo:Function,startGroupAction:t.startGroupAction.bind(t),endGroupAction:t.endGroupAction.bind(t),canLog:null,undoStack:[],redoStack:[]}},t.prototype.addHistoryEntry=function(t,e){var i=null;e.historyList.canLog&&!0===e.historyList.canLog(t).cancel||(e.historyList&&e.historyList.canUndo&&e.historyList.currentEntry&&((i=e.historyList.currentEntry).next?i.previous&&(i.next.previous=null,i.next=t,t.previous=i):(i.next=t,t.previous=i)),e.historyList.currentEntry=t,this.getHistoryList(e),e.historyList.canUndo=!0,e.historyList.canRedo=!1)},t.prototype.undo=function(t){var e=this.getUndoEntry(t),i=0;e&&("Internal"===e.category?("EndGroup"===e.type?(i++,this.groupUndo=!0):this.undoEntry(e,t),this.groupUndo&&(this.undoGroupAction(e,t,i),this.groupUndo=!1)):t.historyList.undo(e))},t.prototype.getHistoryList=function(t){var e,i,n=[],o=[],r=t.historyList.currentEntry;for(r=t.historyList.currentEntry,t.historyList.canUndo||0===t.historyList.undoStack.length?this.getHistroyObject(n,r):this.getHistroyObject(o,r);r&&r.previous;)e=r.previous,this.getHistroyObject(n,e),r=r.previous;for(r=t.historyList.currentEntry;r&&r.next;)i=r.next,this.getHistroyObject(o,i),r=r.next;t.historyList.undoStack=n,t.historyList.redoStack=o},t.prototype.getHistroyObject=function(t,e){e&&"StartGroup"!==e.type&&"EndGroup"!==e.type&&t.push({redoObject:e.redoObject?e.redoObject:null,undoObject:e.undoObject?e.undoObject:null,type:e.type?e.type:null,category:e.category?e.category:null})},t.prototype.undoGroupAction=function(t,e,i){for(;0!==i;)this.undoEntry(t,e),"StartGroup"===(t=this.getUndoEntry(e)).type?i--:"EndGroup"===t.type&&i++;i=0},t.prototype.undoEntry=function(t,e){var i;if("PropertyChanged"!==t.type&&"CollectionChanged"!==t.type&&"LabelCollectionChanged"!==t.type&&(i=t.undoObject),"StartGroup"!==t.type&&"EndGroup"!==t.type&&e.historyList.undoStack.length>0){var n=e.historyList.undoStack.splice(0,1);e.historyList.redoStack.splice(0,0,n[0])}switch(e.protectPropertyChange(!0),e.diagramActions|=Lh.UndoRedo,t.type){case"PositionChanged":case"Align":case"Distribute":this.recordPositionChanged(i,e);break;case"SizeChanged":case"Sizing":this.recordSizeChanged(i,e,t);break;case"RotationChanged":this.recordRotationChanged(i,e,t);break;case"ConnectionChanged":this.recordConnectionChanged(i,e);break;case"PropertyChanged":this.recordPropertyChanged(t,e,!1);break;case"CollectionChanged":t.isUndo=!0,this.recordCollectionChanged(t,e),t.isUndo=!1;break;case"LabelCollectionChanged":t.isUndo=!0,this.recordLabelCollectionChanged(t,e),t.isUndo=!1;break;case"PortCollectionChanged":t.isUndo=!0,this.recordPortCollectionChanged(t,e),t.isUndo=!1;break;case"Group":this.unGroup(t,e);break;case"UnGroup":this.group(t,e);break;case"SegmentChanged":this.recordSegmentChanged(i,e)}e.diagramActions&=~Lh.UndoRedo,e.protectPropertyChange(!1),e.historyChangeTrigger(t)},t.prototype.group=function(t,e){e.add(t.undoObject)},t.prototype.unGroup=function(t,e){t.redoObject=ie(t.undoObject);var i=t.undoObject;e.commandHandler.unGroup(i)},t.prototype.ignoreProperty=function(t){return"zIndex"===t||"wrapper"===t},t.prototype.getProperty=function(t,e){for(var i=0,n=Object.keys(e);i<n.length;i++){var o=n[i];this.ignoreProperty(o)||(e[o]instanceof Object?this.getProperty(t[o],e[o]):t[o]=e[o])}},t.prototype.recordPropertyChanged=function(t,e,i){var n=t.redoObject,o=t.undoObject;this.getProperty(e,i?n:o),i?e.onPropertyChanged(n,o):e.onPropertyChanged(o,n),e.diagramActions=e.diagramActions|Lh.UndoRedo},t.prototype.recordSegmentChanged=function(t,e){var i,n=0;if(t.connectors&&t.connectors.length>0)for(n=0;n<t.connectors.length;n++)i=t.connectors[n],this.segmentChanged(i,e)},t.prototype.segmentChanged=function(t,e){var i=e.nameTable[t.id];i.segments=t.segments,e.commandHandler.updateEndPoint(i)},t.prototype.recordPositionChanged=function(t,e){var i,n,o=0;if(t.nodes&&t.nodes.length>0)for(o=0;o<t.nodes.length;o++)i=t.nodes[o],this.positionChanged(i,e);if(t.connectors&&t.connectors.length>0)for(o=0;o<t.connectors.length;o++)n=t.connectors[o],this.connectionChanged(n,e)},t.prototype.positionChanged=function(t,e,i){var n=e.nameTable[t.id];if(t.processId&&!n.processId&&e.addProcess(t,t.processId),!t.processId&&n.processId&&e.removeProcess(t.id),n.processId){var o=t.margin.left-n.margin.left,r=t.margin.top-n.margin.top;e.drag(n,o,r)}else{var o=t.offsetX-n.wrapper.offsetX,r=t.offsetY-n.wrapper.offsetY;e.drag(n,o,r)}e.bpmnModule&&e.bpmnModule.updateDocks(n,e)},t.prototype.recordSizeChanged=function(t,e,i){var n,o,r=0;if(t&&t.nodes&&t.nodes.length>0)for(r=0;r<t.nodes.length;r++)if((o=t.nodes[r]).children)for(var s=[],a=e.commandHandler.getAllDescendants(o,s),l=0;l<a.length;l++){var h=i.childTable[a[l].id];yp(h)===gp?(this.sizeChanged(h,e,i),this.positionChanged(h,e,i)):this.connectionChanged(h,e,i)}else this.sizeChanged(o,e),this.positionChanged(o,e);if(t&&t.connectors&&t.connectors.length>0){var c=t.connectors;for(r=0;r<c.length;r++)n=c[r],this.connectionChanged(n,e)}},t.prototype.sizeChanged=function(t,e,i){var n=e.nameTable[t.id],o=t.wrapper.actualSize.width/n.wrapper.actualSize.width,r=t.wrapper.actualSize.height/n.wrapper.actualSize.height;i&&i.childTable&&(i.childTable[t.id]=ie(n)),e.scale(n,o,r,{x:t.wrapper.offsetX/n.wrapper.offsetX,y:t.wrapper.offsetY/n.wrapper.offsetY})},t.prototype.recordRotationChanged=function(t,e,i){var n,o,r=0,s=e.selectedItems;if(s.rotateAngle=t.rotateAngle,s&&s.wrapper&&(s.wrapper.rotateAngle=t.rotateAngle),t&&t.nodes&&t.nodes.length>0)for(r=0;r<t.nodes.length;r++)n=t.nodes[r],this.rotationChanged(n,e),this.positionChanged(n,e);if(t&&t.connectors&&t.connectors.length>0)for(r=0;r<t.connectors.length;r++)o=t.connectors[r],this.connectionChanged(o,e)},t.prototype.rotationChanged=function(t,e){var i=e.nameTable[t.id];e.rotate(i,t.rotateAngle-i.rotateAngle)},t.prototype.recordConnectionChanged=function(t,e){var i=t.connectors[0];this.connectionChanged(i,e)},t.prototype.connectionChanged=function(t,e,i){var n=e.nameTable[t.id];t.sourcePortID!==n.sourcePortID&&(n.sourcePortID=t.sourcePortID,e.connectorPropertyChange(n,{},{sourcePortID:t.sourcePortID})),t.targetPortID!==n.targetPortID&&(n.targetPortID=t.targetPortID,e.connectorPropertyChange(n,{},{targetPortID:t.targetPortID})),t.sourceID!==n.sourceID&&(""===t.sourceID?ms(e.nameTable[n.sourceID].outEdges,t.id):e.nameTable[t.sourceID].outEdges.push(t.id),n.sourceID=t.sourceID,e.connectorPropertyChange(n,{},{sourceID:t.sourceID})),t.targetID!==n.targetID&&(""===t.targetID?ms(e.nameTable[n.targetID].inEdges,t.id):e.nameTable[t.targetID].inEdges.push(t.id),n.targetID=t.targetID,e.connectorPropertyChange(n,{},{targetID:t.targetID})),i&&i.childTable&&(i.childTable[t.id]=ie(n));var o=t.sourcePoint.x-n.sourcePoint.x,r=t.sourcePoint.y-n.sourcePoint.y;0===o&&0===r||e.dragSourceEnd(n,o,r);var s=t.targetPoint.x-n.targetPoint.x,a=t.targetPoint.y-n.targetPoint.y;0===s&&0===a||e.dragTargetEnd(n,s,a),e.updateSelector(),"SVG"!==e.mode&&e.refreshDiagramLayer()},t.prototype.recordCollectionChanged=function(t,e){var i=t.undoObject;if(t&&t.changeType){if("Remove"===(t.isUndo?"Insert"===t.changeType?"Remove":"Insert":t.changeType))e.remove(i),e.clearSelectorLayer();else{if(e.clearSelectorLayer(),i.parentId){var n=e.nameTable[i.parentId];n?e.addChild(n,i):e.add(i)}else e.add(i);i.processId&&e.nameTable[i.processId]&&e.addProcess(i,i.processId)}"SVG"!==e.mode&&e.refreshDiagramLayer()}},t.prototype.recordLabelCollectionChanged=function(t,e){var i=t.undoObject,n=t.redoObject,o=e.nameTable[n.id];if(t&&t.changeType){"Remove"===(t.isUndo?"Insert"===t.changeType?"Remove":"Insert":t.changeType)?(e.removeLabels(o,[i]),e.clearSelectorLayer()):(e.clearSelectorLayer(),e.addLabels(o,[i])),"SVG"!==e.mode&&e.refreshDiagramLayer()}},t.prototype.recordPortCollectionChanged=function(t,e){var i=t.undoObject,n=t.redoObject,o=e.nameTable[n.id];if(t&&t.changeType){"Remove"===(t.isUndo?"Insert"===t.changeType?"Remove":"Insert":t.changeType)?(e.removePorts(o,[i]),e.clearSelectorLayer()):(e.clearSelectorLayer(),e.addPorts(o,[i])),"SVG"!==e.mode&&e.refreshDiagramLayer()}},t.prototype.redo=function(t){var e=this.getRedoEntry(t),i=0;e&&("Internal"===e.category?("StartGroup"===e.type?(i++,this.groupUndo=!0):this.redoEntry(e,t),this.groupUndo&&(this.redoGroupAction(e,t,i),this.groupUndo=!1)):t.historyList.redo(e))},t.prototype.redoGroupAction=function(t,e,i){for(;0!==i;)this.redoEntry(t,e),"EndGroup"===(t=this.getRedoEntry(e)).type?i--:"StartGroup"===t.type&&i++;i=0},t.prototype.redoEntry=function(t,e){var i;if("PropertyChanged"!==t.type&&"CollectionChanged"!==t.type&&(i=t.redoObject),e.diagramActions|=Lh.UndoRedo,"StartGroup"!==t.type&&"EndGroup"!==t.type&&e.historyList.redoStack.length>0){var n=e.historyList.redoStack.splice(0,1);e.historyList.undoStack.splice(0,0,n[0])}switch(e.protectPropertyChange(!0),t.type){case"PositionChanged":case"Align":case"Distribute":this.recordPositionChanged(i,e);break;case"SizeChanged":case"Sizing":this.recordSizeChanged(i,e,t);break;case"RotationChanged":this.recordRotationChanged(i,e,t);break;case"ConnectionChanged":this.recordConnectionChanged(i,e);break;case"PropertyChanged":this.recordPropertyChanged(t,e,!0);break;case"CollectionChanged":this.recordCollectionChanged(t,e);break;case"LabelCollectionChanged":this.recordLabelCollectionChanged(t,e);break;case"PortCollectionChanged":this.recordPortCollectionChanged(t,e);break;case"Group":this.group(t,e);break;case"UnGroup":this.unGroup(t,e);break;case"SegmentChanged":this.recordSegmentChanged(i,e)}e.protectPropertyChange(!1),e.diagramActions&=~Lh.UndoRedo,e.historyChangeTrigger(t)},t.prototype.getUndoEntry=function(t){var e,i=null,n=t.historyList;return n.canUndo&&(i=n.currentEntry,(e=n.currentEntry.previous)?(n.currentEntry=e,n.canRedo||(n.canRedo=!0)):(n.canRedo=!0,n.canUndo=!1)),i},t.prototype.getRedoEntry=function(t){var e,i=null,n=t.historyList;return n.canRedo&&((e=n.currentEntry.previous||n.canUndo?n.currentEntry.next:n.currentEntry)&&(n.currentEntry=e,n.canUndo||(n.canUndo=!0),e.next||(n.canRedo=!1,n.canUndo=!0)),i=n.currentEntry),i},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"UndoRedo"},t}(),tv=function(){function t(){this.protectChange=!1}return t.prototype.expand=function(t,e,i,n){var o=this,r={},s=0;if(r[0]=setInterval(function(){return s++,o.layoutAnimation(e,r,6===s,n)},20),i.isExpanded){var a=.2;this.protectChange=n.isProtectedOnChange,n.protectPropertyChange(!1);var l={};this.updateOpacity(i,a,n),l[0]=setInterval(function(){a<=1?o.updateOpacity(i,a,n):clearInterval(l[0]),a+=.2},20)}},t.prototype.layoutAnimation=function(t,e,i,n){if(!i)for(var o=0;o<t.objects.length;o++){var r=n.nameTable[t.objects[o].id];r.offsetX+=t.objects[o].differenceX/5,r.offsetY+=t.objects[o].differenceY/5}i&&(clearInterval(e[0]),n.protectPropertyChange(this.protectChange),n.triggerEvent(Ph.animationComplete,void 0),this.protectChange=!1,n.organizationalChartModule.isAnimation=!1,n.layout.fixedNode="",n.protectPropertyChange(this.protectChange))},t.prototype.updateOpacity=function(t,e,i){for(var n=0;n<t.outEdges.length;n++){var o=i.nameTable[t.outEdges[n]],r=i.nameTable[o.targetID];o.style.opacity=e,i.updateDiagramObject(t);for(var s=0;s<o.wrapper.children.length;s++)o.wrapper.children[s].style.opacity=e,r.style.opacity=e,r.wrapper instanceof ic&&i.updateNodeProperty(r.wrapper,void 0,e);this.updateOpacity(r,e,i)}},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"LayoutAnimate"},t}(),ev=function(){function t(){this.isAnimation=!1}return t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"OrganizationalChart"},t.prototype.updateLayout=function(t,e,i,n,o){var r={type:i.type,nameTable:e,anchorX:0,anchorY:0,firstLevelNodes:[],centerNode:null,levels:[],maxLevel:0,graphNodes:{},orientation:i.orientation,horizontalSpacing:i.horizontalSpacing,verticalSpacing:i.verticalSpacing,verticalAlignment:i.verticalAlignment,horizontalAlignment:i.horizontalAlignment,fixedNode:i.fixedNode,getLayoutInfo:fe(i.getLayoutInfo),margin:i.margin,bounds:i.bounds,objects:[],root:i.root};return this.doLayout(r,t,n,o),r},t.prototype.doLayout=function(t,e,i,n){var o,r,s=[];for(t.nameTable[t.root]&&t.firstLevelNodes.push(t.nameTable[t.root]),r=0;r<e.length;r++)(o=e[r]).excludeFromLayout||((t.graphNodes[o.id]=this.setUpLayoutInfo(t,o)).tree.hasSubTree=!1,t.nameTable[t.root]||o.inEdges&&o.inEdges.length||(s.push(o),o.data&&String(o.data[n])===t.root&&t.firstLevelNodes.push(o)));for(0===t.firstLevelNodes.length&&(t.firstLevelNodes=s),r=0;r<t.firstLevelNodes.length;r++)o=t.firstLevelNodes[r],this.updateEdges(t,o,1);if(t.firstLevelNodes.length>0){t.rootNode=t.firstLevelNodes[0];var a=0,l=0,h=void 0,c=void 0,d=void 0,p=void 0,u=void 0;for(r=0;r<t.firstLevelNodes.length;r++){u=this.updateTree(t,a,l,t.firstLevelNodes[r],0,t.firstLevelNodes[r-1]);var g=t.graphNodes[t.firstLevelNodes[r].id];u.y=Math.min(u.y,g.y),u.x=Math.min(u.x,g.x),-1!==t.orientation.indexOf("Left")?l=u.right+t.horizontalSpacing:a=u.right+t.horizontalSpacing,0===r?(h=u.x,p=u.y,d=u.right,c=u.bottom):(h=Math.min(h,u.x),p=Math.min(p,u.y),d=Math.max(d,u.right),c=Math.max(c,u.bottom))}for(this.updateAnchor(t,{x:h,y:p,right:d,bottom:c},i),r=0;r<t.firstLevelNodes.length;r++)this.updateNodes(t,t.firstLevelNodes[r],0);for(r=0;r<t.firstLevelNodes.length;r++)this.updateConnectors(t,t.firstLevelNodes[r],1)}},t.prototype.getBounds=function(t){var e=t.offsetX-t.actualSize.width*t.pivot.x,i=t.offsetY-t.actualSize.height*t.pivot.y;return new ah(e,i,t.actualSize.width,t.actualSize.height)},t.prototype.updateTree=function(t,e,i,n,o,r,s){var a,l,h,c,d={};if(a=this.getDimensions(t,n,e,i,o),d=t.graphNodes[n.id],t.maxLevel=Math.max(t.maxLevel,o),l=o,(c=this.hasChild(t,n))||d.tree.assistants.length){var p=void 0,u=void 0,g=void 0,m=void 0,f=void 0,v=void 0,y=void 0;y=a.y+a.height+t.verticalSpacing,d.tree.assistants.length&&(l=(h=this.setDepthSpaceForAssitants(t,n,y,a.height,o,t.verticalSpacing)).level,y=h.bottom),d.tree.assistants.length||"Horizontal"===d.tree.orientation||(y=a.y+a.height+t.verticalSpacing/2),d.tree.children.length&&(p="Horizontal"!==d.tree.orientation||"Balanced"===d.tree.type&&1!==d.tree.children.length?"Balanced"===d.tree.type?this.updateHorizontalTreeWithMultipleRows(t,n,r,a.x,y,l):this.updateVerticalTree(t,n,a.x,y,l,s):this.updateHorizontalTree(t,n,r,a.x,y,l)),d.y&&d.y>a.y||(d.y=a.y),e&&e>d.mid||(e=d.mid),d.tree.assistants.length&&(v=void 0!==e?e:a.x,f=this.setBreadthSpaceForAssistants(t,n,a,v,y,o),c||(e=((g=p=f).x+g.right)/2-a.width/2,p=g),m=f?f.canMoveBy:void 0),d.x=e,d.translate||(d.treeWidth=p.right-p.x);var b={layout:t,shape:n,shapeBounds:u={x:e,y:a.y,right:e+a.width,bottom:a.y+a.height},treeBounds:p,dim:a,level:o};return this.translateSubTree(b,m,void 0!==r,s),d.firstChild&&"string"!=typeof d.firstChild&&(d.firstChild.x+=d.subTreeTranslation),n.treeBounds=p,p}return n.treeBounds=this.updateLeafNode(t,n,r,a,o,s),n.treeBounds},t.prototype.updateLeafNode=function(t,e,i,n,o,r){var s,a=t.graphNodes[e.id];a.x=n.x,a.y&&a.y>n.y||(a.y=n.y,a.maxLevel=Math.max(o,a.maxLevel||0)),s={x:n.x,y:n.y,right:n.x+n.width,bottom:n.y+n.height},a.maxLevel=Math.max(a.maxLevel||0,o);var l={layout:t,shape:e,shapeBounds:s,treeBounds:s,dim:n,level:o};return this.translateSubTree(l,void 0,void 0!==i,r),{x:a.x,y:a.y,right:a.x+n.width,bottom:a.y+n.height}},t.prototype.setUpLayoutInfo=function(t,e){var i={};return i.subTreeTranslation=0,"OrganizationalChart"===t.type?i.tree={orientation:"Vertical",type:"Alternate",offset:20,enableRouting:!0}:i.tree={orientation:"Horizontal",type:"Center",enableRouting:!0},i.tree.children=[],i.tree.assistants=[],i.tree.level=0,i.translate=!0,i},t.prototype.translateSubTree=function(t,e,i,n){var o=t.layout,r=t.shape,s=t.shapeBounds,a=t.treeBounds,l=t.level,h=t.dim,c=o.graphNodes[r.id],d=o.nameTable[c.firstChild?c.firstChild.child:c.tree.children[0]],p=d?o.graphNodes[d.id]:null,u=this.hasChild(o,r),g=this.findIntersectingLevels(o,s,l,c.actualLevel),m=this.findIntersectingLevels(o,a,l,c.actualLevel),f=[];g.length&&c.translate?(c.intersect=g,this.spaceLeftFromPrevSubTree(o,r,s),c.canMoveBy=c.diff,void 0!==e&&(c.canMoveBy=Math.min(e,c.canMoveBy)),d&&void 0!==p.canMoveBy&&(p.canMoveBy>=c.canMoveBy&&(c.translated=!0),c.canMoveBy=Math.min(c.canMoveBy,p.canMoveBy)),i&&(c.x-=c.canMoveBy,c.subTreeTranslation-=c.canMoveBy,u&&(this.shiftSubordinates(o,m,c.canMoveBy),a.x=Math.min(a.x,c.x),a.right=Math.max(a.right,c.x+h.width),a.bottom=Math.max(a.bottom,c.y+h.height),a.x-=c.canMoveBy,a.right-=c.canMoveBy),d&&p.canMoveBy>c.canMoveBy?c.canMoveBy=p.canMoveBy-c.canMoveBy:d&&void 0!==c.canMoveBy&&(c.canMoveBy=0))):(u&&(a.x=Math.min(a.x,s.x),a.right=Math.max(a.right,s.x+h.width),a.bottom=Math.max(a.bottom,c.y+h.height)),c.translate||(c.canMoveBy=0,c.subTreeTranslation=0)),n||(s={x:c.x,y:h.y,right:c.x+h.width,bottom:h.y+h.height},f.push({rBounds:s}),this.updateRearBounds(o,r,f,l))},t.prototype.updateRearBounds=function(t,e,i,n,o){var r,s,a,l,h,c,d=!0,p={};if(e&&(o=(p=t.graphNodes[e.id]).intersect,d=!p.tree.children.length&&!p.tree.assistants.length),l=i[0].rBounds,h=i[i.length-1].rBounds,o&&o.length){for(c=(r=t.levels[o[0]].rBounds).bottom,r.y<l.y&&(r.bottom=l.y,i.splice(0,0,{rBounds:r})),c>h.bottom?i.push({rBounds:{x:r.x,right:r.right,y:l.bottom,bottom:c}}):(r=t.levels[o[o.length-1]].rBounds,d&&r.bottom>h.bottom&&(r.y=h.bottom,i.push({rBounds:r}))),s=o[0],a=i.length-1;a>=0;a--)t.levels.splice(s,0,i[a]);s+=i.length,t.levels.splice(s,o.length)}else for(s=this.findLevel(t,i[i.length-1].rBounds,n),a=i.length-1;a>=0;a--)t.levels.splice(s,0,i[a])},t.prototype.shiftSubordinates=function(t,e,i){var n;if(0!==i)for(n=0;n<e.length;n++)t.levels[e[n]].rBounds&&(t.levels[e[n]].rBounds.x-=i,t.levels[e[n]].rBounds.right-=i)},t.prototype.setDepthSpaceForAssitants=function(t,e,i,n,o,r){var s,a,l,h,c=t.graphNodes[e.id],d={};for(h=i,a=0;a<c.tree.assistants.length;a++)(d=t.graphNodes[c.tree.assistants[a]])&&(d.tree.children=d.tree.assistants=[],d.y=i,s=(l=t.nameTable[c.tree.assistants[a]]).actualSize.height,-1!==t.orientation.indexOf("Left")&&(s=l.actualSize.width),h=i+s+r/2,t.maxLevel=o+1,a%2==1&&a!==c.tree.assistants.length-1&&(i=h,o++));return{level:t.maxLevel,bottom:i+s+r}},t.prototype.setBreadthSpaceForAssistants=function(t,e,i,n,o,r){var s,a,l,h,c,d,p,u,g={},m=t.graphNodes[e.id],f=r;for(h=0;h<m.tree.assistants.length;h++)(g=t.graphNodes[m.tree.assistants[h]])&&(s=(l=t.nameTable[m.tree.assistants[h]]).actualSize.width,-1!==t.orientation.indexOf("Left")&&(s=l.actualSize.height),c=h%2==0?n+i.width/2-20-s:n+i.width/2+20,a=this.updateTree(t,c,g.y,t.nameTable[m.tree.assistants[h]],f+1),this.hasChild(t,e)||(0===h?u=a:this.uniteRects(u,a)),h%2==0&&g.prevBounds&&(d=void 0===d?g.canMoveBy:Math.min(d,g.canMoveBy)),h%2!=1&&h!==m.tree.assistants.length-1||(p=this.findIntersectingLevels(t,a,f+1),this.updateRearBounds(t,null,[{rBounds:a}],f+1,p),f++));return u&&(u.canMoveBy=d),u},t.prototype.getDimensions=function(t,e,i,n,o){var r;r=e.actualSize.width;var s;if(s=e.actualSize.height,-1!==t.orientation.indexOf("Left")){if(!o){var a=void 0;a=i,i=n,n=a}s=e.actualSize.width,r=e.actualSize.height}return{x:i,y:n,width:r,height:s}},t.prototype.hasChild=function(t,e){var i=t.graphNodes[e.id];return i.tree.children&&i.tree.children.length},t.prototype.updateHorizontalTree=function(t,e,i,n,o,r){var s;s=this.getDimensions(t,e,n,o,r);var a,l={},h=(l=t.graphNodes[e.id]).tree.type;a=r;var c=0;c=n;var d;d=o;var p,u,g,m,f,v,y,b,w,x,S,C,L,E;if(t.levels.slice(0,t.levels.length),this.hasChild(t,e)){var P=void 0;for(P=-1!==t.orientation.indexOf("Left"),C=0;C<l.tree.children.length;C++){if(g=t.nameTable[l.tree.children[C]],p=g.actualSize.width,u=g.actualSize.height,f=P?u:p,v=P?p:u,t.levels[a+1]?t.levels[a+1].rBounds:null,m=this.updateTree(t,c,d,g,a+1,t.nameTable[l.tree.children[C-1]]),L=t.graphNodes[g.id],l.maxLevel=Math.max(l.maxLevel||0,L.maxLevel||0),b={x:L.x,y:L.y,right:L.x+f,bottom:L.y+v},0===C&&(y={x:Math.min(L.x,m.x),y:Math.min(L.y,m.y),right:m.right,bottom:m.bottom},E=L),S?(S.x=b.x,S.y=b.y,b.right>S.right&&(S.right=b.right),S.bottom=b.bottom):S=b,0===C&&(l.firstChild={x:L.x,canMoveBy:L.canMoveBy,child:g.id}),this.hasChild(t,g))if(!l.firstChild||l.firstChild.x>=L.firstChild.x){L.firstChild&&l.firstChild.canMoveBy<L.canMoveBy&&(l.firstChild.canMoveBy=x,L.canMoveBy=x,x=l.firstChild.canMoveBy,t.graphNodes[l.firstChild.child].canMoveBy=x);var k=void 0!==x?x:L.canMoveBy;l.firstChild={x:L.firstChild.x,canMoveBy:k,child:g.id}}else L.firstChild&&L.translated&&l.firstChild.canMoveBy>L.canMoveBy&&(l.firstChild.canMoveBy=t.graphNodes[l.firstChild.child].canMoveBy=L.canMoveBy);w=w?Math.max(L.maxLevel,w):L.maxLevel,this.uniteRects(y,m),c=0!==C&&!this.hasChild(t,g)&&L.subTreeTranslation<0?m.right-L.subTreeTranslation+t.horizontalSpacing:m.right+t.horizontalSpacing}isNaN(void 0)||(E.canMoveBy=void 0),l.mid=(E.x+S.right)/2-s.width/2,"Left"===h?l.mid=b.right-s.width:"Right"===h&&(l.mid=n)}return y},t.prototype.updateHorizontalTreeWithMultipleRows=function(t,e,i,n,o,r){var s,a,l,h,c,d,p,u,g,m,f,v=this.getDimensions(t,e,n,o,r),y=t.graphNodes[e.id],b=(y.tree.type,r),w=n,x=o,S=(t.levels.slice(0,t.levels.length),0);if(this.hasChild(t,e)){var C=-1!==t.orientation.indexOf("Left"),L=void 0,E=this.splitChildrenInRows(t,e),P=5===y.tree.children.length&&3===E[0].length,k=[],T=[];P?T=E:this.splitRows(E,k,T);var O={leftTree:k,rows:E,rightTree:T,dimensions:v},I=this.updateLeftTree(t,O,e,n,x,b);c=O.bounds;var A=void 0,M=(I||0)+(void 0!==I?t.horizontalSpacing/2:0);void 0!==I&&(y.mid=M-v.width/2,A=I+t.horizontalSpacing),x=o;var R=void 0;for(R=[],g=0;g<T.length;g++)for(w=E[g].length%2==1&&g===T.length-1||P?n:A||n,0!==g&&(x=R[g-1].bottom+t.verticalSpacing),u=0;u<T[g].length;u++)d=(s=t.nameTable[T[g][u]]).actualSize.width,p=s.actualSize.height,h=C?p:d,(a=t.graphNodes[s.id]).actualLevel=b+1+g,0===u&&k[g]&&k[g].length&&(a.translate=!1),P&&1===g&&(0===u&&m+h+t.horizontalSpacing<=f&&(L=!0,w=m-h/2),L&&1===u&&(w=f-h/2)),l=this.updateTree(t,w,x,s,b+1,t.nameTable[T[g][u-1]]),P&&u<=2&&0===g&&1===u&&(m=l.x-t.horizontalSpacing/2,f=l.x+h+t.horizontalSpacing/2),0===u?R[g]={x:l.x,y:l.y,right:l.right,bottom:l.bottom}:this.uniteRects(R[g],l),c||(c={x:R[g].x,y:R[g].y,right:R[g].right,bottom:R[g].bottom}),this.uniteRects(c,R[g]),w=l.right+t.horizontalSpacing,(!y.firstChild||(g===T.length-1&&E[g].length%2==1||P)&&0===u&&void 0!==a.canMoveBy&&S>a.canMoveBy)&&(S=Math.min(S,a.canMoveBy||0),y.firstChild={x:a.x,child:s.id,canMoveBy:a.canMoveBy}),O.leftCenter=m,O.rightCenter=f,O.align=L,O.level=b,O.rightBounds=R,this.alignRowsToCenter(t,g,e,O,A)}return c},t.prototype.updateLeftTree=function(t,e,i,n,o,r){for(var s,a,l,h,c,d=e.leftTree,p=t.graphNodes[i.id],u=[],g=-1!==t.orientation.indexOf("Left"),m=0;m<d.length&&d[m].length;m++){s=n,u[m-1]&&(o=u[m-1].bottom+t.verticalSpacing);for(b=0;b<d[m].length;b++){var f=t.nameTable[d[m][b]],v=(g?f.actualSize.height:f.actualSize.width,g?f.actualSize.width:f.actualSize.height,t.graphNodes[f.id]);v.actualLevel=r+1+m,h=this.updateTree(t,s,o,f,r+1,t.nameTable[d[m][b-1]]),0===b?u[m]={x:h.x,y:h.y,right:h.right,bottom:h.bottom}:this.uniteRects(u[m],h),0===m&&0===b?(a=v.canMoveBy,p.firstChild={x:v.x,child:f.id,canMoveBy:v.canMoveBy}):0===b&&void 0!==v.canMoveBy&&a>v.canMoveBy&&(a=Math.min(a,v.canMoveBy||0),p.firstChild={x:v.x,child:f.id,canMoveBy:v.canMoveBy}),s=h.right+t.horizontalSpacing}l=0===m?u[m].right:Math.max(l,u[m].right)}for(m=0;m<d.length&&d[m].length;m++){if(l!==u[m].right)for(var y=l-u[m].right,b=0;b<d[m].length;b++){t.nameTable[d[m][b]];t.graphNodes[d[m][b]].x+=y}0===m?c={x:u[0].x,y:u[0].y,right:u[0].right,bottom:u[0].bottom}:this.uniteRects(c,u[m])}return e.bounds=c,l},t.prototype.alignRowsToCenter=function(t,e,i,n,o){var r,s,a,l=t.graphNodes[i.id],h=n.rows,c=n.rightTree,d=n.leftCenter,p=n.rightCenter,u=n.align,g=n.rightBounds,m=n.dimensions,f=n.level,v=5===l.tree.children.length&&3===h[0].length;if(v&&1===e&&(r=g[0].right-g[0].x>=g[1].right-g[1].x?0:1),e===h.length-1&&(h[e].length%2==1||v&&1===e)){s=c[e][Math.floor(c[e].length/2)];var y=void 0;y=t.nameTable[s];var b=void 0,w=t.graphNodes[s].x,x=t.graphNodes[s].y;b=this.getDimensions(t,y,w,x,f+1),a=void 0,!u&&v?(1===r&&(e=0),a=(g[r].x+g[r].right)/2-(g[e].x+g[e].right)/2,0===e&&(l.mid+=a)):v||void 0===o||(a=o-t.horizontalSpacing/2-(w+b.width/2)),void 0!==a&&this.updateRearBoundsOfTree(t,c[e],a,m),v&&(l.mid=(p+d)/2+(0===e?a:0)-m.width/2),void 0===l.mid&&t.graphNodes[s]&&(l.mid=w),u=!1,e++}},t.prototype.updateRearBoundsOfTree=function(t,e,i,n){for(var o=0;o<e.length;o++){var r=t.graphNodes[e[o]];t.nameTable[e[o]];if(r.x+=i,r.canMoveBy+=i,o===e.length-1){var s={x:r.x,y:r.y,right:r.x+n.width,bottom:r.y+n.height},a=this.findIntersectingLevels(t,s,r.actualLevel);this.updateRearBounds(t,null,[{rBounds:s}],r.actualLevel,a)}}},t.prototype.splitRows=function(t,e,i){for(var n=0;n<t.length;n++){e[n]=[],i[n]=[];var o=void 0;if(o=t[n].length,t[n].length%2!=1){o=Math.ceil(t[n].length/2);for(var r=0;r<o;r++)e[n].push(t[n][r])}for(var s=e[n].length;s<t[n].length;s++)i[n].push(t[n][s])}},t.prototype.updateVerticalTree=function(t,e,i,n,o,r){this.getDimensions(t,e,i,n,o);var s,a,l,h,c,d,p,u,g,m,f,v=t.graphNodes[e.id],y=t.nameTable[v.tree.children[0]],b=-1!==t.orientation.indexOf("Left"),w="Left"===v.tree.type?-1:0,x=i,S=n;f=o;var C,L,E,P,k=[],T=[];for(C=0;C<v.tree.children.length;C++){if("Alternate"===v.tree.type&&(E=C%2==0&&v.tree.children.length>2?"Left":"Right",w=C%2==0&&v.tree.children.length>2?-1:0),x=i+this.findOffset(t,e,v,E),s=t.nameTable[v.tree.children[C]],h=b?s.actualSize.height:s.actualSize.width,c=b?s.actualSize.width:s.actualSize.height,l=this.updateTree(t,x+w*h,S,s,o+1,void 0,!0),a=t.graphNodes[s.id],u={x:a.x,y:a.y,right:a.x+h,bottom:a.y+c},0===C?(this.uniteRects(l,u),p=l):this.uniteRects(p,l),!a.prevBounds||"Alternate"===v.tree.type&&C%2==1&&v.tree.children.length>2||(P=void 0!==P?Math.min(a.canMoveBy,P):a.canMoveBy),v.maxLevel=Math.max(v.maxLevel||0,a.maxLevel||0),"Alternate"===v.tree.type&&v.tree.children.length>2&&C%2==0?(0!==C&&(S=d.bottom+t.verticalSpacing/2),T.push({rBounds:u}),a.levelBounds&&(T=T.concat(a.levelBounds))):(S="Alternate"===v.tree.type&&v.tree.children.length>2?Math.max(l.bottom,d.bottom)+t.verticalSpacing/2:l.bottom+t.verticalSpacing/2,o=v.maxLevel,k.push({rBounds:u}),m?this.uniteRects(m,u):m={x:a.x,y:a.y,right:a.x+h,bottom:a.y+c},a.levelBounds&&(k=k.concat(a.levelBounds))),0===C&&(v.firstChild={x:a.x,canMoveBy:a.canMoveBy,child:s.id}),this.hasChild(t,s))if(!v.firstChild||v.firstChild.x>=a.firstChild.x){if(a.firstChild&&v.firstChild.canMoveBy<a.canMoveBy){var O=v.firstChild.canMoveBy;a.canMoveBy=O,t.graphNodes[v.firstChild.child].canMoveBy=O,v.firstChild.canMoveBy=O}v.firstChild={x:a.firstChild.x,canMoveBy:void 0!==P?P:a.canMoveBy,child:s.id}}else a.firstChild&&a.translated&&v.firstChild.canMoveBy>a.canMoveBy&&(v.firstChild.canMoveBy=t.graphNodes[v.firstChild.child].canMoveBy=a.canMoveBy);d=u}return r?v.levelBounds=k:("Alternate"===v.tree.type&&v.tree.children.length>2&&(g={x:T[0].rBounds.x,y:T[0].rBounds.y,right:T[T.length-1].rBounds.right,bottom:T[T.length-1].rBounds.bottom},L=this.findIntersectingLevels(t,g,f+1),this.updateRearBounds(t,null,T,f+1,L)),L=this.findIntersectingLevels(t,m||p,f+1),this.updateRearBounds(t,null,m?k:[{rBounds:p}],f+1,L)),isNaN(P)||(t.graphNodes[y.id].canMoveBy=P),v.childBounds=p,v.mid=i,p},t.prototype.splitChildrenInRows=function(t,e){var i,n;n=4;var o,r=[];o=(i=t.graphNodes[e.id]).tree.children.length;var s=this.extend(i.tree.children);if(i.tree.rows){var a=void 0;a=i.tree.children.length;var l=void 0;n=(l=Math.ceil(a/i.tree.rows))%2==0?l:l+1}else 3===i.tree.children.length||4===i.tree.children.length?n=2:5===i.tree.children.length&&(n=3);for(;o>0;)r[r.length]=s.splice(0,n),(o-=n)<n&&(n=o);return r},t.prototype.extend=function(t){var e,i=[];for(e=0;e<t.length;e++)i[e]=t[e];return i},t.prototype.findOffset=function(t,e,i,n){var o=0,r=-1!==t.orientation.indexOf("Left")?e.actualSize.height:e.actualSize.width,s=n||i.tree.type;switch(o=i.tree.offset||20,"Alternate"===i.tree.type&&o>=t.horizontalSpacing&&(o=t.horizontalSpacing/2),s){case"Left":o=r/2-o;break;case"Right":o+=r/2}return o},t.prototype.uniteRects=function(t,e){t.x=Math.min(t.x,e.x),t.right=Math.max(t.right,e.right),t.bottom=Math.max(t.bottom,e.bottom)},t.prototype.spaceLeftFromPrevSubTree=function(t,e,i){var n;n=t.graphNodes[e.id];var o,r,s,a;for(a=t.horizontalSpacing,s=0;s<n.intersect.length;s++)r=t.levels[n.intersect[s]].rBounds,o=i.x-(r.right+a),(void 0===n.diff||o<n.diff)&&(n.diff=o,n.prevBounds=t.levels[n.intersect[s]].rBounds)},t.prototype.findIntersectingLevels=function(t,e,i,n){var o;(o={x:e.x,y:e.y,right:e.right,bottom:e.bottom}).y-=t.verticalSpacing/2,o.bottom+=t.verticalSpacing/2;var r;r=[];var s,a;a=void 0!==n?n:i,s=t.levels[a]?t.levels[a].rBounds:null;do{if(s&&(o.y<s.y&&o.bottom>s.y||o.y<s.bottom&&s.bottom<o.bottom||o.y>=s.y&&o.bottom<=s.bottom||o.y<s.y&&o.bottom>s.bottom)){r.splice(0,0,a)}else if(s&&s.bottom<o.y)break;a--,s=t.levels[a]?t.levels[a].rBounds:null}while(a>=0);a=(void 0!==n?n:i)+1,s=t.levels[a]?t.levels[a].rBounds:null;do{if(s&&(o.y<s.y&&o.bottom>s.y||o.y<s.bottom&&s.bottom<o.bottom||o.y>=s.y&&o.bottom<=s.bottom||o.y<s.y&&o.bottom>s.bottom))r.push(a);else if(s&&s.y>o.bottom)break;a++,s=t.levels[a]?t.levels[a].rBounds:null}while(a<=t.levels.length);return r},t.prototype.findLevel=function(t,e,i){var n;n=e;var o;o=0;var r;for(r=t.levels[o]?t.levels[o].rBounds:null;o<t.levels.length;){if(r&&n.bottom<r.y)return o;o++,r=t.levels[o]?t.levels[o].rBounds:null}return o},t.prototype.getParentNode=function(t,e){return t.nameTable[t.nameTable[e.inEdges[0]].sourceID]},t.prototype.updateEdges=function(t,e,i){var n;n=t.graphNodes[e.id];var o;if(e.outEdges&&e.outEdges.length&&e.isExpanded)for(o=0;o<e.outEdges.length;o++){var r=void 0;(r=t.nameTable[t.nameTable[e.outEdges[o]].targetID]).excludeFromLayout||(-1===n.tree.children.indexOf(r.id)&&n.tree.children.push(r.id),r.outEdges&&r.outEdges.length&&r.isExpanded&&(n.tree.hasSubTree=!0),this.updateEdges(t,r,i+1))}n.tree.level=i,n.tree.hasSubTree&&(n.tree.orientation="Horizontal",n.tree.type="Center"),t.getLayoutInfo&&"OrganizationalChart"===t.type&&(t.getLayoutInfo(e,n.tree),"Balanced"===n.tree.type&&n.tree.hasSubTree&&(n.tree.type="Center",n.tree.orientation="Horizontal")),t.level&&"Alternate"!==n.tree.type&&i>=t.level&&(n.tree.hasSubTree=!1)},t.prototype.updateAnchor=function(t,e,i){var n,o,r,s=0,a=0,l=0,h=new ah(0,0,i.x,i.y);r=t.bounds?t.bounds:h;var c=t.orientation;if(t.fixedNode){s=(o=t.nameTable[t.fixedNode]).actualSize.width,a=o.actualSize.height,t.anchorX=o.offsetX,t.anchorY=o.offsetY;var d=o.pivot;for(t.anchorX+="RightToLeft"===t.orientation?s*d.x:-s*d.x,t.anchorY+="BottomToTop"===t.orientation?a*d.y:-a*d.y,n=o,l=0;n.inEdges.length;)n=this.getParentNode(t,n),l+=t.graphNodes[n.id].subTreeTranslation||0;-1!==t.orientation.indexOf("Left")?(t.anchorX-=t.graphNodes[o.id].y,t.anchorY-=t.graphNodes[o.id].x+l):(t.anchorX-=t.graphNodes[o.id].x+l,t.anchorY-=t.graphNodes[o.id].y)}else if("TopToBottom"===c||"BottomToTop"===c){switch(t.horizontalAlignment){case"Left":t.anchorX=r.x-e.x+t.margin.left;break;case"Right":t.anchorX=r.x+r.width-t.margin.right-e.right;break;case"Auto":case"Center":t.anchorX=r.x+r.width/2-(e.x+e.right)/2}switch(t.verticalAlignment){case"Auto":case"Top":var p;p=r.y+t.margin.top,t.anchorY="TopToBottom"===c?p:e.bottom+p;break;case"Bottom":var u=void 0;u=r.y+r.height-t.margin.bottom,t.anchorY="TopToBottom"===c?u-e.bottom:u;break;case"Center":f=void 0;f=r.y+r.height/2,t.anchorY="TopToBottom"===t.orientation?f-(e.y+e.bottom)/2:f+(e.y+e.bottom)/2}}else{switch(t.horizontalAlignment){case"Auto":case"Left":var g=void 0;g=r.x+t.margin.left,t.anchorX="LeftToRight"===c?g:e.bottom+g;break;case"Right":var m=void 0;m=r.x+r.width-t.margin.right,t.anchorX="LeftToRight"===c?m-e.bottom:m;break;case"Center":var f=void 0;f=r.width/2+r.x,t.anchorX="LeftToRight"===t.orientation?f-(e.y+e.bottom)/2:f+(e.y+e.bottom)/2}switch(t.verticalAlignment){case"Top":t.anchorY=r.y+t.margin.top-e.x;break;case"Auto":case"Center":t.anchorY=r.y+r.height/2-(e.right+e.x)/2;break;case"Bottom":t.anchorY=r.y+r.height-t.margin.bottom-e.right}}},t.prototype.updateConnectors=function(t,e,i){var n,o,r,s;if(o=t.graphNodes[e.id],e.outEdges.length)for(n=0;n<e.outEdges.length;n++)(s=t.nameTable[e.outEdges[n]]).points=[],r=t.nameTable[s.targetID],s.visible&&(s.visited=!0,t.getConnectorSegments?t.getConnectorSegments(s):o&&-1!==o.tree.children.indexOf(s.targetID)&&(s.segments=[],"OrganizationalChart"===t.type&&"Orthogonal"===s.type&&this.updateSegments(t,s,e,r,n)),r&&(r.isExpanded||this.hasChild(t,r))&&this.updateConnectors(t,r,i+1));if(o&&o.tree.assistants.length)for(n=0;n<o.tree.assistants.length;n++)r=t.nameTable[o.tree.assistants[n]],s=t.nameTable[r.inEdges[0]],this.get3Points(t,e,r,s),(r.isExpanded||this.hasChild(t,r))&&this.updateConnectors(t,r,i+1)},t.prototype.updateSegments=function(t,e,i,n,o){var r=t.graphNodes[i.id];r.tree.assistants.length?this.updateSegmentsForHorizontalOrientation(t,i,n,e):"Horizontal"===r.tree.orientation&&"Balanced"===r.tree.type?this.updateSegmentsForBalancedTree(t,e,i,n,o):"Horizontal"===r.tree.orientation?this.updateSegmentsForHorizontalOrientation(t,i,n,e):r.tree.offset<5?this.get5Points(t,i,n,e):this.get3Points(t,i,n,e)},t.prototype.updateSegmentsForBalancedTree=function(t,e,i,n,o){var r,s=t.graphNodes[i.id];if(5===s.tree.children.length&&o>2){r=s.tree.children[1],isNaN(t.graphNodes[r].treeWidth)&&(t.graphNodes[r].treeWidth=t.nameTable[r].actualSize.width);var a=3!==o?1:-1;-1!==t.orientation.indexOf("Left")?t.nameTable[r].offsetY-t.graphNodes[r].treeWidth/2-t.verticalSpacing*a/2:t.nameTable[r].offsetX+t.graphNodes[r].treeWidth/2+t.horizontalSpacing*a/2,this.getSegmentsForMultipleRows(t,i,n,e)}else s.tree.children.length>5?o<4?this.getSegmentsForMultipleRows(t,i,n,e):this.updateSegmentsForHorizontalOrientation(t,i,n,e):4===s.tree.children.length?o<2?this.getSegmentsForMultipleRows(t,i,n,e):this.updateSegmentsForHorizontalOrientation(t,i,n,e):this.getSegmentsForMultipleRows(t,i,n,e)},t.prototype.get3Points=function(t,e,i,n){var o=[],r=this.getBounds(e),s=this.getBounds(i);if(-1!==t.orientation.indexOf("Top")){var a=0===t.orientation.indexOf("Top")?r.bottomCenter:r.topCenter,l=e.offsetX>i.offsetX?s.middleRight:s.middleLeft;o.push(a,{x:r.bottomCenter.x,y:l.y},l)}else{var a=0===t.orientation.indexOf("Left")?r.middleRight:r.middleLeft,l=e.offsetY>i.offsetY?s.bottomCenter:s.topCenter;o.push(a,{x:s.bottomCenter.x,y:r.middleRight.y},l)}this.getSegmentsFromPoints(o,n)},t.prototype.get5Points=function(t,e,i,n){var o=[],r=this.getBounds(e),s=this.getBounds(i);t.graphNodes[e.id];e.offsetX>i.offsetX?o.push(r.bottomCenter,{x:r.bottomCenter.x,y:r.bottomCenter.y+t.verticalSpacing/4},{x:s.middleRight.x+t.horizontalSpacing/2,y:r.bottomCenter.y+t.verticalSpacing/4},{x:s.middleRight.x+t.horizontalSpacing/2,y:s.middleRight.y},s.middleRight):o.push(r.bottomCenter,{x:r.bottomCenter.x,y:r.bottomCenter.y+t.verticalSpacing/4},{x:s.middleLeft.x-t.horizontalSpacing/2,y:r.bottomCenter.y+t.verticalSpacing/4},{x:s.middleLeft.x-t.horizontalSpacing/2,y:s.middleLeft.y},s.middleLeft),this.getSegmentsFromPoints(o,n)},t.prototype.getSegmentsFromPoints=function(t,e){for(var i,n=[],o=0;o<t.length-2;o++)(i=new jd(e,"segments",{type:"Orthogonal"},!0)).direction=sh.direction(t[o],t[o+1]),i.length=sh.distancePoints(t[o],t[o+1]),n.push(i);e.segments=n},t.prototype.getSegmentsForMultipleRows=function(t,e,i,n){var o,r,s=[],a=this.getBounds(i),l=this.getBounds(e);switch(t.orientation){case"TopToBottom":o={x:l.bottomCenter.x,y:l.bottomCenter.y+t.verticalSpacing/4},(r=new jd(n,"segments",{type:"Orthogonal"},!0)).direction=sh.direction(l.bottomCenter,o),r.length=sh.distancePoints(l.bottomCenter,o),s.push(r);break;case"BottomToTop":o={x:l.bottomCenter.x,y:l.topCenter.y-t.verticalSpacing/4},(r=new jd(n,"segments",{type:"Orthogonal"},!0)).direction=sh.direction(l.topCenter,o),r.length=sh.distancePoints(l.topCenter,o),s.push(r);break;case"LeftToRight":if(o={x:l.middleRight.x+t.verticalSpacing/4,y:l.middleRight.y},r=new jd(n,"segments",{type:"Orthogonal"},!0),r.direction=sh.direction(l.middleRight,o),r.length=sh.distancePoints(l.middleRight,o),s.push(r),a.center.y!==l.center.y){var h={x:l.middleRight.x+t.verticalSpacing/4,y:a.middleLeft.y};(r=new jd(n,"segments",{type:"Orthogonal"},!0)).direction=sh.direction(o,h),r.length=sh.distancePoints(o,h),s.push(r)}break;case"RightToLeft":if(o={x:l.middleLeft.x-t.verticalSpacing/4,y:l.middleRight.y},r=new jd(n,"segments",{type:"Orthogonal"},!0),r.direction=sh.direction(l.middleLeft,o),r.length=sh.distancePoints(l.middleLeft,o),s.push(r),a.center.y!==l.center.y){var c={x:l.middleLeft.x-t.verticalSpacing/4,y:a.middleLeft.y};(r=new jd(n,"segments",{type:"Orthogonal"},!0)).direction=sh.direction(c,c),r.length=sh.distancePoints(c,c),s.push(r)}}n.segments=s},t.prototype.updateSegmentsForHorizontalOrientation=function(t,e,i,n){var o,r,s=[],a=[],l=this.getBounds(e),h=this.getBounds(i);switch(t.orientation){case"TopToBottom":o={x:l.bottomCenter.x,y:h.topCenter.y-t.verticalSpacing/2},(r=new jd(n,"segments",{type:"Orthogonal"},!0)).direction=sh.direction(l.bottomCenter,o),r.length=sh.distancePoints(l.bottomCenter,o),a.push(r);break;case"BottomToTop":o={x:l.topCenter.x,y:h.bottomCenter.y+t.verticalSpacing/2},(r=new jd(n,"segments",{type:"Orthogonal"},!0)).direction=sh.direction(l.topCenter,o),r.length=sh.distancePoints(l.topCenter,o),a.push(r);break;case"LeftToRight":if(o={x:h.middleLeft.x-t.verticalSpacing/2,y:l.middleRight.y},r=new jd(n,"segments",{type:"Orthogonal"},!0),r.direction=sh.direction(l.middleRight,o),r.length=sh.distancePoints(l.middleRight,o),a.push(r),h.center.y!==l.center.y){var c={x:h.middleLeft.x-t.verticalSpacing/2,y:h.middleLeft.y};(r=new jd(n,"segments",{type:"Orthogonal"},!0)).direction=sh.direction(o,c),r.length=sh.distancePoints(o,c),a.push(r)}break;case"RightToLeft":if(o={x:h.middleRight.x+t.verticalSpacing/2,y:l.middleRight.y},r=new jd(n,"segments",{type:"Orthogonal"},!0),r.direction=sh.direction(l.middleLeft,o),r.length=sh.distancePoints(l.middleLeft,o),a.push(r),h.center.y!==l.center.y){var d={x:h.middleRight.x+t.verticalSpacing/2,y:h.middleLeft.y};(r=new jd(n,"segments",{type:"Orthogonal"},!0)).direction=sh.direction(o,d),r.length=sh.distancePoints(o,d),a.push(r)}}return n.segments=a,s},t.prototype.updateNodes=function(t,e,i,n,o,r){var s,a,l,h,c,d;if(l=e.actualSize.width,h=e.actualSize.height,!e.excludeFromLayout){c=t.anchorX,d=t.anchorY,"LeftToRight"===t.orientation?(c+=t.graphNodes[e.id].y+l/2,d+=t.graphNodes[e.id].x+i+h/2):"RightToLeft"===t.orientation?(c-=t.graphNodes[e.id].y+l/2,d+=t.graphNodes[e.id].x+i+h/2):"TopToBottom"===t.orientation?(c+=t.graphNodes[e.id].x+i+l/2,d+=t.graphNodes[e.id].y+h/2):(c+=t.graphNodes[e.id].x+i+l/2,d-=t.graphNodes[e.id].y+h/2),t.graphNodes&&(c+=o=o||0,d+=r=r||0,this.isAnimation||(e.offsetX=c,e.offsetY=d));var p={id:e.id,differenceX:c-e.offsetX,differenceY:d-e.offsetY};t.objects.push(p);var u=void 0;if(u=[],this.hasChild(t,e))for(s=0;s<t.graphNodes[e.id].tree.children.length;s++)a=t.nameTable[t.graphNodes[e.id].tree.children[s]],this.updateNodes(t,a,i+(t.graphNodes[e.id].subTreeTranslation||0),n,o,r),u.push(a);if(t.graphNodes[e.id].tree.assistants.length)for(s=0;s<t.graphNodes[e.id].tree.assistants.length;s++)a=t.nameTable[t.graphNodes[e.id].tree.assistants[s]],this.updateNodes(t,a,i+(t.graphNodes[e.id].subTreeTranslation||0),null,o,r)}},t}(),iv=function(){function t(){this.isAnimation=!1}return t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"MindMapChart"},t.prototype.updateLayout=function(t,e,i,n,o,r){var s;if(s=this.checkRoot(t,i,o,r,e))i.fixedNode=s;else for(var a=0,l=t;a<l.length;a++)if(!((f=l[a]).excludeFromLayout||f.inEdges&&f.inEdges.length)){i.fixedNode=f.id;break}var h=e[i.fixedNode],c=this.findFirstLevelNodes(h,i,e),d=[],p=[],u=fe(i.getBranch);u=u||fe(this.getBranch);for(var g=0,m=c;g<m.length;g++){var f=m[g];"Left"===u(f,c)?d.push(f):p.push(f)}var v=new ah(0,0,n.x,n.y);e[i.fixedNode].offsetX=v.x+v.width/2,e[i.fixedNode].offsetY=v.y+v.height/2,d.length&&this.updateMindMapBranch(t,p,e,i,n,o,"Left"),p.length&&this.updateMindMapBranch(t,d,e,i,n,o,"Right")},t.prototype.checkRoot=function(t,e,i,n,o){for(var r=0,s=t;r<s.length;r++){var a=s[r];if(!a.excludeFromLayout){if(a.data&&(a.data[i].toString()===n||a.data[i].toString()===e.root))return a.id;if(!a.data&&a.id===e.root)return a.id}}return""},t.prototype.updateMindMapBranch=function(t,e,i,n,o,r,s){var a;(a={type:"HierarchicalTree",horizontalSpacing:n.verticalSpacing,verticalSpacing:n.horizontalSpacing,verticalAlignment:n.verticalAlignment,horizontalAlignment:n.horizontalAlignment,fixedNode:n.fixedNode,getLayoutInfo:fe(n.getLayoutInfo),margin:n.margin,root:n.fixedNode}).orientation="Left"===s?"LeftToRight":"RightToLeft",this.excludeFromLayout(e,i,!0),(new ev).updateLayout(t,i,a,o,r),this.excludeFromLayout(e,i,!1)},t.prototype.getBranch=function(t,e){return e.indexOf(t)%2==0?"Left":"Right"},t.prototype.excludeFromLayout=function(t,e,i){for(var n=0,o=t;n<o.length;n++)e[o[n].id].excludeFromLayout=i},t.prototype.findFirstLevelNodes=function(t,e,i){var n=[];if(t&&t.outEdges.length)for(var o=0,r=t.outEdges;o<r.length;o++){var s=r[o];n.push(i[i[s].targetID])}return n},t}(),nv=function(){function t(){}return t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"RadialTree"},t.prototype.updateLayout=function(t,e,i,n){var o={type:i.type,nameTable:e,anchorX:0,anchorY:0,firstLevelNodes:[],centerNode:null,levels:[],maxLevel:0,graphNodes:{},layoutNodes:[],orientation:i.orientation,horizontalSpacing:i.horizontalSpacing,verticalSpacing:i.verticalSpacing,verticalAlignment:i.verticalAlignment,horizontalAlignment:i.horizontalAlignment,fixedNode:i.fixedNode,margin:i.margin,bounds:i.bounds,objects:[],root:i.root};this.doLayout(o,t,e,n)},t.prototype.doLayout=function(t,e,i,n){for(var o,r=0;r<e.length;r++)(o=e[r]).excludeFromLayout||(t.graphNodes[o.id]=this.setUpLayoutInfo(t,o),o.inEdges&&o.inEdges.length||t.firstLevelNodes.push(o));t.root&&i[t.root]?t.centerNode=i[t.root]:t.firstLevelNodes.length&&(t.centerNode=t.firstLevelNodes[0],t.root=t.centerNode.id),t.centerNode&&(this.updateEdges(t,t.centerNode,0,i),this.depthFirstAllignment(t,t.centerNode,0,0),this.populateLevels(t),this.transformToCircleLayout(t),this.updateAnchor(t,n),this.updateNodes(t,t.centerNode,i))},t.prototype.updateEdges=function(t,e,i,n){var o=t.graphNodes[e.id];t.layoutNodes.push(o),o.level=i,o.visited=!0,t.maxLevel=Math.max(t.maxLevel,i);for(var r=0;r<e.outEdges.length;r++){var s=n[n[e.outEdges[r]].targetID];s.excludeFromLayout||s.visited||(o.children.push(s),this.updateEdges(t,s,i+1,n))}},t.prototype.depthFirstAllignment=function(t,e,i,n){var o,r=t.graphNodes[e.id];if(r.children.length){n+=300;for(l=0;l<r.children.length;l++)i=(o=this.depthFirstAllignment(t,r.children[l],i,n)).x,n=o.y;r.children=r.children.sort(function(e,i){return t.graphNodes[e.id].x-t.graphNodes[i.id].x});var s=t.graphNodes[r.children[0].id].min,a=t.graphNodes[r.children[r.children.length-1].id].max;if(r.x=s+(a-s)/2,i=a+t.horizontalSpacing,r.segmentOffset=a+t.horizontalSpacing,r.x-=r.width/2,r.y-=r.height/2,r.min=s,r.max=a,r.x<s&&r.visited){r.x=s,i=r.x+r.width/2-(a-s)/2,r.visited=!1;for(var l=0;l<r.children.length;l++)o=this.depthFirstAllignment(t,r.children[l],i,n);r.visited=!0,i=r.x+r.width+t.horizontalSpacing}i=i<(a=t.graphNodes[r.children[r.children.length-1].id].segmentOffset)?a:i,n-=300,r.y=n}else r.x=i,r.y=n,r.min=i,r.max=i+r.width,i+=r.width+t.horizontalSpacing;return{x:i,y:n}},t.prototype.populateLevels=function(t){var e=[],i=Math.min.apply(Math,t.layoutNodes.map(function(t){return t.x})),n=Math.max.apply(Math,t.layoutNodes.map(function(e){return e.x+e.width+t.horizontalSpacing}))-i;t.levels=[];for(var o=0;o<=t.maxLevel;o++)!function(o){e=t.layoutNodes.filter(function(t){return t.level===o?t:null});var r={};e=e.sort(function(t,e){return t.x-e.x}),r.min=e[0].x,r.max=e[e.length-1].x+e[e.length-1].width+t.horizontalSpacing,r.actualCircumference=0,r.height=0;for(var s=0;s<e.length;s++)e[s].height>r.height&&(r.height=e[s].height),r.actualCircumference+=Math.max(e[s].width,e[s].height),s!==e.length-1&&(r.actualCircumference+=t.horizontalSpacing);r.circumference=r.max-r.min,r.actualCircumference<r.circumference&&(r.circumference=(r.circumference+r.actualCircumference)/2),r.radius=r.circumference/(2*Math.PI)+r.height,r.nodes=[],o>1&&t.levels[o-1].radius+t.levels[o-1].height>=r.radius&&(r.radius=t.levels[o-1].radius+t.levels[o-1].height);for(var a=0;a<e.length;a++)e[a].ratio=Math.abs(e[a].x+e[a].width/2-i)/n,r.nodes.push(e[a]);t.levels.push(r)}(o)},t.prototype.transformToCircleLayout=function(t){var e=t.graphNodes[t.centerNode.id];e.x=0,e.y=0;for(var i=1;i<t.levels.length;i++)for(var n=0;n<t.levels[i].nodes.length;n++){var o=t.levels[i].nodes[n];o.x=Math.cos(360*o.ratio*Math.PI/180)*(t.levels[i].radius+t.verticalSpacing*i),o.y=Math.sin(360*o.ratio*Math.PI/180)*(t.levels[i].radius+t.verticalSpacing*i),t.anchorX=Math.min(t.anchorX,o.x),t.anchorY=Math.min(t.anchorY,o.y)}},t.prototype.updateAnchor=function(t,e){t.anchorX=t.centerNode.offsetX||e.x/2,t.anchorY=t.centerNode.offsetY||e.y/2},t.prototype.updateNodes=function(t,e,i){var n=t.graphNodes[e.id],o=n.x+t.anchorX,r=n.y+t.anchorY;e.offsetX+=o,e.offsetY+=r;for(var s=0;s<n.children.length;s++){var a=n.children[s];this.updateNodes(t,i[a.id],i)}},t.prototype.setUpLayoutInfo=function(t,e){var i={};return i.name=e.id,i.x=0,i.y=0,i.min=0,i.max=0,i.width=e.actualSize.width,i.height=e.actualSize.height,i.children=[],i.level=0,i.ratio=0,i.visited=!1,i},t}(),ov=function(){function t(t){this.velocityX=0,this.velocityY=0,this.nodes=[],this.graphNode=t;var e=Ea(this.graphNode);this.location=e.center,this.nodes=[],t.treeInfo.parents||(t.treeInfo.parents=[]),t.treeInfo.children||(t.treeInfo.children=[]),this.nodes=t.treeInfo.parents.concat(t.treeInfo.children)}return t.prototype.applyChanges=function(){this.graphNode.treeInfo.center=this.location},t}(),rv=function(){function t(){this.cdCOEF=.442,this.cfMAXVELOCITY=50,this.cnMAXITERACTION=1e3,this.cnSPRINGLENGTH=100,this.mszMaxForceVelocity={width:this.cfMAXVELOCITY,height:this.cfMAXVELOCITY},this.springLength=0,this.springFactor=this.cdCOEF,this.maxIteration=this.cnMAXITERACTION,this.springLength=this.cnSPRINGLENGTH}return t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"SymmetricalLayout"},t.prototype.doGraphLayout=function(t){var e=this.selectedNode;e.treeInfo.Bounds=t.getModelBounds(t.nodes);var i=e.treeInfo.GraphNodes,n=this.convertGraphNodes(i),o=n.length;o=Math.min(this.maxIteration,o*o*o),this.preLayoutNodes(n,e.treeInfo.Bounds);for(var r=0,s=o;r<s;r++)this.makeSymmetricLayout(n),this.appendForces(n);this.resetGraphPosition(n,e)},t.prototype.preLayoutNodes=function(t,e){for(var i=Math.max(e?e.width:25,e?e.height:25),n={x:i/2,y:i/2},o=2*Math.PI/t.length,r=o,s=0;s<t.length;s++){var a=t[s];this.getForceNode(a).location={x:n.x+i*Number(Math.cos(r).toFixed(2)),y:n.y+i*Number(Math.sin(r).toFixed(2))},r-=o}},t.prototype.doLayout=function(t){this.selectedNode=t.selectedNode,this.doGraphLayout(t)},t.prototype.makeSymmetricLayout=function(t){for(var e,i,n=0;n<t.length;n++){for(var o=t[n],r=(e=this.getForceNode(o)).nodes,s=0;s<r.length;s++)Pa((g=r[s]).id,t)&&this.calcNodesForce(e,this.getForceNode(g));for(var a=0,l=r.length;a<l&&!(l<2);a++){var h=this.getForceNode(r[a]),c=a+1>=l?this.getForceNode(r[0]):this.getForceNode(r[a+1]),d=360/r.length/2*Math.PI/180,p=2*this.springLength*Math.sin(d);this.calcRelatesForce(h,c,p)}for(var u=0;u<t.length;u++){var g=t[u];Pa(g.id,r)||g.id===o.id||(i=this.getForceNode(g),this.updateNeigbour(e,i))}}},t.prototype.appendForces=function(t){for(var e=null,i=0;i<t.length;i++){var n=t[i],o=(e=this.getForceNode(n)).location;o.x+=Math.min(e.velocityX,this.mszMaxForceVelocity.width),o.y+=Math.min(e.velocityY,this.mszMaxForceVelocity.height),e.velocityX=0,e.velocityY=0,e.location=o}},t.prototype.resetGraphPosition=function(t,e){for(var i,n={width:Number.MAX_VALUE,height:Number.MAX_VALUE},o=null,r=0;r<t.length;r++){i=t[r];var s={x:(o=this.getForceNode(i)).location.x-i.actualSize.width/2,y:o.location.y-i.actualSize.height/2};n.width=Math.min(n.width,s.x),n.height=Math.min(n.height,s.y)}for(r=0;r<t.length;r++)i=t[r],(s=(o=this.getForceNode(i)).location).x-=n.width-(e.treeInfo.location?e.treeInfo.location.x:0),s.y-=n.height-(e.treeInfo.location?e.treeInfo.location.y:0),o.location=s,o.applyChanges()},t.prototype.convertGraphNodes=function(t){for(var e=[],i=0,n=Object.keys(t);i<n.length;i++){var o=n[i];if(t[o]){var r=t[o],s=new ov(r);r.treeInfo.tag=s,e.push(r)}}return e},t.prototype.getForceNode=function(t){return t.treeInfo.tag},t.prototype.updateNeigbour=function(t,e){if(null!=e&&null!=t){var i=this.pointDistance(t.location,e.location),n=this.lineAngle(t.location,e.location),o=.9*this.springLength;i<o&&this.calcForce(i,o,n,e)}},t.prototype.lineAngle=function(t,e){var i=0,n=e.x-t.x,o=e.y-t.y;return 0===n?i=o<=0?3*Math.PI/2:Math.PI/2:0===o?i=n<0?Math.PI:0:(i=Math.atan(o/n),n<0&&o>0?i=Math.PI+i:n<0&&o<0?i=Math.PI+i:n>0&&o<0&&(i=2*Math.PI+i)),i},t.prototype.pointDistance=function(t,e){var i=0,n=e.x-t.x,o=e.y-t.y,r=n*n+o*o;return r>0&&(i=Math.sqrt(r)),i},t.prototype.calcRelatesForce=function(t,e,i){var n=this.pointDistance(t.location,e.location),o=this.lineAngle(t.location,e.location);n<i&&this.calcForce(n,i,o,e)},t.prototype.updateLayout=function(t,e,i,n,o,r){(new sv).updateLayout(t,e,i,n,o,r)},t.prototype.calcNodesForce=function(t,e){var i=this.pointDistance(t.location,e.location),n=this.lineAngle(t.location,e.location);(i>this.springLength||i<this.springLength)&&this.calcForce(i,this.springLength,n,e)},t.prototype.calcForce=function(t,e,i,n){var o=n.nodes.length,r=t-e,s=this.springFactor/(o*o)*Math.sqrt(o);if(0!==r){var a=r*s,l=Math.cos(i)*a,h=Math.sin(i)*a;n.velocityX-=l,n.velocityY-=h}},t}(),sv=function(){function t(){this.visitedStack=[],this.cycleEdgesCollection=[],this.graphObjects=[],this.passedNodes=[]}return t.prototype.updateLayout=function(t,e,i,n,o,r){this.nameTable=n,this.nodes=t,this.connectors=e;var s=t;s.length>0&&(this.mhelperSelectedNode=ie(s[0]));for(var a=0,l=t;a<l.length;a++){var h=void 0;(h=m=l[a]).treeInfo={},h.treeInfo.graphType="Node",this.graphObjects.push(h)}for(var c=0,d=e;c<d.length;c++){var p=void 0;(p=d[c]).treeInfo={},p.treeInfo.graphType="Connector",this.graphObjects.push(p)}this.updateLayout1(this.graphObjects,i);for(var u=this.getModelBounds(s),g=0;g<s.length;g++){var m=s[g],f=(r.x-u.width)/2,v=o.margin||{};v.left=v.left||0,v.right=v.right||0,v.top=v.top||0,v.bottom=v.bottom||0,o.margin.left&&(v.left=o.margin.left),o.margin.top&&(v.top=o.margin.top);var y=m.treeInfo.tag.location.x-(m.offsetX-m.actualSize.width/2)-u.x+f+v.left,b=m.treeInfo.tag.location.y-(m.offsetY-m.actualSize.height/2)-u.y+v.top;m.offsetX+=y,m.offsetY+=b,delete m.treeInfo}return!0},t.prototype.getModelBounds=function(t){t=t.slice();for(var e,i=null,n=null,o=0;o<t.length;o++){var r=Ea(e=t[o]);i=new ah(e.treeInfo.tag?e.treeInfo.tag.location.x:r.x,e.treeInfo.tag?e.treeInfo.tag.location.y:r.y,e.actualSize.width,e.actualSize.height),n=n?n.uniteRect(i):i}return n},t.prototype.updateLayout1=function(t,e){this.detectCyclesInGraph(t);var i=t.length;if(i>0){for(var n=[],o=[],r=[],s=0;s<t.length;s++){var a=t[s];void 0===a.treeInfo.isCycleEdge&&(a.treeInfo.isCycleEdge=!1),"Connector"!==a.treeInfo.graphType||a.treeInfo.isCycleEdge?"Connector"===a.treeInfo.graphType?n.push(a):r.push(a):o.push(a)}for(o=o.concat(r),o=n.concat(o);i>this.dictionaryLength(this.passedNodes);)if(this.getNodesToPosition(o),null!=this.selectedNode){e.doLayout(this),this.selectedNode=null,this.visitedStack=[];for(var l=0,h=this.cycleEdgesCollection;l<h.length;l++)h[l].treeInfo.isCycleEdge=!1}this.passedNodes=null,this.selectedNode=null}return!1},t.prototype.getNodesToPosition=function(t){for(var e=0;e<t.length;e++){var i=t[e];if(!Pa(i.id,this.passedNodes)){i&&this.selectNodes(i);break}}},t.prototype.selectNodes=function(t){var e=t;"Connector"===t.treeInfo.graphType?this.exploreGraphEdge(t):null!=e&&this.addNode(t,"passed")&&(this.addNode(t,"selected"),this.isConnectedToAnotherNode(e)?(this.selectedNode={treeInfo:{}},this.selectedNode.treeInfo.LeftMargin=10,this.selectedNode.treeInfo.TopMargin=10,this.selectConnectedNodes(e)):this.selectedNode=t)},t.prototype.selectConnectedNodes=function(t){var e=this.selectedNode;e.treeInfo.GraphNodes||(e.treeInfo.GraphNodes={});var i=t;if(null!=i&&this.addNode(i,"passed")){var n=i.id;if(this.dictionaryContains(e.treeInfo.GraphNodes,i)){var o=e.treeInfo.GraphNodes[n];o.treeInfo.Added&&(o.treeInfo.Added=!1,this.getConnectedRelatives(o),this.exploreRelatives(t))}else{var r=this.addGraphNode(i);this.getConnectedRelatives(r),this.exploreRelatives(t)}}},t.prototype.exploreRelatives=function(t){this.exploreRelatives1(t,"Parents"),this.exploreRelatives1(t,"Children")},t.prototype.exploreRelatives1=function(t,e){var i=[];"Parents"===e?i=t.inEdges:"Children"===e&&(i=t.outEdges);for(var n=0;n<i.length;n++){var o=this.nameTable[i[n]];if(this.addNode(o,"passed")){var r=this.nameTable[o.sourceID],s=this.nameTable[o.targetID];"Parents"===e&&null!=r&&Pa(r.id,this.nodes)?this.selectConnectedNodes(this.nameTable[o.sourceID]):"Children"===e&&null!=s&&Pa(s.id,this.nodes)&&this.selectConnectedNodes(this.nameTable[o.targetID])}}},t.prototype.getConnectedRelatives=function(t){this.getConnectedParents(t),this.getConnectedChildren(t)},t.prototype.dictionaryContains=function(t,e){for(var i=Object.keys(t),n=0;n<i.length;n++)if(i[n]===e.id)return!0;return!1},t.prototype.dictionaryLength=function(t){return Object.keys(t).length},t.prototype.getConnectedChildren=function(t){for(var e=this.selectedNode,i=t,n=0;n<i.outEdges.length;n++){var o=this.nameTable[i.outEdges[n]];if(!o.treeInfo.isCycleEdge){var r=this.nameTable[o.targetID];if(Pa(r.id,this.nodes)&&null!=r&&r.visible){var s=void 0;this.dictionaryContains(e.treeInfo.GraphNodes,r)?s=e.treeInfo.GraphNodes[r.id]:(s=this.addGraphNode(r)).treeInfo.Added=!0,t.treeInfo.children||(t.treeInfo.children=[]),s.treeInfo.parents||(s.treeInfo.parents=[]),this.setNode(s.treeInfo.parents,t),this.findNode(t.treeInfo.children,s.id)<0&&t.treeInfo.children.push(s)}}}},t.prototype.getConnectedParents=function(t){for(var e=this.selectedNode,i=t,n=0;n<i.inEdges.length;n++){var o=this.nameTable[i.inEdges[n]];if(!o.treeInfo.isCycleEdge){var r=this.nameTable[o.sourceID];if(Pa(r.id,this.nodes)&&null!=r&&r.visible){var s=void 0;this.dictionaryContains(e.treeInfo.GraphNodes,r)?s=e.treeInfo.GraphNodes[r.id]:(s=this.addGraphNode(r)).treeInfo.Added=!0,t.treeInfo.parents||(t.treeInfo.parents=[]),s.treeInfo.children||(s.treeInfo.children=[]),this.setNode(s.treeInfo.children,t),this.findNode(t.treeInfo.parents,s.id)<0&&t.treeInfo.parents.push(s)}}}},t.prototype.setNode=function(t,e){var i=this.findNode(t,e.id);i>=0&&i<t.length?t[i]=e:t.push(e)},t.prototype.findNode=function(t,e){var i=-1;if(null!=t&&""!==e)for(var n=0,o=t.length;n<o;n++){var r=t[n];if("string"==typeof r&&r===e){i=n;break}if(null!=r&&r.id===e){i=n;break}}return i},t.prototype.addGraphNode=function(t){var e=this.selectedNode;e.treeInfo.GraphNodes||(e.treeInfo.GraphNodes={});var i=t;if(null!=e){e.treeInfo.GraphNodes[i.id]=i;var n=this.mhelperSelectedNode;null!=n&&t.id===n.id&&(this.mhelperSelectedNode=i)}return i},t.prototype.isConnectedToAnotherNode=function(t){var e=!1;return t.inEdges.concat(t.outEdges).length>0&&(null!=t.inEdges&&t.inEdges.length>0&&(e=this.searchEdgeCollection(t.inEdges,"FromNode")),!e&&null!=t.outEdges&&t.outEdges.length>0&&(e=this.searchEdgeCollection(t.outEdges,"ToNode"))),e},t.prototype.searchEdgeCollection=function(t,e){for(var i=!1,n=0;n<t.length-1;n++){var o=this.nameTable[t[n]];if(this.addNode(o,"passed")&&(!o.treeInfo.isCycleEdge&&("FromNode"===e&&null!=this.nameTable[o.sourceID]||"ToNode"===e&&null!=this.nameTable[o.targetID]))){i=!0;break}}return i},t.prototype.exploreGraphEdge=function(t){var e=t;if(null!=e&&!e.treeInfo.isCycleEdge&&this.addNode(t,"passed")){this.addNode(t,"selected");var i=this.nameTable[e.sourceID],n=this.nameTable[e.targetID];null!=i?this.selectNodes(i):null!=n?this.selectNodes(n):this.selectedNode=t}},t.prototype.addNode=function(t,e){var i=t;return"passed"!==e&&i.visible||this.dictionaryContains(this.passedNodes,i)||(this.passedNodes[i.id]=i),!!i.visible},t.prototype.detectCyclesInGraph=function(t){for(var e=[],i=[],n=0;n<t.length;n++)"Connector"!==t[n].treeInfo.graphType&&e.push(t[n]);if(e.length>0)for(i.push(e[0]),this.visitedStack.push(e[0]);i.length>0;){var o=i[i.length-1],r=this.getUnVisitedChildNodes(o);if(r.length>0){var s=r[0],a=r[r.length-1];Pa(s.id,this.visitedStack)?(a.treeInfo.isCycleEdge=!0,this.cycleEdgesCollection.push(a)):(i.push(s),this.visitedStack.splice(0,0,s))}else i.pop()}},t.prototype.getUnVisitedChildNodes=function(t){var e=[];if(t.outEdges.length>0){for(var i=0;i<t.outEdges.length;i++){var n=this.nameTable[t.outEdges[i]];if(!Pa(n.id,this.visitedStack)){var o=this.nameTable[n.targetID];return null!=o&&e.push(o),e.push(n),this.visitedStack.splice(0,0,n),e}}return e}return e},t}(),av=function(){function t(){}return t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"ComplexHierarchicalTree"},t.prototype.doLayout=function(t,e,i,n){(new lv).doLayout(t,e,i,n)},t}(),lv=function(){function t(){this.nameTable={},this.crossReduction=new cv}return t.prototype.createVertex=function(t,e,i,n,o,r){return{value:e,geometry:{x:i,y:n,width:o,height:r},name:e,vertex:!0,inEdges:t.inEdges.slice(),outEdges:t.outEdges.slice()}},t.prototype.getEdges=function(t){var e=[];if(t){for(i=0;t.inEdges.length>0&&i<t.inEdges.length;i++)e.push(this.nameTable[t.inEdges[i]]);for(var i=0;t.outEdges.length>0&&i<t.outEdges.length;i++)e.push(this.nameTable[t.outEdges[i]])}return e},t.prototype.findRoots=function(t){for(var e=[],i=null,n=-1e5,o=0,r=Object.keys(t);o<r.length;o++){for(var s=t[r[o]],a=this.getEdges(s),l=0,h=0,c=0;c<a.length;c++)this.getVisibleTerminal(a[c],!0).name===s.name?l++:h++;0===h&&l>0&&e.push(s);var d=l-h;d>n&&(n=d,i=s)}return 0===e.length&&null!=i&&e.push(i),e},t.prototype.getVisibleTerminal=function(t,e){var i=this.nameTable[t.targetID];e&&(i=this.nameTable[t.sourceID]);for(var n=0;n<this.vertices.length;n++)if(this.vertices[n].name===i.id)return this.vertices[n];return null},t.prototype.traverse=function(t,e,i,n,o,r){if(null!=t){var s=t.name;if(null==r||null!=r[s]){null==n[s]&&(n[s]=t),null!=r&&delete r[s];for(var a=this.getEdges(t),l=[],h=0;h<a.length;h++)l[h]=this.getVisibleTerminal(a[h],!0)===t;for(h=0;h<a.length;h++)if(!e||l[h]){for(var c=this.getVisibleTerminal(a[h],!l[h]),d=1,p=0;p<a.length;p++)if(p!==h){var u=l[p];this.getVisibleTerminal(a[p],!u)===c&&(u?d++:d--)}d>=0&&(n=this.traverse(c,e,a[h],n,o,r))}}else if(null==n[s])for(h=0;h<o.length;h++){var g=o[h];if(null!=g[s]){for(var m=0,f=Object.keys(g);m<f.length;m++){var v=f[m];n[v]=g[v]}return o.splice(h,1),n}}}return n},t.prototype.getModelBounds=function(t){t=t.slice();for(var e=null,i=null,n=0;n<t.length;n++)if(e=t[n].geometry,i){var o=Math.max(i.x+i.width,e.x+e.width),r=Math.max(i.y+i.height,e.y+e.height);i.x=Math.min(i.x,e.x),i.y=Math.min(i.y,e.y),i.width=o-i.x,i.height=r-i.y}else i={x:e.x,y:e.y,width:e.width,height:e.height};return i},t.prototype.doLayout=function(t,e,i,n){this.nameTable=e;var o={horizontalSpacing:i.horizontalSpacing,verticalSpacing:i.verticalSpacing,orientation:i.orientation,marginX:i.margin.left,marginY:i.margin.top};"BottomToTop"===o.orientation?o.marginY=-i.margin.top:"RightToLeft"===o.orientation&&(o.marginX=-i.margin.left),this.vertices=[];for(var r={},s=0;s<t.length;s++){var a=this.createVertex(t[s],t[s].id,0,0,t[s].actualSize.width,t[s].actualSize.height);this.vertices.push(a),r[a.name]=a}var l,h=[];l=this.findRoots(r);for(s=0;s<l.length;s++){d={};h.push(d),this.traverse(l[s],!0,null,d,h,r)}for(var c={marginX:0,marginY:0},s=0;s<h.length;s++){for(var d=h[s],p=[],u=0,g=Object.keys(d);u<g.length;u++){var m=g[u];p.push(d[m])}var f=new hv(this,p,l,o);this.cycleStage(f),this.layeringStage(f),this.crossingStage(f),c=this.placementStage(f,c.marginX,c.marginY)}for(var v=this.getModelBounds(this.vertices),y=(n.x-v.width)/2,s=0;s<this.vertices.length;s++){var b=this.vertices[s];if(b){var w=this.nameTable[b.name];w.offsetX=0,w.offsetY=0;var x=b.geometry.x-(w.offsetX-w.actualSize.width/2)+o.marginX,S=b.geometry.y-(w.offsetY-w.actualSize.height/2)+o.marginY,C=x,L=S;"BottomToTop"===o.orientation?L=v.height-S:"RightToLeft"===o.orientation&&(C=v.width-x),C+=y,w.offsetX+=C-w.offsetX,w.offsetY+=L-w.offsetY}}},t.prototype.placementStage=function(t,e,i){var n=this.coordinateAssignment(e,i,parent,t);return n.model=t,n.widestRankValue=null,this.placementStageExecute(n),{marginX:n.marginX+t.layout.horizontalSpacing,marginY:n.marginY+t.layout.verticalSpacing}},t.prototype.coordinateAssignment=function(t,e,i,n){var o={};return"TopToBottom"===n.layout.orientation||"BottomToTop"===n.layout.orientation?(o.horizontalSpacing=n.layout.horizontalSpacing,o.verticalSpacing=n.layout.verticalSpacing):(o.horizontalSpacing=n.layout.verticalSpacing,o.verticalSpacing=n.layout.horizontalSpacing),o.orientation="north",o.marginX=o.marginX=t,o.marginY=o.marginY=e,o},t.prototype.calculateWidestRank=function(t,e,i){var n=!1;"LeftToRight"!==t.model.layout.orientation&&"RightToLeft"!==t.model.layout.orientation||(n=!0);var o=-t.verticalSpacing,r=0;t.rankSizes=[],t.rankOffset=[];for(var s=i.maxRank;s>=0;s--){for(var a=0,l=i.ranks[s],h=n?t.marginY:t.marginX,c=0;c<l.length;c++){var d=l[c];if(this.crossReduction.isVertex(d)){var p=d;if(p.cell&&(p.cell.inEdges||p.cell.outEdges)){var u=this.nameTable[p.cell.name];p.width=u.actualSize.width,p.height=u.actualSize.height,a=Math.max(a,n?p.width:p.height)}}else if(d){var g=d,m=1;null!=g.edges&&(m=g.edges.length),d.width=10*(m-1)}n&&(d.height||(d.height=0)),h+=(n?d.height:d.width)/2,this.setXY(d,s,h,!!n),this.setTempVariable(d,s,h),(h+=(n?d.height:d.width)/2+t.horizontalSpacing)>t.widestRankValue&&(t.widestRankValue=h,t.widestRank=s),t.rankSizes[s]=h}t.rankOffset[s]=o;var f=a/2+r/2+t.verticalSpacing;r=a,"north"===t.orientation||"west"===t.orientation?o+=f:o-=f;for(c=0;c<l.length;c++){var v=l[c];this.setXY(v,s,o,!n)}}},t.prototype.setTempVariable=function(t,e,i){this.crossReduction.isVertex(t)?t.temp[0]=i:t.temp[e-t.minRank-1]=i},t.prototype.setXY=function(t,e,i,n){t&&t.cell&&(t.cell.inEdges||t.cell.outEdges?n?t.y[0]=i:t.x[0]=i:n?t.y[e-t.minRank-1]=i:t.x[e-t.minRank-1]=i)},t.prototype.rankCoordinates=function(t,e,i,n){var o=!1;"LeftToRight"!==t.model.layout.orientation&&"RightToLeft"!==t.model.layout.orientation||(o=!0);for(var r=n.ranks[e],s=0,a=(o?t.marginY:t.marginX)+(t.widestRankValue-t.rankSizes[e])/2,l=0;l<r.length;l++){var h=r[l];if(this.crossReduction.isVertex(h)){var c=this.nameTable[h.cell.name];h.width=c.actualSize.width,h.height=c.actualSize.height,s=Math.max(s,h.height)}else{var d=h,p=1;null!=d.edges&&(p=d.edges.length),o?h.height=10*(p-1):h.width=10*(p-1)}var u=(o?h.height:h.width)/2;a+=u,this.setXY(h,e,a,!!o),this.setTempVariable(h,e,a),a+=u+t.horizontalSpacing}},t.prototype.initialCoords=function(t,e,i){this.calculateWidestRank(t,e,i);for(n=t.widestRank;n>=0;n--)n<i.maxRank&&this.rankCoordinates(t,n,e,i);for(var n=t.widestRank+1;n<=i.maxRank;n++)n>0&&this.rankCoordinates(t,n,e,i)},t.prototype.isAncestor=function(t,e){if(null!=e&&null!=t.hashCode&&null!=e.hashCode&&t.hashCode.length<e.hashCode.length){if(t.hashCode===e.hashCode)return!0;if(null==t.hashCode||null==t.hashCode)return!1;for(var i=0;i<t.hashCode.length;i++)if(t.hashCode[i]!==e.hashCode[i])return!1;return!0}return!1},t.prototype.weightedCellSorter=function(t,e){var i={};return i.cell=t||null,i.weightedValue=e||0,i.visited=!1,i.rankIndex=null,i},t.prototype.minNode=function(t,e){for(var i=[],n={map:{}},o=[],r=0;r<=e.maxRank;r++){o[r]=e.ranks[r];for(var s=0;s<o[r].length;s++){var a=o[r][s],l=this.weightedCellSorter(a,r);l.rankIndex=s,l.visited=!0,i.push(l),e.setDictionaryForSorter(n,a,l,!0)}}for(var h=10*i.length,c=0;i.length>0&&c<=h;){var d=i.shift(),p=d.cell,u=d.weightedValue,g=d.rankIndex,m=this.crossReduction.getConnectedCellsOnLayer(p,u),f=this.crossReduction.getConnectedCellsOnLayer(p,u,!0),v=m.length,y=f.length,b=this.medianXValue(t,m,u+1),w=this.medianXValue(t,f,u-1),x=v+y,S=this.crossReduction.getTempVariable(p,u),C=S;x>0&&(C=(b*v+w*y)/x);var L=!1,E=void 0;if(C<S-1)if(0===g)E=C,L=!0;else{var P=o[u][g-1],k=this.crossReduction.getTempVariable(P,u);(k=k+P.width/2+t.intraCellSpacing+p.width/2)<C?(E=C,L=!0):k<this.crossReduction.getTempVariable(p,u)-1&&(E=k,L=!0)}else if(C>S+1)if(g===o[u].length-1)E=C,L=!0;else{var T=o[u][g+1],O=this.crossReduction.getTempVariable(T,u);(O=O-T.width/2-t.intraCellSpacing-p.width/2)>C?(E=C,L=!0):O>this.crossReduction.getTempVariable(p,u)+1&&(E=O,L=!0)}L&&(this.setTempVariable(p,u,E),this.updateNodeList(i,n,m,e),this.updateNodeList(i,n,f,e)),this.crossReduction.isVertex(d.cell)&&(d.visited=!1),c++}},t.prototype.updateNodeList=function(t,e,i,n){for(var o=0;o<i.length;o++){var r=i[o],s=n.getDictionaryForSorter(e,r);null!=s&&!1===s.visited&&(s.visited=!0,t.push(s))}},t.prototype.medianXValue=function(t,e,i){if(0===e.length)return 0;for(var n=[],o=0;o<e.length;o++)n[o]=this.crossReduction.getTempVariable(e[o],i);if(n.sort(function(t,e){return t-e}),e.length%2==1)return n[Math.floor(e.length/2)];var r=e.length/2;return(n[r-1]+n[r])/2},t.prototype.placementStageExecute=function(t){var e=!1;"LeftToRight"!==t.model.layout.orientation&&"RightToLeft"!==t.model.layout.orientation||(e=!0),t.jettyPositions={};var i=t.model;e?t.currentYDelta=0:t.currentXDelta=0,this.initialCoords(t,{model:i},i),this.minNode(t,i);var n=1e8;t.maxIterations||(t.maxIterations=8);for(var o=0;o<t.maxIterations;o++){if((e?t.currentYDelta:t.currentXDelta)<n){for(var r=0;r<i.ranks.length;r++)for(var s=i.ranks[r],a=0;a<s.length;a++){var l=s[a];this.setXY(l,r,this.crossReduction.getTempVariable(l,r),!!e)}n=e?t.currentYDelta:t.currentXDelta}e?t.currentYDelta=0:t.currentXDelta=0}this.setCellLocations(t,i)},t.prototype.setCellLocations=function(t,e){for(var i=this.getValues(e.vertexMapper),n=0;n<i.length;n++)this.setVertexLocation(t,i[n])},t.prototype.garphModelsetVertexLocation=function(t,e,i,n){t.model;var o=e.geometry,r=null;return null!=o&&(r={x:i,y:n,width:o.width,height:o.height},o.x===i&&o.y===n||(e.geometry=r)),r},t.prototype.setVertexLocation=function(t,e){var i=!1;"LeftToRight"!==t.model.layout.orientation&&"RightToLeft"!==t.model.layout.orientation||(i=!0);var n=e.cell,o=e.x[0]-e.width/2,r=e.y[0]-e.height/2;this.garphModelsetVertexLocation(t,n,o,r),i?(t.marginY||(t.marginY=0),t.marginY=Math.max(t.marginY,r+e.height)):(t.marginX||(t.marginX=0),t.marginX=Math.max(t.marginX,o+e.width))},t.prototype.getValues=function(t){var e=[];if(t.map)for(var i=0,n=Object.keys(t.map);i<n.length;i++){var o=n[i];e.push(t.map[o])}return e},t.prototype.crossingStage=function(t){this.crossReduction.execute(t)},t.prototype.layeringStage=function(t){this.initialRank(t),this.fixRanks(t)},t.prototype.initialRank=function(t){for(var e=t.startNodes,i=t.getDictionaryValues(t.vertexMapper),n=e.slice();e.length>0;){for(var o=(c=e[0]).connectsAsTarget,r=c.connectsAsSource,s=!0,a=1e8,l=0;l<o.length;l++){if(5270620!==(u=o[l]).temp[0]){s=!1;break}g=u.source;a=Math.min(a,g.temp[0]-1)}if(s){if(c.temp[0]=a,t.maxRank||(t.maxRank=1e8),t.maxRank=Math.min(t.maxRank,a),null!=r)for(l=0;l<r.length;l++)(u=r[l]).temp[0]=5270620,-1===(g=u.target).temp[0]&&(e.push(g),g.temp[0]=-2);e.shift()}else{var h=e.shift();if(e.push(c),h===c&&1===e.length)break}}for(l=0;l<i.length;l++)i[l].temp[0]-=t.maxRank;for(l=0;l<n.length;l++)for(var c=n[l],d=0,o=c.connectsAsSource,p=0;p<o.length;p++){var u=o[p],g=u.target;c.temp[0]=Math.max(d,g.temp[0]+1),d=c.temp[0]}t.maxRank=1e8-t.maxRank},t.prototype.fixRanks=function(t){t.fixRanks()},t.prototype.cycleStage=function(t){var e={};t.startNodes=[];for(var i=t.getDictionaryValues(t.vertexMapper),n=[],o=0;o<i.length;o++)i[o].temp[0]=-1,n[i[o].id]=i[o];var r=null;if(null!=t.roots){var s=t.roots;r=[];for(o=0;o<s.length;o++)r[o]=t.getDictionary(t.vertexMapper,s[o]),null!=r[o]&&t.startNodes.push(r[o])}t.visit("removeParentConnection",r,!0,null,{seenNodes:e,unseenNodes:n});var a=t.clone(e,null,!0);t.visit("removeNodeConnection",n,!0,a,{seenNodes:e,unseenNodes:n})},t.prototype.remove=function(t,e){var i=e.indexOf(t);return-1!==i&&e.splice(i,1),t},t.prototype.invert=function(t,e){var i=t.source;t.source=t.target,t.target=i,t.isReversed=!t.isReversed},t.prototype.getEdgesBetween=function(t,e,i){i=null!=i&&i;for(var n=this.getEdges(t),o=[],r=0;r<n.length;r++){var s=this.getVisibleTerminal(n[r],!0),a=this.getVisibleTerminal(n[r],!1);(s===t&&a===e||!i&&s===e&&a===t)&&o.push(n[r])}return o},t}(),hv=function(){function t(t,e,i,n){this.multiObjectIdentityCounter=0,this.dfsCount=0,this.hierarchicalUtil=new lv,this.roots=i,this.vertexMapper={map:{}};var o=[];this.layout=n,this.maxRank=1e8,this.hierarchicalLayout=t,this.createInternalCells(t,e,o);for(var r=0;r<e.length;r++){for(var s=o[r].connectsAsSource,a=0;a<s.length;a++){var l=s[a],h=l.edges;if(null!=h&&h.length>0){var c=h[0],d=t.getVisibleTerminal(c,!1),p=this.getDictionary(this.vertexMapper,d);o[r]===p&&(d=t.getVisibleTerminal(c,!0),p=this.getDictionary(this.vertexMapper,d)),null!=p&&o[r]!==p&&(l.target=p,0===p.connectsAsTarget.length&&(p.connectsAsTarget=[]),p.connectsAsTarget.indexOf(l)<0&&p.connectsAsTarget.push(l))}}o[r].temp[0]=1}}return t.prototype.createInternalCells=function(t,e,i){for(var n=0;n<e.length;n++){i[n]={x:[],y:[],temp:[],cell:e[n],id:e[n].name,connectsAsTarget:[],connectsAsSource:[]},this.setDictionary(this.vertexMapper,e[n],i[n]);var o=t.getEdges(e[n]);i[n].connectsAsSource=[];for(var r=0;r<o.length;r++){var s=t.getVisibleTerminal(o[r],!1);if(s!==e[n]){var a=t.getEdgesBetween(e[n],s,!1),l=t.getEdgesBetween(e[n],s,!0);if(null!=a&&a.length>0&&2*l.length>=a.length){for(var h={x:[],y:[],temp:[],edges:a,ids:[]},c=0;c<a.length;c++)h.ids.push(a[c].id);h.source=i[n],i[n].connectsAsSource||(i[n].connectsAsSource=[]),i[n].connectsAsSource.indexOf(h)<0&&i[n].connectsAsSource.push(h)}}}i[n].temp[0]=0}},t.prototype.fixRanks=function(){var t=[];this.ranks=[];for(n=0;n<this.maxRank+1;n++)t[n]=[],this.ranks[n]=t[n];var e=null;if(null!=this.roots){var i=this.roots;e=[];for(var n=0;n<i.length;n++){var o=i[n],r=this.getDictionary(this.vertexMapper,o);e[n]=r}}this.visit("updateMinMaxRank",e,!1,null,{seenNodes:null,unseenNodes:null,rankList:t})},t.prototype.updateMinMaxRank=function(t,e,i){i.seenNodes,i.unseenNodes;var n=i.parent,o=i.root,r=i.edge,s=i.rankList;if(o.maxRank||0===o.maxRank||(o.maxRank=-1),o.minRank||0===o.minRank||(o.minRank=-1),0===e&&o.maxRank<0&&o.minRank<0&&(s[o.temp[0]].push(o),o.maxRank=o.temp[0],o.minRank=o.temp[0],o.temp[0]=s[o.maxRank].length-1),null!=n&&null!=r&&n.maxRank-o.maxRank>1){r.maxRank=n.maxRank,r.minRank=o.maxRank,r.temp=[],r.x=[],r.y=[];for(var a=r.minRank+1;a<r.maxRank;a++)s[a].push(r),this.hierarchicalUtil.setTempVariable(r,a,s[a].length-1)}},t.prototype.setDictionary=function(t,e,i){var n=e.name,o=t.map[n];return t.map[n]=i,o},t.prototype.setDictionaryForSorter=function(t,e,i,n){var o=e.id,r=t.map[o];return t.map[o]=i,r},t.prototype.getDictionary=function(t,e){this.multiObjectIdentityCounter||0===this.multiObjectIdentityCounter||(this.multiObjectIdentityCounter=0);var i=e.name;return i?t.map[i]:e.layoutObjectId?t.map[e.layoutObjectId]:(e.layoutObjectId="graphHierarchyNode#"+this.multiObjectIdentityCounter++,e.layoutObjectId)},t.prototype.getDictionaryForSorter=function(t,e){this.multiObjectIdentityCounter||0===this.multiObjectIdentityCounter||(this.multiObjectIdentityCounter=0);var i=e.id;return i?t.map[i]:e.layoutObjectId?t.map[e.layoutObjectId]:(e.layoutObjectId="graphHierarchyNode#"+this.multiObjectIdentityCounter++,e.layoutObjectId)},t.prototype.getDictionaryValues=function(t){for(var e=[],i=0,n=Object.keys(t.map);i<n.length;i++){var o=n[i];e.push(t.map[o])}return e},t.prototype.visit=function(t,e,i,n,o){o.seenNodes,o.unseenNodes,o.rankList;if(null!=e){for(var r=0;r<e.length;r++){var s=e[r];null!=s&&(null==n&&(n=new Object),o.parent=null,o.root=s,o.edge=null,i?(s.hashCode=[],s.hashCode[0]=this.dfsCount,s.hashCode[1]=r,this.extendedDfs(t,n,r,0,o)):this.depthFirstSearch(t,n,0,o))}this.dfsCount++}},t.prototype.depthFirstSearch=function(t,e,i,n){n.seenNodes,n.unseenNodes,n.rankList,n.parent;var o=n.root;n.edge;if(null!=o){var r=o.id;if(null==e[r]){e[r]=o,this.updateConnectionRank(t,i,0,n);for(var s=o.connectsAsSource.slice(),a=0;a<s.length;a++){var l=s[a],h=l.target;n.parent=o,n.root=h,n.edge=l,this.depthFirstSearch(t,e,i+1,n)}}else this.updateConnectionRank(t,i,1,n)}},t.prototype.updateConnectionRank=function(t,e,i,n){var o=n.parent,r=n.root,s=n.edge;if("removeParentConnection"===t||"removeNodeConnection"===t){var a="removeNodeConnection"===t;this.removeConnectionEdge(o,r,s,e,n,a)}"updateMinMaxRank"===t&&this.updateMinMaxRank(e,i,n)},t.prototype.removeConnectionEdge=function(t,e,i,n,o,r){var s=o.seenNodes,a=o.unseenNodes;o.rankList;this.hierarchicalUtil.isAncestor(e,t)&&(this.hierarchicalUtil.invert(i,0),this.hierarchicalUtil.remove(i,t.connectsAsSource),r?(e.connectsAsSource.push(i),t.connectsAsTarget.push(i),this.hierarchicalUtil.remove(i,e.connectsAsTarget)):(t.connectsAsTarget.push(i),this.hierarchicalUtil.remove(i,e.connectsAsTarget),e.connectsAsSource.push(i))),s[e.id]=e,delete a[e.id]},t.prototype.extendedDfs=function(t,e,i,n,o){o.seenNodes,o.unseenNodes,o.rankList;var r=o.parent,s=o.root;o.edge;if(null!=s){if(null!=r&&(null==s.hashCode||s.hashCode[0]!==r.hashCode[0])){var a=r.hashCode.length+1;s.hashCode=r.hashCode.slice(),s.hashCode[a-1]=i}var l=s.id;if(null==e[l]){e[l]=s,this.updateConnectionRank(t,n,0,o);for(var h=s.connectsAsSource.slice(),c=0;c<h.length;c++){var d=h[c],p=d.target;o.parent=s,o.root=p,o.edge=d,this.extendedDfs(t,e,c,n+1,o)}}else this.updateConnectionRank(t,n,1,o)}},t.prototype.clone=function(t,e,i){if(i=null!=i&&i,null!=t&&"function"==typeof t.constructor){for(var n=t.constructor(),o=0,r=Object.keys(t);o<r.length;o++){var s=r[o];"layoutObjectId"!==s&&(null==e||e.indexOf(s)<0)&&(i||"object"!=typeof t[s])&&(n[s]=t[s])}return n}return null},t}(),cv=function(){function t(){}return t.prototype.calculateCrossings=function(t){for(var e=t.ranks.length,i=0,n=1;n<e;n++)i+=this.calculateRankCrossing(n,t);return i},t.prototype.getTempVariable=function(t,e){return t?this.isVertex(t)?t.temp[0]:t.temp[e-t.minRank-1]:0},t.prototype.calculateRankCrossing=function(t,e){for(var i=0,n=e.ranks[t],o=e.ranks[t-1],r=[],s=0;s<n.length;s++){for(var a=n[s],l=this.getTempVariable(a,t),h=this.getConnectedCellsOnLayer(a,t,!0),c=[],d=0;d<h.length;d++){var p=h[d],u=this.getTempVariable(p,t-1);c.push(u)}c.sort(function(t,e){return t-e}),r[l]=c}for(var g=[],s=0;s<r.length;s++)g=g.concat(r[s]);for(var m=1;m<o.length;)m<<=1;var f=2*m-1;m-=1;for(var v=[],s=0;s<f;++s)v[s]=0;for(s=0;s<g.length;s++){var y=g[s]+m;for(++v[y];y>0;)y%2&&(i+=v[y+1]),++v[y=y-1>>1]}return i},t.prototype.execute=function(t){this.nestedBestRanks=[];for(n=0;n<t.ranks.length;n++)this.nestedBestRanks[n]=t.ranks[n].slice();for(var e=0,i=this.calculateCrossings(t),n=0;n<24&&e<2;n++){this.weightedMedian(n,t);var o=this.calculateCrossings(t);if(o<i){i=o,e=0;for(c=0;c<this.nestedBestRanks.length;c++)for(var r=t.ranks[c],s=0;s<r.length;s++){a=r[s];this.nestedBestRanks[c][a.temp[0]]=a}}else{e++;for(c=0;c<this.nestedBestRanks.length;c++)for(var r=t.ranks[c],s=0;s<r.length;s++){var a=r[s];this.setTempVariable(a,c,s)}}if(0===i)break}for(var l=[],h=[],n=0;n<t.maxRank+1;n++)h[n]=[],l[n]=h[n];for(n=0;n<this.nestedBestRanks.length;n++)for(var c=0;c<this.nestedBestRanks[n].length;c++)h[n].push(this.nestedBestRanks[n][c]);t.ranks=l},t.prototype.isVertex=function(t){return!(!t||!t.cell||!t.cell.inEdges&&!t.cell.outEdges)},t.prototype.weightedMedian=function(t,e){var i=t%2==0;if(i)for(n=e.maxRank-1;n>=0;n--)this.medianRank(n,i);else for(var n=1;n<e.maxRank;n++)this.medianRank(n,i)},t.prototype.getConnectedCellsOnLayer=function(t,e,i){void 0===i&&(i=!1);var n="nextLayerConnectedCells",o="connectsAsTarget";if(i&&(n="previousLayerConnectedCells",o="connectsAsSource"),t){if(this.isVertex(t)){if(null==t[n]){t[n]=[],t[n][0]=[];for(s=0;s<t[o].length;s++){var r=t[o][s];void 0===r.maxRank&&(r.maxRank=-1),-1===r.maxRank||(i?r.minRank===e-1:r.maxRank===e+1)?t[n][0].push(i?r.target:r.source):t[n][0].push(r)}}return t[n][0]}if(null==t[n]){t[n]=[];for(var s=0;s<t.temp.length;s++)t[n][s]=[],s===(i?0:t.temp.length-1)?t[n][s].push(i?t.target:t.source):t[n][s].push(t)}return t[n][e-t.minRank-1]}return null},t.prototype.medianValue=function(t,e){for(var i=[],n=0,o=0;o<t.length;o++){var r=t[o];i[n++]=this.getTempVariable(r,e)}if(i.sort(function(t,e){return t-e}),n%2==1)return i[Math.floor(n/2)];if(2===n)return(i[0]+i[1])/2;var s=n/2,a=i[s-1]-i[0],l=i[n-1]-i[s];return(i[s-1]*l+i[s]*a)/(a+l)},t.prototype.setTempVariable=function(t,e,i){t&&(t.temp[0]=i)},t.prototype.medianRank=function(t,e){for(var i=this.nestedBestRanks[t].length,n=[],o=[],r=0;r<i;r++){var s=this.nestedBestRanks[t][r],a={medianValue:0};a.cell=s;var l=void 0;l=e?this.getConnectedCellsOnLayer(s,t):this.getConnectedCellsOnLayer(s,t,!0);var h=void 0;h=e?t+1:t-1,null!=l&&0!==l.length?(a.medianValue=this.medianValue(l,h),n.push(a)):o[this.getTempVariable(s,t)]=!0}n.sort(this.compare);for(r=0;r<i;r++)if(null==o[r]){s=n.shift().cell;this.setTempVariable(s,t,r)}},t.prototype.compare=function(t,e){if(null!=t&&null!=e){if(e.medianValue>t.medianValue)return-1;if(e.medianValue<t.medianValue)return 1}return 0},t}(),dv=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),pv=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},uv=function(t){var e=t;return e.sourcePoint||e.targetPoint||e.sourceID||e.targetID||e.sourcePortID||e.targetPortID||e.sourceDecorator||e.targetDecorator?Vd:(t.shape&&(t.shape instanceof Kd||t.shape.type),gp)},gv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return dv(e,t),pv([et("")],e.prototype,"id",void 0),pv([et()],e.prototype,"height",void 0),pv([et(!0)],e.prototype,"expanded",void 0),pv([et("")],e.prototype,"iconCss",void 0),pv([et("")],e.prototype,"title",void 0),pv([rt(uv)],e.prototype,"symbols",void 0),e}(qa),mv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return dv(e,t),pv([et()],e.prototype,"width",void 0),pv([et()],e.prototype,"height",void 0),pv([it({},sh)],e.prototype,"offset",void 0),e}(qa),fv=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.symbolTable={},n.info="info",n.helper=function(t){var e,i=t.sender.target.id.split("_container")[0],o=n.symbolTable[i];if(o&&n.selectedSymbol){n.selectedSymbols=n.selectedSymbol.id===o.id?o:n.selectedSymbol;n.getMousePosition(t.sender);(e=n.getSymbolPreview(n.selectedSymbols,t.sender,n.element)).setAttribute("paletteId",n.element.id)}return e},n}return dv(e,t),e.prototype.onPropertyChanged=function(t,e){for(var i=!1,n=0,o=Object.keys(t);n<o.length;n++)switch(o[n]){case"width":this.element.style.width=this.width.toString();break;case"height":this.element.style.height=this.height.toString();break;case"symbolPreview":break;case"symbolWidth":case"symbolHeight":case"getSymbolInfo":i=!0;break;case"enableSearch":if(t.enableSearch)this.createTextbox();else{var r=document.getElementById(this.element.id+"_search");r&&r.parentNode.removeChild(r)}break;case"palettes":for(var s=0,a=Object.keys(t.palettes);s<a.length;s++){var l=a[s],h=Number(l);void 0!==t.palettes[h].iconCss&&(this.accordionElement.items[h].iconCss=t.palettes[h].iconCss,i=!0),void 0!==t.palettes[h].expanded&&(this.palettes[h].isInteraction?this.palettes[h].isInteraction=!1:(this.accordionElement.items[h].expanded=t.palettes[h].expanded,i=!0))}break;case"enableAnimation":this.enableAnimation?this.accordionElement.animation={expand:{duration:400},collapse:{duration:400}}:this.accordionElement.animation={expand:{duration:0},collapse:{duration:0}};break;case"expandMode":this.accordionElement.expandMode=this.expandMode,i=!0}i&&this.refreshPalettes()},e.prototype.getPersistData=function(){var t=["loaded"];return this.addOnPersist(t)},e.prototype.preRender=function(){var t=this;this.element.style.overflow="auto",this.element.style.height=this.height.toString(),this.element.style.width=this.width.toString(),this.enableSearch&&this.createTextbox();var e=L("div",{id:this.element.id+"_container"});this.accordionElement=new _m({expandMode:this.expandMode}),this.enableAnimation||(this.accordionElement.animation={expand:{duration:0},collapse:{duration:0}}),this.accordionElement.expanded=function(e){var i=t.accordionElement.items.indexOf(e.item);t.palettes[i].expanded=e.isExpanded,t.palettes[i].isInteraction=!0},this.element.appendChild(e),ni(),this.unWireEvents(),this.wireEvents()},e.prototype.render=function(){this.diagramRenderer=new bp(this.element.id,new dh,!1),this.svgRenderer=new bp(this.element.id,new dh,!0),this.updatePalettes(),this.accordionElement.appendTo("#"+this.element.id+"_container")},e.prototype.getModuleName=function(){return"SymbolPalette"},e.prototype.requiredModules=function(){var t=[];return t.push({member:"Bpmn",args:[]}),t},e.prototype.destroy=function(){if(this.allowDrag){this.draggable.destroy(),this.unWireEvents(),this.notify("destroy",{}),t.prototype.destroy.call(this);var e=document.getElementById(this.element.id+"_container");if(e){this.element.removeChild(e);window.measureElement&&(window.measureElement.usageCount-=1,0===window.measureElement.usageCount&&(window.measureElement.parentNode.removeChild(window.measureElement),window.measureElement=null))}this.element.classList.remove("e-symbolpalette")}},e.prototype.initSymbols=function(t){for(var e=0,i=t.symbols;e<i.length;e++){var n=i[e];if(n instanceof gp){var o=fe(this.getNodeDefaults);o&&o(n,this)}else if(n instanceof Vd){var r=fe(this.getConnectorDefaults);r&&r(n,this)}this.prepareSymbol(n),this.symbolTable[n.id]=n}},e.prototype.renderPalette=function(t){var e=document.createElement("div");e.setAttribute("id",t.id);var i="display:none;overflow:auto;";t.height&&(i+="height:"+t.height+"px"),e.setAttribute("style",i),this.element.appendChild(e);var n={header:t.title,expanded:t.expanded,content:"#"+t.id,iconCss:t.iconCss};this.accordionElement.items.push(n),this.renderSymbols(t,e)},e.prototype.addPaletteItem=function(t,e){for(var i=0;i<this.palettes.length;i++){var n=this.palettes[i];if(-1!==n.id.indexOf(t)){for(var o=[void 0,n,"symbols",{},!0],r=new(Function.prototype.bind.apply(uv(e),o)),s=0;s<Object.keys(e).length;s++)r[Object.keys(e)[s]]=e[Object.keys(e)[s]];n.symbols.push(r),this.prepareSymbol(r),this.symbolTable[r.id]=r;var a=document.getElementById(n.id);a.appendChild(this.getSymbolContainer(r,a));break}}},e.prototype.removePaletteItem=function(t,e){for(var i,n=0;n<this.palettes.length;n++){var o=this.palettes[n];if(-1!==o.id.indexOf(t))for(var r=0,s=o.symbols;r<s.length;r++){var a=s[r];if(-1!==a.id.indexOf(e)){var l=o.symbols.indexOf(a);o.symbols.splice(l,1),delete this.symbolTable[a.id];var h=document.getElementById(a.id+"_container");h.parentNode.removeChild(h),i=!0;break}}if(i)break}},e.prototype.prepareSymbol=function(t){var e,i,n,o,r,s=new Cu,a=t,l=new sc,h=fe(this.getSymbolTemplate);h&&(r=h(t)),r||(r=t.init(this));var c={width:this.symbolWidth,height:this.symbolHeight},d=fe(this.getSymbolInfo);if(d&&(c=d(t)),c=c||{},r.relativeMode="Object",r.horizontalAlignment=r.verticalAlignment="Center",l.style.strokeColor=l.style.fill="none",l.children=[r],r.measure(new nh),r.arrange(r.desiredSize),e=c.width=c.width||(void 0!==a.width?r.actualSize.width:void 0)||this.symbolWidth,n=c.height=c.height||(void 0!==a.height?r.actualSize.height:void 0)||this.symbolHeight,void 0!==e&&void 0!==n){var p=e,u=n;void 0!==this.symbolWidth?p=this.symbolWidth-this.symbolMargin.left-this.symbolMargin.right:e+=a.style.strokeWidth,void 0!==this.symbolHeight?u=this.symbolHeight-this.symbolMargin.top-this.symbolMargin.bottom:n+=a.style.strokeWidth,c.description&&""!==c.description.text&&(u-=20),i=p/(r.width||e),o=u/(r.height||n),c.fit&&(i=p/c.width,o=u/c.height),e=p,n=u,i=o=Math.min(i,o),l.width=e,l.height=n,r.width=c.width,r.height=c.height,this.scaleSymbol(t,l,i,o,e,n)}else{var g=void 0;t instanceof Vd&&(g=Ko(t)),r.width=t.width||g?g.width:r.actualSize.width,r.height=t.height||g?g.height:r.actualSize.height}t.wrapper=s,s.children=[l],r.pivot=s.pivot={x:0,y:0},s.id=r.id+"_symbol",s.style.fill=s.style.strokeColor="transparent",s.offsetX=t.style.strokeWidth/2,s.offsetY=t.style.strokeWidth/2,this.getSymbolDescription(c,e,s),s.measure(new nh),s.arrange(s.desiredSize),c.width=c.width||r.actualSize.width,c.height=c.height||r.actualSize.height,t[this.info]=c},e.prototype.getSymbolDescription=function(t,e,i){if(t&&t.description&&t.description.text){var n=new Fh;t.description.overflow=t.description.overflow||"Ellipsis",t.description.wrap=t.description.wrap||"WrapWithOverflow",n.content=t.description.text,n.width=e,n.height=20,n.style.strokeColor="transparent",n.style.fill="transparent",n.style.strokeWidth=0,n.style.textWrapping=t.description.wrap,n.style.textOverflow=t.description.overflow,n.margin={left:0,right:0,top:0,bottom:5},i.children.push(n)}},e.prototype.renderSymbols=function(t,e){for(var i=0,n=t.symbols;i<n.length;i++){var o=n[i];this.getSymbolContainer(o,e)}},e.prototype.getSymbolPreview=function(t,e,i){var n,o,r,s=t.wrapper.children[0].desiredSize.width+t.style.strokeWidth,a=t.wrapper.children[0].desiredSize.height+t.style.strokeWidth,l=t.wrapper.children[0].children[0];if(void 0!==this.symbolPreview.width||void 0!==this.symbolPreview.height){s=(this.symbolPreview.width||s)-t.style.strokeWidth,a=(this.symbolPreview.height||a)-t.style.strokeWidth,o=s/l.actualSize.width,r=a/l.actualSize.height,o=r=Math.min(o,r);var h=l.actualSize.width*o,c=l.actualSize.height*r;t.wrapper.children[0].width=s,t.wrapper.children[0].height=a,this.measureAndArrangeSymbol(l),this.scaleSymbol(t,t.wrapper.children[0],o,r,h,c),s=h,a=c}var d={x:l.offsetX,y:l.offsetY};l.offsetX=l.offsetY=t.style.strokeWidth/2,l.pivot={x:0,y:0},this.measureAndArrangeSymbol(l);var p,u=L("div");u.setAttribute("draggable","true"),u.setAttribute("class","e-dragclone"),u.style.pointerEvents="none",document.body.appendChild(u);var g="margin:5px;";if("Native"===t.shape.type){n=Ge("svg",{id:t.id+"_preview",width:Math.ceil(s)+1,height:Math.ceil(a)+1});var m=Ge("g",{id:t.id+"_g"});n.appendChild(m),u.appendChild(n),this.svgRenderer.renderElement(l,m,void 0,void 0,n)}else"HTML"===t.shape.type?p=this.getHtmlSymbol(t,n,u,a,s,!0):(n=ch.createCanvas(t.id+"_preview",2*(Math.ceil(s)+t.style.strokeWidth+1),2*(Math.ceil(a)+t.style.strokeWidth+1)),u.appendChild(n),g+="transform:scale(0.5);",n.setAttribute("transform-origin","0 0"),n.getContext("2d").setTransform(2,0,0,2,0,0),this.diagramRenderer.renderElement(l,n,void 0));return(p&&"HTML"===t.shape.type?p:n).setAttribute("style",g),l.offsetX=d.x,l.offsetY=d.y,u},e.prototype.measureAndArrangeSymbol=function(t){t.children&&(t.children[0].transform=wh.Self),t.measure(new nh),t.arrange(t.desiredSize),t.children&&(t.children[0].transform=wh.Parent)},e.prototype.updateSymbolSize=function(t,e,i){var n=t.wrapper.children[0].children[0],o=t.style.strokeWidth;n.width=(e||n.width)-(o+1),n.height=(i||n.height)-(o+1),t.wrapper.measure(new nh),t.wrapper.arrange(t.wrapper.desiredSize)},e.prototype.getSymbolContainer=function(t,e,i){var n=this.symbolTable[t.id][this.info],o=this.getSymbolSize(t,n),r=o.width+1,s=o.height+1,a=L("div",{id:t.id+"_container",styles:"width:"+r+"px;height:"+s+"px;float:left;overflow:hidden"});a.setAttribute("title",n.description?n.description.text:t.id),e.appendChild(a);var l,h,c;if("Native"===t.shape.type?(l=Ge("svg",{id:t.id,width:Math.ceil(t.wrapper.actualSize.width)+1,height:Math.ceil(t.wrapper.actualSize.height)+1}),h=Ge("g",{id:t.id+"_g"}),l.appendChild(h),a.appendChild(l),this.updateSymbolSize(t),this.svgRenderer.renderElement(t.wrapper,h,void 0,void 0,l)):"HTML"===t.shape.type?c=this.getHtmlSymbol(t,l,a,t.wrapper.actualSize.height,t.wrapper.actualSize.width,!1):(l=ch.createCanvas(t.id,Math.ceil(2*(t.wrapper.actualSize.width+t.style.strokeWidth))+1,Math.ceil(2*(t.wrapper.actualSize.height+t.style.strokeWidth))+1),a.appendChild(l),l.getContext("2d").setTransform(2,0,0,2,0,0),this.diagramRenderer.renderElement(t.wrapper,h||l,void 0)),!i){var d=t.wrapper.actualSize.width+t.style.strokeWidth,p=t.wrapper.actualSize.height+t.style.strokeWidth,u="margin-left:"+Math.max(this.symbolMargin.left,(r-d)/2)+"px;margin-top:"+Math.max(this.symbolMargin.top,(s-p)/2)+"px;pointer-events:none;transform-origin:0 0;overflow:hidden;";return l instanceof HTMLCanvasElement&&(u+="transform:scale(.5,.5);"),(c&&"HTML"===t.shape.type?c:l).setAttribute("style",u),a.classList.add("e-symbol-draggable"),a}return l},e.prototype.getHtmlSymbol=function(t,e,i,n,o,r){var s=Ye("div",{id:t.id+(r?"_html_div_preview":"_html_div")}),a=Ye("div",{id:t.id+(r?"_htmlLayer_preview":"_htmlLayer"),style:"width:"+Math.ceil(o+1)+"px;height:"+Math.ceil(n+1)+"px;position:absolute",class:"e-html-layer"}),l=Ye("div",{id:t.id+(r?"_htmlLayer_div_preview":"_htmlLayer_div"),style:"width:"+Math.ceil(o+1)+"px;height:"+Math.ceil(n+1)+"px;position:absolute"});return a.appendChild(l),s.appendChild(a),e=ch.createCanvas(r?t.id+"_preview":t.id,Math.ceil(o)+1,Math.ceil(n)+1),s.appendChild(e),i.appendChild(s),this.diagramRenderer.renderElement(t.wrapper.children[0].children[0],e,a),s},e.prototype.getSymbolSize=function(t,e){var i=t.wrapper.actualSize.width,n=t.wrapper.actualSize.height;return this.symbolWidth||this.symbolHeight?(i=this.symbolWidth,n=Math.max(this.symbolHeight,n)):(i+=this.symbolMargin.left+this.symbolMargin.right+t.style.strokeWidth,n+=this.symbolMargin.top+this.symbolMargin.bottom+t.style.strokeWidth),new nh(i,n)},e.prototype.getMousePosition=function(t){var e,i,n;if(-1!==t.type.indexOf("touch")){var o=(n=t).changedTouches[0].clientY,r=n.changedTouches[0].clientX;e=o-this.element.offsetTop,i=r-this.element.offsetLeft}else e=t.clientY-this.element.offsetTop,i=t.clientX-this.element.offsetLeft;return{x:i,y:e}},e.prototype.mouseMove=function(t,e){!this.highlightedSymbol||this.selectedSymbol&&this.selectedSymbol.id+"_container"===this.highlightedSymbol.id||(this.highlightedSymbol.classList.remove("e-symbol-hover"),this.highlightedSymbol.style.backgroundColor="",this.highlightedSymbol=null);var i=t.target.id.split("_container")[0];if(this.symbolTable[i]){var n=document.getElementById(i+"_container");n.classList.add("e-symbol-hover"),this.highlightedSymbol=n}t.preventDefault()},e.prototype.mouseUp=function(t){if(t&&t.target)if("iconSearch"===t.srcElement.id){var e=document.getElementById("iconSearch");e.classList.contains("e-clear-searchtext")&&(e.className="e-input-group-icon e-search e-icons",document.getElementById("textEnter").value="",this.searchPalette(""))}else t.preventDefault()},e.prototype.keyUp=function(t){var e=this;if(this.enableSearch){var i=this;document.getElementById("iconSearch").className="e-input-group-icon e-clear-searchtext e-icons",!t||"Enter"!==t.key&&13!==t.keyCode?(this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){t.target instanceof HTMLInputElement&&(i.searchPalette(t.target.value),e.timer=null)},500)):t.target instanceof HTMLInputElement&&this.searchPalette(t.target.value)}},e.prototype.mouseDown=function(t){var e=t.target.id.split("_container")[0];if(this.selectedSymbol){if(e!==this.selectedSymbol.id){document.getElementById(this.selectedSymbol.id+"_container").classList.remove("e-symbol-selected");var i={oldValue:this.selectedSymbol.id,newValue:e};this.trigger("paletteSelectionChange",i)}(n=document.getElementById(this.selectedSymbol.id+"_container")).style.backgroundColor="",this.selectedSymbol=null}if(this.symbolTable[e]){var n=document.getElementById(e+"_container");n.classList.add("e-symbol-selected"),this.selectedSymbol=this.symbolTable[e],t.preventDefault()}},e.prototype.initDraggable=function(){this.allowDrag&&(this.draggable=new Pl(this.element,{dragTarget:".e-symbol-draggable",helper:this.helper,dragStart:this.dragStart,dragStop:this.dragStop,drag:function(t){var e=Ze(t.target,"e-droppable");if(e&&e.classList.contains("e-diagram")){e.ej2_instances[0].droppable.over(t)}},cursorAt:{left:this.symbolPreview.offset.x,top:this.symbolPreview.offset.y}}))},e.prototype.dragStart=function(t){var e=this.helper[0];e&&e.setAttribute("paletteId",this.element.id)},e.prototype.dragStop=function(t){Ze(t.target,"e-diagram")||M(t.helper)},e.prototype.scaleSymbol=function(t,e,i,n,o,r){if(t instanceof Vd){p=t.wrapper;t.wrapper=e.children[0];for(var s=t.scale(i,n,o,r,e.children[0]),a=o/2-e.children[0].children[0].offsetX+s.x/2,l=r/2-e.children[0].children[0].offsetY+s.y/2,h=0,c=e.children[0].children;h<c.length;h++){var d=c[h];d.offsetX+=a,d.offsetY+=l,d.staticSize=!1}t.wrapper=p}else if(t.shape instanceof up&&this.bpmnModule){var p=t.wrapper;t.wrapper=e,e.children[0].width=o,e.children[0].height=r,this.bpmnModule.updateBPMN({width:o,height:r},t,t,null),t.wrapper=p}else Ls(e.children[0],i,n,e)},e.prototype.refreshPalettes=function(){this.accordionElement.items=[],this.updatePalettes(),this.accordionElement.dataBind()},e.prototype.updatePalettes=function(){for(var t=0;t<this.palettes.length;t++){var e=this.palettes[t];this.initSymbols(e),this.renderPalette(e)}},e.prototype.createTextbox=function(){var t=L("div",{id:this.element.id+"_search"});t.setAttribute("style","backgroundColor:white;height:30px"),t.className="e-input-group",this.element.appendChild(t);var e=document.createElement("input");e.placeholder="Search Shapes",e.id="textEnter",e.setAttribute("style","width:100%;height:auto"),e.className="e-input",t.appendChild(e);var i=L("span",{id:"iconSearch",className:"e-input-group-icon e-search e-icons"});t.appendChild(i)},e.prototype.searchPalette=function(t){var e,i=[],n=document.getElementById("SearchPalette");if(n)for(var o=n.children.length-1;o>=0;o--)n.removeChild(n.children[o]);for(var r=0;r<this.palettes.length;r++)for(var s=this.palettes[r],a=0;a<s.symbols.length;a++){var l=s.symbols[a];""!==t&&-1!==l.id.toLowerCase().indexOf(t.toLowerCase())&&i.push(l)}var h=fe(this.filterSymbols);if(h&&(i=h(i)||[]),n||(n=e=this.createSearchPalette(e)),i.length>0)for(var c=0,d=i;c<d.length;c++){var p=d[c];this.getSymbolContainer(p,n)}else if(""!==t){var u=document.createElement("div");u.setAttribute("id","EmptyDiv"),u.innerHTML="No Items To Display",u.setAttribute("style","textAlign:center;fontStyle:italic"),n.appendChild(u)}else document.getElementById("iconSearch").className="e-input-group-icon e-search e-icons",this.accordionElement.removeItem(0)},e.prototype.createSearchPalette=function(t){(t=document.createElement("div")).setAttribute("id","SearchPalette"),t.setAttribute("style","display:none;overflow:auto;"),this.element.appendChild(t);var e={header:"Search Results",expanded:!0,content:"#SearchPalette"};return this.accordionElement.addItem(e,0),t},e.prototype.wireEvents=function(){var t=za.touchStartEvent,e=za.touchEndEvent,i=za.touchMoveEvent;Ma.add(this.element,t,this.mouseDown,this),Ma.add(this.element,i,this.mouseMove,this),Ma.add(this.element,e,this.mouseUp,this),Ma.add(this.element,"keyup",this.keyUp,this),this.initDraggable()},e.prototype.unWireEvents=function(){var t=za.touchStartEvent,e=za.touchEndEvent,i=za.touchMoveEvent;Ma.remove(this.element,t,this.mouseDown),Ma.remove(this.element,i,this.mouseMove),Ma.remove(this.element,e,this.mouseUp),Ma.remove(this.element,"keyup",this.keyUp)},pv([et("S")],e.prototype,"accessKey",void 0),pv([et("100%")],e.prototype,"width",void 0),pv([et("100%")],e.prototype,"height",void 0),pv([ot([],gv)],e.prototype,"palettes",void 0),pv([et()],e.prototype,"getSymbolInfo",void 0),pv([et()],e.prototype,"filterSymbols",void 0),pv([et()],e.prototype,"getSymbolTemplate",void 0),pv([et()],e.prototype,"symbolWidth",void 0),pv([et()],e.prototype,"symbolHeight",void 0),pv([it({left:10,right:10,top:10,bottom:10},Xh)],e.prototype,"symbolMargin",void 0),pv([et(!0)],e.prototype,"allowDrag",void 0),pv([it({},mv)],e.prototype,"symbolPreview",void 0),pv([et(!1)],e.prototype,"enableSearch",void 0),pv([et(!0)],e.prototype,"enableAnimation",void 0),pv([et("Multiple")],e.prototype,"expandMode",void 0),pv([st()],e.prototype,"paletteSelectionChange",void 0),pv([et()],e.prototype,"getNodeDefaults",void 0),pv([et()],e.prototype,"getConnectorDefaults",void 0),e}(wl),vv=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),yv=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},bv=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.mode="Canvas",n.id="overview",n.actionName="",n.startPoint=null,n.currentPoint=null,n.prevPoint=null,n.scale=null,n.inAction=!1,n.viewPortRatio=1,n.horizontalOffset=0,n.verticalOffset=0,n.model={},n.event=!0,n.model={width:n.width,height:n.height},n}return vv(e,t),e.prototype.onPropertyChanged=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++)switch(n[i]){case"sourceID":this.setParent(t.sourceID);break;case"width":case"height":this.renderCanvas(),this.setParent(this.sourceID)}},e.prototype.getPersistData=function(){var t=["loaded"];return this.addOnPersist(t)},e.prototype.preRender=function(){this.element.style.background="transparent",this.unWireEvents(),this.wireEvents()},e.prototype.render=function(){this.diagramRenderer=new bp(this.element.id,new dh,!1),this.renderCanvas(),this.setParent(this.sourceID)},e.prototype.getSizeValue=function(t){return t.toString().indexOf("px")>0||t.toString().indexOf("%")>0?t.toString():t.toString()+"px"},e.prototype.renderCanvas=function(t){var e=document.getElementById(this.element.id+"_canvas");e||(e=document.createElement("div"),this.element.appendChild(e)),ii(e,{id:this.element.id+"_canvas",class:"drawing",style:"position:relative; height:"+this.getSizeValue(this.model.height)+"; width:"+this.getSizeValue(this.model.width)+";style:-ms-touch-action: none;touch-action: none;"}),this.element.setAttribute("tabindex",String(0)),this.element.style.overflow="hidden",this.element.style.height=String(this.model.height),this.element.style.width=String(this.model.width),this.canvas=e},e.prototype.setParent=function(t){var e=document.getElementById(t);if(this.parent){var i=this.parent;this.parent=null,i.setOverview(null,this.id),this.removeDocument(this)}this.parent=this.getDiagram(e,"ej2_instances"),this.parent&&this.parent.setOverview(this)},e.prototype.getDiagram=function(t,e){for(var i,n=t[e].length,o=0;o<n;o++)if(Ke(t[e][o].element,"e-diagram")){i=t[e][o];break}return i},e.prototype.unWireEvents=function(){var t=za.touchStartEvent,e=za.touchMoveEvent,i=za.isPointer?"pointerleave":"mouseleave",n=za.isPointer,o=(za.info.name,za.touchEndEvent);Ma.remove(this.element,t,this.mouseDown),Ma.remove(this.element,e,this.mouseMove),Ma.remove(this.element,o,this.mouseUp),Ma.remove(this.element,i,this.documentMouseUp),Ma.remove(window,"resize",this.windowResize);var r=document.getElementById(this.sourceID+"content");r&&Ma.remove(r,"scroll",this.scrolled)},e.prototype.wireEvents=function(){var t=za.touchStartEvent,e=za.touchEndEvent,i=za.touchMoveEvent,n=za.isPointer?"pointerleave":"mouseleave",o=za.isPointer;za.info.name;Ma.add(this.element,t,this.mouseDown,this),Ma.add(this.element,i,this.mouseMove,this),Ma.add(this.element,e,this.mouseUp,this),Ma.add(this.element,n,this.documentMouseUp,this),Ma.add(window,"resize",this.windowResize,this);var r=document.getElementById(this.sourceID+"content");r&&Ma.add(r,"scroll",this.scrolled,this)},e.prototype.renderDocument=function(t){t.canvas=this.canvas;var e=document.getElementById(this.canvas.id+"_svg");e&&e.parentNode.removeChild(e);var i=Ge("svg",{id:this.canvas.id+"_svg",version:"1.1",xlink:"http://www.w3.org/1999/xlink",class:"overview_svg"});this.svg=i,t.svg=i,t.canvas.appendChild(i);var n=document.getElementById(this.element.id),o=n.clientWidth,r=n.clientHeight,s=n.getBoundingClientRect(),a=window.screenX<0?-1*window.screenX:window.screenX,l=window.screenY<0?-1*window.screenY:window.screenY;0===o&&(o=Math.floor(window.innerWidth-a-Math.floor(s.left))),0===r&&(r=Math.floor(window.innerHeight-l-Math.floor(s.top))),i.setAttribute("width",String(o)),i.setAttribute("height",String(r)),this.model.width=o,this.model.height=r;var h;if(!t.diagramLayerDiv){t.diagramLayerDiv=document.createElement("div");document.getElementById(this.element.id);t.diagramLayer=ch.createCanvas(this.element.id+"_diagramLayer",this.model.width,this.model.height),t.diagramLayer.setAttribute("style","position:absolute; left:0px;  top:0px "),t.diagramLayerDiv.appendChild(t.diagramLayer),t.canvas.appendChild(t.diagramLayerDiv)}h={id:this.element.id+"_diagramLayer_div",style:"width:"+this.model.width+"px; height:"+this.model.height+"px;position:absolute;top:0px;left:0px"},ii(t.diagramLayerDiv,h),this.renderHtmlLayer(t.canvas),this.renderNativeLayer(t.canvas,t),this.addOverviewRectPanel(t)},e.prototype.removeDocument=function(t){var e=document.getElementById(this.canvas.id+"_svg");this.canvas.removeChild(e);var i=document.getElementById(this.element.id+"_htmlLayer");this.canvas.removeChild(i);var n=document.getElementById(this.id+"_diagramLayer_div");this.canvas.removeChild(n),t.diagramLayerDiv=null,t.diagramLayer=null},e.prototype.renderHtmlLayer=function(t){var e=document.createElement("div");ii(e,{id:this.element.id+"_htmlLayer",class:"e-html-layer"});var i=e;e.style.pointerEvents="none",e.style.position="absolute",e.style.left="0px",e.style.top="0px";var n=document.createElement("div");return ii(n,{id:this.element.id+"_htmlLayer_div",style:"position:absolute;top:0px;left:0px;"}),i.appendChild(n),t.appendChild(i),i},e.prototype.renderNativeLayer=function(t,e){var i=this.parent.createSvg(this.element.id+"_nativeLayer_svg",this.model.width,this.model.height),n=Ge("g",{id:this.element.id+"_nativeLayer"});i.appendChild(n),e.diagramLayerDiv.appendChild(i),ei(i,{class:"e-native-layer"})},e.prototype.addOverviewRectPanel=function(t){var e=document.getElementById(this.canvas.id+"_overviewsvg");e&&e.parentNode.removeChild(e),e=Ge("svg",{id:this.canvas.id+"_overviewsvg",version:"1.1",xlink:"http://www.w3.org/1999/xlink",style:"position:absolute;left:0px;top:0px; aria-label:Specifies overview",width:this.model.width,height:this.model.height}),t.canvas.appendChild(e);var i=Ge("g",{id:this.id+"_overviewlayer",style:"pointer-events:none"});e.appendChild(i);var n=Ge("rect",{fill:"transparent",width:"100%",height:"100%",class:"overviewbackrect",id:this.canvas.id+"overviewbackrect"});n.setAttribute("style"," pointer-events: none; "),i.appendChild(n);var o=Ge("g",{id:this.canvas.id+"overviewhandle",style:"pointer-events:all"});i.appendChild(o);var r=Ge("rect",{id:this.canvas.id+"overviewrect",fill:"transparent"});o.appendChild(r),this.renderOverviewCorner("left",o),this.renderOverviewCorner("right",o),this.renderOverviewCorner("top",o),this.renderOverviewCorner("bottom",o),this.renderOverviewCorner("topleft",o),this.renderOverviewCorner("topright",o),this.renderOverviewCorner("bottomleft",o),this.renderOverviewCorner("bottomright",o)},e.prototype.renderOverviewCorner=function(t,e){this.svg;var i,n=Ge(i="top"===t||"bottom"===t||"right"===t||"left"===t?"rect":"circle",{id:this.canvas.id+"visible"+t});e.appendChild(n);var o=Ge(i,{id:this.canvas.id+t,class:"overviewresizer",fill:"transparent"});e.appendChild(o)},e.prototype.updateOverviewRectangle=function(){var t=this.currentPoint.x-this.prevPoint.x,e=this.currentPoint.y-this.prevPoint.y,i=new nh;i.width=0,i.height=0;var n=0,o=0;switch(this.resizeDirection){case"left":i.width-=t,i.height-=t/this.viewPortRatio,n=t,o=t/this.viewPortRatio,o/=2;break;case"right":i.width+=t,i.height+=t/this.viewPortRatio,o=t/this.viewPortRatio,o/=-2;break;case"top":i.height-=e,i.width-=e*this.viewPortRatio,o=e,n=e*this.viewPortRatio,n/=2;break;case"bottom":i.height+=e,i.width+=e*this.viewPortRatio,n=e*this.viewPortRatio,n/=-2;break;case"topleft":Math.abs(e)>Math.abs(t)?t=e*this.viewPortRatio:e=t/this.viewPortRatio,i.width-=t,i.height-=e,n=t,o=e;break;case"topright":Math.abs(e)>Math.abs(t)?t=-e*this.viewPortRatio:e=-t/this.viewPortRatio,o=e,i.width+=t,i.height-=e;break;case"bottomleft":Math.abs(e)>Math.abs(t)?t=-e*this.viewPortRatio:e=-t/this.viewPortRatio,n=t,i.width-=t,i.height+=e;break;case"bottomright":Math.abs(e)>Math.abs(t)?t=e*this.viewPortRatio:e=t/this.viewPortRatio,i.width+=t,i.height+=e}this.updateHelper(n,o,i,void 0,void 0)},e.prototype.updateHelper=function(t,e,i,n,o){var r,s,a,l=this.element.getElementsByTagName("svg")[2].getElementById("helper");if(i)r=(a=l.getBBox()).x+t,s=a.y+e,n=a.width+i.width,o=a.height+i.height;else{var h;h=this.currentPoint.x>this.startPoint.x?this.currentPoint.x-this.prevPoint.x:this.prevPoint.x-this.currentPoint.x;var c;c=this.currentPoint.y>this.startPoint.y?this.currentPoint.y-this.prevPoint.y:this.prevPoint.y-this.currentPoint.y,Math.abs(c)>Math.abs(h)?h=this.viewPortRatio*c:c=h/this.viewPortRatio,a=l.getBBox(),r=this.startPoint.x>this.currentPoint.x?a.x-h:a.x,s=this.startPoint.y>this.currentPoint.y?a.y-c:a.y,n=a.width+h,o=a.height+c}ei(this.helper,{id:this.helper.id,x:r,y:s,width:Math.max(0,n),height:Math.max(0,o)})},e.prototype.updateOverviewrect=function(t,e,i,n){ii(document.getElementById(this.canvas.id+"overviewrect"),{x:t,y:e,width:Math.max(1,i),height:Math.max(1,n)}),this.updateOverviewCorner("top",t+8,e-2,Math.max(0,i-16),2),this.updateOverviewCorner("bottom",t+8,e+n,Math.max(0,i-16),2),this.updateOverviewCorner("left",t-2,e+8,2,Math.max(0,n-16)),this.updateOverviewCorner("right",t+i,e+8,2,Math.max(0,n-16)),this.updateOverviewCorner("topleft",t,e,5,5),this.updateOverviewCorner("topright",t+i,e,5,5),this.updateOverviewCorner("bottomleft",t,e+n,5,5),this.updateOverviewCorner("bottomright",t+i,e+n,5,5)},e.prototype.updateOverviewCorner=function(t,e,i,n,o){var r,s,a="visible"+t,l=document.getElementById(this.canvas.id+a);"top"===t||"bottom"===t||"right"===t||"left"===t?(r={x:e,y:i,width:n,height:o,fill:"#ED1C24"},s={x:e-2,y:i-2,width:2===n?4:n,height:2===o?4:o}):(r={cx:e,cy:i,r:4,fill:"#ED1C24"},s={cx:e,cy:i,r:6,fill:"transparent"}),ii(l,r),ii(document.getElementById(this.canvas.id+t),s)},e.prototype.translateOverviewRectangle=function(){var t=Number(this.model.width),e=Number(this.model.height),i=this.currentPoint.x-this.prevPoint.x,n=this.currentPoint.y-this.prevPoint.y,o=(Math.min(this.parent.scroller.viewPortWidth/t,this.parent.scroller.viewPortHeight/e),this.element.getElementsByTagName("svg")[2].getElementById(this.canvas.id+"overviewrect").getBBox()),r=o.x+i,s=o.y+n,a=o.width,l=o.height;this.updateOverviewrect(r,s,a,l),this.updateParentView(this.parent.scroller.currentZoom,r,s,a,l,null)},e.prototype.renderOverviewRect=function(t,e,i,n){var o=Number(this.model.width),r=Number(this.model.height),s=i/o*this.contentWidth,a=n/r*this.contentHeight,l=Math.max(this.parent.scroller.viewPortWidth/s,this.parent.scroller.viewPortHeight/a);if(l>=.25&&l<=30){var h={x:0,y:0};this.updateParentView(l,t,e,i,n,h);var c=this.scrollOverviewRect(this.parent.scroller.horizontalOffset,this.parent.scroller.verticalOffset,this.parent.scroller.currentZoom,!0);if(this.helper){var d=this.element.getElementsByTagName("rect")[10].getBBox();c.x=d.x,c.y=d.y}this.updateOverviewrect(c.x,c.y,c.width,c.height)}},e.prototype.scrollOverviewRect=function(t,e,i,n){if(!this.actionName||n){var o=Number(this.model.width),r=Number(this.model.height),s=Math.min(this.contentWidth/o,this.contentHeight/r),a=new ah,l=a.x=t/i/s,h=a.y=e/i/s,c=a.width=this.parent.scroller.viewPortWidth/i/s,d=a.height=this.parent.scroller.viewPortHeight/i/s;this.parent.scroller.viewPortWidth,this.parent.scroller.viewPortHeight;if(n){var p=new ah;return p.x=l,p.y=h,p.width=c,p.height=d,p}this.updateOverviewrect(-l,-h,c,d)}return null},e.prototype.updateParentView=function(t,e,i,n,o,r){var s,a,l=Number(this.model.width),h=Number(this.model.height),c=e*(this.contentWidth/l)*t,d=i*(this.contentHeight/h)*t;this.parent.scroller.getPageBounds();1===t&&"pan"!==this.actionName||(s=-c-this.parent.scroller.horizontalOffset,a=-d-this.parent.scroller.verticalOffset),"scale"===this.actionName||"draw"===this.actionName?this.parent.scroller.zoom(t/this.parent.scroller.currentZoom,s,a,r):this.parent.pan(s,a,r)},e.prototype.updateView=function(t){var e,i,n=this.parent.scroller.getPageBounds();e=n.width,i=n.height;var o,r=Number(this.model.width),s=Number(this.model.height),a=Math.max(e,this.parent.scroller.viewPortWidth),l=Math.max(i,this.parent.scroller.viewPortHeight);this.contentWidth=a=Math.max(a,r/s*l),this.contentHeight=l=Math.max(l,s/r*a),o=Math.min(r/a,s/l);var h=document.getElementById(this.element.id+"_htmlLayer");h.style.webkitTransform="scale("+o+") translate("+-n.x+"px,"+-n.y+"px)",h.style.transform="scale("+o+") translate("+-n.x+"px,"+-n.y+"px)",document.getElementById(this.id+"_overviewlayer").setAttribute("transform","translate("+-n.x*o+","+-n.y*o+")"),this.horizontalOffset=n.x*o,this.verticalOffset=n.y*o;var c=document.getElementById("overview_diagramLayer"),d=qe(this.element.id),p=c.getContext("2d"),u=Number(this.model.width)/this.contentWidth,g=Number(this.model.height)/this.contentHeight;u=Math.min(u,g),d.setAttribute("transform","translate(0,0),scale("+u+")"),p.setTransform(u,0,0,u,0,0),p.fillStyle="red",this.scrollOverviewRect(this.parent.scroller.horizontalOffset,this.parent.scroller.verticalOffset,this.parent.scroller.currentZoom)},e.prototype.scrolled=function(t){if(this.event){var e=this.scrollOverviewRect(this.parent.scroller.horizontalOffset,this.parent.scroller.verticalOffset,this.parent.scroller.currentZoom,!0);this.updateOverviewrect(-e.x,-e.y,e.width,e.height)}},e.prototype.updateCursor=function(t){if(Ke(t.target,"overviewresizer"))switch(t.target.id){case this.canvas.id+"left":this.canvas.style.cursor="w-resize";break;case this.canvas.id+"right":this.canvas.style.cursor="e-resize";break;case this.canvas.id+"top":this.canvas.style.cursor="n-resize";break;case this.canvas.id+"bottom":this.canvas.style.cursor="s-resize";break;case this.canvas.id+"topleft":this.canvas.style.cursor="nw-resize";break;case this.canvas.id+"topright":this.canvas.style.cursor="ne-resize";break;case this.canvas.id+"bottomleft":this.canvas.style.cursor="sw-resize";break;case this.canvas.id+"bottomright":this.canvas.style.cursor="se-resize"}else this.canvas.style.cursor="default"},e.prototype.mouseMove=function(t){if(this.event=!1,this.updateCursor(t),this.currentPoint=this.mousePosition(t),this.actionName)switch(this.actionName){case"draw":this.inAction||this.startPoint.x===this.currentPoint.x&&this.startPoint.y===this.currentPoint.y||(this.initHelper(),this.inAction=!0),this.inAction&&this.updateHelper();break;case"scale":this.inAction||(this.initHelper(),this.inAction=!0),this.updateOverviewRectangle();break;case"pan":(this.startPoint.x!==this.currentPoint.x||this.startPoint.y===this.currentPoint.y||this.inAction)&&(this.inAction=!0,this.translateOverviewRectangle())}this.prevPoint=this.currentPoint},e.prototype.documentMouseUp=function(t){this.inAction=!1,this.actionName="",this.helper&&(this.helper.parentNode.removeChild(this.helper),this.helper=null),this.event=!0,document.getElementById(this.canvas.id+"overviewhandle").style.pointerEvents="all"},e.prototype.windowResize=function(t){var e=this;return this.resizeTo&&clearTimeout(this.resizeTo),this.resizeTo=setTimeout(function(){var t=document.getElementById(e.element.id).getBoundingClientRect();e.model.width=t.width,e.model.height=t.height,e.renderCanvas(),e.setParent(e.sourceID)},10),!1},e.prototype.mouseDown=function(t){if(t.target.id===this.canvas.id+"_overviewsvg"&&(this.actionName="draw"),t.target.id===this.canvas.id+"overviewrect"&&(this.actionName="pan"),Ke(t.target,"overviewresizer"))switch(this.actionName="scale",t.target.id){case this.canvas.id+"left":this.resizeDirection="left";break;case this.canvas.id+"right":this.resizeDirection="right";break;case this.canvas.id+"top":this.resizeDirection="top";break;case this.canvas.id+"bottom":this.resizeDirection="bottom";break;case this.canvas.id+"topleft":this.resizeDirection="topleft";break;case this.canvas.id+"topright":this.resizeDirection="topright";break;case this.canvas.id+"bottomleft":this.resizeDirection="bottomleft";break;case this.canvas.id+"bottomright":this.resizeDirection="bottomright"}this.startPoint=this.prevPoint=this.mousePosition(t),this.viewPortRatio=this.parent.scroller.viewPortWidth/this.parent.scroller.viewPortHeight,document.getElementById(this.canvas.id+"overviewhandle").style.pointerEvents="none"},e.prototype.mouseUp=function(t){this.currentPoint=this.mousePosition(t);Number(this.model.width),Number(this.model.height);if(this.actionName)if(this.startPoint.x!==this.currentPoint.x||this.startPoint.y!==this.currentPoint.y){if("pan"===this.actionName);else if(this.helper){var e=this.element.getElementsByTagName("rect")[10].getBBox();this.resizeDirection=this.resizeDirection||"";var i=e.x,n=e.y,o=e.width,r=e.height;"topleft"===this.resizeDirection||"topright"===this.resizeDirection||"bottomleft"===this.resizeDirection||this.resizeDirection;this.renderOverviewRect(i,n,o,r)}}else if(t.target.id===this.canvas.id+"_overviewsvg"||"helper"===t.target.id){var o=(e=this.element.getElementsByTagName("svg")[2].getElementById(this.canvas.id+"overviewrect").getBBox()).width,r=e.height;this.inAction=!0,this.actionName="pan",this.renderOverviewRect(this.currentPoint.x-o/2,this.currentPoint.y-r/2,o,r),this.inAction=!1}this.helper&&(this.helper.parentNode.removeChild(this.helper),this.helper=null),this.actionName="",this.startPoint=null,this.currentPoint=null,this.prevPoint=null,this.helper=null,this.viewPortRatio=1,this.resizeDirection="",this.inAction=!1,this.event=!0,document.getElementById(this.canvas.id+"overviewhandle").style.pointerEvents="all"},e.prototype.initHelper=function(){var t=this.element.getElementsByTagName("svg")[2],e=(this.parent.scroller.currentZoom,this.startPoint.x),i=this.startPoint.y,n=1,o=1;if("scale"===this.actionName){var r=t.getElementById(this.canvas.id+"overviewrect").getBBox();e=r.x,i=r.y,n=r.width,o=r.height}var s=Ge("rect",{id:"helper",x:e,y:i,width:n,height:o,fill:"transparent",stroke:"gray","stroke-dasharray":"2 2","shape-rendering":"crispEdges"});t.getElementById(this.id+"_overviewlayer").appendChild(s),this.helper=s},e.prototype.mousePosition=function(t){var e,i,n;if(-1!==t.type.indexOf("touch")){var o=(e=t).changedTouches[0].clientX,r=e.changedTouches[0].clientY;i=o-this.element.offsetLeft,n=r-this.element.offsetTop}else i=t.clientX,n=t.clientY;var s=this.element.getBoundingClientRect();return i-=s.left,n-=s.top,{x:i+this.horizontalOffset,y:n+this.verticalOffset}},e.prototype.destroy=function(){if(this.unWireEvents(),this.notify("destroy",{}),t.prototype.destroy.call(this),document.getElementById(this.element.id)){this.element.classList.remove("e-overview");var e=document.getElementById(this.element.id+"_canvas");e&&this.element.removeChild(e)}this.parent.views.splice(this.parent.views.indexOf(this.id),1),this.diagramLayerDiv=null,this.canvas=null,this.parent=null},e.prototype.getModuleName=function(){return"Overview"},yv([et("100%")],e.prototype,"width",void 0),yv([et("100%")],e.prototype,"height",void 0),yv([et("")],e.prototype,"sourceID",void 0),yv([st()],e.prototype,"created",void 0),e}(wl),wv=Object.freeze({Diagram:wu,PrintAndExport:xu,Size:nh,Rect:ah,get MatrixTypes(){return xl},Matrix:hh,identityMatrix:_t,transformPointByMatrix:Wt,transformPointsByMatrix:Ut,rotateMatrix:qt,scaleMatrix:Xt,translateMatrix:Yt,multiplyMatrix:Qt,Point:sh,get PortVisibility(){return lh},get SnapConstraints(){return ph},get SelectorConstraints(){return uh},get ConnectorConstraints(){return gh},get AnnotationConstraints(){return mh},get NodeConstraints(){return fh},get ThumbsConstraints(){return vh},get DiagramConstraints(){return yh},get DiagramTools(){return bh},get Transform(){return wh},get RenderMode(){return xh},get KeyModifiers(){return Sh},get Keys(){return Ch},get DiagramAction(){return Lh},get NoOfSegments(){return Eh},get DiagramEvent(){return Ph},get PortConstraints(){return kh},contextMenuClick:"contextMenuClick",contextMenuOpen:"contextMenuOpen",Thickness:qh,Margin:Xh,Shadow:Yh,Stop:Gh,Gradient:Zh,LinearGradient:Kh,RadialGradient:Qh,ShapeStyle:Jh,StrokeStyle:$h,TextStyle:tc,DiagramElement:Bh,PathElement:Hh,ImageElement:jh,TextElement:Fh,Container:ic,Canvas:sc,StackPanel:Cu,findConnectorPoints:_n,findAngle:vo,getIntersectionPoints:Co,getPortDirection:Zo,getOuterBounds:Ko,getOppositeDirection:Qo,processPathData:At,parsePathData:Mt,getRectanglePath:Rt,getPolygonPath:Dt,pathSegmentCollection:Bt,transformPath:Nt,updatedSegment:Ht,scalePathData:zt,splitArrayCollection:jt,getPathString:Vt,getString:Ft,randomId:te,getBounds:ee,cloneObject:ie,getInternalProperties:ne,cloneArray:oe,extendObject:re,extendArray:se,textAlignToString:ae,wordBreakToString:le,bBoxText:he,middleElement:ce,overFlow:de,whiteSpaceToString:pe,rotateSize:ue,rotatePoint:ge,getOffset:me,getFunction:fe,completeRegion:qr,findObjectType:Xr,findNearestPoint:Yr,isPointOverConnector:Zr,intersect3:Kr,getPoints:Qr,getTooltipOffset:Jr,sort:es,getAnnotationPosition:is,getOffsetOfConnector:ns,getAlignedPosition:os,alignLabelOnSegments:rs,getBezierDirection:ss,serialize:as,deserialize:ls,updateStyle:cs,updateHyperlink:ds,updateShapeContent:ps,updateShape:us,updateContent:gs,removeItem:ms,updateConnector:fs,getUserHandlePosition:vs,canResizeCorner:ys,canShowCorner:bs,checkPortRestriction:ws,findAnnotation:xs,findPortIndex:Ss,getObjectFromCollection:Cs,scaleElement:Ls,insertObject:Es,getObjectType:yp,CanvasRenderer:ch,DiagramRenderer:bp,DataBinding:Fu,getBasicShape:oi,getPortShape:ri,getDecoratorShape:si,getIconShape:ai,getFlowShape:li,Hyperlink:gc,Annotation:mc,ShapeAnnotation:fc,PathAnnotation:vc,Port:cc,PointPort:dc,menuClass:Wf,DiagramContextMenu:Uf,Shape:Kd,Path:Qd,Native:Jd,Html:$d,Image:tp,Text:ep,BasicShape:ip,FlowShape:np,BpmnGateway:op,BpmnDataObject:rp,BpmnTask:sp,BpmnEvent:ap,BpmnSubEvent:lp,BpmnTransactionSubProcess:hp,BpmnSubProcess:cp,BpmnActivity:dp,BpmnAnnotation:pp,BpmnShape:up,Node:gp,BpmnDiagrams:qf,getBpmnShapePathData:wa,getBpmnTriggerShapePathData:xa,getBpmnGatewayShapePathData:Sa,getBpmnTaskShapePathData:Ca,getBpmnLoopShapePathData:La,Decorator:Md,Vector:Rd,ConnectorShape:Dd,BpmnFlow:Bd,ConnectorSegment:Nd,StraightSegment:Hd,BezierSegment:zd,OrthogonalSegment:jd,getDirection:Jo,isEmptyVector:$o,getBezierPoints:tr,getBezierBounds:er,bezierPoints:ir,Connector:Vd,ConnectorBridging:Qf,Snapping:Jf,UndoRedo:$f,DiagramTooltip:Ld,initTooltip:Hn,updateTooltip:Vn,LayoutAnimation:tv,UserHandle:Wd,Selector:Ud,ToolBase:_p,SelectTool:Wp,ConnectTool:Up,MoveTool:qp,RotateTool:Xp,ResizeTool:Yp,NodeDrawingTool:Gp,ConnectorDrawingTool:Zp,TextDrawingTool:Kp,ZoomPanTool:Qp,ExpandTool:Jp,LabelTool:$p,PolygonDrawingTool:tu,DiagramEventHandler:nu,CommandHandler:lu,findToolToActivate:Ps,findPortToolToActivate:Ts,contains:Is,hasSelection:As,hasSingleConnection:Ms,isSelected:Rs,getCursor:Ds,ConnectorEditing:iu,DataSource:Np,Gridlines:Tp,SnapSettings:Op,KeyGesture:gu,Command:mu,CommandManager:fu,ContextMenuSettings:vu,Layout:jp,MindMap:iv,HierarchicalTree:ev,RadialTree:nv,GraphForceNode:ov,SymmetricLayout:rv,GraphLayoutManager:sv,ComplexHierarchicalTree:av,Palette:gv,SymbolPreview:mv,SymbolPalette:fv,Ruler:vp,Overview:bv});return t.diagrams=wv,t.base=ih,t.data=Vu,t.navigations=_f,t.inputs=Cm,t.popups=xd,t.buttons=Vc,t.lists=Ju,t}({});
//# sourceMappingURL=ej2-diagrams.min.js.map
